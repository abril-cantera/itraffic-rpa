!function(){"use strict";var e={58394:function(e,t,o){e.exports=o.p+"aa56bb5b97ec10ed9127.css"}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.m=e,o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e}(),o.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(e){if(!e)return"";try{const[t,o,n]=e.split("-");return`${o}/${n}/${t}`}catch(e){return""}}const t=["1 BODEGA CON ALMUERZO LUJAN/MAIPU","2 BODEGAS CON ALMUERZO LUJAN/MAIPU","2 BODEGAS CON ALMUERZO VDU","ACTIVIDAD EN BODEGA","ACTIVIDAD EN BODEGAS CORPORATIVO 21%","ACTIVIDAD EN BODEGAS CORPORATIVO EXENTO","ALMUERZO EN BODEGA ALFACRUX","ALMUERZO EN RESTAURANTE","ALMUERZO EN VALLE ANDINO","ALMUERZO RESTAURANT","ALMUERZO THE VINES","ALMUERZO/CENA EN BODEGA","ALMUERZO/CENA EN BODEGA VU C/TRASLADO","ALMUERZO/CENA EN BODEGA ZC C/TRASLADO","ALMUERZO/CENA EN BODEGAS ZC","ALMUERZO/CENA EN RESTAURANTE","ALTA MONTA√ëA","ALTA MONTA√ëA EN PRIVADO","ATARDECER EN VIGIL","BODEGAS Y OLIVAS EN PRIVADO","BODEGAS ZONA MAIPU C ALMUERZO","CABALGATA AL ATARDECER + CENA","CABALGATA AL ATARDECER CON ASADO COMPLETO","CABALGATA CRIOLLA","CABALGATA ENTRE VI√ëEDOS CON ASADO","CABALGATA RINCON DE LOS OSCUROS","CACHEUTA CIUDAD O*V","CACHEUTA POR TRAMO","CA√ëON DEL ATUEL DESDE MENDOZA","CA√ëON DEL ATUEL EN PRIVADO","CA√ëON DEL ATUEL SAN RAFAEL","CATA DE BURBUJAS CON VINO Y PICADA","CENA DE FIN DE A√ëO","CENA FIN DE A√ëO EN SHERATON","CENA GOURMET EN RESTAURANT DE BODEGA","CITY HOTEL CENTRICO","CITY TOUR","CITY TOUR + BODEGA C/ALM","CITY TOUR + DEGUSTACI√ìN","CITY TOUR EN PRIVADO","CIUDAD - SAN RAFAEL CON ESPERA","COMISIONES CLIENTE","COOKING CLASS VALLE DE UCO + ALMUERZO","COOKING CLASS ZONA CENTRO","COROLLA - CACHEUTA POR TRAMO","COROLLA - TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM","COROLLA - TRASLADO A 3 BODEGAS VALLE DE UCO","COROLLA - TRF IN/OUT AEROP CACHEUTA","COROLLA TRF IN AEROP BOD/POS ZC","COROLLA TRF IN AEROP- HOTEL CENTRICO","COROLLA TRF IN AEROP/CDAD A BOD/POS UCO","COROLLA TRF OUT AEROP/CDAD A BOD/POS UCO","COROLLA TRF OUT BOD/POS ZC AEROP","COROLLA TRF OUT HOTEL CENTRICO-AEROP","COSTUMBRES MENDOCINAS (AFA)","CRONOS - CACHEUTA POR TRAMO","CRONOS - TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM","CRONOS - TRASLADO A 3 BODEGAS VALLE DE UCO","CRONOS - TRF IN/OUT AEROP CACHEUTA","CRONOS TRF IN AEROP BOD/POS ZC","CRONOS TRF IN AEROP- HOTEL CENTRICO","CRONOS TRF IN AEROP/CDAD A BOD/POS UCO","CRONOS TRF OUT AEROP/CDAD A BOD/POS UCO","CRONOS TRF OUT BOD/POS ZC AEROP","CRONOS TRF OUT HOTEL CENTRICO-AEROP","DIA DE AVENTURA","DIQUE LOS REYUNOS SAN RAFAEL","ENOLOGO POR UN DIA C/ALM","ENTRADAS VENDIMIA 2026","ENTRE VIDES Y COPAS","EXCURSION ANDESTRUCK","EXCURSION BARREAL - PAMPA EL LEONCITO - CALINGASTA - OBSERVATORIO ASTRONOMICO","EXCURSION BODEGA PUTRUELE","EXCURSION CANOPY ADRENALINA","EXCURSION CANOPY BASE","EXCURSION CIUDAD - DIQUES Y QUEBRADA","EXCURSION DIQUES Y QUEBRADA CON ALMUERZO EN BODEGA","EXCURSION FULL DAY DE VINOS VALLE DE UCO","EXCURSION FULL DAY DE VINOS VALLE DE UCO PREMIUM","EXCURSION FULL DAY DE VINOS ZONA CENTRO","EXCURSION FULL DAY DE VINOS ZONA CENTRO PREMIUM","EXCURSION MENDOZA VINOS Y OLIVA","EXCURSION PARQUE ISCHIGUALASTO - VALLE DE LA LUNA (UAQ)","EXCURSION PARQUE NACIONAL TALAMPAYA (UAQ)","EXCURSION RAFTING MEDIO DIA","EXCURSION RUTA INTERLAGO ‚Äì DIQUES QUEBRADAS Y MIRADORES","EXCURSION TREKKING CERRO NEGRO","EXCURSION TREKKING CON RAPPEL","EXCURSION VALLE DE LAS LE√ëAS","EXCURSION VALLES IGLECIANOS JACHAL - RODEO - IGLESIA","EXCURSION VINOS Y SABORES DE MAIPU","EXCURSION VI√ëEDOS Y BODEGAS - RUTA DEL VINO","EXPERIENCIA ACONCAGUA","EXPERIENCIA ALMUERZO O CENA EL ENEMIGO","EXPERIENCIA ALMUERZO O CENA EN ANGELICA","EXPERIENCIA CATENA ZAPATA CON ALMUERZO EN EL ENEMIGO","EXPERIENCIA CHOCOLATE","EXPERIENCIA VALLE DE UCO","FULL CATENA (DEGUSTACION CATENA+ ALM ANGELICA)","FULL DAY SALENTEIN","FULL DAY SPA SIN TRASLADO","FULL DAY SPA TERMAS CON TRASLADOS","FULL DAY SPA Y GLOBO PREMIUM","HASTA 3 BODEGAS S ALMUERZO","HOTEL - POTRERILLOS - HOTEL (5hs)","HOTEL CACHEUTA (5 HS)","LAGUNA DE LLANCANELO","LAS LE√ëAS CIUDAD O*V","LOS VALLES HASTA LAS LE√ëAS 1/2 DIA","MANQUI MALAL (s/ Entrada) 1/2 DIA","MINDFULNESS TERMAL CON TRASLADOS","PAQUETE TERMAS CON BODEGAS EN CORD√ìN DEL PLATA","PAQUETE VENDIMIA -ENTRADA CHARDONNAY","PAQUETE VENDIMIA -ENTRADA MALBEC","PAQUETE VENDIMIA -ENTRADA TEMPRANILLO","PAQUETE VINOS Y M√ÅS","PARQUE DE AGUA CON TRASLADOS","PASEO EN GLOBO","PASEO EN VELERO CON QUESOS Y VINOS","PAYUNIA 4x4","POTRERILLOS CIUDAD O*V","PROGRAMA 1 SAN JUAN Y LA RIOJA","RAFTING CON TARDE DE SPA","RECARGO TC","RUTA DE SABORES","SAN RAFAEL - CIUDAD o*V","SERVICIO DE GUIA ALTA MONTA√ëA","SERVICIO DE GUIA CA√ëON DEL ATUEL","SERVICIO DE GUIA DIA COMPLETO","SERVICIO DE GUIA FULL DAY","SERVICIO DE GUIA FULL DAY VALLE DE UCO","SERVICIO DE GUIA IN / OUT HOTEL / POSADA VALLE DE UCO","SERVICIO DE GUIA IN / OUT HOTEL O POSADA LUJAN/MAIPU","SERVICIO DE GUIA MEDIO DIA","SERVICIO DE GUIA MEDIO DIA CITY","SERVICIO DE GUIA MEDIO DIA CON ALMUERZO","SERVICIO DE GUIA MEDIO DIA EXCURSION CONVENCIONAL","SERVICIO DE GUIA TRASLADO A CENA","SERVICIO DE GUIA TRASLADO A CENA CON ASISTENCIA","SERVICIO DE GUIA TRASLADO A CENA CON ESPERA","SERVICIO DE GUIA TRASLADO A CHILE","SERVICIO DE GUIA TRF IN / OUT HOTEL O POSADA LUJAN/MAIPU","SERVICIO DE GUIA TRF IN/ OUT HOTEL CENTRO","SERVICIO DE GUIA TRF IN/OUT HOTEL - VALLE DE UCO","SERVICIO FULL DAY","SERVICIO FULL DAY VALLE DE UCO","SERVICIOS EN LAS LE√ëAS","SNACKS","SPA HAMMAM - 8H CON ALMUERZO","TARDECITAS EN ANDELUNA","TICKET BUS TERRESTRE","TOUR CACHEUTA","TOUR CATENA Y VIGIL","TOUR DE BICI POR ZUCCARDI CON ALMUERZO PARRILLERO","TOUR ORGANICO - VIS. BODEGA CECCHIN Y VISITA CON PICNIC EN ALPAMANTA","TOUR POTRERILLOS c/ ALM EN EL HOTEL","TRASLADO A 1 BODEGAS MAIPU/LUJAN C/ALM","TRASLADO A 1 BODEGAS MAIPU/LUJAN C/CENA","TRASLADO A 2 BODEGAS MAIPU/LUJAN C/ALM","TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM","TRASLADO A 3 BODEGAS VALLE DE UCO","TRASLADO A CHILE","TRASLADO A PENITENTES CON ESPERA","TRASLADO A SANTIAGO DE CHILE","TRASLADO AEROP DE SAN RAFAEL A LAS LE√ëAS","TRASLADO ALTA MONTA√ëA","TRASLADO BODEGAS","TRASLADO CA√ëON","TRASLADO CITY TOUR","TRASLADO CIUDAD USPALLATA / VALLECITOS O*V","TRASLADO CON ESPERA RESTO CIUDAD","TRASLADO CON ESPERA VALLE DE UCO HASTA 3 BODEGAS C/ALM","TRASLADO CON ESPERA ZONA MAIPU LUJAN HASTA 3 BODEGAS C/ALM","TRASLADO HOTEL CENTRICO RESTAURANTE ZC","TRASLADO PENITENTES / ACONCAGUA POR EL D√çA","TRASLADO RESTO-CIUDAD","TRASLADO TOUR  BODEGAS Y OLIVAS","TRASLADO VILLAVICENCIO","TRASLADOS VARIOS CORPORATIVO 10.5%","TRASLADOS VARIOS CORPORATIVO EXENTO","TREKKING CERRO ARENALES-VALLECITOS","TREKKING CERRO BAYOS","TREKKING CERRO CABRAS","TREKKING LAS CAMPANAS","TRF AEROPUERTO CACHEUTA IN/OUT","TRF HOTEL - POTRERILLOS - HOTEL (5hs)","TRF IN / OUT AEROPUERTO U HOTEL EN MENDOZA / AEROPUERTO U HOTEL SAN JUAN","TRF IN AEROP BOD/POS ZC","TRF IN AEROP UAQ- HOTEL CENTRICO","TRF IN AEROP- HOTEL CENTRICO","TRF IN AEROP/CDAD A BOD/POS UCO","TRF IN BOD/POS ZC AEROP","TRF IN HOTEL CENTRICO-AEROP","TRF IN HOTEL CENTRICO-TERMINAL","TRF IN TERMINAL- HOTEL CENTRICO","TRF IN/OUT AEROP CACHEUTA","TRF IN/OUT SAN RAFAEL AERO / HOTEL O*V","TRF IN/OUT SAN RAFAEL TERM / HOTEL O*V","TRF OUT AEROP- HOTEL CENTRICO","TRF OUT AEROP/CDAD A BOD/POS UCO","TRF OUT BOD/POS UCO A AERO","TRF OUT BOD/POS ZC AEROP","TRF OUT HOTEL CENTRICO-AEROP","TRF OUT HOTEL CENTRICO-AEROP UAQ","TRF OUT HOTEL CENTRICO-TERMINAL","TRF OUT TERMINAL- HOTEL CENTRICO","TRF TEST","USPALLATA POR TRAMO","VALLE DE UCO REGULAR","VALLE HERMOSO 1/2 DIA","VEHICULO A DISPOSICION HASTA 8 HS","VILLAVICENCIO","VILLAVICENCIO EN PRIVADO","VISITA A 2 BODEGAS CON DEGUSTACION","VISITA A BIANCHI c/ ALM EN ATAMISQUE","VISITA A NORTON CON ALMUERZO EN BELASCO","VISITA A ZUCCARDI CON ALMUERZO EN SALENTEIN","VISITA AL ENEMIGO c/ALM EN SANTA JULIA","VISITA AL ENEMIGO CON ALMUERZO EN ANGELICA","VISITA c/ PICADA EN BODEGA","VISITA CON DEGUSTACION EN BODEGA (ANAIA / VI√ëA COBOS)","VISITA CON DEGUSTACION EN BODEGA EL ENEMIGO","VISITA Y ALMUERZO EN VDU (SALENTEIN / DIAMANDES / LA VIGILIA)","VISITA Y DEGUSTACION EN 2 BODEGAS ZC C/TRASLADO","VISITA Y DEGUSTACION EN BODEGAS","VISITA Y DEGUSTACION EN BODEGAS VUCO","VOLCAN MALA CARA","WINE & FOOD TOUR","WINE & RIDE CAMINOS DEL VI√ëEDO","WINE & RIDE DESDE LUJAN CON ALMUERZO","WINE & RIDE DESDE MAIPU CON ALMUERZO EN ESENCIA","WINE & RIDE DESDE MAIPU CON ALMUERZO EN TRIVENTO","WINE & RIDE DESDE MAIPU SIN ALMUERZO","WINE & RIDE EXPERIENCIA CAROLINO","WINE & RIDE EXPERIENCIA DE LOS ANDES","WINE & RIDE LUJAN OPCION 1","WINE & RIDE LUJAN OPCION 2","WINE & RIDE LUJAN OPCION 3","WINE CLASSIC TOUR (Esencia o Villafa√±e)","WINE CLASSIC TOUR SUPERIOR (Pan y oliva o Hacienda del Plata)","WINE ECO TOURS - 2 BODEGAS CON ALMUERZO EN VALLE DE UCO","ZACTIVIDAD EN BODEGA","ZACTIVIDAD EN BODEGA VUCO + ALMUERZO","ZACTIVIDAD EN BODEGA ZC","ZALMUERZO BODEGA PENEDO","ZALMUERZO EN BODEGA","ZALMUERZO EN BODEGA GIMENEZ RIILI","ZALMUERZO EN BODEGA NIETO","ZALMUERZO EN BODEGA RUCA MALEN","ZALMUERZO EN BODEGA TONELES","ZALMUERZO EN BODEGAS ZC","ZALMUERZO EN RESTAURANTE","ZALMUERZO/CENA EN BODEGA","ZALMUERZO/CENA EN BODEGAS VUCO","ZALMUERZO/CENA EN BODEGAS ZC","ZCABALGATA COLIBRI","ZCABALGATA RANCHO VIEJO","ZCABALGATA RINCON DE LOS OSCUROS (2 HS)","ZCENA RINCON DE LOS OSCUROS (MENU 2)","ZENTRADAS MALBEC 2026","ZHASTA 3 BODEGAS S ALMUERZO","ZPASEO EN GLOBO","ZPASEO EN VELERO","ZREGALO PASAJERO","ZSERVICIO DE GUIA ALTA MONTA√ëA","ZSERVICIO DE GUIA ALTA MONTA√ëA x VILLAVICENCIO","ZSERVICIO DE GUIA CA√ëON DEL ATUEL","ZSERVICIO DE GUIA FULL DAY","ZSERVICIO DE GUIA FULL DAY VALLE DE UCO","ZSERVICIO DE GUIA MEDIO DIA CON ALMUERZO","ZSERVICIO DE GUIA MEDIO DIA CONVENCIONAL","ZSERVICIO DE GUIA MEDIO DIA EXCURSION CONVENCIONAL","ZSERVICIO DE GUIA TRASLADO A CENA","ZSERVICIO DE GUIA TRASLADO A CENA CON ASISTENCIA","ZTOUR PANOR√ÅMICO POTRERILLOS","ZTOUR POTRERILLOS MEDIO D√çA","ZTRASLADO A 1 BODEGAS MAIPU/LUJAN C/ALM","ZTRASLADO A 2 BODEGAS MAIPU/LUJAN C/ALM","ZTRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM","ZTRASLADO A 3 BODEGAS VALLE DE UCO","ZTRASLADO A 3 BODEGAS VALLE DE UCO C/ CRUCE","ZTRASLADO A PENITENTES CON ESPERA","ZTRASLADO AL GLOBO","ZTRASLADO AL RINCON DE LOS OSCUROS (5HS)","ZTRASLADO ALTA MONTA√ëA","ZTRASLADO CA√ëON","ZTRASLADO CITY TOUR","ZTRASLADO HASTA 3 BODEGAS S/ALMUERZO","ZTRASLADO RANCHO VIEJO","ZTRASLADO RESTO-CIUDAD","ZTRASLADO TOUR  BODEGAS Y OLIVAS","ZTRASLADO TOUR CA√ëON","ZTRASLADO TOUR VALLECITOS x EL DIA","ZTRASLADO VILLAVICENCIO","ZUCCARDI CON ALMUERZO EN SANTA JULIA (MEN√ö SANTA JULIA)","ZVISITA Y DEGUSTACION EN BODEGA","ZVISITA Y DEGUSTACION EN BODEGAS","ZVISITA Y DEGUSTACION EN BODEGAS VUCO","ZVISITA Y DEGUSTACION EN BODEGAS ZC","ZVISITA Y DEGUSTACION EN CATENA ZAPATA"],o={sellers:[],clients:[],statuses:[],reservationTypes:[],genders:[],documentTypes:[],countries:[],loaded:!1};let n={didExtractionExist:!1,doesReservationExist:!1,reservationCode:null,originData:null,createdReservationCode:null},a=null;function i(e,t="info"){const o=document.createElement("div");o.className=`status-message ${t}`,o.textContent=e,o.style.position="fixed",o.style.top="20px",o.style.left="50%",o.style.transform="translateX(-50%)",o.style.zIndex="10000",o.style.minWidth="200px",o.style.maxWidth="90%",o.style.textAlign="center",o.style.animation="slideDown 0.3s ease",document.body.appendChild(o),setTimeout(()=>{o.style.animation="slideUp 0.3s ease",setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o)},300)},3e3)}function l(){const e=document.getElementById("hotel_in"),t=document.getElementById("hotel_out");if(!(e&&t&&e.value&&t.value))return e&&(e.style.borderColor=""),void(t&&(t.style.borderColor=""));const o=new Date(e.value),n=new Date(t.value);return isNaN(o.getTime())||isNaN(n.getTime())?void 0:n<=o?(e.style.borderColor="#d32f2f",void(t.style.borderColor="#d32f2f")):void(Math.floor((n-o)/864e5)<1?(e.style.borderColor="#d32f2f",t.style.borderColor="#d32f2f"):(e.style.borderColor="",t.style.borderColor=""))}function r(){const e=document.getElementById("tipoReserva");e&&o.reservationTypes.length>0?(e.innerHTML='<option value="">Seleccione...</option>',o.reservationTypes.forEach(t=>{const o=document.createElement("option");o.value=t.name,o.textContent=t.name,e.appendChild(o)}),console.log(`üìã Tipo Reserva poblado con ${o.reservationTypes.length} opciones`)):e&&(e.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="AGENCIAS [COAG]">AGENCIAS [COAG]</option>\n      <option value="MAYORISTA [COMA]">MAYORISTA [COMA]</option>\n      <option value="DIRECTO [CODI]">DIRECTO [CODI]</option>\n      <option value="CORPORATIVA [COCO]">CORPORATIVA [COCO]</option>\n    ',console.log("üìã Tipo Reserva poblado con opciones por defecto"));const t=document.getElementById("estadoReserva");t&&o.statuses.length>0?(t.innerHTML='<option value="">Seleccione...</option>',o.statuses.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,t.appendChild(o)}),console.log(`üìã Estado poblado con ${o.statuses.length} opciones`)):t&&(t.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="PENDIENTE DE CONFIRMACION [PC]">PENDIENTE DE CONFIRMACION [PC]</option>\n      <option value="CONFIRMADA [CO]">CONFIRMADA [CO]</option>\n      <option value="CANCELADA [CA]">CANCELADA [CA]</option>\n    ',console.log("üìã Estado poblado con opciones por defecto"));const n=document.getElementById("vendedor");n&&o.sellers.length>0?(n.innerHTML='<option value="">Seleccione...</option>',o.sellers.forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,n.appendChild(t)}),console.log(`üìã Vendedor poblado con ${o.sellers.length} opciones`)):n&&(n.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="TEST TEST">TEST TEST</option>\n    ',console.log("üìã Vendedor poblado con opciones por defecto"));const a=document.getElementById("cliente");a&&o.clients.length>0?(a.innerHTML='<option value="">Seleccione...</option>',o.clients.forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,a.appendChild(t)}),console.log(`üìã Cliente poblado con ${o.clients.length} opciones`)):a&&(a.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="DESPEGAR - TEST - 1">DESPEGAR - TEST - 1</option>\n    ',console.log("üìã Cliente poblado con opciones por defecto"))}async function c(e=!1){try{const t=document.getElementById("run");t.style.display="none";const a=document.getElementById("loader");a.style.display="block";const l=document.getElementById("results");l.style.display="none",Office.context.mailbox.item,Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,async c=>{if(c.status===Office.AsyncResultStatus.Succeeded){const t=c.value;try{let c=[];try{c=await async function(){const e=[],t=Office.context.mailbox.item,o=10485760,n=52428800;let a=0;try{if(!t)return console.warn("‚ö†Ô∏è No se pudo acceder al item del email"),[];if(t.attachments&&t.attachments.length>0)for(let i=0;i<t.attachments.length;i++){const l=t.attachments[i];if([".jpg",".jpeg",".png",".gif",".bmp",".webp",".svg"].some(e=>l.name.toLowerCase().endsWith(e)))try{const i=await new Promise((e,o)=>{t.getAttachmentContentAsync(l.id,t=>{t.status===Office.AsyncResultStatus.Succeeded?e(t.value):o(new Error(t.error.message))})}),r=i.contentType||"image/jpeg",c=i.content,d=atob(c),u=new Uint8Array(d.length);for(let e=0;e<d.length;e++)u[e]=d.charCodeAt(e);const E=new Blob([u],{type:r});if(E.size>o){console.warn(`‚ö†Ô∏è Imagen ${l.name} es muy grande (${(E.size/1024/1024).toFixed(2)}MB), se comprimir√°`);const t=await s(E,l.name);if(t&&t.size>0){if(a+t.size>n){console.warn(`‚ö†Ô∏è L√≠mite total de tama√±o alcanzado. Se omitir√° ${l.name}`);continue}const o=new File([t],l.name,{type:t.type});e.push(o),a+=t.size}else console.warn(`‚ö†Ô∏è No se pudo comprimir ${l.name}, se omitir√°`)}else{if(a+E.size>n){console.warn(`‚ö†Ô∏è L√≠mite total de tama√±o alcanzado. Se omitir√° ${l.name}`);continue}const t=new File([E],l.name,{type:r});e.push(t),a+=E.size}}catch(e){console.warn(`‚ö†Ô∏è Error al extraer attachment ${l.name}:`,e)}}try{const i=await new Promise((e,o)=>{t.body.getAsync(Office.CoercionType.Html,t=>{t.status===Office.AsyncResultStatus.Succeeded?e(t.value):o(new Error(t.error.message))})}),l=(new DOMParser).parseFromString(i,"text/html").querySelectorAll("img");for(const t of l){const i=t.getAttribute("src");if(i&&i.startsWith("data:image/"))try{const[t,l]=i.split(","),r=t.match(/data:image\/([^;]+)/),c=r?`image/${r[1]}`:"image/png",d=atob(l),u=new Uint8Array(d.length);for(let e=0;e<d.length;e++)u[e]=d.charCodeAt(e);const E=new Blob([u],{type:c});if(E.size>o){console.warn(`‚ö†Ô∏è Imagen inline es muy grande (${(E.size/1024/1024).toFixed(2)}MB), se comprimir√°`);const t=await s(E,e.length);if(t&&t.size>0){if(a+t.size>n){console.warn("‚ö†Ô∏è L√≠mite total de tama√±o alcanzado. Se omitir√° imagen inline");continue}const o=new File([t],`inline-image-${e.length}.png`,{type:t.type});e.push(o),a+=t.size}else console.warn("‚ö†Ô∏è No se pudo comprimir imagen inline, se omitir√°")}else{if(a+E.size>n){console.warn("‚ö†Ô∏è L√≠mite total de tama√±o alcanzado. Se omitir√° imagen inline");continue}const t=`inline-image-${e.length}.${c.split("/")[1]||"png"}`,o=new File([E],t,{type:c});e.push(o),a+=E.size}}catch(e){console.warn("‚ö†Ô∏è Error al procesar imagen inline:",e)}}}catch(e){console.warn("‚ö†Ô∏è Error al extraer im√°genes inline del HTML:",e)}return console.log(`üì∏ Im√°genes extra√≠das: ${e.length} (${(a/1024/1024).toFixed(2)}MB total)`),e.length>0&&a>41943040&&console.warn(`‚ö†Ô∏è Advertencia: Se est√° usando ${(a/n*100).toFixed(1)}% del l√≠mite total de tama√±o`),e}catch(e){return console.error("‚ùå Error al extraer im√°genes:",e),[]}}(),c.length>0&&console.log(`üì∏ ${c.length} imagen(es) extra√≠da(s) del email`)}catch(e){console.warn("‚ö†Ô∏è Error al extraer im√°genes, continuando sin ellas:",e)}const O=await async function(e,t=!1,o=[]){const n="https://app-itraffic-rpa.whiteflower-4df565a8.eastus2.azurecontainerapps.io/api/extract",a=Office.context.mailbox;if(console.log("üì§ Enviando extracci√≥n - isReExtract:",t,"tipo:",typeof t),console.log("üì∏ Im√°genes a enviar:",o.length),o&&o.length>0)try{const i=new FormData;i.append("emailContent",e),i.append("userId",a.userProfile.emailAddress||"outlook-user"),i.append("conversationId",a.item.conversationId||"conversation-id"),i.append("isReExtract",t.toString());let l=0;if(o.forEach((e,t)=>{e&&e.size>0&&e.size<=52428800?(i.append("images",e,e.name),l++):console.warn(`‚ö†Ô∏è Imagen ${e?.name||t} inv√°lida o muy grande, se omitir√°`)}),0!==l){console.log(`üì§ Enviando ${l} imagen(es) con FormData`);const e=await fetch(n,{method:"POST",body:i});if(!e.ok){const t=await e.json().catch(()=>({error:"Error al extraer datos"}));throw new Error(t.error||"Error al extraer datos")}const t=await e.json();return{...t.data,didExtractionExist:t.didExtractionExist||!1,doesReservationExist:t.doesReservationExist||!1}}console.warn("‚ö†Ô∏è No hay im√°genes v√°lidas, se enviar√° sin im√°genes"),o=[]}catch(e){console.error("‚ùå Error al enviar FormData con im√°genes:",e),console.warn("‚ö†Ô∏è Reintentando sin im√°genes..."),o=[]}const i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailContent:e,userId:a.userProfile.emailAddress||"outlook-user",conversationId:a.item.conversationId||"conversation-id",isReExtract:t})});if(!i.ok){const e=await i.json();throw new Error(e.error||"Error al extraer datos")}const l=await i.json();return{...l.data,didExtractionExist:l.didExtractionExist||!1,doesReservationExist:l.doesReservationExist||!1}}(t,e,c);a.style.display="none",l.style.display="block";const v=document.querySelector(".ms-welcome__main");v&&v.classList.remove("no-scroll");const C=document.getElementById("reextract");if(C&&(C.style.display="block"),O&&O.passengers&&O.passengers.length>0){const e=O.didExtractionExist,t=!0===e||"true"===e||1===e,a=O.doesReservationExist,l=!0===a||"true"===a||1===a;console.log("üîç didExtractionExist recibido:",e,"tipo:",typeof e),console.log("üîç didExtractionExist convertido:",t),console.log("üîç doesReservationExist recibido:",a,"tipo:",typeof a),console.log("üîç doesReservationExist convertido:",l),n.didExtractionExist=t,n.doesReservationExist=l,n.reservationCode=O.reservationCode||null,l&&(n.originData=JSON.parse(JSON.stringify(O))),console.log("üíæ extractionState.didExtractionExist guardado:",n.didExtractionExist),console.log("üíæ extractionState.doesReservationExist guardado:",n.doesReservationExist),console.log("üíæ extractionState.reservationCode guardado:",n.reservationCode),console.log("üíæ extractionState.originData guardado:",n.originData),d(O.passengers.length,t),I=O.passengers,setTimeout(()=>{I.forEach((e,t)=>{const o=t+1;if(document.getElementById(`tipoPasajero_${o}`)){let t="";const n=e.passengerType||e.paxType;"ADU"===n?t="adulto":"CHD"===n?t="menor":"INF"===n&&(t="infante"),document.getElementById(`tipoPasajero_${o}`).value=t,document.getElementById(`nombre_${o}`).value=e.firstName||"",document.getElementById(`apellido_${o}`).value=e.lastName||"",document.getElementById(`dni_${o}`).value=e.documentNumber||"",document.getElementById(`fechaNacimiento_${o}`).value=e.dateOfBirth||e.birthDate||"",document.getElementById(`cuil_${o}`).value=e.cuilCuit||"";const a=document.getElementById(`tipoDoc_${o}`);a&&e.documentType&&(a.value=e.documentType,console.log(`‚úÖ Tipo Doc ${o}: ${e.documentType} -> ${a.value}`));const i=document.getElementById(`sexo_${o}`);i&&e.sex&&(i.value=e.sex,console.log(`‚úÖ Sexo ${o}: ${e.sex} -> ${i.value}`));const l=document.getElementById(`nacionalidad_${o}`);l&&e.nationality&&(l.value=e.nationality,console.log(`‚úÖ Nacionalidad ${o}: ${e.nationality} -> ${l.value}`)),document.getElementById(`direccion_${o}`).value=e.direccion||"",document.getElementById(`telefono_${o}`).value=e.phoneNumber||e.telefono||""}}),setTimeout(()=>p(),200)},150),u=O,r(),setTimeout(()=>{const e=document.getElementById("tipoReserva");if(e){const t=u.reservationType;if(console.log(`üîç Intentando asignar Tipo Reserva: "${t}"`),console.log("üìã Opciones en select:",Array.from(e.options).map(e=>`"${e.value}"`)),t&&"null"!==t&&null!==t&&(e.value=t,console.log(`‚úÖ Tipo Reserva asignado: "${t}" -> "${e.value}"`),!e.value||""===e.value)){const o=Array.from(e.options).find(e=>e.value&&t&&(e.value.toUpperCase().includes(t.toUpperCase())||t.toUpperCase().includes(e.value.toUpperCase())));o?(e.value=o.value,console.log(`‚úÖ Tipo Reserva (coincidencia): "${t}" -> "${e.value}"`)):console.warn(`‚ö†Ô∏è No se encontr√≥ coincidencia para Tipo Reserva: "${t}"`)}}const t=document.getElementById("estadoReserva");if(t){const e=u.status,o=Array.from(t.options).map(e=>e.value);if(console.log(`üîç Intentando asignar Estado: "${e}"`),console.log("üìã Opciones disponibles en select Estado:",o),console.log(`üìä Total de opciones: ${o.length}`),e&&"null"!==e&&null!==e)if(t.value=e,console.log(`üîÑ Intento directo: "${e}" -> "${t.value}"`),t.value&&""!==t.value)console.log(`‚úÖ Estado asignado correctamente: "${t.value}"`);else{console.log("‚ö†Ô∏è Asignaci√≥n directa fall√≥, buscando coincidencia...");const n=Array.from(t.options);let a=n.find(t=>t.value&&t.value.trim().toUpperCase()===e.trim().toUpperCase());if(a)t.value=a.value,console.log(`‚úÖ Estado (coincidencia exacta): "${e}" -> "${t.value}"`);else if(a=n.find(t=>t.value&&e&&(t.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(t.value.toUpperCase()))),a)t.value=a.value,console.log(`‚úÖ Estado (coincidencia parcial): "${e}" -> "${t.value}"`);else{const i=e.toUpperCase();i.includes("CONFIRMAD")||i.includes("CONFIRM")?a=n.find(e=>e.value&&e.value.toUpperCase().includes("CONFIRMAD")):i.includes("PENDIENTE")||i.includes("PENDING")?a=n.find(e=>e.value&&e.value.toUpperCase().includes("PENDIENTE")):(i.includes("CANCELAD")||i.includes("CANCEL"))&&(a=n.find(e=>e.value&&e.value.toUpperCase().includes("CANCELAD"))),a?(t.value=a.value,console.log(`‚úÖ Estado (mapeo inteligente): "${e}" -> "${t.value}"`)):(console.error(`‚ùå No se encontr√≥ ninguna coincidencia para Estado: "${e}"`),console.log("üí° Sugerencia: Verifica que el valor extra√≠do coincida con alguna de estas opciones:",o))}}else console.log(`‚ö†Ô∏è Estado es null o inv√°lido: "${e}"`)}document.getElementById("fechaViaje")&&(document.getElementById("fechaViaje").value=u.travelDate||"",console.log(`‚úÖ Fecha Viaje: ${u.travelDate}`));const n=document.getElementById("vendedor");if(n){const e=u.seller;if(e&&"null"!==e&&null!==e){if(n.value=e,console.log(`‚úÖ Vendedor: "${e}" -> "${n.value}"`),!n.value||""===n.value){const t=Array.from(n.options).find(t=>t.value&&e&&(t.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(t.value.toUpperCase())));t&&(n.value=t.value,console.log(`‚úÖ Vendedor (coincidencia): "${e}" -> "${n.value}"`))}}else console.log(`‚ö†Ô∏è Vendedor es null o inv√°lido: "${e}"`)}const a=document.getElementById("cliente");if(a){const e=u.client;if(e&&"null"!==e&&null!==e)if(a.value=e,a.value&&""!==a.value)console.log(`‚úÖ Cliente asignado correctamente: "${a.value}"`);else{const t=function(e,t){if(!e||"string"!=typeof e)return null;if(!t||!Array.isArray(t)||0===t.length)return null;const o=e.trim();if(0===o.length)return null;const n=o.toLowerCase();for(const e of t)if(e&&e.name&&"string"==typeof e.name&&e.name.trim().toLowerCase()===n)return e.name;const a=o.toUpperCase(),i=a.split(/\s+|[-‚Äì‚Äî]/).filter(e=>e.length>0);if(0===i.length)return null;let l=null,r=0,c=0;const s=a.replace(/\s+/g,"");for(const e of t){if(!e||!e.name||"string"!=typeof e.name)continue;const t=e.name.trim().toUpperCase(),o=t.replace(/\s+/g,"");let n=!1;if(s.length>0&&o.length>0){if(s===o)return e.name;(s.includes(o)||o.includes(s))&&(n=!0)}const a=t.split(/\s+|[-‚Äì‚Äî]/).filter(e=>e.length>0);if(0===a.length)continue;let d=0,u=0;i.forEach(e=>{a.some(t=>t===e?(u+=2,!0):!!((t.includes(e)||e.includes(t))&&e.length>=3&&t.length>=3)&&(u+=1,!0))&&d++}),n&&(u+=1.5),d>r&&(d>1||u>=2)?(r=d,c=u,l=e.name):d===r&&u>c&&(c=u,l=e.name)}return r>=2||c>=2?l:null}(e,o.clients);t?(a.value=t,console.log(`‚úÖ Cliente (coincidencia inteligente): "${e}" -> "${a.value}"`)):console.warn(`‚ö†Ô∏è No se encontr√≥ coincidencia para Cliente: "${e}"`)}else console.log(`‚ö†Ô∏è Cliente es null o inv√°lido: "${e}"`)}document.getElementById("codigo")&&(document.getElementById("codigo").value=u.codigo||""),document.getElementById("fechaReserva")&&(document.getElementById("fechaReserva").value=u.reservationDate||""),document.getElementById("fechaFinTour")&&(document.getElementById("fechaFinTour").value=u.tourEndDate||""),document.getElementById("fechaVencimiento")&&(document.getElementById("fechaVencimiento").value=u.dueDate||""),document.getElementById("contacto")&&(document.getElementById("contacto").value=u.contact||""),document.getElementById("contactEmail")&&(document.getElementById("contactEmail").value=u.contactEmail||""),document.getElementById("contactPhone")&&(document.getElementById("contactPhone").value=u.contactPhone||""),document.getElementById("moneda")&&(document.getElementById("moneda").value=u.currency||""),document.getElementById("tipoCambio")&&(document.getElementById("tipoCambio").value=u.exchangeRate||""),document.getElementById("comision")&&(document.getElementById("comision").value=u.commission||""),document.getElementById("montoNeto")&&(document.getElementById("montoNeto").value=u.netAmount||""),document.getElementById("montoBruto")&&(document.getElementById("montoBruto").value=u.grossAmount||""),document.getElementById("nombreViaje")&&(document.getElementById("nombreViaje").value=u.tripName||""),document.getElementById("codigoProducto")&&(document.getElementById("codigoProducto").value=u.productCode||""),document.getElementById("adultos")&&(document.getElementById("adultos").value=u.adults||""),document.getElementById("ninos")&&(document.getElementById("ninos").value=u.children||""),document.getElementById("infantes")&&(document.getElementById("infantes").value=u.infants||""),document.getElementById("proveedor")&&(document.getElementById("proveedor").value=u.provider||""),document.getElementById("codigoReserva")&&(document.getElementById("codigoReserva").value=u.reservationCode||"");const i=document.getElementById("hotelSection"),l=document.getElementById("agregarHotel"),r=document.getElementById("eliminarHotel");u.hotel&&"object"==typeof u.hotel?(i&&(i.style.display="block"),l&&(l.style.display="none"),r&&(r.style.display="block"),["hotel_nombre","hotel_tipo_habitacion","hotel_ciudad","hotel_in","hotel_out"].forEach(e=>{const t=document.getElementById(e);t&&(t.required=!0)}),document.getElementById("hotel_nombre")&&(document.getElementById("hotel_nombre").value=u.hotel.nombre_hotel||""),document.getElementById("hotel_tipo_habitacion")&&(document.getElementById("hotel_tipo_habitacion").value=u.hotel.tipo_habitacion||""),document.getElementById("hotel_ciudad")&&(document.getElementById("hotel_ciudad").value=u.hotel.Ciudad||""),document.getElementById("hotel_categoria")&&(document.getElementById("hotel_categoria").value=u.hotel.Categoria||""),document.getElementById("hotel_in")&&(document.getElementById("hotel_in").value=u.hotel.in||""),document.getElementById("hotel_out")&&(document.getElementById("hotel_out").value=u.hotel.out||"")):"string"==typeof u.hotel?(i&&(i.style.display="block"),l&&(l.style.display="none"),r&&(r.style.display="block"),["hotel_nombre","hotel_tipo_habitacion","hotel_ciudad","hotel_in","hotel_out"].forEach(e=>{const t=document.getElementById(e);t&&(t.required=!0)}),document.getElementById("hotel_nombre")&&(document.getElementById("hotel_nombre").value=u.hotel||"")):(i&&(i.style.display="none"),l&&(l.style.display="block"),r&&(r.style.display="none"),["hotel_nombre","hotel_tipo_habitacion","hotel_ciudad","hotel_in","hotel_out"].forEach(e=>{const t=document.getElementById(e);t&&(t.required=!1,t.value="")})),document.getElementById("checkIn")&&(document.getElementById("checkIn").value=u.checkIn||""),document.getElementById("checkOut")&&(document.getElementById("checkOut").value=u.checkOut||""),document.getElementById("estadoDeuda")&&(document.getElementById("estadoDeuda").value=u.estadoDeuda||"");const c=document.getElementById("serviciosSection");if(document.getElementById("agregarServicio"),u.services&&Array.isArray(u.services)&&u.services.length>0?(c&&(c.style.display="block"),function(e){const t=document.getElementById("serviciosContainer"),o=document.getElementById("serviciosSection");t&&(t.innerHTML="",o&&(o.style.display="block"),e.forEach((e,o)=>{const n=E(o,e,!0);t.appendChild(n)}),setTimeout(()=>p(),200))}(u.services)):c&&(c.style.display="none"),u.flights&&Array.isArray(u.flights)&&u.flights.length>0){const e=document.getElementById("vuelosSection");e&&(e.style.display="block"),function(e){const t=document.getElementById("vuelosContainer"),o=document.getElementById("vuelosSection");if(!t)return;t.innerHTML="",o&&(o.style.display="block");const n=document.getElementById("agregarVuelo");n&&(n.style.display="block"),e.forEach((e,o)=>{const n=A(o,e,!0);t.appendChild(n)}),setTimeout(()=>p(),200)}(u.flights)}setTimeout(()=>p(),200)},250),m(l),i(t?"‚úÖ Hay una extracci√≥n de datos existente para el correo":`‚úÖ Datos extra√≠dos: ${O.passengers.length} pasajero(s)`,"success")}else d(1),i("No se pudieron extraer datos. Por favor, llena el formulario manualmente.","info")}catch(e){a.style.display="none",l.style.display="block";const t=document.querySelector(".ms-welcome__main");t&&t.classList.remove("no-scroll"),d(1),i("Error al extraer datos: "+e.message+". Llena el formulario manualmente.","error")}}else a.style.display="none",t.style.display="block",i("Error al obtener el contenido del correo","error");var u,I})}catch(e){document.getElementById("loader").style.display="none",document.getElementById("run").style.display="block",i("Error inesperado: "+e.message,"error")}}async function s(e,t){return new Promise(t=>{try{const o=new Image,n=URL.createObjectURL(e),a=setTimeout(()=>{URL.revokeObjectURL(n),console.warn("‚ö†Ô∏è Timeout al comprimir imagen"),t(null)},3e4);o.onload=()=>{clearTimeout(a),URL.revokeObjectURL(n);try{const e=1920;let n=o.width,a=o.height;if((n>e||a>e)&&(n>a?(a=a/n*e,n=e):(n=n/a*e,a=e)),n<1||a<1)return console.warn("‚ö†Ô∏è Dimensiones inv√°lidas para compresi√≥n"),void t(null);const i=document.createElement("canvas");i.width=n,i.height=a;const l=i.getContext("2d");if(!l)return console.warn("‚ö†Ô∏è No se pudo obtener contexto del canvas"),void t(null);l.drawImage(o,0,0,n,a),i.toBlob(e=>{e&&e.size>0?t(e):(console.warn("‚ö†Ô∏è Error al generar blob comprimido"),t(null))},"image/jpeg",.8)}catch(e){console.warn("‚ö†Ô∏è Error durante la compresi√≥n:",e),t(null)}},o.onerror=()=>{clearTimeout(a),URL.revokeObjectURL(n),console.warn("‚ö†Ô∏è Error al cargar imagen para compresi√≥n"),t(null)},o.src=n}catch(e){console.warn("‚ö†Ô∏è Error al iniciar compresi√≥n:",e),t(null)}})}function d(e,t=!1){const o=document.getElementById("pasajerosContainer");o.innerHTML="";for(let t=0;t<e;t++){const e=u(t+1);o.appendChild(e)}setTimeout(()=>p(),200)}function u(e){const t=document.createElement("div");t.className="pasajero-acordeon",t.dataset.numeroPasajero=e;const n=document.createElement("div");n.className="pasajero-header",n.innerHTML=`\n    <span class="pasajero-titulo">Pasajero ${e}</span>\n    <div class="pasajero-actions">\n      <span class="arrow">‚ñº</span>\n      <button class="btn-eliminar-pasajero" title="Eliminar pasajero">‚úï</button>\n    </div>\n  `;const a=document.createElement("div");return a.className="pasajero-content",a.style.display="none",a.innerHTML=`\n    <div>\n      <label>Tipo de Pasajero:</label>\n      <select id="tipoPasajero_${e}">\n        <option value="">Seleccione...</option>\n        <option value="adulto">Adulto</option>\n        <option value="menor">Menor</option>\n        <option value="infante">Infante</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nombre: <span style="color: red;">*</span></label>\n      <input type="text" id="nombre_${e}" placeholder="Ingrese el nombre">\n    </div>\n\n    <div>\n      <label>Apellido: <span style="color: red;">*</span></label>\n      <input type="text" id="apellido_${e}" placeholder="Ingrese el apellido">\n    </div>\n\n    <div>\n      <label>DNI:</label>\n      <input type="number" id="dni_${e}" placeholder="Ingrese el DNI">\n    </div>\n\n    <div>\n      <label>Fecha de Nacimiento:</label>\n      <input type="date" id="fechaNacimiento_${e}">\n    </div>\n\n    <div>\n      <label>CUIL:</label>\n      <input type="number" id="cuil_${e}" placeholder="Ingrese el CUIL">\n    </div>\n\n    <div>\n      <label>Tipo de Documento:</label>\n      <select id="tipoDoc_${e}">\n        <option value="">Seleccione...</option>\n        <option value="dni">DNI</option>\n        <option value="pasaporte">Pasaporte</option>\n        <option value="cedula">C√©dula</option>\n        <option value="otro">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Sexo:</label>\n      <select id="sexo_${e}">\n        <option value="">Seleccione...</option>\n        <option value="masculino">Masculino</option>\n        <option value="femenino">Femenino</option>\n        <option value="otro">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nacionalidad:</label>\n      <select id="nacionalidad_${e}">\n        <option value="">Seleccione...</option>\n        <option value="argentina">Argentina</option>\n        <option value="brasilera">Brasilera</option>\n        <option value="chilena">Chilena</option>\n        <option value="uruguaya">Uruguaya</option>\n        <option value="paraguaya">Paraguaya</option>\n        <option value="boliviana">Boliviana</option>\n        <option value="peruana">Peruana</option>\n        <option value="colombiana">Colombiana</option>\n        <option value="venezolana">Venezolana</option>\n        <option value="otra">Otra</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Direcci√≥n:</label>\n      <input type="text" id="direccion_${e}" placeholder="Ingrese la direcci√≥n">\n    </div>\n\n    <div>\n      <label>N√∫mero de Tel√©fono:</label>\n      <input type="tel" id="telefono_${e}" placeholder="Ingrese el tel√©fono">\n    </div>\n  `,n.onclick=function(e){if(e.target.classList.contains("btn-eliminar-pasajero"))return;const t="block"===a.style.display,o=n.querySelector(".arrow");t?(a.style.display="none",o.style.transform="rotate(0deg)"):(a.style.display="block",o.style.transform="rotate(180deg)")},setTimeout(()=>{const t=document.getElementById(`nombre_${e}`),o=document.getElementById(`apellido_${e}`);t&&t.addEventListener("input",p),o&&o.addEventListener("input",p)},100),n.querySelector(".btn-eliminar-pasajero").onclick=function(e){e.stopPropagation(),function(e){try{if(document.getElementById("pasajerosContainer").querySelectorAll(".pasajero-acordeon").length<=1)return void i("Debe haber al menos un pasajero","info");e.remove(),document.getElementById("pasajerosContainer").querySelectorAll(".pasajero-acordeon").forEach((e,t)=>{const o=t+1;e.querySelector(".pasajero-titulo").textContent=`Pasajero ${o}`,e.dataset.numeroPasajero=o}),i("Pasajero eliminado correctamente","success"),setTimeout(()=>p(),200)}catch(e){i("Error al eliminar pasajero","error")}}(t)},t.appendChild(n),t.appendChild(a),setTimeout(()=>{!function(e){const t=document.getElementById(`sexo_${e}`);if(t&&o.genders.length>0){const n=t.value;t.innerHTML='<option value="">Seleccione...</option>',o.genders.forEach(e=>{const o=document.createElement("option");o.value=e.code,o.textContent=e.name,t.appendChild(o)}),n&&(t.value=n),console.log(`üìã Sexo ${e} poblado con ${o.genders.length} opciones`)}else t&&(t.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="M">MASCULINO</option>\n      <option value="F">FEMENINO</option>\n    ',console.log(`üìã Sexo ${e} poblado con opciones por defecto`));const n=document.getElementById(`tipoDoc_${e}`);if(n&&o.documentTypes.length>0){const t=n.value;n.innerHTML='<option value="">Seleccione...</option>',o.documentTypes.forEach(e=>{const t=document.createElement("option");t.value=e.code,t.textContent=e.name,n.appendChild(t)}),t&&(n.value=t),console.log(`üìã Tipo Doc ${e} poblado con ${o.documentTypes.length} opciones`)}else n&&(n.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="DNI">DOCUMENTO NACIONAL DE IDENTIDAD</option>\n      <option value="PAS">PASAPORTE</option>\n      <option value="CI">C√âDULA DE IDENTIDAD</option>\n      <option value="LE">LIBRETA DE ENROLAMIENTO</option>\n      <option value="LC">LIBRETA C√çVICA</option>\n    ',console.log(`üìã Tipo Doc ${e} poblado con opciones por defecto`));const a=document.getElementById(`nacionalidad_${e}`);if(a&&o.countries.length>0){const t=a.value;a.innerHTML='<option value="">Seleccione...</option>',o.countries.forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,a.appendChild(t)}),t&&(a.value=t),console.log(`üìã Nacionalidad ${e} poblada con ${o.countries.length} opciones`)}else a&&(a.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="ARGENTINA">ARGENTINA</option>\n      <option value="BRASIL">BRASIL</option>\n      <option value="CHILE">CHILE</option>\n      <option value="URUGUAY">URUGUAY</option>\n      <option value="PARAGUAY">PARAGUAY</option>\n      <option value="BOLIVIA">BOLIVIA</option>\n      <option value="PERU">PERU</option>\n      <option value="COLOMBIA">COLOMBIA</option>\n      <option value="VENEZUELA">VENEZUELA</option>\n      <option value="ECUADOR">ECUADOR</option>\n      <option value="MEXICO">MEXICO</option>\n      <option value="ESPA√ëA">ESPA√ëA</option>\n      <option value="ESTADOS UNIDOS">ESTADOS UNIDOS</option>\n    ',console.log(`üìã Nacionalidad ${e} poblada con opciones por defecto`))}(e)},50),t}function E(e,o={},n=!1){const a=document.createElement("div");a.className="servicio-item";const l=o.servicio?function(e){if(!e||"string"!=typeof e)return null;const o=e.trim().toUpperCase().split(/\s+/).filter(e=>e.length>0);if(0===o.length)return null;let n=null,a=0,i=0;const l=["BODEGA","BODEGAS","TRASLADO","EXCURSION","TOUR","ALMUERZO","CENA","HOTEL","SPA","CABALGATA"];return t.forEach(e=>{const t=e.trim().toUpperCase().split(/\s+/).filter(e=>e.length>0);let r=0,c=0;o.forEach(e=>{t.some(t=>t===e?(l.includes(e)?c+=2:c+=1,!0):!!((t.includes(e)||e.includes(t))&&e.length>=3&&t.length>=3)&&(l.includes(e)||l.includes(t)?c+=1:c+=.5,!0))&&r++}),r>a&&(r>1||c>=2)?(a=r,i=c,n=e):r===a&&c>i&&(i=c,n=e)}),a>=2||i>=2?n:null}(o.servicio):null,r=function(e){if(!e||"string"!=typeof e)return"";if(2===e.length&&/^[A-Z]{2}$/.test(e))return e;const t=e.match(/^([A-Z]{2})\s*-/);if(t)return t[1];const o=e.match(/\[([A-Z]{2})\]/);return o?o[1]:""}(o.estado||""),c=`serviciosList_${e}`,s=n?"required":"",d=n?'<span style="color: red;">*</span>':"";return a.dataset.servicioIndex=e,a.innerHTML=`\n    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">\n      <h4 style="margin: 0;">Servicio ${e+1}</h4>\n      <button class="btn-eliminar-servicio" title="Eliminar servicio" data-servicio-index="${e}">‚úï</button>\n    </div>\n    <div class="form-group">\n      <label>Destino: ${d}</label>\n      <input type="text" id="servicio_destino_${e}" value="${o.destino||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Fecha Entrada: ${d}</label>\n      <input type="date" id="servicio_in_${e}" value="${o.in||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Fecha Salida: ${d}</label>\n      <input type="date" id="servicio_out_${e}" value="${o.out||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Noches: ${d}</label>\n      <input type="number" id="servicio_nts_${e}" value="${void 0!==o.nts&&null!==o.nts?o.nts:""}" min="0" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Base Pax: ${d}</label>\n      <input type="number" id="servicio_basePax_${e}" value="${o.basePax||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Servicio: ${d}</label>\n      <input type="text" id="servicio_servicio_${e}" \n             list="${c}" \n             value="${l||o.servicio||""}" \n             placeholder="Buscar o escribir servicio..."\n             ${s}>\n      <datalist id="${c}">\n        ${t.map(e=>`<option class="servicio-option" value="${e}">${e}</option>`).join("")}\n      </datalist>\n    </div>\n    <div class="form-group">\n      <label>Descripci√≥n: ${d}</label>\n      <textarea id="servicio_descripcion_${e}" ${s}>${o.descripcion||""}</textarea>\n    </div>\n    <div class="form-group">\n      <label>Estado: ${d}</label>\n      <select id="servicio_estado_${e}" ${s}>\n        <option value="">Seleccione...</option>\n        <option value="LI" ${"LI"===r?"selected":""}>LI - LIBERADO [LI]</option>\n        <option value="OK" ${"OK"===r?"selected":""}>OK - CONFIRMADO [OK]</option>\n        <option value="WL" ${"WL"===r?"selected":""}>WL - LISTA DE ESPERA [WL]</option>\n        <option value="RM" ${"RM"===r?"selected":""}>RM - FAVOR MODIFICAR [RM]</option>\n        <option value="NN" ${"NN"===r?"selected":""}>NN - FAVOR RESERVAR [NN]</option>\n        <option value="RQ" ${"RQ"===r?"selected":""}>RQ - REQUERIDO [RQ]</option>\n        <option value="LK" ${"LK"===r?"selected":""}>LK - RVA OK S/LIQUIDAR [LK]</option>\n        <option value="RE" ${"RE"===r?"selected":""}>RE - RECHAZADO [RE]</option>\n        <option value="MQ" ${"MQ"===r?"selected":""}>MQ - MODIFICACION REQUERIDA [MQ]</option>\n        <option value="CL" ${"CL"===r?"selected":""}>CL - FAVOR CANCELAR [CL]</option>\n        <option value="CA" ${"CA"===r?"selected":""}>CA - CANCELACION SOLICITADA [CA]</option>\n        <option value="CX" ${"CX"===r?"selected":""}>CX - CANCELADO [CX]</option>\n        <option value="EM" ${"EM"===r?"selected":""}>EM - EMITIDO [EM]</option>\n        <option value="EN" ${"EN"===r?"selected":""}>EN - ENTREGADO [EN]</option>\n        <option value="AR" ${"AR"===r?"selected":""}>AR - FAVOR RESERVAR [AR]</option>\n        <option value="HK" ${"HK"===r?"selected":""}>HK - OK CUPO [HK]</option>\n        <option value="PE" ${"PE"===r?"selected":""}>PE - PENALIDAD [PE]</option>\n        <option value="NO" ${"NO"===r?"selected":""}>NO - NEGADO [NO]</option>\n        <option value="NC" ${"NC"===r?"selected":""}>NC - NO CONFORMIDAD [NC]</option>\n        <option value="PF" ${"PF"===r?"selected":""}>PF - PENDIENTE DE FC. COMISION [PF]</option>\n        <option value="AO" ${"AO"===r?"selected":""}>AO - REQUERIR ON LINE [AO]</option>\n        <option value="CO" ${"CO"===r?"selected":""}>CO - CANCELAR ONLINE [CO]</option>\n        <option value="GX" ${"GX"===r?"selected":""}>GX - GASTOS CANCELACION ONLINE [GX]</option>\n        <option value="EO" ${"EO"===r?"selected":""}>EO - EN TRAFICO [EO]</option>\n        <option value="KL" ${"KL"===r?"selected":""}>KL - REQUERIDO CUPO [KL]</option>\n        <option value="MI" ${"MI"===r?"selected":""}>MI - RESERVA MIGRADA [MI]</option>\n        <option value="VO" ${"VO"===r?"selected":""}>VO - VOID [VO]</option>\n      </select>\n    </div>\n  `,setTimeout(()=>{[`servicio_destino_${e}`,`servicio_in_${e}`,`servicio_out_${e}`,`servicio_nts_${e}`,`servicio_basePax_${e}`,`servicio_servicio_${e}`,`servicio_descripcion_${e}`,`servicio_estado_${e}`].forEach(e=>{const t=document.getElementById(e);t&&(t.addEventListener("change",p),t.addEventListener("input",p))});const t=a.querySelector(".btn-eliminar-servicio");t&&(t.onclick=function(e){e.stopPropagation(),function(e){try{const t=document.getElementById("serviciosContainer");if(!t)return;if(t.querySelectorAll(".servicio-item").length<=1&&e.querySelector("[required]"))return void i("Debe haber al menos un servicio cuando vienen de la extracci√≥n","info");e.remove(),function(){const e=document.getElementById("serviciosContainer");if(!e)return;Array.from(e.querySelectorAll(".servicio-item")).forEach((e,t)=>{const o=t;e.dataset.servicioIndex=o;const n=e.querySelector("div:first-child");if(n){const e=n.querySelector("h4");e&&(e.textContent=`Servicio ${o+1}`)}["servicio_destino","servicio_in","servicio_out","servicio_nts","servicio_basePax","servicio_servicio","servicio_descripcion","servicio_estado"].forEach(t=>{const n=e.querySelector(`[id^="${t}_"]`);if(n){const a=n.value;if(n.id=`${t}_${o}`,n.value=a,"servicio_servicio"===t){const t=`serviciosList_${o}`;n.setAttribute("list",t);const a=e.querySelector("datalist");a&&(a.id=t)}}});const a=e.querySelector(".btn-eliminar-servicio");a&&a.setAttribute("data-servicio-index",o)})}(),i("Servicio eliminado correctamente","success"),setTimeout(()=>p(),200)}catch(e){i("Error al eliminar servicio","error")}}(a)})},100),a}function A(e,t={},o=!1){const n=t.departureDate||t.date||"",a=t.departureTime||t.time||"",l=t.arrivalDate||"",r=t.arrivalTime||"",c=document.createElement("div");c.className="vuelo-item",c.dataset.vueloIndex=e;const s=o?"readonly":"";return c.innerHTML=`\n    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">\n      <h4 style="margin: 0;">Vuelo ${e+1}</h4>\n      <button class="btn-eliminar-vuelo" title="Eliminar vuelo" data-vuelo-index="${e}">‚úï</button>\n    </div>\n    <div class="form-group">\n      <label>Aerol√≠nea:</label>\n      <input type="text" id="vuelo_airline_${e}" value="${t.airline||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>N√∫mero de Vuelo:</label>\n      <input type="text" id="vuelo_flightNumber_${e}" value="${t.flightNumber||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Origen:</label>\n      <input type="text" id="vuelo_origin_${e}" value="${t.origin||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Destino:</label>\n      <input type="text" id="vuelo_destination_${e}" value="${t.destination||""}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Fecha de Salida:</label>\n      <input type="date" id="vuelo_departureDate_${e}" value="${n}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Hora de Salida:</label>\n      <input type="time" id="vuelo_departureTime_${e}" value="${a}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Fecha de Llegada:</label>\n      <input type="date" id="vuelo_arrivalDate_${e}" value="${l}" ${s}>\n    </div>\n    <div class="form-group">\n      <label>Hora de Llegada:</label>\n      <input type="time" id="vuelo_arrivalTime_${e}" value="${r}" ${s}>\n    </div>\n  `,setTimeout(()=>{const e=c.querySelector(".btn-eliminar-vuelo");e&&(e.onclick=function(e){e.stopPropagation(),function(e){try{const t=document.getElementById("vuelosContainer");if(!t)return;if(t.querySelectorAll(".vuelo-item").length<=1&&e.querySelector("[readonly]"))return void i("Debe haber al menos un vuelo cuando vienen de la extracci√≥n","info");e.remove(),function(){const e=document.getElementById("vuelosContainer");if(!e)return;Array.from(e.querySelectorAll(".vuelo-item")).forEach((e,t)=>{const o=t;e.dataset.vueloIndex=o;const n=e.querySelector("div:first-child");if(n){const e=n.querySelector("h4");e&&(e.textContent=`Vuelo ${o+1}`)}["vuelo_airline","vuelo_flightNumber","vuelo_origin","vuelo_destination","vuelo_departureDate","vuelo_departureTime","vuelo_arrivalDate","vuelo_arrivalTime"].forEach(t=>{const n=e.querySelector(`[id^="${t}_"]`);if(n){const e=n.value;n.id=`${t}_${o}`,n.value=e}});const a=e.querySelector(".btn-eliminar-vuelo");a&&a.setAttribute("data-vuelo-index",o)})}(),i("Vuelo eliminado correctamente","success"),setTimeout(()=>p(),200)}catch(e){i("Error al eliminar vuelo","error")}}(c)})},100),c}function m(e=!1){const t=document.getElementById("crearReserva");if(!t)return;const o=t.querySelector(".ms-Button-label");if(o){const t=e?"‚úèÔ∏è Editar Reserva en iTraffic":"üöÄ Crear Reserva en iTraffic";o.textContent=t,console.log("üìù Texto del bot√≥n actualizado:",t,"isEdit:",e)}}function p(){const e=document.getElementById("crearReserva");if(!e)return;const t=function(){const e=document.getElementById("pasajerosContainer");if(!e)return!1;const t=e.querySelectorAll(".pasajero-acordeon");if(0===t.length)return!1;let o=!0;t.forEach(e=>{const t=e.dataset.numeroPasajero,n=e.querySelector(".pasajero-content");if(n){const e=n.querySelector(`#nombre_${t}`)?.value||"",a=n.querySelector(`#apellido_${t}`)?.value||"";""!==e.trim()&&""!==a.trim()||(o=!1)}});const n=document.getElementById("tipoReserva")?.value||"",a=document.getElementById("estadoReserva")?.value||"",i=document.getElementById("fechaViaje")?.value||"",l=document.getElementById("vendedor")?.value||"",r=document.getElementById("cliente")?.value||"",c=""!==n.trim()&&""!==a.trim()&&""!==i.trim()&&""!==l.trim()&&""!==r.trim(),s=document.getElementById("hotelSection");let d=!0;if(s&&"none"!==s.style.display){const e=document.getElementById("hotel_nombre"),t=document.getElementById("hotel_tipo_habitacion"),o=document.getElementById("hotel_ciudad"),n=document.getElementById("hotel_in"),a=document.getElementById("hotel_out");!e?.required||e.value&&""!==e.value.trim()||(d=!1),!t?.required||t.value&&""!==t.value.trim()||(d=!1),!o?.required||o.value&&""!==o.value.trim()||(d=!1),!n?.required||n.value&&""!==n.value.trim()||(d=!1),!a?.required||a.value&&""!==a.value.trim()||(d=!1)}const u=document.getElementById("serviciosSection"),E=document.getElementById("serviciosContainer");let A=!0;if(u&&"none"!==u.style.display&&E){const e=E.querySelectorAll(".servicio-item");e.length>0&&e.forEach((e,t)=>{const o=document.getElementById(`servicio_destino_${t}`),n=document.getElementById(`servicio_in_${t}`),a=document.getElementById(`servicio_out_${t}`),i=document.getElementById(`servicio_nts_${t}`),l=document.getElementById(`servicio_basePax_${t}`),r=document.getElementById(`servicio_servicio_${t}`),c=document.getElementById(`servicio_descripcion_${t}`),s=document.getElementById(`servicio_estado_${t}`);!o?.required||o.value&&""!==o.value.trim()||(A=!1),!n?.required||n.value&&""!==n.value.trim()||(A=!1),!a?.required||a.value&&""!==a.value.trim()||(A=!1),!i?.required||null!==i.value&&void 0!==i.value&&""!==i.value||(A=!1),!l?.required||l.value&&""!==l.value.trim()||(A=!1),!r?.required||r.value&&""!==r.value.trim()||(A=!1),!c?.required||c.value&&""!==c.value.trim()||(A=!1),!s?.required||s.value&&""!==s.value.trim()||(A=!1)})}return o&&c&&d&&A}(),o=!0===n.doesReservationExist;console.log("üîÑ actualizarEstadoBotonCrearReserva - doesReservationExist:",o,"extractionState:",n),m(o),t?(e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer"):(e.disabled=!0,e.style.opacity="0.5",e.style.cursor="not-allowed")}Office.onReady(t=>{try{if(t.host===Office.HostType.Outlook){const t=document.getElementById("datosReservaSection");t&&(a=t.innerHTML);const s=document.getElementById("sideload-msg");s&&(s.style.display="none");const d=document.getElementById("app-body");d&&(d.style.display="flex");const I=document.querySelector(".ms-welcome__main");I&&I.classList.add("no-scroll");const O=document.getElementById("run");O&&(O.onclick=function(){try{c()}catch(e){i("Error al extraer datos: "+e.message,"error")}});const v=document.getElementById("reextract");v&&(v.style.display="none",v.onclick=function(){try{document.getElementById("results").style.display="none",v.style.display="none",c(!0)}catch(e){i("Error al re-extraer datos: "+e.message,"error")}});const C=document.getElementById("guardar");C&&(C.onclick=function(){try{!function(){try{const e=document.getElementById("pasajerosContainer");if(!e)return void i("No se encontr√≥ el contenedor de pasajeros","error");const t=e.querySelectorAll(".pasajero-acordeon");if(0===t.length)return void i("No hay pasajeros para guardar. Por favor, extraiga datos primero.","info");const o=[];t.forEach((e,t)=>{const n=e.dataset.numeroPasajero,a=e.querySelector(".pasajero-content");if(a){const e={numeroPasajero:t+1,tipoPasajero:a.querySelector(`#tipoPasajero_${n}`)?.value||"",nombre:a.querySelector(`#nombre_${n}`)?.value||"",apellido:a.querySelector(`#apellido_${n}`)?.value||"",dni:a.querySelector(`#dni_${n}`)?.value||"",fechaNacimiento:a.querySelector(`#fechaNacimiento_${n}`)?.value||"",cuil:a.querySelector(`#cuil_${n}`)?.value||"",tipoDoc:a.querySelector(`#tipoDoc_${n}`)?.value||"",sexo:a.querySelector(`#sexo_${n}`)?.value||"",nacionalidad:a.querySelector(`#nacionalidad_${n}`)?.value||"",direccion:a.querySelector(`#direccion_${n}`)?.value||"",telefono:a.querySelector(`#telefono_${n}`)?.value||""};o.push(e)}}),i(`Datos de ${o.length} pasajero(s) guardados correctamente`,"success")}catch(e){throw e}}()}catch(e){i("Error al guardar datos: "+e.message,"error")}});const y=document.getElementById("agregarPasajero");y&&(y.onclick=function(){try{!function(){try{const e=document.getElementById("pasajerosContainer");if(!e)return;const t=u(e.querySelectorAll(".pasajero-acordeon").length+1);e.appendChild(t);const o=t.querySelector(".pasajero-content"),n=t.querySelector(".arrow");o&&n&&(o.style.display="block",n.style.transform="rotate(180deg)"),t.scrollIntoView&&t.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>p(),200)}catch(e){throw e}}()}catch(e){i("Error al agregar pasajero: "+e.message,"error")}});const g=document.getElementById("agregarHotel");g&&(g.onclick=function(){try{!function(){const e=document.getElementById("hotelSection"),t=document.getElementById("agregarHotel"),o=document.getElementById("eliminarHotel");e&&(e.style.display="block"),t&&(t.style.display="none"),o&&(o.style.display="block");["hotel_nombre","hotel_tipo_habitacion","hotel_ciudad","hotel_in","hotel_out"].forEach(e=>{const t=document.getElementById(e);t&&(t.required=!0)}),setTimeout(()=>p(),200)}()}catch(e){i("Error al agregar hotel: "+e.message,"error")}});const R=document.getElementById("agregarServicio");R&&(R.onclick=function(){try{!function(){const e=document.getElementById("serviciosContainer"),t=document.getElementById("serviciosSection");if(!e)return;t&&(t.style.display="block");const o=E(e.querySelectorAll(".servicio-item").length,{},!1);e.appendChild(o),o.scrollIntoView&&o.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>p(),200)}()}catch(e){i("Error al agregar servicio: "+e.message,"error")}});const N=document.getElementById("agregarVuelo");N&&(N.onclick=function(){try{!function(){const e=document.getElementById("vuelosContainer"),t=document.getElementById("vuelosSection");if(!e)return;t&&(t.style.display="block");const o=document.getElementById("agregarVuelo");o&&(o.style.display="block");const n=A(e.querySelectorAll(".vuelo-item").length,{},!1);e.appendChild(n),n.scrollIntoView&&n.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>p(),200)}()}catch(e){i("Error al agregar vuelo: "+e.message,"error")}});const S=document.getElementById("eliminarHotel");S&&(S.onclick=function(){try{!function(){try{const e=document.getElementById("hotelSection"),t=document.getElementById("agregarHotel");if(!e)return;["hotel_nombre","hotel_tipo_habitacion","hotel_ciudad","hotel_categoria","hotel_in","hotel_out"].forEach(e=>{const t=document.getElementById(e);t&&(t.value="",t.required=!1)}),e.style.display="none",t&&(t.style.display="block");const o=document.getElementById("eliminarHotel");o&&(o.style.display="none"),i("Hotel eliminado correctamente","success"),setTimeout(()=>p(),200)}catch(e){i("Error al eliminar hotel","error")}}()}catch(e){i("Error al eliminar hotel: "+e.message,"error")}});const T=document.getElementById("crearReserva");T&&(T.onclick=function(){!async function(){try{const t=document.getElementById("pasajerosContainer");if(!t)return void i("No se encontr√≥ el contenedor de pasajeros","error");const o=t.querySelectorAll(".pasajero-acordeon");if(0===o.length)return void i("No hay pasajeros para crear la reserva. Por favor, extraiga datos primero.","info");const l=[];o.forEach((e,t)=>{const o=e.dataset.numeroPasajero,n=e.querySelector(".pasajero-content");if(n){const e={numeroPasajero:t+1,tipoPasajero:n.querySelector(`#tipoPasajero_${o}`)?.value||"",nombre:n.querySelector(`#nombre_${o}`)?.value||"",apellido:n.querySelector(`#apellido_${o}`)?.value||"",dni:n.querySelector(`#dni_${o}`)?.value||"",fechaNacimiento:n.querySelector(`#fechaNacimiento_${o}`)?.value||"",cuil:n.querySelector(`#cuil_${o}`)?.value||"",tipoDoc:n.querySelector(`#tipoDoc_${o}`)?.value||"",sexo:n.querySelector(`#sexo_${o}`)?.value||"",nacionalidad:n.querySelector(`#nacionalidad_${o}`)?.value||"",direccion:n.querySelector(`#direccion_${o}`)?.value||"",telefono:n.querySelector(`#telefono_${o}`)?.value||""};l.push(e)}});const c={tipoReserva:document.getElementById("tipoReserva")?.value||"",estadoReserva:document.getElementById("estadoReserva")?.value||"",fechaViaje:document.getElementById("fechaViaje")?.value||"",vendedor:document.getElementById("vendedor")?.value||"",cliente:document.getElementById("cliente")?.value||"",codigo:document.getElementById("codigo")?.value||"",reservationDate:document.getElementById("fechaReserva")?.value||"",tourEndDate:document.getElementById("fechaFinTour")?.value||"",dueDate:document.getElementById("fechaVencimiento")?.value||"",contact:document.getElementById("contacto")?.value||"",contactEmail:document.getElementById("contactEmail")?.value||"",contactPhone:document.getElementById("contactPhone")?.value||"",currency:document.getElementById("moneda")?.value||"",exchangeRate:parseFloat(document.getElementById("tipoCambio")?.value)||0,commission:parseFloat(document.getElementById("comision")?.value)||0,netAmount:parseFloat(document.getElementById("montoNeto")?.value)||0,grossAmount:parseFloat(document.getElementById("montoBruto")?.value)||0,tripName:document.getElementById("nombreViaje")?.value||"",productCode:document.getElementById("codigoProducto")?.value||"",adults:parseInt(document.getElementById("adultos")?.value)||0,children:parseInt(document.getElementById("ninos")?.value)||0,infants:parseInt(document.getElementById("infantes")?.value)||0,provider:document.getElementById("proveedor")?.value||"",reservationCode:document.getElementById("codigoReserva")?.value||n.reservationCode||"",hotel:(()=>{const e=document.getElementById("hotel_nombre")?.value||"",t=document.getElementById("hotel_tipo_habitacion")?.value||"",o=document.getElementById("hotel_ciudad")?.value||"",n=document.getElementById("hotel_categoria")?.value||null,a=document.getElementById("hotel_in")?.value||"",i=document.getElementById("hotel_out")?.value||"";return e||t||o||a||i?{nombre_hotel:e,tipo_habitacion:t,Ciudad:o,Categoria:n||null,in:a,out:i}:null})(),checkIn:document.getElementById("checkIn")?.value||"",checkOut:document.getElementById("checkOut")?.value||"",estadoDeuda:document.getElementById("estadoDeuda")?.value||""},s=Office.context.mailbox.item;c.conversationId=s.conversationId||null,c.itemId=s.itemId||null;const d=[],u=document.getElementById("serviciosContainer");u&&u.querySelectorAll(".servicio-item").forEach((e,t)=>{d.push({destino:document.getElementById(`servicio_destino_${t}`)?.value||"",in:document.getElementById(`servicio_in_${t}`)?.value||"",out:document.getElementById(`servicio_out_${t}`)?.value||"",nts:parseInt(document.getElementById(`servicio_nts_${t}`)?.value)||0,basePax:parseInt(document.getElementById(`servicio_basePax_${t}`)?.value)||0,servicio:document.getElementById(`servicio_servicio_${t}`)?.value||"",descripcion:document.getElementById(`servicio_descripcion_${t}`)?.value||"",estado:document.getElementById(`servicio_estado_${t}`)?.value||""})}),c.services=d;const E=[],A=document.getElementById("vuelosContainer");A&&A.querySelectorAll(".vuelo-item").forEach((e,t)=>{E.push({airline:document.getElementById(`vuelo_airline_${t}`)?.value||"",flightNumber:document.getElementById(`vuelo_flightNumber_${t}`)?.value||"",origin:document.getElementById(`vuelo_origin_${t}`)?.value||"",destination:document.getElementById(`vuelo_destination_${t}`)?.value||"",departureDate:document.getElementById(`vuelo_departureDate_${t}`)?.value||"",departureTime:document.getElementById(`vuelo_departureTime_${t}`)?.value||"",arrivalDate:document.getElementById(`vuelo_arrivalDate_${t}`)?.value||"",arrivalTime:document.getElementById(`vuelo_arrivalTime_${t}`)?.value||""})}),c.flights=E;let m=[];l.forEach((e,t)=>{e.nombre&&""!==e.nombre.trim()||m.push(`Pasajero ${t+1}: Nombre`),e.apellido&&""!==e.apellido.trim()||m.push(`Pasajero ${t+1}: Apellido`)}),c.tipoReserva&&""!==c.tipoReserva.trim()||m.push("Tipo de Reserva"),c.estadoReserva&&""!==c.estadoReserva.trim()||m.push("Estado"),c.fechaViaje&&""!==c.fechaViaje.trim()||m.push("Fecha de Viaje"),c.vendedor&&""!==c.vendedor.trim()||m.push("Vendedor"),c.cliente&&""!==c.cliente.trim()||m.push("Cliente");const p=document.getElementById("hotelSection");if(p&&"none"!==p.style.display){const e=document.getElementById("hotel_nombre"),t=document.getElementById("hotel_tipo_habitacion"),o=document.getElementById("hotel_ciudad"),n=document.getElementById("hotel_in"),a=document.getElementById("hotel_out");if(!e?.required||c.hotel?.nombre_hotel&&""!==c.hotel.nombre_hotel.trim()||m.push("Hotel: Nombre"),!t?.required||c.hotel?.tipo_habitacion&&""!==c.hotel.tipo_habitacion.trim()||m.push("Hotel: Tipo de Habitaci√≥n"),!o?.required||c.hotel?.Ciudad&&""!==c.hotel.Ciudad.trim()||m.push("Hotel: Ciudad"),!n?.required||c.hotel?.in&&""!==c.hotel.in.trim()||m.push("Hotel: Fecha Entrada"),!a?.required||c.hotel?.out&&""!==c.hotel.out.trim()||m.push("Hotel: Fecha Salida"),c.hotel?.in&&c.hotel?.out){const e=new Date(c.hotel.in),t=new Date(c.hotel.out);if(t<=e)return void i("Las fechas del hotel no son v√°lidas. La fecha de salida debe ser al menos un d√≠a posterior a la fecha de entrada.","error");if(Math.floor((t-e)/864e5)<1)return void i("Las fechas del hotel deben tener al menos un d√≠a de diferencia. La fecha de salida debe ser posterior a la fecha de entrada.","error")}}const I=document.getElementById("serviciosSection");if(I&&"none"!==I.style.display)if(c.services&&0!==c.services.length)c.services.forEach((e,t)=>{const o=document.getElementById(`servicio_destino_${t}`),n=document.getElementById(`servicio_in_${t}`),a=document.getElementById(`servicio_out_${t}`),i=document.getElementById(`servicio_nts_${t}`),l=document.getElementById(`servicio_basePax_${t}`),r=document.getElementById(`servicio_servicio_${t}`),c=document.getElementById(`servicio_descripcion_${t}`),s=document.getElementById(`servicio_estado_${t}`);!o?.required||e.destino&&""!==e.destino.trim()||m.push(`Servicio ${t+1}: Destino`),!n?.required||e.in&&""!==e.in.trim()||m.push(`Servicio ${t+1}: Fecha Entrada`),!a?.required||e.out&&""!==e.out.trim()||m.push(`Servicio ${t+1}: Fecha Salida`),!i?.required||null!==i.value&&void 0!==i.value&&""!==i.value||m.push(`Servicio ${t+1}: Noches`),!l?.required||e.basePax&&0!==e.basePax||m.push(`Servicio ${t+1}: Base Pax`),!r?.required||e.servicio&&""!==e.servicio.trim()||m.push(`Servicio ${t+1}: Servicio`),!c?.required||e.descripcion&&""!==e.descripcion.trim()||m.push(`Servicio ${t+1}: Descripci√≥n`),!s?.required||e.estado&&""!==e.estado.trim()||m.push(`Servicio ${t+1}: Estado`)});else{const e=document.getElementById("serviciosContainer");if(e){const t=e.querySelector(".servicio-item");t&&t.querySelector("[required]")&&m.push("Servicios: Debe haber al menos un servicio")}}if(m.length>0)return void i(`Por favor completa los siguientes campos obligatorios: ${m.join(", ")}`,"error");const O=!0===n.doesReservationExist;if(console.log("üöÄ ejecutarCrearReserva - doesReservationExist:",O,"extractionState:",n),O&&n.originData){const e=c.services||[],t=c.hotel||null,o=function(e,t,o,n){const a={pasajeros:!1,servicios:!1,hotel:!1,tieneCambios:!1};if(!e)return a;const i=e.passengers||[];if(i.length!==t.length)a.pasajeros=!0,a.tieneCambios=!0;else for(let e=0;e<t.length;e++){const o=t[e],n=i[e];if(!n||o.nombre!==(n.firstName||"")||o.apellido!==(n.lastName||"")||o.dni!==(n.documentNumber||"")||o.fechaNacimiento!==(n.dateOfBirth||"")){a.pasajeros=!0,a.tieneCambios=!0;break}}const l=e.services||[];if(l.length!==o.length)a.servicios=!0,a.tieneCambios=!0;else for(let e=0;e<o.length;e++){const t=o[e],n=l[e];if(!n||t.destino!==(n.destino||"")||t.in!==(n.in||"")||t.out!==(n.out||"")||t.servicio!==(n.servicio||"")){a.servicios=!0,a.tieneCambios=!0;break}}const r=e.hotel||null;return null===r&&null!==n||null!==r&&null===n?(a.hotel=!0,a.tieneCambios=!0):r&&n&&(r.nombre_hotel===n.nombre_hotel&&r.Ciudad===n.Ciudad&&r.in===n.in&&r.out===n.out||(a.hotel=!0,a.tieneCambios=!0)),a}(n.originData,l,e,t);if(o.tieneCambios){const e=await function(e){return new Promise(t=>{const o=document.createElement("div");o.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.5);\n      z-index: 10001;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    ";const n=document.createElement("div");n.style.cssText="\n      background: white;\n      padding: 24px;\n      border-radius: 8px;\n      max-width: 500px;\n      width: 90%;\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n    ";const a=[];e.pasajeros&&a.push("Pasajeros"),e.servicios&&a.push("Servicios"),e.hotel&&a.push("Hotel"),n.innerHTML=`\n      <h3 style="margin-top: 0; margin-bottom: 16px; color: #d32f2f;">‚ö†Ô∏è Advertencia</h3>\n      <p style="margin-bottom: 16px; line-height: 1.5;">\n        Se detectaron cambios en los siguientes elementos que ser√°n <strong>reemplazados</strong>:\n      </p>\n      <ul style="margin-bottom: 20px; padding-left: 20px;">\n        ${a.map(e=>`<li style="margin-bottom: 8px;">${e}</li>`).join("")}\n      </ul>\n      <p style="margin-bottom: 20px; color: #666; font-size: 14px;">\n        ¬øDesea continuar con la edici√≥n?\n      </p>\n      <div style="display: flex; gap: 12px; justify-content: flex-end;">\n        <button id="modalCancelar" style="\n          padding: 10px 20px;\n          border: 1px solid #ccc;\n          background: white;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n        ">Cancelar</button>\n        <button id="modalContinuar" style="\n          padding: 10px 20px;\n          border: none;\n          background: #0078d4;\n          color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n        ">Continuar</button>\n      </div>\n    `,o.appendChild(n),document.body.appendChild(o),document.getElementById("modalCancelar").onclick=()=>{document.body.removeChild(o),t(!1)},document.getElementById("modalContinuar").onclick=()=>{document.body.removeChild(o),t(!0)},o.onclick=e=>{e.target===o&&(document.body.removeChild(o),t(!1))}})}(o);if(!e)return}}i(O?"Editando reserva en iTraffic... Por favor espere.":"Creando reserva en iTraffic... Por favor espere.","info"),function(){const e=document.getElementById("pasajerosContainer");e&&(e.querySelectorAll("input, select").forEach(e=>{e.disabled=!0,e.style.backgroundColor="#f3f4f6",e.style.cursor="not-allowed"}),e.querySelectorAll(".btn-eliminar-pasajero").forEach(e=>{e.disabled=!0,e.style.opacity="0.3",e.style.cursor="not-allowed",e.style.pointerEvents="none"}));["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const t=document.getElementById(e);t&&(t.disabled=!0,t.style.backgroundColor="#f3f4f6",t.style.cursor="not-allowed")});const t=document.getElementById("agregarPasajero");t&&(t.disabled=!0,t.style.opacity="0.5",t.style.cursor="not-allowed");const o=document.getElementById("guardar");o&&(o.disabled=!0,o.style.opacity="0.5",o.style.cursor="not-allowed")}();const v=document.getElementById("crearReserva");v&&(v.disabled=!0,v.style.opacity="0.6",v.querySelector(".ms-Button-label").textContent="‚è≥ Procesando...");const C=O?n.originData:null,y=await async function(t,o={},n=!1,a=null){try{const i=function(t,o={},n=!1,a=null){const i={passengers:t.map(t=>({lastName:t.apellido||"",firstName:t.nombre||"",paxType:"adulto"===t.tipoPasajero?"ADU":"menor"===t.tipoPasajero?"CHD":"INF",birthDate:e(t.fechaNacimiento),nationality:t.nacionalidad?.toUpperCase()||"ARGENTINA",sex:"masculino"===t.sexo?"M":"femenino"===t.sexo?"F":"O",documentNumber:t.dni||"",documentType:t.tipoDoc?.toUpperCase()||"DNI",cuilCuit:t.cuil||"",phoneNumber:t.telefono||"",direccion:t.direccion||""})),conversationId:o.conversationId||null,emailId:o.itemId||null,reservationType:o.tipoReserva||"AGENCIAS [COAG]",status:o.estadoReserva||"PENDIENTE DE CONFIRMACION [PC]",client:o.cliente||"DESPEGAR - TEST - 1",travelDate:e(o.fechaViaje)||"12/01/2026",seller:o.vendedor||"TEST TEST",codigo:o.codigo||"",reservationDate:e(o.reservationDate)||"",tourEndDate:e(o.tourEndDate)||"",dueDate:e(o.dueDate)||"",contact:o.contact||"",contactEmail:o.contactEmail||"",contactPhone:o.contactPhone||"",currency:o.currency||"ARS",exchangeRate:o.exchangeRate||0,commission:o.commission||0,netAmount:o.netAmount||0,grossAmount:o.grossAmount||0,tripName:o.tripName||"",productCode:o.productCode||"",adults:o.adults||0,children:o.children||0,infants:o.infants||0,provider:o.provider||"",reservationCode:o.reservationCode||"",hotel:o.hotel&&"object"==typeof o.hotel?o.hotel:o.hotel?{nombre_hotel:o.hotel,tipo_habitacion:"",Ciudad:"",Categoria:null}:null,checkIn:e(o.checkIn)||"",checkOut:e(o.checkOut)||"",estadoDeuda:o.estadoDeuda||"",services:o.services||[],flights:o.flights||[]};return n&&a&&(i.originData=a),i}(t,o,n,a),l=n?"https://app-itraffic-rpa.whiteflower-4df565a8.eastus2.azurecontainerapps.io/api/rpa/edit-reservation":"https://app-itraffic-rpa.whiteflower-4df565a8.eastus2.azurecontainerapps.io/api/rpa/create-reservation",r=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),c=await r.json();if(!r.ok||!1===c.success){const e=c.error||c.message||`Error del servidor: ${r.status} ${r.statusText}`;throw new Error(e)}return{success:!1!==c.success,data:c.data||c,reservationCode:c.reservationCode||null,message:c.message||(n?"Reserva editada exitosamente en iTraffic":"Reserva creada exitosamente en iTraffic")}}catch(e){if(e.message.includes("fetch"))throw new Error("No se pudo conectar con el servicio RPA. Aseg√∫rate de que el servidor est√© corriendo.");throw e}}(l,c,O,C),g=y.data?.reservationCode||y.reservationCode||null;g&&(n.createdReservationCode=g);let R=O?"¬°Reserva editada exitosamente en iTraffic!":"¬°Reserva creada exitosamente en iTraffic!";g&&(R+=` C√≥digo de la reserva: ${g}`),i(R,"success"),function(e=null){const t=document.getElementById("pasajerosContainer");t&&t.querySelectorAll(".pasajero-acordeon").forEach(e=>{const t=e.dataset.numeroPasajero,o=e.querySelector(".pasajero-content");if(o){const e={tipoPasajero:o.querySelector(`#tipoPasajero_${t}`)?.value||"",nombre:o.querySelector(`#nombre_${t}`)?.value||"",apellido:o.querySelector(`#apellido_${t}`)?.value||"",dni:o.querySelector(`#dni_${t}`)?.value||"",fechaNacimiento:o.querySelector(`#fechaNacimiento_${t}`)?.value||"",cuil:o.querySelector(`#cuil_${t}`)?.value||"",tipoDoc:o.querySelector(`#tipoDoc_${t}`)?.value||"",sexo:o.querySelector(`#sexo_${t}`)?.value||"",nacionalidad:o.querySelector(`#nacionalidad_${t}`)?.value||"",direccion:o.querySelector(`#direccion_${t}`)?.value||"",telefono:o.querySelector(`#telefono_${t}`)?.value||""};o.innerHTML=`\n          <div class="campo-lectura">\n            <label>Tipo de Pasajero:</label>\n            <p>${e.tipoPasajero||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Nombre:</label>\n            <p>${e.nombre||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Apellido:</label>\n            <p>${e.apellido||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>DNI:</label>\n            <p>${e.dni||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Fecha de Nacimiento:</label>\n            <p>${e.fechaNacimiento||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>CUIL:</label>\n            <p>${e.cuil||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Tipo de Documento:</label>\n            <p>${e.tipoDoc||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Sexo:</label>\n            <p>${e.sexo||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Nacionalidad:</label>\n            <p>${e.nacionalidad||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Direcci√≥n:</label>\n            <p>${e.direccion||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>N√∫mero de Tel√©fono:</label>\n            <p>${e.telefono||"-"}</p>\n          </div>\n        `}const n=e.querySelector(".btn-eliminar-pasajero");n&&(n.style.display="none")});const o=document.getElementById("datosReservaSection");if(o){const t=e||n.createdReservationCode||null,i={tipoReserva:document.getElementById("tipoReserva")?.value||"",estadoReserva:document.getElementById("estadoReserva")?.value||"",fechaViaje:document.getElementById("fechaViaje")?.value||"",vendedor:document.getElementById("vendedor")?.value||"",cliente:document.getElementById("cliente")?.value||""};if(o.innerHTML=`\n      <h3>Datos de la Reserva</h3>\n      ${t?`\n      <div class="campo-lectura">\n        <label>C√≥digo de Reserva:</label>\n        <p><strong>${t}</strong></p>\n      </div>\n      `:""}\n      <div class="campo-lectura">\n        <label>Tipo de Reserva:</label>\n        <p>${i.tipoReserva||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Estado:</label>\n        <p>${i.estadoReserva||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Fecha de Viaje:</label>\n        <p>${i.fechaViaje||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Vendedor:</label>\n        <p>${i.vendedor||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Cliente:</label>\n        <p>${i.cliente||"-"}</p>\n      </div>\n    `,!document.getElementById("crearOtraReserva")){const e=document.createElement("button");e.id="crearOtraReserva",e.className="ms-Button",e.style.cssText="margin-top: 20px; padding: 12px 24px; background: #0078d4; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;",e.innerHTML='<span class="ms-Button-label">‚ûï Crear otra reserva</span>',e.onclick=function(){!function(){const e=document.getElementById("results");e&&(e.style.display="none");const t=document.getElementById("run");t&&(t.style.display="block");const o=document.getElementById("reextract");o&&(o.style.display="none");const i=document.getElementById("pasajerosContainer");i&&(i.innerHTML="",document.getElementById("results")),n={didExtractionExist:!1,doesReservationExist:!1,reservationCode:null,originData:null,createdReservationCode:null};const l=document.getElementById("datosReservaSection");l&&a?(l.innerHTML=a,setTimeout(()=>{r(),["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const t=document.getElementById(e);t&&(t.disabled=!1,t.style.backgroundColor="",t.style.cursor="",t.value="")})},100)):["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const t=document.getElementById(e);t&&(t.disabled=!1,t.style.backgroundColor="",t.style.cursor="",t.value="")});const c=document.getElementById("hotelSection");c&&(c.style.display="none");const s=document.getElementById("serviciosSection");s&&(s.style.display="none");const d=document.getElementById("vuelosSection");d&&(d.style.display="none");const u=document.getElementById("agregarVuelo");u&&(u.style.display="none");const E=document.getElementById("crearOtraReserva");E&&E.remove()}()},o.appendChild(e)}}const i=document.getElementById("agregarPasajero");i&&(i.style.display="none");const l=document.getElementById("guardar");l&&(l.style.display="none");const c=document.getElementById("crearReserva");c&&(c.style.display="none")}(g)}catch(e){i(!0===n.doesReservationExist?"Error al editar reserva: "+e.message:"Error al crear reserva: "+e.message,"error"),function(){const e=document.getElementById("pasajerosContainer");e&&(e.querySelectorAll("input, select").forEach(e=>{e.disabled=!1,e.style.backgroundColor="#ffffff",e.style.cursor="text"}),e.querySelectorAll(".btn-eliminar-pasajero").forEach(e=>{e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer",e.style.pointerEvents="auto"}));["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const t=document.getElementById(e);t&&(t.disabled=!1,t.style.backgroundColor="#ffffff",t.style.cursor="pointer")});const t=document.getElementById("agregarPasajero");t&&(t.disabled=!1,t.style.opacity="1",t.style.cursor="pointer");const o=document.getElementById("guardar");o&&(o.disabled=!1,o.style.opacity="1",o.style.cursor="pointer");const a=document.getElementById("crearReserva");if(a){const e=!0===n.doesReservationExist;a.disabled=!1,a.style.opacity="1",m(e)}}()}}()},T.disabled=!0,T.style.opacity="0.5",T.style.cursor="not-allowed"),["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const t=document.getElementById(e);t&&(t.addEventListener("change",p),t.addEventListener("input",p))}),["hotel_nombre","hotel_tipo_habitacion","hotel_ciudad","hotel_in","hotel_out"].forEach(e=>{const t=document.getElementById(e);t&&(t.addEventListener("change",()=>{l(),p()}),t.addEventListener("input",()=>{l(),p()}))}),async function(){try{const e="https://app-itraffic-rpa.whiteflower-4df565a8.eastus2.azurecontainerapps.io/api/master-data",t=await fetch(e);if(!t.ok)return void console.warn("‚ö†Ô∏è No se pudieron cargar los datos maestros, usando valores por defecto");const n=await t.json();n.success&&n.data&&(o.sellers=n.data.sellers||[],o.clients=n.data.clients||[],o.statuses=n.data.statuses||[],o.reservationTypes=n.data.reservationTypes||[],o.genders=n.data.genders||[],o.documentTypes=n.data.documentTypes||[],o.countries=n.data.countries||[],o.loaded=!0,console.log("‚úÖ Datos maestros cargados:",{vendedores:o.sellers.length,clientes:o.clients.length,estados:o.statuses.length,tiposReserva:o.reservationTypes.length,generos:o.genders.length,tiposDoc:o.documentTypes.length,paises:o.countries.length}),r())}catch(e){console.error("‚ùå Error cargando datos maestros:",e)}}()}}catch(e){}})}(),new URL(o(58394),o.b)}();
//# sourceMappingURL=taskpane.js.map