!function(){"use strict";var e={58394:function(e,o,n){e.exports=n.p+"09c7ed346a47b145dfa0.css"}},o={};function n(t){var a=o[t];if(void 0!==a)return a.exports;var l=o[t]={exports:{}};return e[t](l,l.exports,n),l.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var o=n.g.document;if(!e&&o&&(o.currentScript&&"SCRIPT"===o.currentScript.tagName.toUpperCase()&&(e=o.currentScript.src),!e)){var t=o.getElementsByTagName("script");if(t.length)for(var a=t.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=t[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(e){if(!e)return"";try{const[o,n,t]=e.split("-");return`${n}/${t}/${o}`}catch(e){return""}}const o={sellers:[],clients:[],statuses:[],reservationTypes:[],genders:[],documentTypes:[],countries:[],loaded:!1};function n(e,o="info"){const n=document.createElement("div");n.className=`status-message ${o}`,n.textContent=e,n.style.position="fixed",n.style.top="20px",n.style.left="50%",n.style.transform="translateX(-50%)",n.style.zIndex="10000",n.style.minWidth="200px",n.style.maxWidth="90%",n.style.textAlign="center",n.style.animation="slideDown 0.3s ease",document.body.appendChild(n),setTimeout(()=>{n.style.animation="slideUp 0.3s ease",setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n)},300)},3e3)}function t(){const e=document.getElementById("tipoReserva");e&&o.reservationTypes.length>0?(e.innerHTML='<option value="">Seleccione...</option>',o.reservationTypes.forEach(o=>{const n=document.createElement("option");n.value=o.name,n.textContent=o.name,e.appendChild(n)}),console.log(`üìã Tipo Reserva poblado con ${o.reservationTypes.length} opciones`)):e&&(e.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="AGENCIAS [COAG]">AGENCIAS [COAG]</option>\n      <option value="MAYORISTA [COMA]">MAYORISTA [COMA]</option>\n      <option value="DIRECTO [CODI]">DIRECTO [CODI]</option>\n      <option value="CORPORATIVA [COCO]">CORPORATIVA [COCO]</option>\n    ',console.log("üìã Tipo Reserva poblado con opciones por defecto"));const n=document.getElementById("estadoReserva");n&&o.statuses.length>0?(n.innerHTML='<option value="">Seleccione...</option>',o.statuses.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,n.appendChild(o)}),console.log(`üìã Estado poblado con ${o.statuses.length} opciones`)):n&&(n.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="PENDIENTE DE CONFIRMACION [PC]">PENDIENTE DE CONFIRMACION [PC]</option>\n      <option value="CONFIRMADA [CO]">CONFIRMADA [CO]</option>\n      <option value="CANCELADA [CA]">CANCELADA [CA]</option>\n    ',console.log("üìã Estado poblado con opciones por defecto"));const t=document.getElementById("vendedor");t&&o.sellers.length>0?(t.innerHTML='<option value="">Seleccione...</option>',o.sellers.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,t.appendChild(o)}),console.log(`üìã Vendedor poblado con ${o.sellers.length} opciones`)):t&&(t.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="TEST TEST">TEST TEST</option>\n    ',console.log("üìã Vendedor poblado con opciones por defecto"));const a=document.getElementById("cliente");a&&o.clients.length>0?(a.innerHTML='<option value="">Seleccione...</option>',o.clients.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,a.appendChild(o)}),console.log(`üìã Cliente poblado con ${o.clients.length} opciones`)):a&&(a.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="DESPEGAR - TEST - 1">DESPEGAR - TEST - 1</option>\n    ',console.log("üìã Cliente poblado con opciones por defecto"))}async function a(){try{const e=document.getElementById("run");e.style.display="none";const o=document.getElementById("loader");o.style.display="block";const a=document.getElementById("results");a.style.display="none",Office.context.mailbox.item,Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,async r=>{if(r.status===Office.AsyncResultStatus.Succeeded){const e=r.value;try{const r=await async function(e){const o=await fetch("https://20.3.142.67/api/extract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailContent:e,userId:Office.context.mailbox.userProfile.emailAddress||"outlook-user"})});if(!o.ok){const e=await o.json();throw new Error(e.error||"Error al extraer datos")}return(await o.json()).data}(e);o.style.display="none",a.style.display="block",r&&r.passengers&&r.passengers.length>0?(l(r.passengers.length),c=r.passengers,setTimeout(()=>{c.forEach((e,o)=>{const n=o+1;if(document.getElementById(`tipoPasajero_${n}`)){let o="";"ADU"===e.paxType?o="adulto":"CHD"===e.paxType?o="menor":"INF"===e.paxType&&(o="infante"),document.getElementById(`tipoPasajero_${n}`).value=o,document.getElementById(`nombre_${n}`).value=e.firstName||"",document.getElementById(`apellido_${n}`).value=e.lastName||"",document.getElementById(`dni_${n}`).value=e.documentNumber||"",document.getElementById(`fechaNacimiento_${n}`).value=e.birthDate||"",document.getElementById(`cuil_${n}`).value=e.cuilCuit||"";const t=document.getElementById(`tipoDoc_${n}`);t&&e.documentType&&(t.value=e.documentType,console.log(`‚úÖ Tipo Doc ${n}: ${e.documentType} -> ${t.value}`));const a=document.getElementById(`sexo_${n}`);a&&e.sex&&(a.value=e.sex,console.log(`‚úÖ Sexo ${n}: ${e.sex} -> ${a.value}`));const l=document.getElementById(`nacionalidad_${n}`);l&&e.nationality&&(l.value=e.nationality,console.log(`‚úÖ Nacionalidad ${n}: ${e.nationality} -> ${l.value}`)),document.getElementById(`direccion_${n}`).value=e.direccion||"",document.getElementById(`telefono_${n}`).value=e.telefono||""}}),setTimeout(()=>i(),200)},150),s=r,t(),setTimeout(()=>{const e=document.getElementById("tipoReserva");if(e){const o=s.reservationType;if(console.log(`üîç Intentando asignar Tipo Reserva: "${o}"`),console.log("üìã Opciones en select:",Array.from(e.options).map(e=>`"${e.value}"`)),o&&"null"!==o&&null!==o&&(e.value=o,console.log(`‚úÖ Tipo Reserva asignado: "${o}" -> "${e.value}"`),!e.value||""===e.value)){const n=Array.from(e.options).find(e=>e.value&&o&&(e.value.toUpperCase().includes(o.toUpperCase())||o.toUpperCase().includes(e.value.toUpperCase())));n?(e.value=n.value,console.log(`‚úÖ Tipo Reserva (coincidencia): "${o}" -> "${e.value}"`)):console.warn(`‚ö†Ô∏è No se encontr√≥ coincidencia para Tipo Reserva: "${o}"`)}}const o=document.getElementById("estadoReserva");if(o){const e=s.status,n=Array.from(o.options).map(e=>e.value);if(console.log(`üîç Intentando asignar Estado: "${e}"`),console.log("üìã Opciones disponibles en select Estado:",n),console.log(`üìä Total de opciones: ${n.length}`),e&&"null"!==e&&null!==e)if(o.value=e,console.log(`üîÑ Intento directo: "${e}" -> "${o.value}"`),o.value&&""!==o.value)console.log(`‚úÖ Estado asignado correctamente: "${o.value}"`);else{console.log("‚ö†Ô∏è Asignaci√≥n directa fall√≥, buscando coincidencia...");const t=Array.from(o.options);let a=t.find(o=>o.value&&o.value.trim().toUpperCase()===e.trim().toUpperCase());if(a)o.value=a.value,console.log(`‚úÖ Estado (coincidencia exacta): "${e}" -> "${o.value}"`);else if(a=t.find(o=>o.value&&e&&(o.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(o.value.toUpperCase()))),a)o.value=a.value,console.log(`‚úÖ Estado (coincidencia parcial): "${e}" -> "${o.value}"`);else{const l=e.toUpperCase();l.includes("CONFIRMAD")||l.includes("CONFIRM")?a=t.find(e=>e.value&&e.value.toUpperCase().includes("CONFIRMAD")):l.includes("PENDIENTE")||l.includes("PENDING")?a=t.find(e=>e.value&&e.value.toUpperCase().includes("PENDIENTE")):(l.includes("CANCELAD")||l.includes("CANCEL"))&&(a=t.find(e=>e.value&&e.value.toUpperCase().includes("CANCELAD"))),a?(o.value=a.value,console.log(`‚úÖ Estado (mapeo inteligente): "${e}" -> "${o.value}"`)):(console.error(`‚ùå No se encontr√≥ ninguna coincidencia para Estado: "${e}"`),console.log("üí° Sugerencia: Verifica que el valor extra√≠do coincida con alguna de estas opciones:",n))}}else console.log(`‚ö†Ô∏è Estado es null o inv√°lido: "${e}"`)}document.getElementById("fechaViaje")&&(document.getElementById("fechaViaje").value=s.travelDate||"",console.log(`‚úÖ Fecha Viaje: ${s.travelDate}`));const n=document.getElementById("vendedor");if(n){const e=s.seller;if(e&&"null"!==e&&null!==e){if(n.value=e,console.log(`‚úÖ Vendedor: "${e}" -> "${n.value}"`),!n.value||""===n.value){const o=Array.from(n.options).find(o=>o.value&&e&&(o.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(o.value.toUpperCase())));o&&(n.value=o.value,console.log(`‚úÖ Vendedor (coincidencia): "${e}" -> "${n.value}"`))}}else console.log(`‚ö†Ô∏è Vendedor es null o inv√°lido: "${e}"`)}const t=document.getElementById("cliente");if(t){const e=s.client;if(e&&"null"!==e&&null!==e){if(t.value=e,console.log(`‚úÖ Cliente: "${e}" -> "${t.value}"`),!t.value||""===t.value){const o=Array.from(t.options).find(o=>o.value&&e&&(o.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(o.value.toUpperCase())));o&&(t.value=o.value,console.log(`‚úÖ Cliente (coincidencia): "${e}" -> "${t.value}"`))}}else console.log(`‚ö†Ô∏è Cliente es null o inv√°lido: "${e}"`)}setTimeout(()=>i(),200)},250),n(`‚úÖ Datos extra√≠dos: ${r.passengers.length} pasajero(s)`,"success")):(l(1),n("No se pudieron extraer datos. Por favor, llena el formulario manualmente.","info"))}catch(e){o.style.display="none",a.style.display="block",l(1),n("Error al extraer datos: "+e.message+". Llena el formulario manualmente.","error")}}else o.style.display="none",e.style.display="block",n("Error al obtener el contenido del correo","error");var s,c})}catch(e){document.getElementById("loader").style.display="none",document.getElementById("run").style.display="block",n("Error inesperado: "+e.message,"error")}}function l(e){const o=document.getElementById("pasajerosContainer");o.innerHTML="";for(let n=0;n<e;n++){const e=r(n+1);o.appendChild(e)}setTimeout(()=>i(),200)}function r(e){const t=document.createElement("div");t.className="pasajero-acordeon",t.dataset.numeroPasajero=e;const a=document.createElement("div");a.className="pasajero-header",a.innerHTML=`\n    <span class="pasajero-titulo">Pasajero ${e}</span>\n    <div class="pasajero-actions">\n      <span class="arrow">‚ñº</span>\n      <button class="btn-eliminar-pasajero" title="Eliminar pasajero">‚úï</button>\n    </div>\n  `;const l=document.createElement("div");return l.className="pasajero-content",l.style.display="none",l.innerHTML=`\n    <div>\n      <label>Tipo de Pasajero:</label>\n      <select id="tipoPasajero_${e}">\n        <option value="">Seleccione...</option>\n        <option value="adulto">Adulto</option>\n        <option value="menor">Menor</option>\n        <option value="infante">Infante</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nombre: <span style="color: red;">*</span></label>\n      <input type="text" id="nombre_${e}" placeholder="Ingrese el nombre">\n    </div>\n\n    <div>\n      <label>Apellido: <span style="color: red;">*</span></label>\n      <input type="text" id="apellido_${e}" placeholder="Ingrese el apellido">\n    </div>\n\n    <div>\n      <label>DNI:</label>\n      <input type="number" id="dni_${e}" placeholder="Ingrese el DNI">\n    </div>\n\n    <div>\n      <label>Fecha de Nacimiento:</label>\n      <input type="date" id="fechaNacimiento_${e}">\n    </div>\n\n    <div>\n      <label>CUIL:</label>\n      <input type="number" id="cuil_${e}" placeholder="Ingrese el CUIL">\n    </div>\n\n    <div>\n      <label>Tipo de Documento:</label>\n      <select id="tipoDoc_${e}">\n        <option value="">Seleccione...</option>\n        <option value="dni">DNI</option>\n        <option value="pasaporte">Pasaporte</option>\n        <option value="cedula">C√©dula</option>\n        <option value="otro">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Sexo:</label>\n      <select id="sexo_${e}">\n        <option value="">Seleccione...</option>\n        <option value="masculino">Masculino</option>\n        <option value="femenino">Femenino</option>\n        <option value="otro">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nacionalidad:</label>\n      <select id="nacionalidad_${e}">\n        <option value="">Seleccione...</option>\n        <option value="argentina">Argentina</option>\n        <option value="brasilera">Brasilera</option>\n        <option value="chilena">Chilena</option>\n        <option value="uruguaya">Uruguaya</option>\n        <option value="paraguaya">Paraguaya</option>\n        <option value="boliviana">Boliviana</option>\n        <option value="peruana">Peruana</option>\n        <option value="colombiana">Colombiana</option>\n        <option value="venezolana">Venezolana</option>\n        <option value="otra">Otra</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Direcci√≥n:</label>\n      <input type="text" id="direccion_${e}" placeholder="Ingrese la direcci√≥n">\n    </div>\n\n    <div>\n      <label>N√∫mero de Tel√©fono:</label>\n      <input type="tel" id="telefono_${e}" placeholder="Ingrese el tel√©fono">\n    </div>\n  `,a.onclick=function(e){if(e.target.classList.contains("btn-eliminar-pasajero"))return;const o="block"===l.style.display,n=a.querySelector(".arrow");o?(l.style.display="none",n.style.transform="rotate(0deg)"):(l.style.display="block",n.style.transform="rotate(180deg)")},setTimeout(()=>{const o=document.getElementById(`nombre_${e}`),n=document.getElementById(`apellido_${e}`);o&&o.addEventListener("input",i),n&&n.addEventListener("input",i)},100),a.querySelector(".btn-eliminar-pasajero").onclick=function(e){e.stopPropagation(),function(e){try{if(document.getElementById("pasajerosContainer").querySelectorAll(".pasajero-acordeon").length<=1)return void n("Debe haber al menos un pasajero","info");e.remove(),document.getElementById("pasajerosContainer").querySelectorAll(".pasajero-acordeon").forEach((e,o)=>{const n=o+1;e.querySelector(".pasajero-titulo").textContent=`Pasajero ${n}`,e.dataset.numeroPasajero=n}),n("Pasajero eliminado correctamente","success"),setTimeout(()=>i(),200)}catch(e){n("Error al eliminar pasajero","error")}}(t)},t.appendChild(a),t.appendChild(l),setTimeout(()=>{!function(e){const n=document.getElementById(`sexo_${e}`);if(n&&o.genders.length>0){const t=n.value;n.innerHTML='<option value="">Seleccione...</option>',o.genders.forEach(e=>{const o=document.createElement("option");o.value=e.code,o.textContent=e.name,n.appendChild(o)}),t&&(n.value=t),console.log(`üìã Sexo ${e} poblado con ${o.genders.length} opciones`)}else n&&(n.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="M">MASCULINO</option>\n      <option value="F">FEMENINO</option>\n    ',console.log(`üìã Sexo ${e} poblado con opciones por defecto`));const t=document.getElementById(`tipoDoc_${e}`);if(t&&o.documentTypes.length>0){const n=t.value;t.innerHTML='<option value="">Seleccione...</option>',o.documentTypes.forEach(e=>{const o=document.createElement("option");o.value=e.code,o.textContent=e.name,t.appendChild(o)}),n&&(t.value=n),console.log(`üìã Tipo Doc ${e} poblado con ${o.documentTypes.length} opciones`)}else t&&(t.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="DNI">DOCUMENTO NACIONAL DE IDENTIDAD</option>\n      <option value="PAS">PASAPORTE</option>\n      <option value="CI">C√âDULA DE IDENTIDAD</option>\n      <option value="LE">LIBRETA DE ENROLAMIENTO</option>\n      <option value="LC">LIBRETA C√çVICA</option>\n    ',console.log(`üìã Tipo Doc ${e} poblado con opciones por defecto`));const a=document.getElementById(`nacionalidad_${e}`);if(a&&o.countries.length>0){const n=a.value;a.innerHTML='<option value="">Seleccione...</option>',o.countries.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,a.appendChild(o)}),n&&(a.value=n),console.log(`üìã Nacionalidad ${e} poblada con ${o.countries.length} opciones`)}else a&&(a.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="ARGENTINA">ARGENTINA</option>\n      <option value="BRASIL">BRASIL</option>\n      <option value="CHILE">CHILE</option>\n      <option value="URUGUAY">URUGUAY</option>\n      <option value="PARAGUAY">PARAGUAY</option>\n      <option value="BOLIVIA">BOLIVIA</option>\n      <option value="PERU">PERU</option>\n      <option value="COLOMBIA">COLOMBIA</option>\n      <option value="VENEZUELA">VENEZUELA</option>\n      <option value="ECUADOR">ECUADOR</option>\n      <option value="MEXICO">MEXICO</option>\n      <option value="ESPA√ëA">ESPA√ëA</option>\n      <option value="ESTADOS UNIDOS">ESTADOS UNIDOS</option>\n    ',console.log(`üìã Nacionalidad ${e} poblada con opciones por defecto`))}(e)},50),t}function i(){const e=document.getElementById("crearReserva");e&&(!function(){const e=document.getElementById("pasajerosContainer");if(!e)return!1;const o=e.querySelectorAll(".pasajero-acordeon");if(0===o.length)return!1;let n=!0;o.forEach(e=>{const o=e.dataset.numeroPasajero,t=e.querySelector(".pasajero-content");if(t){const e=t.querySelector(`#nombre_${o}`)?.value||"",a=t.querySelector(`#apellido_${o}`)?.value||"";""!==e.trim()&&""!==a.trim()||(n=!1)}});const t=document.getElementById("tipoReserva")?.value||"",a=document.getElementById("estadoReserva")?.value||"",l=document.getElementById("fechaViaje")?.value||"",r=document.getElementById("vendedor")?.value||"",i=document.getElementById("cliente")?.value||"",s=""!==t.trim()&&""!==a.trim()&&""!==l.trim()&&""!==r.trim()&&""!==i.trim();return n&&s}()?(e.disabled=!0,e.style.opacity="0.5",e.style.cursor="not-allowed"):(e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer"))}Office.onReady(l=>{try{if(l.host===Office.HostType.Outlook){const l=document.getElementById("sideload-msg");l&&(l.style.display="none");const s=document.getElementById("app-body");s&&(s.style.display="flex");const c=document.getElementById("run");c&&(c.onclick=function(){try{a()}catch(e){n("Error al extraer datos: "+e.message,"error")}});const d=document.getElementById("reextract");d&&(d.onclick=function(){try{document.getElementById("results").style.display="none",a()}catch(e){n("Error al re-extraer datos: "+e.message,"error")}});const u=document.getElementById("guardar");u&&(u.onclick=function(){try{!function(){try{const e=document.getElementById("pasajerosContainer");if(!e)return void n("No se encontr√≥ el contenedor de pasajeros","error");const o=e.querySelectorAll(".pasajero-acordeon");if(0===o.length)return void n("No hay pasajeros para guardar. Por favor, extraiga datos primero.","info");const t=[];o.forEach((e,o)=>{const n=e.dataset.numeroPasajero,a=e.querySelector(".pasajero-content");if(a){const e={numeroPasajero:o+1,tipoPasajero:a.querySelector(`#tipoPasajero_${n}`)?.value||"",nombre:a.querySelector(`#nombre_${n}`)?.value||"",apellido:a.querySelector(`#apellido_${n}`)?.value||"",dni:a.querySelector(`#dni_${n}`)?.value||"",fechaNacimiento:a.querySelector(`#fechaNacimiento_${n}`)?.value||"",cuil:a.querySelector(`#cuil_${n}`)?.value||"",tipoDoc:a.querySelector(`#tipoDoc_${n}`)?.value||"",sexo:a.querySelector(`#sexo_${n}`)?.value||"",nacionalidad:a.querySelector(`#nacionalidad_${n}`)?.value||"",direccion:a.querySelector(`#direccion_${n}`)?.value||"",telefono:a.querySelector(`#telefono_${n}`)?.value||""};t.push(e)}}),n(`Datos de ${t.length} pasajero(s) guardados correctamente`,"success")}catch(e){throw e}}()}catch(e){n("Error al guardar datos: "+e.message,"error")}});const p=document.getElementById("agregarPasajero");p&&(p.onclick=function(){try{!function(){try{const e=document.getElementById("pasajerosContainer");if(!e)return;const o=r(e.querySelectorAll(".pasajero-acordeon").length+1);e.appendChild(o);const n=o.querySelector(".pasajero-content"),t=o.querySelector(".arrow");n&&t&&(n.style.display="block",t.style.transform="rotate(180deg)"),o.scrollIntoView&&o.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>i(),200)}catch(e){throw e}}()}catch(e){n("Error al agregar pasajero: "+e.message,"error")}});const m=document.getElementById("crearReserva");m&&(m.onclick=function(){!async function(){try{const o=document.getElementById("pasajerosContainer");if(!o)return void n("No se encontr√≥ el contenedor de pasajeros","error");const t=o.querySelectorAll(".pasajero-acordeon");if(0===t.length)return void n("No hay pasajeros para crear la reserva. Por favor, extraiga datos primero.","info");const a=[];t.forEach((e,o)=>{const n=e.dataset.numeroPasajero,t=e.querySelector(".pasajero-content");if(t){const e={numeroPasajero:o+1,tipoPasajero:t.querySelector(`#tipoPasajero_${n}`)?.value||"",nombre:t.querySelector(`#nombre_${n}`)?.value||"",apellido:t.querySelector(`#apellido_${n}`)?.value||"",dni:t.querySelector(`#dni_${n}`)?.value||"",fechaNacimiento:t.querySelector(`#fechaNacimiento_${n}`)?.value||"",cuil:t.querySelector(`#cuil_${n}`)?.value||"",tipoDoc:t.querySelector(`#tipoDoc_${n}`)?.value||"",sexo:t.querySelector(`#sexo_${n}`)?.value||"",nacionalidad:t.querySelector(`#nacionalidad_${n}`)?.value||"",direccion:t.querySelector(`#direccion_${n}`)?.value||"",telefono:t.querySelector(`#telefono_${n}`)?.value||""};a.push(e)}});const l={tipoReserva:document.getElementById("tipoReserva")?.value||"",estadoReserva:document.getElementById("estadoReserva")?.value||"",fechaViaje:document.getElementById("fechaViaje")?.value||"",vendedor:document.getElementById("vendedor")?.value||"",cliente:document.getElementById("cliente")?.value||""};let r=[];if(a.forEach((e,o)=>{e.nombre&&""!==e.nombre.trim()||r.push(`Pasajero ${o+1}: Nombre`),e.apellido&&""!==e.apellido.trim()||r.push(`Pasajero ${o+1}: Apellido`)}),l.tipoReserva&&""!==l.tipoReserva.trim()||r.push("Tipo de Reserva"),l.estadoReserva&&""!==l.estadoReserva.trim()||r.push("Estado"),l.fechaViaje&&""!==l.fechaViaje.trim()||r.push("Fecha de Viaje"),l.vendedor&&""!==l.vendedor.trim()||r.push("Vendedor"),l.cliente&&""!==l.cliente.trim()||r.push("Cliente"),r.length>0)return void n(`Por favor completa los siguientes campos obligatorios: ${r.join(", ")}`,"error");n("Creando reserva en iTraffic... Por favor espere.","info"),function(){const e=document.getElementById("pasajerosContainer");e&&(e.querySelectorAll("input, select").forEach(e=>{e.disabled=!0,e.style.backgroundColor="#f3f4f6",e.style.cursor="not-allowed"}),e.querySelectorAll(".btn-eliminar-pasajero").forEach(e=>{e.disabled=!0,e.style.opacity="0.3",e.style.cursor="not-allowed",e.style.pointerEvents="none"}));["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const o=document.getElementById(e);o&&(o.disabled=!0,o.style.backgroundColor="#f3f4f6",o.style.cursor="not-allowed")});const o=document.getElementById("agregarPasajero");o&&(o.disabled=!0,o.style.opacity="0.5",o.style.cursor="not-allowed");const n=document.getElementById("guardar");n&&(n.disabled=!0,n.style.opacity="0.5",n.style.cursor="not-allowed")}();const i=document.getElementById("crearReserva");i&&(i.disabled=!0,i.style.opacity="0.6",i.querySelector(".ms-Button-label").textContent="‚è≥ Procesando..."),await async function(o,n={}){try{const t=function(o,n={}){return{passengers:o.map(o=>({lastName:o.apellido||"",firstName:o.nombre||"",paxType:"adulto"===o.tipoPasajero?"ADU":"menor"===o.tipoPasajero?"CHD":"INF",birthDate:e(o.fechaNacimiento),nationality:o.nacionalidad?.toUpperCase()||"ARGENTINA",sex:"masculino"===o.sexo?"M":"femenino"===o.sexo?"F":"O",documentNumber:o.dni||"",documentType:o.tipoDoc?.toUpperCase()||"DNI",cuilCuit:o.cuil||"",telefono:o.telefono||"",direccion:o.direccion||""})),reservationType:n.tipoReserva||"AGENCIAS [COAG]",status:n.estadoReserva||"PENDIENTE DE CONFIRMACION [PC]",client:n.cliente||"DESPEGAR - TEST - 1",travelDate:e(n.fechaViaje)||"12/01/2026",seller:n.vendedor||"TEST TEST"}}(o,n),a=await fetch("https://20.3.142.67/api/rpa/create-reservation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw new Error(`Error del servidor: ${a.status} ${a.statusText}`);return{success:!0,data:await a.json(),message:"Reserva creada exitosamente en iTraffic"}}catch(e){if(e.message.includes("fetch"))throw new Error("No se pudo conectar con el servicio RPA. Aseg√∫rate de que el servidor est√© corriendo.");throw e}}(a,l),n("¬°Reserva creada exitosamente en iTraffic!","success"),function(){const e=document.getElementById("pasajerosContainer");e&&e.querySelectorAll(".pasajero-acordeon").forEach(e=>{const o=e.dataset.numeroPasajero,n=e.querySelector(".pasajero-content");if(n){const e={tipoPasajero:n.querySelector(`#tipoPasajero_${o}`)?.value||"",nombre:n.querySelector(`#nombre_${o}`)?.value||"",apellido:n.querySelector(`#apellido_${o}`)?.value||"",dni:n.querySelector(`#dni_${o}`)?.value||"",fechaNacimiento:n.querySelector(`#fechaNacimiento_${o}`)?.value||"",cuil:n.querySelector(`#cuil_${o}`)?.value||"",tipoDoc:n.querySelector(`#tipoDoc_${o}`)?.value||"",sexo:n.querySelector(`#sexo_${o}`)?.value||"",nacionalidad:n.querySelector(`#nacionalidad_${o}`)?.value||"",direccion:n.querySelector(`#direccion_${o}`)?.value||"",telefono:n.querySelector(`#telefono_${o}`)?.value||""};n.innerHTML=`\n          <div class="campo-lectura">\n            <label>Tipo de Pasajero:</label>\n            <p>${e.tipoPasajero||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Nombre:</label>\n            <p>${e.nombre||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Apellido:</label>\n            <p>${e.apellido||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>DNI:</label>\n            <p>${e.dni||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Fecha de Nacimiento:</label>\n            <p>${e.fechaNacimiento||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>CUIL:</label>\n            <p>${e.cuil||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Tipo de Documento:</label>\n            <p>${e.tipoDoc||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Sexo:</label>\n            <p>${e.sexo||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Nacionalidad:</label>\n            <p>${e.nacionalidad||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Direcci√≥n:</label>\n            <p>${e.direccion||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>N√∫mero de Tel√©fono:</label>\n            <p>${e.telefono||"-"}</p>\n          </div>\n        `}const t=e.querySelector(".btn-eliminar-pasajero");t&&(t.style.display="none")});const o=document.getElementById("datosReservaSection");if(o){const e={tipoReserva:document.getElementById("tipoReserva")?.value||"",estadoReserva:document.getElementById("estadoReserva")?.value||"",fechaViaje:document.getElementById("fechaViaje")?.value||"",vendedor:document.getElementById("vendedor")?.value||"",cliente:document.getElementById("cliente")?.value||""};o.innerHTML=`\n      <h3>Datos de la Reserva</h3>\n      <div class="campo-lectura">\n        <label>Tipo de Reserva:</label>\n        <p>${e.tipoReserva||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Estado:</label>\n        <p>${e.estadoReserva||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Fecha de Viaje:</label>\n        <p>${e.fechaViaje||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Vendedor:</label>\n        <p>${e.vendedor||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Cliente:</label>\n        <p>${e.cliente||"-"}</p>\n      </div>\n    `}const n=document.getElementById("agregarPasajero");n&&(n.style.display="none");const t=document.getElementById("guardar");t&&(t.style.display="none");const a=document.getElementById("crearReserva");a&&(a.style.display="none")}()}catch(e){n("Error al crear reserva: "+e.message,"error"),function(){const e=document.getElementById("pasajerosContainer");e&&(e.querySelectorAll("input, select").forEach(e=>{e.disabled=!1,e.style.backgroundColor="#ffffff",e.style.cursor="text"}),e.querySelectorAll(".btn-eliminar-pasajero").forEach(e=>{e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer",e.style.pointerEvents="auto"}));["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const o=document.getElementById(e);o&&(o.disabled=!1,o.style.backgroundColor="#ffffff",o.style.cursor="pointer")});const o=document.getElementById("agregarPasajero");o&&(o.disabled=!1,o.style.opacity="1",o.style.cursor="pointer");const n=document.getElementById("guardar");n&&(n.disabled=!1,n.style.opacity="1",n.style.cursor="pointer");const t=document.getElementById("crearReserva");t&&(t.disabled=!1,t.style.opacity="1",t.querySelector(".ms-Button-label").textContent="üöÄ Crear Reserva en iTraffic")}()}}()},m.disabled=!0,m.style.opacity="0.5",m.style.cursor="not-allowed"),["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const o=document.getElementById(e);o&&(o.addEventListener("change",i),o.addEventListener("input",i))}),async function(){try{const e="https://20.3.142.67/api/master-data",n=await fetch(e);if(!n.ok)return void console.warn("‚ö†Ô∏è No se pudieron cargar los datos maestros, usando valores por defecto");const a=await n.json();a.success&&a.data&&(o.sellers=a.data.sellers||[],o.clients=a.data.clients||[],o.statuses=a.data.statuses||[],o.reservationTypes=a.data.reservationTypes||[],o.genders=a.data.genders||[],o.documentTypes=a.data.documentTypes||[],o.countries=a.data.countries||[],o.loaded=!0,console.log("‚úÖ Datos maestros cargados:",{vendedores:o.sellers.length,clientes:o.clients.length,estados:o.statuses.length,tiposReserva:o.reservationTypes.length,generos:o.genders.length,tiposDoc:o.documentTypes.length,paises:o.countries.length}),t())}catch(e){console.error("‚ùå Error cargando datos maestros:",e)}}()}}catch(e){}})}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map