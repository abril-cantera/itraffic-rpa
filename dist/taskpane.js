!function(){"use strict";var e={58394:function(e,o,t){e.exports=t.p+"09c7ed346a47b145dfa0.css"}},o={};function t(n){var a=o[n];if(void 0!==a)return a.exports;var l=o[n]={exports:{}};return e[n](l,l.exports,t),l.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var o=t.g.document;if(!e&&o&&(o.currentScript&&"SCRIPT"===o.currentScript.tagName.toUpperCase()&&(e=o.currentScript.src),!e)){var n=o.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(e){if(!e)return"";try{const[o,t,n]=e.split("-");return`${t}/${n}/${o}`}catch(e){return""}}const o={sellers:[],clients:[],statuses:[],reservationTypes:[],genders:[],documentTypes:[],countries:[],loaded:!1};function t(e,o="info"){const t=document.createElement("div");t.className=`status-message ${o}`,t.textContent=e,t.style.position="fixed",t.style.top="20px",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.zIndex="10000",t.style.minWidth="200px",t.style.maxWidth="90%",t.style.textAlign="center",t.style.animation="slideDown 0.3s ease",document.body.appendChild(t),setTimeout(()=>{t.style.animation="slideUp 0.3s ease",setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},300)},3e3)}function n(){const e=document.getElementById("tipoReserva");e&&o.reservationTypes.length>0?(e.innerHTML='<option value="">Seleccione...</option>',o.reservationTypes.forEach(o=>{const t=document.createElement("option");t.value=o.name,t.textContent=o.name,e.appendChild(t)}),console.log(`üìã Tipo Reserva poblado con ${o.reservationTypes.length} opciones`)):e&&(e.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="AGENCIAS [COAG]">AGENCIAS [COAG]</option>\n      <option value="MAYORISTA [COMA]">MAYORISTA [COMA]</option>\n      <option value="DIRECTO [CODI]">DIRECTO [CODI]</option>\n      <option value="CORPORATIVA [COCO]">CORPORATIVA [COCO]</option>\n    ',console.log("üìã Tipo Reserva poblado con opciones por defecto"));const t=document.getElementById("estadoReserva");t&&o.statuses.length>0?(t.innerHTML='<option value="">Seleccione...</option>',o.statuses.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,t.appendChild(o)}),console.log(`üìã Estado poblado con ${o.statuses.length} opciones`)):t&&(t.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="PENDIENTE DE CONFIRMACION [PC]">PENDIENTE DE CONFIRMACION [PC]</option>\n      <option value="CONFIRMADA [CO]">CONFIRMADA [CO]</option>\n      <option value="CANCELADA [CA]">CANCELADA [CA]</option>\n    ',console.log("üìã Estado poblado con opciones por defecto"));const n=document.getElementById("vendedor");n&&o.sellers.length>0?(n.innerHTML='<option value="">Seleccione...</option>',o.sellers.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,n.appendChild(o)}),console.log(`üìã Vendedor poblado con ${o.sellers.length} opciones`)):n&&(n.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="TEST TEST">TEST TEST</option>\n    ',console.log("üìã Vendedor poblado con opciones por defecto"));const a=document.getElementById("cliente");a&&o.clients.length>0?(a.innerHTML='<option value="">Seleccione...</option>',o.clients.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,a.appendChild(o)}),console.log(`üìã Cliente poblado con ${o.clients.length} opciones`)):a&&(a.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="DESPEGAR - TEST - 1">DESPEGAR - TEST - 1</option>\n    ',console.log("üìã Cliente poblado con opciones por defecto"))}async function a(){try{const e=document.getElementById("run");e.style.display="none";const o=document.getElementById("loader");o.style.display="block";const a=document.getElementById("results");a.style.display="none",Office.context.mailbox.item,Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,async i=>{if(i.status===Office.AsyncResultStatus.Succeeded){const e=i.value;try{const i=await async function(e){const o=await fetch("https://aymara.canterasoft.com/api/extract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailContent:e,userId:Office.context.mailbox.userProfile.emailAddress||"outlook-user"})});if(!o.ok){const e=await o.json();throw new Error(e.error||"Error al extraer datos")}return(await o.json()).data}(e);o.style.display="none",a.style.display="block",i&&i.passengers&&i.passengers.length>0?(l(i.passengers.length),s=i.passengers,setTimeout(()=>{s.forEach((e,o)=>{const t=o+1;if(document.getElementById(`tipoPasajero_${t}`)){let o="";const n=e.passengerType||e.paxType;"ADU"===n?o="adulto":"CHD"===n?o="menor":"INF"===n&&(o="infante"),document.getElementById(`tipoPasajero_${t}`).value=o,document.getElementById(`nombre_${t}`).value=e.firstName||"",document.getElementById(`apellido_${t}`).value=e.lastName||"",document.getElementById(`dni_${t}`).value=e.documentNumber||"",document.getElementById(`fechaNacimiento_${t}`).value=e.dateOfBirth||e.birthDate||"",document.getElementById(`cuil_${t}`).value=e.cuilCuit||"";const a=document.getElementById(`tipoDoc_${t}`);a&&e.documentType&&(a.value=e.documentType,console.log(`‚úÖ Tipo Doc ${t}: ${e.documentType} -> ${a.value}`));const l=document.getElementById(`sexo_${t}`);l&&e.sex&&(l.value=e.sex,console.log(`‚úÖ Sexo ${t}: ${e.sex} -> ${l.value}`));const i=document.getElementById(`nacionalidad_${t}`);i&&e.nationality&&(i.value=e.nationality,console.log(`‚úÖ Nacionalidad ${t}: ${e.nationality} -> ${i.value}`)),document.getElementById(`direccion_${t}`).value=e.direccion||"",document.getElementById(`telefono_${t}`).value=e.phoneNumber||e.telefono||""}}),setTimeout(()=>c(),200)},150),r=i,n(),setTimeout(()=>{const e=document.getElementById("tipoReserva");if(e){const o=r.reservationType;if(console.log(`üîç Intentando asignar Tipo Reserva: "${o}"`),console.log("üìã Opciones en select:",Array.from(e.options).map(e=>`"${e.value}"`)),o&&"null"!==o&&null!==o&&(e.value=o,console.log(`‚úÖ Tipo Reserva asignado: "${o}" -> "${e.value}"`),!e.value||""===e.value)){const t=Array.from(e.options).find(e=>e.value&&o&&(e.value.toUpperCase().includes(o.toUpperCase())||o.toUpperCase().includes(e.value.toUpperCase())));t?(e.value=t.value,console.log(`‚úÖ Tipo Reserva (coincidencia): "${o}" -> "${e.value}"`)):console.warn(`‚ö†Ô∏è No se encontr√≥ coincidencia para Tipo Reserva: "${o}"`)}}const o=document.getElementById("estadoReserva");if(o){const e=r.status,t=Array.from(o.options).map(e=>e.value);if(console.log(`üîç Intentando asignar Estado: "${e}"`),console.log("üìã Opciones disponibles en select Estado:",t),console.log(`üìä Total de opciones: ${t.length}`),e&&"null"!==e&&null!==e)if(o.value=e,console.log(`üîÑ Intento directo: "${e}" -> "${o.value}"`),o.value&&""!==o.value)console.log(`‚úÖ Estado asignado correctamente: "${o.value}"`);else{console.log("‚ö†Ô∏è Asignaci√≥n directa fall√≥, buscando coincidencia...");const n=Array.from(o.options);let a=n.find(o=>o.value&&o.value.trim().toUpperCase()===e.trim().toUpperCase());if(a)o.value=a.value,console.log(`‚úÖ Estado (coincidencia exacta): "${e}" -> "${o.value}"`);else if(a=n.find(o=>o.value&&e&&(o.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(o.value.toUpperCase()))),a)o.value=a.value,console.log(`‚úÖ Estado (coincidencia parcial): "${e}" -> "${o.value}"`);else{const l=e.toUpperCase();l.includes("CONFIRMAD")||l.includes("CONFIRM")?a=n.find(e=>e.value&&e.value.toUpperCase().includes("CONFIRMAD")):l.includes("PENDIENTE")||l.includes("PENDING")?a=n.find(e=>e.value&&e.value.toUpperCase().includes("PENDIENTE")):(l.includes("CANCELAD")||l.includes("CANCEL"))&&(a=n.find(e=>e.value&&e.value.toUpperCase().includes("CANCELAD"))),a?(o.value=a.value,console.log(`‚úÖ Estado (mapeo inteligente): "${e}" -> "${o.value}"`)):(console.error(`‚ùå No se encontr√≥ ninguna coincidencia para Estado: "${e}"`),console.log("üí° Sugerencia: Verifica que el valor extra√≠do coincida con alguna de estas opciones:",t))}}else console.log(`‚ö†Ô∏è Estado es null o inv√°lido: "${e}"`)}document.getElementById("fechaViaje")&&(document.getElementById("fechaViaje").value=r.travelDate||"",console.log(`‚úÖ Fecha Viaje: ${r.travelDate}`));const t=document.getElementById("vendedor");if(t){const e=r.seller;if(e&&"null"!==e&&null!==e){if(t.value=e,console.log(`‚úÖ Vendedor: "${e}" -> "${t.value}"`),!t.value||""===t.value){const o=Array.from(t.options).find(o=>o.value&&e&&(o.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(o.value.toUpperCase())));o&&(t.value=o.value,console.log(`‚úÖ Vendedor (coincidencia): "${e}" -> "${t.value}"`))}}else console.log(`‚ö†Ô∏è Vendedor es null o inv√°lido: "${e}"`)}const n=document.getElementById("cliente");if(n){const e=r.client;if(e&&"null"!==e&&null!==e){if(n.value=e,console.log(`‚úÖ Cliente: "${e}" -> "${n.value}"`),!n.value||""===n.value){const o=Array.from(n.options).find(o=>o.value&&e&&(o.value.toUpperCase().includes(e.toUpperCase())||e.toUpperCase().includes(o.value.toUpperCase())));o&&(n.value=o.value,console.log(`‚úÖ Cliente (coincidencia): "${e}" -> "${n.value}"`))}}else console.log(`‚ö†Ô∏è Cliente es null o inv√°lido: "${e}"`)}if(document.getElementById("codigo")&&(document.getElementById("codigo").value=r.codigo||""),document.getElementById("fechaReserva")&&(document.getElementById("fechaReserva").value=r.reservationDate||""),document.getElementById("fechaFinTour")&&(document.getElementById("fechaFinTour").value=r.tourEndDate||""),document.getElementById("fechaVencimiento")&&(document.getElementById("fechaVencimiento").value=r.dueDate||""),document.getElementById("contacto")&&(document.getElementById("contacto").value=r.contact||""),document.getElementById("contactEmail")&&(document.getElementById("contactEmail").value=r.contactEmail||""),document.getElementById("contactPhone")&&(document.getElementById("contactPhone").value=r.contactPhone||""),document.getElementById("moneda")&&(document.getElementById("moneda").value=r.currency||""),document.getElementById("tipoCambio")&&(document.getElementById("tipoCambio").value=r.exchangeRate||""),document.getElementById("comision")&&(document.getElementById("comision").value=r.commission||""),document.getElementById("montoNeto")&&(document.getElementById("montoNeto").value=r.netAmount||""),document.getElementById("montoBruto")&&(document.getElementById("montoBruto").value=r.grossAmount||""),document.getElementById("nombreViaje")&&(document.getElementById("nombreViaje").value=r.tripName||""),document.getElementById("codigoProducto")&&(document.getElementById("codigoProducto").value=r.productCode||""),document.getElementById("adultos")&&(document.getElementById("adultos").value=r.adults||""),document.getElementById("ninos")&&(document.getElementById("ninos").value=r.children||""),document.getElementById("infantes")&&(document.getElementById("infantes").value=r.infants||""),document.getElementById("proveedor")&&(document.getElementById("proveedor").value=r.provider||""),document.getElementById("codigoReserva")&&(document.getElementById("codigoReserva").value=r.reservationCode||""),document.getElementById("hotel")&&(document.getElementById("hotel").value=r.hotel||""),document.getElementById("checkIn")&&(document.getElementById("checkIn").value=r.checkIn||""),document.getElementById("checkOut")&&(document.getElementById("checkOut").value=r.checkOut||""),document.getElementById("estadoDeuda")&&(document.getElementById("estadoDeuda").value=r.estadoDeuda||""),r.services&&Array.isArray(r.services)&&r.services.length>0){const e=document.getElementById("serviciosSection");e&&(e.style.display="block"),function(e){const o=document.getElementById("serviciosContainer");o&&(o.innerHTML="",e.forEach((e,t)=>{const n=document.createElement("div");n.className="servicio-item",n.innerHTML=`\n      <h4>Servicio ${t+1}</h4>\n      <div class="form-group">\n        <label>Destino:</label>\n        <input type="text" id="servicio_destino_${t}" value="${e.destino||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Fecha Entrada:</label>\n        <input type="date" id="servicio_in_${t}" value="${e.in||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Fecha Salida:</label>\n        <input type="date" id="servicio_out_${t}" value="${e.out||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Noches:</label>\n        <input type="number" id="servicio_nts_${t}" value="${e.nts||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Base Pax:</label>\n        <input type="number" id="servicio_basePax_${t}" value="${e.basePax||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Servicio:</label>\n        <input type="text" id="servicio_servicio_${t}" value="${e.servicio||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Descripci√≥n:</label>\n        <textarea id="servicio_descripcion_${t}" readonly>${e.descripcion||""}</textarea>\n      </div>\n      <div class="form-group">\n        <label>Estado:</label>\n        <input type="text" id="servicio_estado_${t}" value="${e.estado||""}" readonly>\n      </div>\n    `,o.appendChild(n)}))}(r.services)}if(r.flights&&Array.isArray(r.flights)&&r.flights.length>0){const e=document.getElementById("vuelosSection");e&&(e.style.display="block"),function(e){const o=document.getElementById("vuelosContainer");o&&(o.innerHTML="",e.forEach((e,t)=>{const n=document.createElement("div");n.className="vuelo-item",n.innerHTML=`\n      <h4>Vuelo ${t+1}</h4>\n      <div class="form-group">\n        <label>Aerol√≠nea:</label>\n        <input type="text" id="vuelo_airline_${t}" value="${e.airline||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>N√∫mero de Vuelo:</label>\n        <input type="text" id="vuelo_flightNumber_${t}" value="${e.flightNumber||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Origen:</label>\n        <input type="text" id="vuelo_origin_${t}" value="${e.origin||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Destino:</label>\n        <input type="text" id="vuelo_destination_${t}" value="${e.destination||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Fecha:</label>\n        <input type="date" id="vuelo_date_${t}" value="${e.date||""}" readonly>\n      </div>\n      <div class="form-group">\n        <label>Hora:</label>\n        <input type="time" id="vuelo_time_${t}" value="${e.time||""}" readonly>\n      </div>\n    `,o.appendChild(n)}))}(r.flights)}setTimeout(()=>c(),200)},250),t(`‚úÖ Datos extra√≠dos: ${i.passengers.length} pasajero(s)`,"success")):(l(1),t("No se pudieron extraer datos. Por favor, llena el formulario manualmente.","info"))}catch(e){o.style.display="none",a.style.display="block",l(1),t("Error al extraer datos: "+e.message+". Llena el formulario manualmente.","error")}}else o.style.display="none",e.style.display="block",t("Error al obtener el contenido del correo","error");var r,s})}catch(e){document.getElementById("loader").style.display="none",document.getElementById("run").style.display="block",t("Error inesperado: "+e.message,"error")}}function l(e){const o=document.getElementById("pasajerosContainer");o.innerHTML="";for(let t=0;t<e;t++){const e=i(t+1);o.appendChild(e)}setTimeout(()=>c(),200)}function i(e){const n=document.createElement("div");n.className="pasajero-acordeon",n.dataset.numeroPasajero=e;const a=document.createElement("div");a.className="pasajero-header",a.innerHTML=`\n    <span class="pasajero-titulo">Pasajero ${e}</span>\n    <div class="pasajero-actions">\n      <span class="arrow">‚ñº</span>\n      <button class="btn-eliminar-pasajero" title="Eliminar pasajero">‚úï</button>\n    </div>\n  `;const l=document.createElement("div");return l.className="pasajero-content",l.style.display="none",l.innerHTML=`\n    <div>\n      <label>Tipo de Pasajero:</label>\n      <select id="tipoPasajero_${e}">\n        <option value="">Seleccione...</option>\n        <option value="adulto">Adulto</option>\n        <option value="menor">Menor</option>\n        <option value="infante">Infante</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nombre: <span style="color: red;">*</span></label>\n      <input type="text" id="nombre_${e}" placeholder="Ingrese el nombre">\n    </div>\n\n    <div>\n      <label>Apellido: <span style="color: red;">*</span></label>\n      <input type="text" id="apellido_${e}" placeholder="Ingrese el apellido">\n    </div>\n\n    <div>\n      <label>DNI:</label>\n      <input type="number" id="dni_${e}" placeholder="Ingrese el DNI">\n    </div>\n\n    <div>\n      <label>Fecha de Nacimiento:</label>\n      <input type="date" id="fechaNacimiento_${e}">\n    </div>\n\n    <div>\n      <label>CUIL:</label>\n      <input type="number" id="cuil_${e}" placeholder="Ingrese el CUIL">\n    </div>\n\n    <div>\n      <label>Tipo de Documento:</label>\n      <select id="tipoDoc_${e}">\n        <option value="">Seleccione...</option>\n        <option value="dni">DNI</option>\n        <option value="pasaporte">Pasaporte</option>\n        <option value="cedula">C√©dula</option>\n        <option value="otro">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Sexo:</label>\n      <select id="sexo_${e}">\n        <option value="">Seleccione...</option>\n        <option value="masculino">Masculino</option>\n        <option value="femenino">Femenino</option>\n        <option value="otro">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nacionalidad:</label>\n      <select id="nacionalidad_${e}">\n        <option value="">Seleccione...</option>\n        <option value="argentina">Argentina</option>\n        <option value="brasilera">Brasilera</option>\n        <option value="chilena">Chilena</option>\n        <option value="uruguaya">Uruguaya</option>\n        <option value="paraguaya">Paraguaya</option>\n        <option value="boliviana">Boliviana</option>\n        <option value="peruana">Peruana</option>\n        <option value="colombiana">Colombiana</option>\n        <option value="venezolana">Venezolana</option>\n        <option value="otra">Otra</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Direcci√≥n:</label>\n      <input type="text" id="direccion_${e}" placeholder="Ingrese la direcci√≥n">\n    </div>\n\n    <div>\n      <label>N√∫mero de Tel√©fono:</label>\n      <input type="tel" id="telefono_${e}" placeholder="Ingrese el tel√©fono">\n    </div>\n  `,a.onclick=function(e){if(e.target.classList.contains("btn-eliminar-pasajero"))return;const o="block"===l.style.display,t=a.querySelector(".arrow");o?(l.style.display="none",t.style.transform="rotate(0deg)"):(l.style.display="block",t.style.transform="rotate(180deg)")},setTimeout(()=>{const o=document.getElementById(`nombre_${e}`),t=document.getElementById(`apellido_${e}`);o&&o.addEventListener("input",c),t&&t.addEventListener("input",c)},100),a.querySelector(".btn-eliminar-pasajero").onclick=function(e){e.stopPropagation(),function(e){try{if(document.getElementById("pasajerosContainer").querySelectorAll(".pasajero-acordeon").length<=1)return void t("Debe haber al menos un pasajero","info");e.remove(),document.getElementById("pasajerosContainer").querySelectorAll(".pasajero-acordeon").forEach((e,o)=>{const t=o+1;e.querySelector(".pasajero-titulo").textContent=`Pasajero ${t}`,e.dataset.numeroPasajero=t}),t("Pasajero eliminado correctamente","success"),setTimeout(()=>c(),200)}catch(e){t("Error al eliminar pasajero","error")}}(n)},n.appendChild(a),n.appendChild(l),setTimeout(()=>{!function(e){const t=document.getElementById(`sexo_${e}`);if(t&&o.genders.length>0){const n=t.value;t.innerHTML='<option value="">Seleccione...</option>',o.genders.forEach(e=>{const o=document.createElement("option");o.value=e.code,o.textContent=e.name,t.appendChild(o)}),n&&(t.value=n),console.log(`üìã Sexo ${e} poblado con ${o.genders.length} opciones`)}else t&&(t.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="M">MASCULINO</option>\n      <option value="F">FEMENINO</option>\n    ',console.log(`üìã Sexo ${e} poblado con opciones por defecto`));const n=document.getElementById(`tipoDoc_${e}`);if(n&&o.documentTypes.length>0){const t=n.value;n.innerHTML='<option value="">Seleccione...</option>',o.documentTypes.forEach(e=>{const o=document.createElement("option");o.value=e.code,o.textContent=e.name,n.appendChild(o)}),t&&(n.value=t),console.log(`üìã Tipo Doc ${e} poblado con ${o.documentTypes.length} opciones`)}else n&&(n.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="DNI">DOCUMENTO NACIONAL DE IDENTIDAD</option>\n      <option value="PAS">PASAPORTE</option>\n      <option value="CI">C√âDULA DE IDENTIDAD</option>\n      <option value="LE">LIBRETA DE ENROLAMIENTO</option>\n      <option value="LC">LIBRETA C√çVICA</option>\n    ',console.log(`üìã Tipo Doc ${e} poblado con opciones por defecto`));const a=document.getElementById(`nacionalidad_${e}`);if(a&&o.countries.length>0){const t=a.value;a.innerHTML='<option value="">Seleccione...</option>',o.countries.forEach(e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,a.appendChild(o)}),t&&(a.value=t),console.log(`üìã Nacionalidad ${e} poblada con ${o.countries.length} opciones`)}else a&&(a.innerHTML='\n      <option value="">Seleccione...</option>\n      <option value="ARGENTINA">ARGENTINA</option>\n      <option value="BRASIL">BRASIL</option>\n      <option value="CHILE">CHILE</option>\n      <option value="URUGUAY">URUGUAY</option>\n      <option value="PARAGUAY">PARAGUAY</option>\n      <option value="BOLIVIA">BOLIVIA</option>\n      <option value="PERU">PERU</option>\n      <option value="COLOMBIA">COLOMBIA</option>\n      <option value="VENEZUELA">VENEZUELA</option>\n      <option value="ECUADOR">ECUADOR</option>\n      <option value="MEXICO">MEXICO</option>\n      <option value="ESPA√ëA">ESPA√ëA</option>\n      <option value="ESTADOS UNIDOS">ESTADOS UNIDOS</option>\n    ',console.log(`üìã Nacionalidad ${e} poblada con opciones por defecto`))}(e)},50),n}function c(){const e=document.getElementById("crearReserva");e&&(!function(){const e=document.getElementById("pasajerosContainer");if(!e)return!1;const o=e.querySelectorAll(".pasajero-acordeon");if(0===o.length)return!1;let t=!0;o.forEach(e=>{const o=e.dataset.numeroPasajero,n=e.querySelector(".pasajero-content");if(n){const e=n.querySelector(`#nombre_${o}`)?.value||"",a=n.querySelector(`#apellido_${o}`)?.value||"";""!==e.trim()&&""!==a.trim()||(t=!1)}});const n=document.getElementById("tipoReserva")?.value||"",a=document.getElementById("estadoReserva")?.value||"",l=document.getElementById("fechaViaje")?.value||"",i=document.getElementById("vendedor")?.value||"",c=document.getElementById("cliente")?.value||"",r=""!==n.trim()&&""!==a.trim()&&""!==l.trim()&&""!==i.trim()&&""!==c.trim();return t&&r}()?(e.disabled=!0,e.style.opacity="0.5",e.style.cursor="not-allowed"):(e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer"))}Office.onReady(l=>{try{if(l.host===Office.HostType.Outlook){const l=document.getElementById("sideload-msg");l&&(l.style.display="none");const r=document.getElementById("app-body");r&&(r.style.display="flex");const s=document.getElementById("run");s&&(s.onclick=function(){try{a()}catch(e){t("Error al extraer datos: "+e.message,"error")}});const d=document.getElementById("reextract");d&&(d.onclick=function(){try{document.getElementById("results").style.display="none",a()}catch(e){t("Error al re-extraer datos: "+e.message,"error")}});const u=document.getElementById("guardar");u&&(u.onclick=function(){try{!function(){try{const e=document.getElementById("pasajerosContainer");if(!e)return void t("No se encontr√≥ el contenedor de pasajeros","error");const o=e.querySelectorAll(".pasajero-acordeon");if(0===o.length)return void t("No hay pasajeros para guardar. Por favor, extraiga datos primero.","info");const n=[];o.forEach((e,o)=>{const t=e.dataset.numeroPasajero,a=e.querySelector(".pasajero-content");if(a){const e={numeroPasajero:o+1,tipoPasajero:a.querySelector(`#tipoPasajero_${t}`)?.value||"",nombre:a.querySelector(`#nombre_${t}`)?.value||"",apellido:a.querySelector(`#apellido_${t}`)?.value||"",dni:a.querySelector(`#dni_${t}`)?.value||"",fechaNacimiento:a.querySelector(`#fechaNacimiento_${t}`)?.value||"",cuil:a.querySelector(`#cuil_${t}`)?.value||"",tipoDoc:a.querySelector(`#tipoDoc_${t}`)?.value||"",sexo:a.querySelector(`#sexo_${t}`)?.value||"",nacionalidad:a.querySelector(`#nacionalidad_${t}`)?.value||"",direccion:a.querySelector(`#direccion_${t}`)?.value||"",telefono:a.querySelector(`#telefono_${t}`)?.value||""};n.push(e)}}),t(`Datos de ${n.length} pasajero(s) guardados correctamente`,"success")}catch(e){throw e}}()}catch(e){t("Error al guardar datos: "+e.message,"error")}});const p=document.getElementById("agregarPasajero");p&&(p.onclick=function(){try{!function(){try{const e=document.getElementById("pasajerosContainer");if(!e)return;const o=i(e.querySelectorAll(".pasajero-acordeon").length+1);e.appendChild(o);const t=o.querySelector(".pasajero-content"),n=o.querySelector(".arrow");t&&n&&(t.style.display="block",n.style.transform="rotate(180deg)"),o.scrollIntoView&&o.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>c(),200)}catch(e){throw e}}()}catch(e){t("Error al agregar pasajero: "+e.message,"error")}});const m=document.getElementById("crearReserva");m&&(m.onclick=function(){!async function(){try{const o=document.getElementById("pasajerosContainer");if(!o)return void t("No se encontr√≥ el contenedor de pasajeros","error");const n=o.querySelectorAll(".pasajero-acordeon");if(0===n.length)return void t("No hay pasajeros para crear la reserva. Por favor, extraiga datos primero.","info");const a=[];n.forEach((e,o)=>{const t=e.dataset.numeroPasajero,n=e.querySelector(".pasajero-content");if(n){const e={numeroPasajero:o+1,tipoPasajero:n.querySelector(`#tipoPasajero_${t}`)?.value||"",nombre:n.querySelector(`#nombre_${t}`)?.value||"",apellido:n.querySelector(`#apellido_${t}`)?.value||"",dni:n.querySelector(`#dni_${t}`)?.value||"",fechaNacimiento:n.querySelector(`#fechaNacimiento_${t}`)?.value||"",cuil:n.querySelector(`#cuil_${t}`)?.value||"",tipoDoc:n.querySelector(`#tipoDoc_${t}`)?.value||"",sexo:n.querySelector(`#sexo_${t}`)?.value||"",nacionalidad:n.querySelector(`#nacionalidad_${t}`)?.value||"",direccion:n.querySelector(`#direccion_${t}`)?.value||"",telefono:n.querySelector(`#telefono_${t}`)?.value||""};a.push(e)}});const l={tipoReserva:document.getElementById("tipoReserva")?.value||"",estadoReserva:document.getElementById("estadoReserva")?.value||"",fechaViaje:document.getElementById("fechaViaje")?.value||"",vendedor:document.getElementById("vendedor")?.value||"",cliente:document.getElementById("cliente")?.value||"",codigo:document.getElementById("codigo")?.value||"",reservationDate:document.getElementById("fechaReserva")?.value||"",tourEndDate:document.getElementById("fechaFinTour")?.value||"",dueDate:document.getElementById("fechaVencimiento")?.value||"",contact:document.getElementById("contacto")?.value||"",contactEmail:document.getElementById("contactEmail")?.value||"",contactPhone:document.getElementById("contactPhone")?.value||"",currency:document.getElementById("moneda")?.value||"",exchangeRate:parseFloat(document.getElementById("tipoCambio")?.value)||0,commission:parseFloat(document.getElementById("comision")?.value)||0,netAmount:parseFloat(document.getElementById("montoNeto")?.value)||0,grossAmount:parseFloat(document.getElementById("montoBruto")?.value)||0,tripName:document.getElementById("nombreViaje")?.value||"",productCode:document.getElementById("codigoProducto")?.value||"",adults:parseInt(document.getElementById("adultos")?.value)||0,children:parseInt(document.getElementById("ninos")?.value)||0,infants:parseInt(document.getElementById("infantes")?.value)||0,provider:document.getElementById("proveedor")?.value||"",reservationCode:document.getElementById("codigoReserva")?.value||"",hotel:document.getElementById("hotel")?.value||"",checkIn:document.getElementById("checkIn")?.value||"",checkOut:document.getElementById("checkOut")?.value||"",estadoDeuda:document.getElementById("estadoDeuda")?.value||""},i=[],c=document.getElementById("serviciosContainer");c&&c.querySelectorAll(".servicio-item").forEach((e,o)=>{i.push({destino:document.getElementById(`servicio_destino_${o}`)?.value||"",in:document.getElementById(`servicio_in_${o}`)?.value||"",out:document.getElementById(`servicio_out_${o}`)?.value||"",nts:parseInt(document.getElementById(`servicio_nts_${o}`)?.value)||0,basePax:parseInt(document.getElementById(`servicio_basePax_${o}`)?.value)||0,servicio:document.getElementById(`servicio_servicio_${o}`)?.value||"",descripcion:document.getElementById(`servicio_descripcion_${o}`)?.value||"",estado:document.getElementById(`servicio_estado_${o}`)?.value||""})}),l.services=i;const r=[],s=document.getElementById("vuelosContainer");s&&s.querySelectorAll(".vuelo-item").forEach((e,o)=>{r.push({airline:document.getElementById(`vuelo_airline_${o}`)?.value||"",flightNumber:document.getElementById(`vuelo_flightNumber_${o}`)?.value||"",origin:document.getElementById(`vuelo_origin_${o}`)?.value||"",destination:document.getElementById(`vuelo_destination_${o}`)?.value||"",date:document.getElementById(`vuelo_date_${o}`)?.value||"",time:document.getElementById(`vuelo_time_${o}`)?.value||""})}),l.flights=r;let d=[];if(a.forEach((e,o)=>{e.nombre&&""!==e.nombre.trim()||d.push(`Pasajero ${o+1}: Nombre`),e.apellido&&""!==e.apellido.trim()||d.push(`Pasajero ${o+1}: Apellido`)}),l.tipoReserva&&""!==l.tipoReserva.trim()||d.push("Tipo de Reserva"),l.estadoReserva&&""!==l.estadoReserva.trim()||d.push("Estado"),l.fechaViaje&&""!==l.fechaViaje.trim()||d.push("Fecha de Viaje"),l.vendedor&&""!==l.vendedor.trim()||d.push("Vendedor"),l.cliente&&""!==l.cliente.trim()||d.push("Cliente"),d.length>0)return void t(`Por favor completa los siguientes campos obligatorios: ${d.join(", ")}`,"error");t("Creando reserva en iTraffic... Por favor espere.","info"),function(){const e=document.getElementById("pasajerosContainer");e&&(e.querySelectorAll("input, select").forEach(e=>{e.disabled=!0,e.style.backgroundColor="#f3f4f6",e.style.cursor="not-allowed"}),e.querySelectorAll(".btn-eliminar-pasajero").forEach(e=>{e.disabled=!0,e.style.opacity="0.3",e.style.cursor="not-allowed",e.style.pointerEvents="none"}));["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const o=document.getElementById(e);o&&(o.disabled=!0,o.style.backgroundColor="#f3f4f6",o.style.cursor="not-allowed")});const o=document.getElementById("agregarPasajero");o&&(o.disabled=!0,o.style.opacity="0.5",o.style.cursor="not-allowed");const t=document.getElementById("guardar");t&&(t.disabled=!0,t.style.opacity="0.5",t.style.cursor="not-allowed")}();const u=document.getElementById("crearReserva");u&&(u.disabled=!0,u.style.opacity="0.6",u.querySelector(".ms-Button-label").textContent="‚è≥ Procesando..."),await async function(o,t={}){try{const n=function(o,t={}){return{passengers:o.map(o=>({lastName:o.apellido||"",firstName:o.nombre||"",paxType:"adulto"===o.tipoPasajero?"ADU":"menor"===o.tipoPasajero?"CHD":"INF",birthDate:e(o.fechaNacimiento),nationality:o.nacionalidad?.toUpperCase()||"ARGENTINA",sex:"masculino"===o.sexo?"M":"femenino"===o.sexo?"F":"O",documentNumber:o.dni||"",documentType:o.tipoDoc?.toUpperCase()||"DNI",cuilCuit:o.cuil||"",phoneNumber:o.telefono||"",direccion:o.direccion||""})),reservationType:t.tipoReserva||"AGENCIAS [COAG]",status:t.estadoReserva||"PENDIENTE DE CONFIRMACION [PC]",client:t.cliente||"DESPEGAR - TEST - 1",travelDate:e(t.fechaViaje)||"12/01/2026",seller:t.vendedor||"TEST TEST",codigo:t.codigo||"",reservationDate:e(t.reservationDate)||"",tourEndDate:e(t.tourEndDate)||"",dueDate:e(t.dueDate)||"",contact:t.contact||"",contactEmail:t.contactEmail||"",contactPhone:t.contactPhone||"",currency:t.currency||"ARS",exchangeRate:t.exchangeRate||0,commission:t.commission||0,netAmount:t.netAmount||0,grossAmount:t.grossAmount||0,tripName:t.tripName||"",productCode:t.productCode||"",adults:t.adults||0,children:t.children||0,infants:t.infants||0,provider:t.provider||"",reservationCode:t.reservationCode||"",hotel:t.hotel||"",checkIn:e(t.checkIn)||"",checkOut:e(t.checkOut)||"",estadoDeuda:t.estadoDeuda||"",services:t.services||[],flights:t.flights||[]}}(o,t),a=await fetch("https://aymara.canterasoft.com/api/rpa/create-reservation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error(`Error del servidor: ${a.status} ${a.statusText}`);return{success:!0,data:await a.json(),message:"Reserva creada exitosamente en iTraffic"}}catch(e){if(e.message.includes("fetch"))throw new Error("No se pudo conectar con el servicio RPA. Aseg√∫rate de que el servidor est√© corriendo.");throw e}}(a,l),t("¬°Reserva creada exitosamente en iTraffic!","success"),function(){const e=document.getElementById("pasajerosContainer");e&&e.querySelectorAll(".pasajero-acordeon").forEach(e=>{const o=e.dataset.numeroPasajero,t=e.querySelector(".pasajero-content");if(t){const e={tipoPasajero:t.querySelector(`#tipoPasajero_${o}`)?.value||"",nombre:t.querySelector(`#nombre_${o}`)?.value||"",apellido:t.querySelector(`#apellido_${o}`)?.value||"",dni:t.querySelector(`#dni_${o}`)?.value||"",fechaNacimiento:t.querySelector(`#fechaNacimiento_${o}`)?.value||"",cuil:t.querySelector(`#cuil_${o}`)?.value||"",tipoDoc:t.querySelector(`#tipoDoc_${o}`)?.value||"",sexo:t.querySelector(`#sexo_${o}`)?.value||"",nacionalidad:t.querySelector(`#nacionalidad_${o}`)?.value||"",direccion:t.querySelector(`#direccion_${o}`)?.value||"",telefono:t.querySelector(`#telefono_${o}`)?.value||""};t.innerHTML=`\n          <div class="campo-lectura">\n            <label>Tipo de Pasajero:</label>\n            <p>${e.tipoPasajero||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Nombre:</label>\n            <p>${e.nombre||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Apellido:</label>\n            <p>${e.apellido||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>DNI:</label>\n            <p>${e.dni||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Fecha de Nacimiento:</label>\n            <p>${e.fechaNacimiento||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>CUIL:</label>\n            <p>${e.cuil||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Tipo de Documento:</label>\n            <p>${e.tipoDoc||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Sexo:</label>\n            <p>${e.sexo||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Nacionalidad:</label>\n            <p>${e.nacionalidad||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>Direcci√≥n:</label>\n            <p>${e.direccion||"-"}</p>\n          </div>\n          <div class="campo-lectura">\n            <label>N√∫mero de Tel√©fono:</label>\n            <p>${e.telefono||"-"}</p>\n          </div>\n        `}const n=e.querySelector(".btn-eliminar-pasajero");n&&(n.style.display="none")});const o=document.getElementById("datosReservaSection");if(o){const e={tipoReserva:document.getElementById("tipoReserva")?.value||"",estadoReserva:document.getElementById("estadoReserva")?.value||"",fechaViaje:document.getElementById("fechaViaje")?.value||"",vendedor:document.getElementById("vendedor")?.value||"",cliente:document.getElementById("cliente")?.value||""};o.innerHTML=`\n      <h3>Datos de la Reserva</h3>\n      <div class="campo-lectura">\n        <label>Tipo de Reserva:</label>\n        <p>${e.tipoReserva||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Estado:</label>\n        <p>${e.estadoReserva||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Fecha de Viaje:</label>\n        <p>${e.fechaViaje||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Vendedor:</label>\n        <p>${e.vendedor||"-"}</p>\n      </div>\n      <div class="campo-lectura">\n        <label>Cliente:</label>\n        <p>${e.cliente||"-"}</p>\n      </div>\n    `}const t=document.getElementById("agregarPasajero");t&&(t.style.display="none");const n=document.getElementById("guardar");n&&(n.style.display="none");const a=document.getElementById("crearReserva");a&&(a.style.display="none")}()}catch(e){t("Error al crear reserva: "+e.message,"error"),function(){const e=document.getElementById("pasajerosContainer");e&&(e.querySelectorAll("input, select").forEach(e=>{e.disabled=!1,e.style.backgroundColor="#ffffff",e.style.cursor="text"}),e.querySelectorAll(".btn-eliminar-pasajero").forEach(e=>{e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer",e.style.pointerEvents="auto"}));["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const o=document.getElementById(e);o&&(o.disabled=!1,o.style.backgroundColor="#ffffff",o.style.cursor="pointer")});const o=document.getElementById("agregarPasajero");o&&(o.disabled=!1,o.style.opacity="1",o.style.cursor="pointer");const t=document.getElementById("guardar");t&&(t.disabled=!1,t.style.opacity="1",t.style.cursor="pointer");const n=document.getElementById("crearReserva");n&&(n.disabled=!1,n.style.opacity="1",n.querySelector(".ms-Button-label").textContent="üöÄ Crear Reserva en iTraffic")}()}}()},m.disabled=!0,m.style.opacity="0.5",m.style.cursor="not-allowed"),["tipoReserva","estadoReserva","fechaViaje","vendedor","cliente"].forEach(e=>{const o=document.getElementById(e);o&&(o.addEventListener("change",c),o.addEventListener("input",c))}),async function(){try{const e="https://aymara.canterasoft.com/api/master-data",t=await fetch(e);if(!t.ok)return void console.warn("‚ö†Ô∏è No se pudieron cargar los datos maestros, usando valores por defecto");const a=await t.json();a.success&&a.data&&(o.sellers=a.data.sellers||[],o.clients=a.data.clients||[],o.statuses=a.data.statuses||[],o.reservationTypes=a.data.reservationTypes||[],o.genders=a.data.genders||[],o.documentTypes=a.data.documentTypes||[],o.countries=a.data.countries||[],o.loaded=!0,console.log("‚úÖ Datos maestros cargados:",{vendedores:o.sellers.length,clientes:o.clients.length,estados:o.statuses.length,tiposReserva:o.reservationTypes.length,generos:o.genders.length,tiposDoc:o.documentTypes.length,paises:o.countries.length}),n())}catch(e){console.error("‚ùå Error cargando datos maestros:",e)}}()}}catch(e){}})}(),new URL(t(58394),t.b)}();
//# sourceMappingURL=taskpane.js.map