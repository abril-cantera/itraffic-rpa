{"version":3,"file":"taskpane.js","mappings":"iGACIA,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,CAGAJ,EAAoBO,EAAID,ECzBxBN,EAAoBQ,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAChB,CAAE,MAAOC,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBb,EAAoBc,EAAI,SAASC,EAAKC,GAAQ,OAAOC,OAAOC,UAAUC,eAAeC,KAAKL,EAAKC,EAAO,E,WCAtG,IAAIK,EACArB,EAAoBQ,EAAEc,gBAAeD,EAAYrB,EAAoBQ,EAAEe,SAAW,IACtF,IAAIC,EAAWxB,EAAoBQ,EAAEgB,SACrC,IAAKH,GAAaG,IACbA,EAASC,eAAkE,WAAjDD,EAASC,cAAcC,QAAQC,gBAC5DN,EAAYG,EAASC,cAAcG,MAC/BP,GAAW,CACf,IAAIQ,EAAUL,EAASM,qBAAqB,UAC5C,GAAGD,EAAQE,OAEV,IADA,IAAIC,EAAIH,EAAQE,OAAS,EAClBC,GAAK,KAAOX,IAAc,aAAaY,KAAKZ,KAAaA,EAAYQ,EAAQG,KAAKJ,GAE3F,CAID,IAAKP,EAAW,MAAM,IAAIa,MAAM,yDAChCb,EAAYA,EAAUc,QAAQ,SAAU,IAAIA,QAAQ,OAAQ,IAAIA,QAAQ,QAAS,IAAIA,QAAQ,YAAa,KAC1GnC,EAAoBoC,EAAIf,C,IClBxBrB,EAAoBqC,EAAyB,oBAAbb,UAA4BA,SAASc,SAAYC,KAAKhB,SAASiB,K,WCuF/F,SAASC,EAAeC,GACtB,IAAKA,EAAO,MAAO,GAEnB,IACE,MAAOC,EAAMC,EAAOC,GAAOH,EAAMI,MAAM,KACvC,MAAO,GAAGF,KAASC,KAAOF,GAC5B,CAAE,MAAOI,GACP,MAAO,EACT,CACF,CChGO,MAAMC,EAAc,CAAC,oCAC1B,qCACA,6BACA,sBACA,uCACA,0CACA,8BACA,0BACA,2BACA,sBACA,qBACA,0BACA,wCACA,wCACA,8BACA,+BACA,eACA,0BACA,qBACA,8BACA,gCACA,gCACA,4CACA,oBACA,oCACA,kCACA,sBACA,qBACA,gCACA,6BACA,6BACA,qCACA,qBACA,8BACA,uCACA,sBACA,YACA,2BACA,0BACA,uBACA,iCACA,qBACA,wCACA,4BACA,+BACA,mDACA,8CACA,sCACA,kCACA,uCACA,0CACA,2CACA,mCACA,uCACA,8BACA,8BACA,kDACA,6CACA,qCACA,iCACA,sCACA,yCACA,0CACA,kCACA,sCACA,kBACA,+BACA,2BACA,yBACA,sBACA,uBACA,gFACA,4BACA,8BACA,wBACA,uCACA,qDACA,2CACA,mDACA,0CACA,kDACA,kCACA,0DACA,4CACA,8BACA,0DACA,iCACA,gCACA,+BACA,uDACA,qCACA,8CACA,wBACA,yCACA,0CACA,uDACA,wBACA,2BACA,iDACA,qBACA,4BACA,oCACA,+BACA,6BACA,oCACA,wBACA,uBACA,uBACA,qCACA,oCACA,mCACA,iDACA,uCACA,mCACA,wCACA,sBACA,+BACA,iBACA,qCACA,cACA,yBACA,iCACA,2BACA,aACA,kBACA,0BACA,gCACA,mCACA,gCACA,4BACA,yCACA,wDACA,uDACA,6BACA,kCACA,0CACA,oDACA,mCACA,kDACA,8CACA,oCACA,2DACA,4CACA,mDACA,oBACA,iCACA,yBACA,SACA,+BACA,yBACA,uBACA,gBACA,sBACA,oDACA,uEACA,sCACA,yCACA,0CACA,yCACA,yCACA,oCACA,mBACA,mCACA,+BACA,2CACA,wBACA,mBACA,iBACA,qBACA,6CACA,mCACA,yDACA,6DACA,yCACA,6CACA,wBACA,kCACA,yBACA,qCACA,sCACA,qCACA,uBACA,wBACA,wBACA,iCACA,wCACA,2EACA,0BACA,mCACA,+BACA,kCACA,0BACA,8BACA,iCACA,kCACA,4BACA,yCACA,yCACA,gCACA,mCACA,6BACA,2BACA,+BACA,mCACA,kCACA,mCACA,WACA,sBACA,uBACA,wBACA,oCACA,gBACA,2BACA,qCACA,uCACA,0CACA,8CACA,yCACA,6CACA,6BACA,wDACA,8CACA,gEACA,kDACA,kCACA,uCACA,mBACA,mBACA,iCACA,uCACA,kDACA,mDACA,uCACA,mCACA,uCACA,6BACA,6BACA,6BACA,0CACA,gEACA,0DACA,uBACA,uCACA,0BACA,0BACA,sBACA,oCACA,4BACA,iCACA,8BACA,0BACA,2BACA,2BACA,iCACA,+BACA,qBACA,0BACA,0CACA,uCACA,wBACA,8BACA,kBACA,mBACA,mBACA,iCACA,iDACA,oCACA,6BACA,0CACA,2CACA,2CACA,qDACA,oCACA,mDACA,+BACA,8BACA,0CACA,0CACA,0CACA,qCACA,8CACA,oCACA,qBACA,2CACA,yBACA,kBACA,sBACA,uCACA,yBACA,yBACA,mCACA,uBACA,qCACA,0BACA,0DACA,kCACA,mCACA,wCACA,sCACA,0CChSIC,EAAa,CACjBC,QAAS,GACTC,QAAS,GACTC,SAAU,GACVC,iBAAkB,GAClBC,QAAS,GACTC,cAAe,GACfC,UAAW,GACXC,QAAQ,GAIV,IAAIC,EAAkB,CACpBC,oBAAoB,EACpBC,gBAAiB,KACjBC,WAAY,MAId,SAASC,EAAeC,EAASC,EAAO,QAEtC,MAAMC,EAAazC,SAAS0C,cAAc,OAC1CD,EAAWE,UAAY,kBAAkBH,IACzCC,EAAWG,YAAcL,EACzBE,EAAWI,MAAMC,SAAW,QAC5BL,EAAWI,MAAME,IAAM,OACvBN,EAAWI,MAAMG,KAAO,MACxBP,EAAWI,MAAMI,UAAY,mBAC7BR,EAAWI,MAAMK,OAAS,QAC1BT,EAAWI,MAAMM,SAAW,QAC5BV,EAAWI,MAAMO,SAAW,MAC5BX,EAAWI,MAAMQ,UAAY,SAC7BZ,EAAWI,MAAMS,UAAY,sBAE7BtD,SAASuD,KAAKC,YAAYf,GAG1BgB,WAAW,KACThB,EAAWI,MAAMS,UAAY,oBAC7BG,WAAW,KACLhB,EAAWiB,YACbjB,EAAWiB,WAAWC,YAAYlB,IAEnC,MACF,IACL,CAmJA,SAASmB,IACP,MAAMC,EAAU7D,SAAS8D,eAAe,YAClCC,EAAW/D,SAAS8D,eAAe,aAGzC,KAAKD,GAAYE,GAAaF,EAAQG,OAAUD,EAASC,OAIvD,OAFIH,IAASA,EAAQhB,MAAMoB,YAAc,SACrCF,IAAUA,EAASlB,MAAMoB,YAAc,KAI7C,MAAMC,EAAU,IAAIC,KAAKN,EAAQG,OAC3BI,EAAW,IAAID,KAAKJ,EAASC,OAGnC,OAAIK,MAAMH,EAAQI,YAAcD,MAAMD,EAASE,gBAA/C,EAKIF,GAAYF,GAEdL,EAAQhB,MAAMoB,YAAc,eAC5BF,EAASlB,MAAMoB,YAAc,iBAKRM,KAAKC,OAAOJ,EAAWF,GAAW,OAEpC,GAEnBL,EAAQhB,MAAMoB,YAAc,UAC5BF,EAASlB,MAAMoB,YAAc,YAG7BJ,EAAQhB,MAAMoB,YAAc,GAC5BF,EAASlB,MAAMoB,YAAc,IAEjC,CAoDA,SAASQ,IAEP,MAAMC,EAAoB1E,SAAS8D,eAAe,eAC9CY,GAAqBjD,EAAWI,iBAAiBtB,OAAS,GAC5DmE,EAAkBC,UAAY,0CAC9BlD,EAAWI,iBAAiB+C,QAAQpC,IAClC,MAAMqC,EAAS7E,SAAS0C,cAAc,UACtCmC,EAAOb,MAAQxB,EAAKsC,KACpBD,EAAOjC,YAAcJ,EAAKsC,KAC1BJ,EAAkBlB,YAAYqB,KAEhCE,QAAQC,IAAI,+BAA+BvD,EAAWI,iBAAiBtB,oBAC9DmE,IAETA,EAAkBC,UAAY,8TAO9BI,QAAQC,IAAI,qDAId,MAAMC,EAAejF,SAAS8D,eAAe,iBACzCmB,GAAgBxD,EAAWG,SAASrB,OAAS,GAC/C0E,EAAaN,UAAY,0CACzBlD,EAAWG,SAASgD,QAAQM,IAC1B,MAAML,EAAS7E,SAAS0C,cAAc,UACtCmC,EAAOb,MAAQkB,EAAOJ,KACtBD,EAAOjC,YAAcsC,EAAOJ,KAC5BG,EAAazB,YAAYqB,KAE3BE,QAAQC,IAAI,yBAAyBvD,EAAWG,SAASrB,oBAChD0E,IAETA,EAAaN,UAAY,oRAMzBI,QAAQC,IAAI,+CAId,MAAMG,EAAiBnF,SAAS8D,eAAe,YAC3CqB,GAAkB1D,EAAWC,QAAQnB,OAAS,GAChD4E,EAAeR,UAAY,0CAC3BlD,EAAWC,QAAQkD,QAAQQ,IACzB,MAAMP,EAAS7E,SAAS0C,cAAc,UACtCmC,EAAOb,MAAQoB,EAASN,KACxBD,EAAOjC,YAAcwC,EAASN,KAC9BK,EAAe3B,YAAYqB,KAE7BE,QAAQC,IAAI,2BAA2BvD,EAAWC,QAAQnB,oBACjD4E,IAETA,EAAeR,UAAY,4GAI3BI,QAAQC,IAAI,iDAId,MAAMK,EAAgBrF,SAAS8D,eAAe,WAC1CuB,GAAiB5D,EAAWE,QAAQpB,OAAS,GAC/C8E,EAAcV,UAAY,0CAC1BlD,EAAWE,QAAQiD,QAAQU,IACzB,MAAMT,EAAS7E,SAAS0C,cAAc,UACtCmC,EAAOb,MAAQsB,EAAQR,KACvBD,EAAOjC,YAAc0C,EAAQR,KAC7BO,EAAc7B,YAAYqB,KAE5BE,QAAQC,IAAI,0BAA0BvD,EAAWE,QAAQpB,oBAChD8E,IAETA,EAAcV,UAAY,gIAI1BI,QAAQC,IAAI,+CAEhB,CA2FAO,eAAeC,EAAIC,GAAc,GAC/B,IAEE,MAAMC,EAAY1F,SAAS8D,eAAe,OAC1C4B,EAAU7C,MAAM8C,QAAU,OAG1B,MAAMC,EAAS5F,SAAS8D,eAAe,UACvC8B,EAAO/C,MAAM8C,QAAU,QAGvB,MAAME,EAAa7F,SAAS8D,eAAe,WAC3C+B,EAAWhD,MAAM8C,QAAU,OAEhBG,OAAOC,QAAQC,QAAQC,KAGlCH,OAAOC,QAAQC,QAAQC,KAAK1C,KAAK2C,SAC/BJ,OAAOK,aAAaC,KACpBb,UACE,GAAIc,EAAOC,SAAWR,OAAOS,kBAAkBC,UAAW,CACxD,MAAMC,EAAeJ,EAAOrC,MAE5B,IAEE,MAAM0C,QAiGlBnB,eAAiCoB,EAAclB,GAAc,GAE3D,MAGMO,EAAUF,OAAOC,QAAQC,QAG/BjB,QAAQC,IAAI,wCAAyCS,EAAa,eAAgBA,GAElF,MAAMmB,QAAiBC,MAPnBC,0FAOqC,CACvCC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBzD,KAAM0D,KAAKC,UAAU,CACnBP,aAAcA,EACdQ,OAAQnB,EAAQoB,YAAYC,cAAgB,eAC5CC,eAAgBtB,EAAQC,KAAKqB,gBAAkB,kBAC/C7B,YAAaA,MAIjB,IAAKmB,EAASW,GAAI,CAChB,MAAMC,QAAkBZ,EAASa,OACjC,MAAM,IAAI/G,MAAM8G,EAAUjG,OAAS,yBACrC,CAEA,MAAM8E,QAAeO,EAASa,OAQ9B,MALgC,IAC3BpB,EAAOqB,KACVvF,mBAAoBkE,EAAOlE,qBAAsB,EAIrD,CAtIwCwF,CAAkBlB,EAAchB,GAG5DG,EAAO/C,MAAM8C,QAAU,OAGvBE,EAAWhD,MAAM8C,QAAU,QAG3B,MAAMiC,EAAkB5H,SAAS8D,eAAe,aAKhD,GAJI8D,IACFA,EAAgB/E,MAAM8C,QAAU,SAG9Be,GAAiBA,EAAcmB,YAAcnB,EAAcmB,WAAWtH,OAAS,EAAG,CAEpF,MAAMuH,EAAwBpB,EAAcvE,mBACtCA,GAA+C,IAA1B2F,GAA4D,SAA1BA,GAA8D,IAA1BA,EAGjG/C,QAAQC,IAAI,kCAAmC8C,EAAuB,eAAgBA,GACtF/C,QAAQC,IAAI,oCAAqC7C,GAGjDD,EAAgBC,mBAAqBA,EACrCD,EAAgBE,gBAAkBsE,EAActE,iBAAmB,KAG/DD,IACFD,EAAgBG,WAAa4E,KAAKc,MAAMd,KAAKC,UAAUR,KAIzD3B,QAAQC,IAAI,kDAAmD9C,EAAgBC,oBAC/E4C,QAAQC,IAAI,+CAAgD9C,EAAgBE,iBAC5E2C,QAAQC,IAAI,0CAA2C9C,EAAgBG,YAGvE2F,EAA0BtB,EAAcmB,WAAWtH,OAAQ4B,GAqY3C8F,EAlYKvB,EAAcmB,WAqY/CpE,WAAW,KACTwE,EAAerD,QAAQ,CAACsD,EAAOC,KAC7B,MAAMC,EAASD,EAAQ,EAEvB,GAAInI,SAAS8D,eAAe,gBAAgBsE,KAAW,CAErD,IAAIC,EAAe,GACnB,MAAMC,EAAgBJ,EAAMI,eAAiBJ,EAAMK,QAC7B,QAAlBD,EAAyBD,EAAe,SACjB,QAAlBC,EAAyBD,EAAe,QACtB,QAAlBC,IAAyBD,EAAe,WAOjDrI,SAAS8D,eAAe,gBAAgBsE,KAAUpE,MAAQqE,EAC1DrI,SAAS8D,eAAe,UAAUsE,KAAUpE,MAAQkE,EAAMM,WAAa,GACvExI,SAAS8D,eAAe,YAAYsE,KAAUpE,MAAQkE,EAAMO,UAAY,GACxEzI,SAAS8D,eAAe,OAAOsE,KAAUpE,MAAQkE,EAAMQ,gBAAkB,GAEzE1I,SAAS8D,eAAe,mBAAmBsE,KAAUpE,MAAQkE,EAAMS,aAAeT,EAAMU,WAAa,GACrG5I,SAAS8D,eAAe,QAAQsE,KAAUpE,MAAQkE,EAAMW,UAAY,GAGpE,MAAMC,EAAgB9I,SAAS8D,eAAe,WAAWsE,KACrDU,GAAiBZ,EAAMa,eACzBD,EAAc9E,MAAQkE,EAAMa,aAC5BhE,QAAQC,IAAI,cAAcoD,MAAWF,EAAMa,mBAAmBD,EAAc9E,UAG9E,MAAMgF,EAAahJ,SAAS8D,eAAe,QAAQsE,KAC/CY,GAAcd,EAAMe,MACtBD,EAAWhF,MAAQkE,EAAMe,IACzBlE,QAAQC,IAAI,UAAUoD,MAAWF,EAAMe,UAAUD,EAAWhF,UAG9D,MAAMkF,EAAqBlJ,SAAS8D,eAAe,gBAAgBsE,KAC/Dc,GAAsBhB,EAAMiB,cAC9BD,EAAmBlF,MAAQkE,EAAMiB,YACjCpE,QAAQC,IAAI,kBAAkBoD,MAAWF,EAAMiB,kBAAkBD,EAAmBlF,UAGtFhE,SAAS8D,eAAe,aAAasE,KAAUpE,MAAQkE,EAAMkB,WAAa,GAE1EpJ,SAAS8D,eAAe,YAAYsE,KAAUpE,MAAQkE,EAAMmB,aAAenB,EAAMoB,UAAY,EAC/F,IAIF7F,WAAW,IAAM8F,IAAqC,MACrD,KAMuBC,EA5bK9C,EA8b/BjC,IAGAhB,WAAW,KAET,MAAMiB,EAAoB1E,SAAS8D,eAAe,eAClD,GAAIY,EAAmB,CACrB,MAAM+E,EAAmBD,EAAeE,gBAIxC,GAHA3E,QAAQC,IAAI,wCAAwCyE,MACpD1E,QAAQC,IAAI,yBAA0B2E,MAAMC,KAAKlF,EAAkBmF,SAASC,IAAIxK,GAAK,IAAIA,EAAE0E,WAEvFyF,GAAyC,SAArBA,GAAoD,OAArBA,IACrD/E,EAAkBV,MAAQyF,EAC1B1E,QAAQC,IAAI,6BAA6ByE,UAAyB/E,EAAkBV,WAG/EU,EAAkBV,OAAqC,KAA5BU,EAAkBV,OAAc,CAC9D,MACM+F,EADWJ,MAAMC,KAAKlF,EAAkBmF,SAChBG,KAAKC,GACjCA,EAAIjG,OAASyF,IACZQ,EAAIjG,MAAM7D,cAAc+J,SAAST,EAAiBtJ,gBACnDsJ,EAAiBtJ,cAAc+J,SAASD,EAAIjG,MAAM7D,iBAEhD4J,GACFrF,EAAkBV,MAAQ+F,EAAa/F,MACvCe,QAAQC,IAAI,mCAAmCyE,UAAyB/E,EAAkBV,WAE1Fe,QAAQoF,KAAK,sDAAsDV,KAEvE,CAEJ,CAGA,MAAMW,EAAsBpK,SAAS8D,eAAe,iBACpD,GAAIsG,EAAqB,CACvB,MAAMC,EAAcb,EAAelD,OAC7BgE,EAAsBX,MAAMC,KAAKQ,EAAoBP,SAASC,IAAIxK,GAAKA,EAAE0E,OAM/E,GAJAe,QAAQC,IAAI,kCAAkCqF,MAC9CtF,QAAQC,IAAI,4CAA6CsF,GACzDvF,QAAQC,IAAI,yBAAyBsF,EAAoB/J,UAErD8J,GAA+B,SAAhBA,GAA0C,OAAhBA,EAM3C,GAJAD,EAAoBpG,MAAQqG,EAC5BtF,QAAQC,IAAI,wBAAwBqF,UAAoBD,EAAoBpG,UAGvEoG,EAAoBpG,OAAuC,KAA9BoG,EAAoBpG,MA+CpDe,QAAQC,IAAI,qCAAqCoF,EAAoBpG,cA/CH,CAClEe,QAAQC,IAAI,yDAEZ,MAAMuF,EAAWZ,MAAMC,KAAKQ,EAAoBP,SAGhD,IAAIE,EAAeQ,EAASP,KAAKC,GAC/BA,EAAIjG,OACJiG,EAAIjG,MAAMwG,OAAOrK,gBAAkBkK,EAAYG,OAAOrK,eAGxD,GAAI4J,EACFK,EAAoBpG,MAAQ+F,EAAa/F,MACzCe,QAAQC,IAAI,oCAAoCqF,UAAoBD,EAAoBpG,eASxF,GANA+F,EAAeQ,EAASP,KAAKC,GAC3BA,EAAIjG,OAASqG,IACZJ,EAAIjG,MAAM7D,cAAc+J,SAASG,EAAYlK,gBAC9CkK,EAAYlK,cAAc+J,SAASD,EAAIjG,MAAM7D,iBAG3C4J,EACFK,EAAoBpG,MAAQ+F,EAAa/F,MACzCe,QAAQC,IAAI,qCAAqCqF,UAAoBD,EAAoBpG,cACpF,CAEL,MAAMyG,EAAaJ,EAAYlK,cAE3BsK,EAAWP,SAAS,cAAgBO,EAAWP,SAAS,WAC1DH,EAAeQ,EAASP,KAAKC,GAAOA,EAAIjG,OAASiG,EAAIjG,MAAM7D,cAAc+J,SAAS,cACzEO,EAAWP,SAAS,cAAgBO,EAAWP,SAAS,WACjEH,EAAeQ,EAASP,KAAKC,GAAOA,EAAIjG,OAASiG,EAAIjG,MAAM7D,cAAc+J,SAAS,eACzEO,EAAWP,SAAS,aAAeO,EAAWP,SAAS,aAChEH,EAAeQ,EAASP,KAAKC,GAAOA,EAAIjG,OAASiG,EAAIjG,MAAM7D,cAAc+J,SAAS,cAGhFH,GACFK,EAAoBpG,MAAQ+F,EAAa/F,MACzCe,QAAQC,IAAI,kCAAkCqF,UAAoBD,EAAoBpG,YAEtFe,QAAQxD,MAAM,uDAAuD8I,MACrEtF,QAAQC,IAAI,uFAAwFsF,GAExG,CAEJ,MAIAvF,QAAQC,IAAI,kCAAkCqF,KAElD,CAGIrK,SAAS8D,eAAe,gBAC1B9D,SAAS8D,eAAe,cAAcE,MAAQwF,EAAekB,YAAc,GAC3E3F,QAAQC,IAAI,kBAAkBwE,EAAekB,eAI/C,MAAMvF,EAAiBnF,SAAS8D,eAAe,YAC/C,GAAIqB,EAAgB,CAClB,MAAMwF,EAAgBnB,EAAeoB,OACrC,GAAID,GAAmC,SAAlBA,GAA8C,OAAlBA,GAK/C,GAJAxF,EAAenB,MAAQ2G,EACvB5F,QAAQC,IAAI,gBAAgB2F,UAAsBxF,EAAenB,WAG5DmB,EAAenB,OAAkC,KAAzBmB,EAAenB,MAAc,CACxD,MACM+F,EADWJ,MAAMC,KAAKzE,EAAe0E,SACbG,KAAKC,GACjCA,EAAIjG,OAAS2G,IACZV,EAAIjG,MAAM7D,cAAc+J,SAASS,EAAcxK,gBAChDwK,EAAcxK,cAAc+J,SAASD,EAAIjG,MAAM7D,iBAE7C4J,IACF5E,EAAenB,MAAQ+F,EAAa/F,MACpCe,QAAQC,IAAI,+BAA+B2F,UAAsBxF,EAAenB,UAEpF,OAEAe,QAAQC,IAAI,oCAAoC2F,KAEpD,CAGA,MAAMtF,EAAgBrF,SAAS8D,eAAe,WAC9C,GAAIuB,EAAe,CACjB,MAAMwF,EAAerB,EAAesB,OACpC,GAAID,GAAiC,SAAjBA,GAA4C,OAAjBA,GAK7C,GAJAxF,EAAcrB,MAAQ6G,EACtB9F,QAAQC,IAAI,eAAe6F,UAAqBxF,EAAcrB,WAGzDqB,EAAcrB,OAAiC,KAAxBqB,EAAcrB,MAAc,CACtD,MACM+F,EADWJ,MAAMC,KAAKvE,EAAcwE,SACZG,KAAKC,GACjCA,EAAIjG,OAAS6G,IACZZ,EAAIjG,MAAM7D,cAAc+J,SAASW,EAAa1K,gBAC/C0K,EAAa1K,cAAc+J,SAASD,EAAIjG,MAAM7D,iBAE5C4J,IACF1E,EAAcrB,MAAQ+F,EAAa/F,MACnCe,QAAQC,IAAI,8BAA8B6F,UAAqBxF,EAAcrB,UAEjF,OAEAe,QAAQC,IAAI,mCAAmC6F,KAEnD,CAII7K,SAAS8D,eAAe,YAC1B9D,SAAS8D,eAAe,UAAUE,MAAQwF,EAAeuB,QAAU,IAIjE/K,SAAS8D,eAAe,kBAC1B9D,SAAS8D,eAAe,gBAAgBE,MAAQwF,EAAewB,iBAAmB,IAIhFhL,SAAS8D,eAAe,kBAC1B9D,SAAS8D,eAAe,gBAAgBE,MAAQwF,EAAeyB,aAAe,IAI5EjL,SAAS8D,eAAe,sBAC1B9D,SAAS8D,eAAe,oBAAoBE,MAAQwF,EAAe0B,SAAW,IAI5ElL,SAAS8D,eAAe,cAC1B9D,SAAS8D,eAAe,YAAYE,MAAQwF,EAAe2B,SAAW,IAIpEnL,SAAS8D,eAAe,kBAC1B9D,SAAS8D,eAAe,gBAAgBE,MAAQwF,EAAe4B,cAAgB,IAI7EpL,SAAS8D,eAAe,kBAC1B9D,SAAS8D,eAAe,gBAAgBE,MAAQwF,EAAe6B,cAAgB,IAI7ErL,SAAS8D,eAAe,YAC1B9D,SAAS8D,eAAe,UAAUE,MAAQwF,EAAe8B,UAAY,IAInEtL,SAAS8D,eAAe,gBAC1B9D,SAAS8D,eAAe,cAAcE,MAAQwF,EAAe+B,cAAgB,IAI3EvL,SAAS8D,eAAe,cAC1B9D,SAAS8D,eAAe,YAAYE,MAAQwF,EAAegC,YAAc,IAIvExL,SAAS8D,eAAe,eAC1B9D,SAAS8D,eAAe,aAAaE,MAAQwF,EAAeiC,WAAa,IAIvEzL,SAAS8D,eAAe,gBAC1B9D,SAAS8D,eAAe,cAAcE,MAAQwF,EAAekC,aAAe,IAI1E1L,SAAS8D,eAAe,iBAC1B9D,SAAS8D,eAAe,eAAeE,MAAQwF,EAAemC,UAAY,IAIxE3L,SAAS8D,eAAe,oBAC1B9D,SAAS8D,eAAe,kBAAkBE,MAAQwF,EAAeoC,aAAe,IAI9E5L,SAAS8D,eAAe,aAC1B9D,SAAS8D,eAAe,WAAWE,MAAQwF,EAAeqC,QAAU,IAIlE7L,SAAS8D,eAAe,WAC1B9D,SAAS8D,eAAe,SAASE,MAAQwF,EAAesC,UAAY,IAIlE9L,SAAS8D,eAAe,cAC1B9D,SAAS8D,eAAe,YAAYE,MAAQwF,EAAeuC,SAAW,IAIpE/L,SAAS8D,eAAe,eAC1B9D,SAAS8D,eAAe,aAAaE,MAAQwF,EAAewC,UAAY,IAItEhM,SAAS8D,eAAe,mBAC1B9D,SAAS8D,eAAe,iBAAiBE,MAAQwF,EAAepH,iBAAmB,IAIrF,MAAM6J,EAAejM,SAAS8D,eAAe,gBACvCoI,EAAqBlM,SAAS8D,eAAe,gBAE/C0F,EAAe2C,OAAyC,iBAAzB3C,EAAe2C,OAE5CF,IACFA,EAAapJ,MAAM8C,QAAU,SAE3BuG,IACFA,EAAmBrJ,MAAM8C,QAAU,QAIjB,CAAC,eAAgB,wBAAyB,eAAgB,WAAY,aAC9Ef,QAAQwH,IAClB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMC,UAAW,KAIjBtM,SAAS8D,eAAe,kBAC1B9D,SAAS8D,eAAe,gBAAgBE,MAAQwF,EAAe2C,MAAMI,cAAgB,IAEnFvM,SAAS8D,eAAe,2BAC1B9D,SAAS8D,eAAe,yBAAyBE,MAAQwF,EAAe2C,MAAMK,iBAAmB,IAE/FxM,SAAS8D,eAAe,kBAC1B9D,SAAS8D,eAAe,gBAAgBE,MAAQwF,EAAe2C,MAAMM,QAAU,IAE7EzM,SAAS8D,eAAe,qBAC1B9D,SAAS8D,eAAe,mBAAmBE,MAAQwF,EAAe2C,MAAMO,WAAa,IAEnF1M,SAAS8D,eAAe,cAC1B9D,SAAS8D,eAAe,YAAYE,MAAQwF,EAAe2C,MAAMQ,IAAM,IAErE3M,SAAS8D,eAAe,eAC1B9D,SAAS8D,eAAe,aAAaE,MAAQwF,EAAe2C,MAAMS,KAAO,KAElC,iBAAzBpD,EAAe2C,OAE3BF,IACFA,EAAapJ,MAAM8C,QAAU,SAE3BuG,IACFA,EAAmBrJ,MAAM8C,QAAU,QAGjB,CAAC,eAAgB,wBAAyB,eAAgB,WAAY,aAC9Ef,QAAQwH,IAClB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMC,UAAW,KAIjBtM,SAAS8D,eAAe,kBAC1B9D,SAAS8D,eAAe,gBAAgBE,MAAQwF,EAAe2C,OAAS,MAItEF,IACFA,EAAapJ,MAAM8C,QAAU,QAE3BuG,IACFA,EAAmBrJ,MAAM8C,QAAU,SAIjB,CAAC,eAAgB,wBAAyB,eAAgB,WAAY,aAC9Ef,QAAQwH,IAClB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMC,UAAW,EACjBD,EAAMrI,MAAQ,OAMhBhE,SAAS8D,eAAe,aAC1B9D,SAAS8D,eAAe,WAAWE,MAAQwF,EAAeqD,SAAW,IAInE7M,SAAS8D,eAAe,cAC1B9D,SAAS8D,eAAe,YAAYE,MAAQwF,EAAesD,UAAY,IAIrE9M,SAAS8D,eAAe,iBAC1B9D,SAAS8D,eAAe,eAAeE,MAAQwF,EAAeuD,aAAe,IAI/E,MAAMC,EAAmBhN,SAAS8D,eAAe,oBAkBjD,GAjB8B9D,SAAS8D,eAAe,mBAElD0F,EAAeyD,UAAYtD,MAAMuD,QAAQ1D,EAAeyD,WAAazD,EAAeyD,SAAS1M,OAAS,GACpGyM,IACFA,EAAiBnK,MAAM8C,QAAU,SA2NzC,SAAyBwH,GACvB,MAAMC,EAAqBpN,SAAS8D,eAAe,sBAC7CkJ,EAAmBhN,SAAS8D,eAAe,oBAC5CsJ,IAELA,EAAmBzI,UAAY,GAG3BqI,IACFA,EAAiBnK,MAAM8C,QAAU,SAGnCwH,EAAUvI,QAAQ,CAACyI,EAAUlF,KAC3B,MAAMmF,EAAcC,EAAsBpF,EAAOkF,GAAU,GAC3DD,EAAmB5J,YAAY8J,KAIjC7J,WAAW,IAAM8F,IAAqC,KACxD,CA5OMiE,CAAgBhE,EAAeyD,WAG3BD,IACFA,EAAiBnK,MAAM8C,QAAU,QAOjC6D,EAAeiE,SAAW9D,MAAMuD,QAAQ1D,EAAeiE,UAAYjE,EAAeiE,QAAQlN,OAAS,EAAG,CACxG,MAAMmN,EAAgB1N,SAAS8D,eAAe,iBAC1C4J,IACFA,EAAc7K,MAAM8C,QAAU,SAkYtC,SAAsBgI,GACpB,MAAMC,EAAkB5N,SAAS8D,eAAe,mBAC3C8J,IAELA,EAAgBjJ,UAAY,GAE5BgJ,EAAO/I,QAAQ,CAACiJ,EAAO1F,KACrB,MAAM2F,EAAW9N,SAAS0C,cAAc,OACxCoL,EAASnL,UAAY,aACrBmL,EAASnJ,UAAY,qBACPwD,EAAQ,2HAGqBA,aAAiB0F,EAAME,SAAW,2JAI7B5F,aAAiB0F,EAAMG,cAAgB,4IAI7C7F,aAAiB0F,EAAMI,QAAU,kJAI5B9F,aAAiB0F,EAAMK,aAAe,yIAI7C/F,aAAiB0F,EAAMM,MAAQ,wIAI/BhG,aAAiB0F,EAAMO,MAAQ,oCAGvER,EAAgBpK,YAAYsK,KAEhC,CAtaMO,CAAa7E,EAAeiE,QAC9B,CAGAhK,WAAW,IAAM8F,IAAqC,MACrD,KAxzBS+E,EAA4BnM,GAG1BG,EADCH,EACc,yDAEA,sBAAsBuE,EAAcmB,WAAWtH,qBAFW,UAI7E,MAEEyH,EAA0B,GAC1B1F,EAAe,4EAA6E,OAEhG,CAAE,MAAOf,GAEPqE,EAAO/C,MAAM8C,QAAU,OAGvBE,EAAWhD,MAAM8C,QAAU,QAG3BqC,EAA0B,GAC1B1F,EAAe,2BAA6Bf,EAAMgN,QAAU,qCAAsC,QACpG,CACF,MAEE3I,EAAO/C,MAAM8C,QAAU,OAGvBD,EAAU7C,MAAM8C,QAAU,QAE1BrD,EAAe,2CAA4C,SA2ZrE,IAA4BkH,EA7DEvB,GA1V5B,CAAE,MAAO1G,GAEQvB,SAAS8D,eAAe,UAChCjB,MAAM8C,QAAU,OAGL3F,SAAS8D,eAAe,OAChCjB,MAAM8C,QAAU,QAE1BrD,EAAe,qBAAuBf,EAAMgN,QAAS,QACvD,CACF,CA4CA,SAASvG,EAA0BwG,EAAiBrM,GAAqB,GACvE,MAAMsM,EAAYzO,SAAS8D,eAAe,sBAC1C2K,EAAU9J,UAAY,GAEtB,IAAK,IAAInE,EAAI,EAAGA,EAAIgO,EAAiBhO,IAAK,CACxC,MAAMkO,EAAcC,EAAwBnO,EAAI,GAChDiO,EAAUjL,YAAYkL,EACxB,CAGAjL,WAAW,IAAM8F,IAAqC,IACxD,CAEA,SAASoF,EAAwBvG,GAC/B,MAAMsG,EAAc1O,SAAS0C,cAAc,OAC3CgM,EAAY/L,UAAY,oBACxB+L,EAAYE,QAAQC,eAAiBzG,EAGrC,MAAM0G,EAAS9O,SAAS0C,cAAc,OACtCoM,EAAOnM,UAAY,kBACnBmM,EAAOnK,UAAY,gDACwByD,qLAQ3C,MAAM2G,EAAU/O,SAAS0C,cAAc,OAuIvC,OAtIAqM,EAAQpM,UAAY,mBACpBoM,EAAQlM,MAAM8C,QAAU,OACxBoJ,EAAQpK,UAAY,uFAGWyD,wVAUKA,0KAKEA,iIAKHA,sJAKUA,iGAKTA,kIAKVA,kVAWHA,4TAUQA,urBAiBQA,mJAKFA,wDAKrC0G,EAAOE,QAAU,SAAS5P,GAExB,GAAIA,EAAE6P,OAAOC,UAAUC,SAAS,yBAC9B,OAGF,MAAMC,EAAmC,UAA1BL,EAAQlM,MAAM8C,QACvB0J,EAAQP,EAAOQ,cAAc,UAE/BF,GACFL,EAAQlM,MAAM8C,QAAU,OACxB0J,EAAMxM,MAAMI,UAAY,iBAExB8L,EAAQlM,MAAM8C,QAAU,QACxB0J,EAAMxM,MAAMI,UAAY,iBAE5B,EAGAQ,WAAW,KACT,MAAM8L,EAAcvP,SAAS8D,eAAe,UAAUsE,KAChDoH,EAAgBxP,SAAS8D,eAAe,YAAYsE,KAEtDmH,GACFA,EAAYE,iBAAiB,QAASlG,GAEpCiG,GACFA,EAAcC,iBAAiB,QAASlG,IAEzC,KAGiBuF,EAAOQ,cAAc,0BAC7BN,QAAU,SAAS5P,GAC7BA,EAAEsQ,kBAeN,SAA0BhB,GACxB,IAKE,GAJkB1O,SAAS8D,eAAe,sBACd6L,iBAAiB,sBAG/BpP,QAAU,EAEtB,YADA+B,EAAe,kCAAmC,QAKpDoM,EAAYkB,SAYI5P,SAAS8D,eAAe,sBACd6L,iBAAiB,sBAEnC/K,QAAQ,CAAC8J,EAAavG,KAC9B,MAAM0H,EAAc1H,EAAQ,EACbuG,EAAYY,cAAc,oBAClC1M,YAAc,YAAYiN,IACjCnB,EAAYE,QAAQC,eAAiBgB,IAjBrCvN,EAAe,mCAAoC,WAGnDmB,WAAW,IAAM8F,IAAqC,IACxD,CAAE,MAAOhI,GACPe,EAAe,6BAA8B,QAC/C,CACF,CAnCIwN,CAAiBpB,EACnB,EAEAA,EAAYlL,YAAYsL,GACxBJ,EAAYlL,YAAYuL,GAGxBtL,WAAW,MAvZb,SAA+B2E,GAE7B,MAAMY,EAAahJ,SAAS8D,eAAe,QAAQsE,KACnD,GAAIY,GAAcvH,EAAWK,QAAQvB,OAAS,EAAG,CAC/C,MAAMwP,EAAc/G,EAAWhF,MAC/BgF,EAAWrE,UAAY,0CACvBlD,EAAWK,QAAQ8C,QAAQoL,IACzB,MAAMnL,EAAS7E,SAAS0C,cAAc,UACtCmC,EAAOb,MAAQgM,EAAOC,KACtBpL,EAAOjC,YAAcoN,EAAOlL,KAC5BkE,EAAWxF,YAAYqB,KAErBkL,IAAa/G,EAAWhF,MAAQ+L,GACpChL,QAAQC,IAAI,WAAWoD,iBAAsB3G,EAAWK,QAAQvB,kBAClE,MAAWyI,IAETA,EAAWrE,UAAY,+IAKvBI,QAAQC,IAAI,WAAWoD,uCAIzB,MAAMU,EAAgB9I,SAAS8D,eAAe,WAAWsE,KACzD,GAAIU,GAAiBrH,EAAWM,cAAcxB,OAAS,EAAG,CACxD,MAAMwP,EAAcjH,EAAc9E,MAClC8E,EAAcnE,UAAY,0CAC1BlD,EAAWM,cAAc6C,QAAQpC,IAC/B,MAAMqC,EAAS7E,SAAS0C,cAAc,UACtCmC,EAAOb,MAAQxB,EAAKyN,KACpBpL,EAAOjC,YAAcJ,EAAKsC,KAC1BgE,EAActF,YAAYqB,KAExBkL,IAAajH,EAAc9E,MAAQ+L,GACvChL,QAAQC,IAAI,eAAeoD,iBAAsB3G,EAAWM,cAAcxB,kBAC5E,MAAWuI,IAETA,EAAcnE,UAAY,8UAQ1BI,QAAQC,IAAI,eAAeoD,uCAI7B,MAAMc,EAAqBlJ,SAAS8D,eAAe,gBAAgBsE,KACnE,GAAIc,GAAsBzH,EAAWO,UAAUzB,OAAS,EAAG,CACzD,MAAMwP,EAAc7G,EAAmBlF,MACvCkF,EAAmBvE,UAAY,0CAC/BlD,EAAWO,UAAU4C,QAAQsL,IAC3B,MAAMrL,EAAS7E,SAAS0C,cAAc,UACtCmC,EAAOb,MAAQkM,EAAKpL,KACpBD,EAAOjC,YAAcsN,EAAKpL,KAC1BoE,EAAmB1F,YAAYqB,KAE7BkL,IAAa7G,EAAmBlF,MAAQ+L,GAC5ChL,QAAQC,IAAI,mBAAmBoD,iBAAsB3G,EAAWO,UAAUzB,kBAC5E,MAAW2I,IAETA,EAAmBvE,UAAY,krBAgB/BI,QAAQC,IAAI,mBAAmBoD,sCAEnC,CAqUI+H,CAAsB/H,IACrB,IAEIsG,CACT,CA0pBA,SAASnB,EAAsBpF,EAAOkF,EAAW,CAAC,EAAG+C,GAAiB,GACpE,MAAM9C,EAActN,SAAS0C,cAAc,OAC3C4K,EAAY3K,UAAY,gBAGxB,MAAM0N,EAAsBhD,EAASA,SA9FvC,SAAsCiD,GACpC,IAAKA,GAA8C,iBAApBA,EAC7B,OAAO,KAGT,MACMC,EADsBD,EAAgB9F,OAAOrK,cACPmB,MAAM,OAAOkP,OAAO5P,GAAKA,EAAEL,OAAS,GAEhF,GAA+B,IAA3BgQ,EAAgBhQ,OAClB,OAAO,KAGT,IAAIkQ,EAAoB,KACpBC,EAAmB,EACnBC,EAAkB,EAGtB,MAAMC,EAAgB,CAAC,SAAU,UAAW,WAAY,YAAa,OAAQ,WAAY,OAAQ,QAAS,MAAO,aA0DjH,OAxDApP,EAAaoD,QAAQiM,IACnB,MACMC,EAD2BD,EAAcrG,OAAOrK,cACPmB,MAAM,OAAOkP,OAAO5P,GAAKA,EAAEL,OAAS,GAGnF,IAAIwQ,EAAgB,EAChBC,EAAa,EAEjBT,EAAgB3L,QAAQqM,IAEHH,EAAcI,KAAKC,GAEhCA,IAAiBF,GAEfL,EAAc1G,SAAS+G,GACzBD,GAAc,EAEdA,GAAc,GAET,OAGLG,EAAajH,SAAS+G,IAAmBA,EAAe/G,SAASiH,KAE/DF,EAAe1Q,QAAU,GAAK4Q,EAAa5Q,QAAU,KAEnDqQ,EAAc1G,SAAS+G,IAAmBL,EAAc1G,SAASiH,GACnEH,GAAc,EAEdA,GAAc,IAET,KAOXD,MAMAA,EAAgBL,IAAqBK,EAAgB,GAAKC,GAAc,IAC1EN,EAAmBK,EACnBJ,EAAkBK,EAClBP,EAAoBI,GACXE,IAAkBL,GAAoBM,EAAaL,IAE5DA,EAAkBK,EAClBP,EAAoBI,KAKpBH,GAAoB,GAAKC,GAAmB,EACvCF,EAGF,IACT,CAeMW,CAA6B/D,EAASA,UACtC,KAGEgE,EAAa,iBAAiBlJ,IAC9BmJ,EAAelB,EAAiB,WAAa,GAC7CmB,EAAenB,EAAiB,qCAAuC,GAgF7E,OA9EA9C,EAAYsB,QAAQ4C,cAAgBrJ,EACpCmF,EAAY3I,UAAY,uJAEcwD,EAAQ,sGAC6CA,kFAGrEoJ,4DACwBpJ,aAAiBkF,EAASoE,SAAW,OAAOH,6EAG9DC,uDACapJ,aAAiBkF,EAASV,IAAM,OAAO2E,4EAGrDC,wDACepJ,aAAiBkF,EAAST,KAAO,OAAO0E,sEAG7DC,0DACuBpJ,aAAiBkF,EAASqE,KAAO,OAAOJ,wEAG7DC,8DACyBpJ,aAAiBkF,EAASsE,SAAW,OAAOL,wEAGrEC,6DACwBpJ,2BAC5BkJ,4BACChB,GAAuBhD,EAASA,UAAY,gFAEnDiE,2BACOD,gBACZ7P,EAAasI,IAAI8H,GAAK,0CAA0CA,MAAMA,cAAcC,KAAK,+FAIvEN,uDACepJ,MAAUmJ,KAAgBjE,EAASyE,aAAe,iFAGtEP,2DACwBpJ,aAAiBkF,EAASnI,QAAU,OAAOoM,qBAKxF7N,WAAW,KACc,CACrB,oBAAoB0E,IACpB,eAAeA,IACf,gBAAgBA,IAChB,gBAAgBA,IAChB,oBAAoBA,IACpB,qBAAqBA,IACrB,wBAAwBA,IACxB,mBAAmBA,KAGNvD,QAAQwH,IACrB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMoD,iBAAiB,SAAUlG,GACjC8C,EAAMoD,iBAAiB,QAASlG,MAKpC,MAAMwI,EAAczE,EAAYgC,cAAc,0BAC1CyC,IACFA,EAAY/C,QAAU,SAAS5P,GAC7BA,EAAEsQ,kBAiGV,SAA0BpC,GACxB,IACE,MAAMF,EAAqBpN,SAAS8D,eAAe,sBACnD,IAAKsJ,EAAoB,OAKzB,GAHsBA,EAAmBuC,iBAAiB,kBAGxCpP,QAAU,GACN+M,EAAYgC,cAAc,cAG5C,YADAhN,EAAe,iEAAkE,QAMrFgL,EAAYsC,SAiBhB,WACE,MAAMxC,EAAqBpN,SAAS8D,eAAe,sBACnD,IAAKsJ,EAAoB,OAEHzD,MAAMC,KAAKwD,EAAmBuC,iBAAiB,mBAEvD/K,QAAQ,CAAC0I,EAAanF,KAClC,MAAM6J,EAAa7J,EAGnBmF,EAAYsB,QAAQ4C,cAAgBQ,EAGpC,MAAMC,EAAY3E,EAAYgC,cAAc,mBAC5C,GAAI2C,EAAW,CACb,MAAMC,EAASD,EAAU3C,cAAc,MACnC4C,IACFA,EAAOtP,YAAc,YAAYoP,EAAa,IAElD,CAGe,CACb,mBACA,cACA,eACA,eACA,mBACA,oBACA,uBACA,mBAGKpN,QAAQuN,IAEb,MAAMC,EAAa9E,EAAYgC,cAAc,SAAS6C,QACtD,GAAIC,IACFA,EAAWC,GAAK,GAAGF,KAAaH,IAGd,sBAAdG,GAAmC,CACrC,MAAMd,EAAa,iBAAiBW,IACpCI,EAAWE,aAAa,OAAQjB,GAGhC,MAAMkB,EAAWjF,EAAYgC,cAAc,YACvCiD,IACFA,EAASF,GAAKhB,EAElB,IAKJ,MAAMU,EAAczE,EAAYgC,cAAc,0BAC1CyC,GACFA,EAAYO,aAAa,sBAAuBN,IAGtD,CAzEIQ,GAEAlQ,EAAe,mCAAoC,WAGnDmB,WAAW,IAAM8F,IAAqC,IACxD,CAAE,MAAOhI,GACPe,EAAe,6BAA8B,QAC/C,CACF,CA7HQmQ,CAAiBnF,EACnB,IAED,KAEIA,CACT,CAkWA,SAASgB,EAA4BoE,GAAS,GAC5C,MAAMC,EAAQ3S,SAAS8D,eAAe,gBACtC,IAAK6O,EAAO,OAEZ,MAAMC,EAAQD,EAAMrD,cAAc,oBAClC,GAAIsD,EAAO,CACT,MAAMC,EAAQH,EACV,gCACA,+BACJE,EAAMhQ,YAAciQ,EACpB9N,QAAQC,IAAI,kCAAmC6N,EAAO,UAAWH,EACnE,CACF,CAKA,SAASnJ,IACP,MAAMoJ,EAAQ3S,SAAS8D,eAAe,gBACtC,IAAK6O,EAAO,OAEZ,MAAMG,EA9IR,WACE,MAAMrE,EAAYzO,SAAS8D,eAAe,sBAC1C,IAAK2K,EAAW,OAAO,EAEvB,MAAMsE,EAAYtE,EAAUkB,iBAAiB,sBAC7C,GAAyB,IAArBoD,EAAUxS,OAAc,OAAO,EAGnC,IAAIyS,GAAmB,EACvBD,EAAUnO,QAAS8J,IACjB,MAAMtG,EAASsG,EAAYE,QAAQC,eAC7BE,EAAUL,EAAYY,cAAc,qBAE1C,GAAIP,EAAS,CACX,MAAMkE,EAASlE,EAAQO,cAAc,WAAWlH,MAAWpE,OAAS,GAC9DkP,EAAWnE,EAAQO,cAAc,aAAalH,MAAWpE,OAAS,GAElD,KAAlBiP,EAAOzI,QAAqC,KAApB0I,EAAS1I,SACnCwI,GAAmB,EAEvB,IAIF,MAAMG,EAAcnT,SAAS8D,eAAe,gBAAgBE,OAAS,GAC/DoP,EAAgBpT,SAAS8D,eAAe,kBAAkBE,OAAS,GACnEqP,EAAarT,SAAS8D,eAAe,eAAeE,OAAS,GAC7DoB,EAAWpF,SAAS8D,eAAe,aAAaE,OAAS,GACzDsB,EAAUtF,SAAS8D,eAAe,YAAYE,OAAS,GAEvDsP,EACmB,KAAvBH,EAAY3I,QACa,KAAzB4I,EAAc5I,QACQ,KAAtB6I,EAAW7I,QACS,KAApBpF,EAASoF,QACU,KAAnBlF,EAAQkF,OAGJyB,EAAejM,SAAS8D,eAAe,gBAC7C,IAAIyP,GAAc,EAElB,GAAItH,GAA+C,SAA/BA,EAAapJ,MAAM8C,QAAoB,CACzD,MAAM6N,EAAcxT,SAAS8D,eAAe,gBACtC2P,EAAsBzT,SAAS8D,eAAe,yBAC9C4P,EAAc1T,SAAS8D,eAAe,gBACtCD,EAAU7D,SAAS8D,eAAe,YAClCC,EAAW/D,SAAS8D,eAAe,cAGrC0P,GAAalH,UAAckH,EAAYxP,OAAsC,KAA7BwP,EAAYxP,MAAMwG,SACpE+I,GAAc,IAEZE,GAAqBnH,UAAcmH,EAAoBzP,OAA8C,KAArCyP,EAAoBzP,MAAMwG,SAC5F+I,GAAc,IAEZG,GAAapH,UAAcoH,EAAY1P,OAAsC,KAA7B0P,EAAY1P,MAAMwG,SACpE+I,GAAc,IAEZ1P,GAASyI,UAAczI,EAAQG,OAAkC,KAAzBH,EAAQG,MAAMwG,SACxD+I,GAAc,IAEZxP,GAAUuI,UAAcvI,EAASC,OAAmC,KAA1BD,EAASC,MAAMwG,SAC3D+I,GAAc,EAElB,CAGA,MAAMvG,EAAmBhN,SAAS8D,eAAe,oBAC3CsJ,EAAqBpN,SAAS8D,eAAe,sBACnD,IAAI6P,GAAmB,EAEvB,GAAI3G,GAAuD,SAAnCA,EAAiBnK,MAAM8C,SAAsByH,EAAoB,CACvF,MAAMwG,EAAgBxG,EAAmBuC,iBAAiB,kBAEtDiE,EAAcrT,OAAS,GACzBqT,EAAchP,QAAQ,CAACqB,EAAMkC,KAC3B,MAAMsJ,EAAUzR,SAAS8D,eAAe,oBAAoBqE,KACtD0L,EAAa7T,SAAS8D,eAAe,eAAeqE,KACpD2L,EAAc9T,SAAS8D,eAAe,gBAAgBqE,KACtDuJ,EAAM1R,SAAS8D,eAAe,gBAAgBqE,KAC9CwJ,EAAU3R,SAAS8D,eAAe,oBAAoBqE,KACtDkF,EAAWrN,SAAS8D,eAAe,qBAAqBqE,KACxD2J,EAAc9R,SAAS8D,eAAe,wBAAwBqE,KAC9DjD,EAASlF,SAAS8D,eAAe,mBAAmBqE,MAGtDsJ,GAASnF,UAAcmF,EAAQzN,OAAkC,KAAzByN,EAAQzN,MAAMwG,SACxDmJ,GAAmB,IAEjBE,GAAYvH,UAAcuH,EAAW7P,OAAqC,KAA5B6P,EAAW7P,MAAMwG,SACjEmJ,GAAmB,IAEjBG,GAAaxH,UAAcwH,EAAY9P,OAAsC,KAA7B8P,EAAY9P,MAAMwG,SACpEmJ,GAAmB,IAEjBjC,GAAKpF,UAAcoF,EAAI1N,OAA8B,KAArB0N,EAAI1N,MAAMwG,SAC5CmJ,GAAmB,IAEjBhC,GAASrF,UAAcqF,EAAQ3N,OAAkC,KAAzB2N,EAAQ3N,MAAMwG,SACxDmJ,GAAmB,IAEjBtG,GAAUf,UAAce,EAASrJ,OAAmC,KAA1BqJ,EAASrJ,MAAMwG,SAC3DmJ,GAAmB,IAEjB7B,GAAaxF,UAAcwF,EAAY9N,OAAsC,KAA7B8N,EAAY9N,MAAMwG,SACpEmJ,GAAmB,IAEjBzO,GAAQoH,UAAcpH,EAAOlB,OAAiC,KAAxBkB,EAAOlB,MAAMwG,SACrDmJ,GAAmB,IAI3B,CAEA,OAAOX,GAAoBM,GAAiBC,GAAeI,CAC7D,CA2BmBI,GACX5R,GAA4D,IAAvCD,EAAgBC,mBAG3C4C,QAAQC,IAAI,6DAA8D7C,EAAoB,mBAAoBD,GAGlHoM,EAA4BnM,GAExB2Q,GACFH,EAAMqB,UAAW,EACjBrB,EAAM9P,MAAMoR,QAAU,IACtBtB,EAAM9P,MAAMqR,OAAS,YAErBvB,EAAMqB,UAAW,EACjBrB,EAAM9P,MAAMoR,QAAU,MACtBtB,EAAM9P,MAAMqR,OAAS,cAEzB,CAp2DApO,OAAOqO,QAASC,IACd,IACA,GAAIA,EAAKC,OAASvO,OAAOwO,SAASC,QAAS,CAEvC,MAAMC,EAAcxU,SAAS8D,eAAe,gBACxC0Q,IACFA,EAAY3R,MAAM8C,QAAU,QAI9B,MAAM8O,EAAUzU,SAAS8D,eAAe,YACpC2Q,IACFA,EAAQ5R,MAAM8C,QAAU,QAI1B,MAAMD,EAAY1F,SAAS8D,eAAe,OACtC4B,IACFA,EAAUsJ,QAAU,WAClB,IACExJ,GACF,CAAE,MAAOjE,GACPe,EAAe,2BAA6Bf,EAAMgN,QAAS,QAC7D,CACF,GAIF,MAAM3G,EAAkB5H,SAAS8D,eAAe,aAC5C8D,IAEFA,EAAgB/E,MAAM8C,QAAU,OAEhCiC,EAAgBoH,QAAU,WACxB,IAEqBhP,SAAS8D,eAAe,WAChCjB,MAAM8C,QAAU,OAE3BiC,EAAgB/E,MAAM8C,QAAU,OAEhCH,GAAI,EACN,CAAE,MAAOjE,GACPe,EAAe,8BAAgCf,EAAMgN,QAAS,QAChE,CACF,GAIF,MAAMmG,EAAgB1U,SAAS8D,eAAe,WAC1C4Q,IACFA,EAAc1F,QAAU,WACtB,KAsvBV,WACE,IACE,MAAMP,EAAYzO,SAAS8D,eAAe,sBAC1C,IAAK2K,EAEH,YADAnM,EAAe,4CAA6C,SAI9D,MAAMyQ,EAAYtE,EAAUkB,iBAAiB,sBAC7C,GAAyB,IAArBoD,EAAUxS,OAEZ,YADA+B,EAAe,oEAAqE,QAItF,MAAMqS,EAAiB,GAEvB5B,EAAUnO,QAAQ,CAAC8J,EAAavG,KAC9B,MAAMC,EAASsG,EAAYE,QAAQC,eAG7BE,EAAUL,EAAYY,cAAc,qBAC1C,GAAIP,EAAS,CACX,MAAM7G,EAAQ,CACZ2G,eAAgB1G,EAAQ,EACxBE,aAAc0G,EAAQO,cAAc,iBAAiBlH,MAAWpE,OAAS,GACzEiP,OAAQlE,EAAQO,cAAc,WAAWlH,MAAWpE,OAAS,GAC7DkP,SAAUnE,EAAQO,cAAc,aAAalH,MAAWpE,OAAS,GACjE4Q,IAAK7F,EAAQO,cAAc,QAAQlH,MAAWpE,OAAS,GACvD6Q,gBAAiB9F,EAAQO,cAAc,oBAAoBlH,MAAWpE,OAAS,GAC/E8Q,KAAM/F,EAAQO,cAAc,SAASlH,MAAWpE,OAAS,GACzD+Q,QAAShG,EAAQO,cAAc,YAAYlH,MAAWpE,OAAS,GAC/DgR,KAAMjG,EAAQO,cAAc,SAASlH,MAAWpE,OAAS,GACzDiR,aAAclG,EAAQO,cAAc,iBAAiBlH,MAAWpE,OAAS,GACzEoF,UAAW2F,EAAQO,cAAc,cAAclH,MAAWpE,OAAS,GACnEsF,SAAUyF,EAAQO,cAAc,aAAalH,MAAWpE,OAAS,IAGnE2Q,EAAeO,KAAKhN,EACtB,IAWF5F,EAAe,YAAYqS,EAAepU,6CAA8C,UAC1F,CAAE,MAAOgB,GACP,MAAMA,CACR,CACF,CA1yBY4T,EACF,CAAE,MAAO5T,GACPe,EAAe,2BAA6Bf,EAAMgN,QAAS,QAC7D,CACF,GAIF,MAAM6G,EAAgBpV,SAAS8D,eAAe,mBAC1CsR,IACFA,EAAcpG,QAAU,WACtB,KAysBV,WACE,IACE,MAAMP,EAAYzO,SAAS8D,eAAe,sBAC1C,IAAK2K,EACH,OAGF,MAGM4G,EAAgB1G,EAHJF,EAAUkB,iBAAiB,sBACfpP,OAAS,GAGvCkO,EAAUjL,YAAY6R,GAGtB,MAAMtG,EAAUsG,EAAc/F,cAAc,qBACtCD,EAAQgG,EAAc/F,cAAc,UACtCP,GAAWM,IACbN,EAAQlM,MAAM8C,QAAU,QACxB0J,EAAMxM,MAAMI,UAAY,kBAItBoS,EAAcC,gBAChBD,EAAcC,eAAe,CAAEC,SAAU,SAAUC,MAAO,YAI5D/R,WAAW,IAAM8F,IAAqC,IACxD,CAAE,MAAOhI,GACP,MAAMA,CACR,CACF,CAvuBYkU,EACF,CAAE,MAAOlU,GACPe,EAAe,8BAAgCf,EAAMgN,QAAS,QAChE,CACF,GAIF,MAAMrC,EAAqBlM,SAAS8D,eAAe,gBAC/CoI,IACFA,EAAmB8C,QAAU,WAC3B,KA48CV,WACE,MAAM/C,EAAejM,SAAS8D,eAAe,gBACvCoI,EAAqBlM,SAAS8D,eAAe,gBAE/CmI,IACFA,EAAapJ,MAAM8C,QAAU,SAG3BuG,IACFA,EAAmBrJ,MAAM8C,QAAU,QAIjB,CAAC,eAAgB,wBAAyB,eAAgB,WAAY,aAC9Ef,QAAQwH,IAClB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMC,UAAW,KAKrB7I,WAAW,IAAM8F,IAAqC,IACxD,CAl+CYmM,EACF,CAAE,MAAOnU,GACPe,EAAe,2BAA6Bf,EAAMgN,QAAS,QAC7D,CACF,GAIF,MAAMoH,EAAwB3V,SAAS8D,eAAe,mBAClD6R,IACFA,EAAsB3G,QAAU,WAC9B,KAi6CV,WACE,MAAM5B,EAAqBpN,SAAS8D,eAAe,sBAC7CkJ,EAAmBhN,SAAS8D,eAAe,oBAEjD,IAAKsJ,EAAoB,OAGrBJ,IACFA,EAAiBnK,MAAM8C,QAAU,SAInC,MAIMiQ,EAAgBrI,EAJAH,EAAmBuC,iBAAiB,kBACzBpP,OAGuB,CAAC,GAAG,GAC5D6M,EAAmB5J,YAAYoS,GAG3BA,EAAcN,gBAChBM,EAAcN,eAAe,CAAEC,SAAU,SAAUC,MAAO,YAI5D/R,WAAW,IAAM8F,IAAqC,IACxD,CA17CYsM,EACF,CAAE,MAAOtU,GACPe,EAAe,8BAAgCf,EAAMgN,QAAS,QAChE,CACF,GAIF,MAAMuH,EAAqB9V,SAAS8D,eAAe,gBAC/CgS,IACFA,EAAmB9G,QAAU,YA6sErCzJ,iBACE,IAEE,MAAMkJ,EAAYzO,SAAS8D,eAAe,sBAC1C,IAAK2K,EAEH,YADAnM,EAAe,4CAA6C,SAI9D,MAAMyQ,EAAYtE,EAAUkB,iBAAiB,sBAC7C,GAAyB,IAArBoD,EAAUxS,OAEZ,YADA+B,EAAe,6EAA8E,QAK/F,MAAMqS,EAAiB,GACvB5B,EAAUnO,QAAQ,CAAC8J,EAAavG,KAC9B,MAAMC,EAASsG,EAAYE,QAAQC,eAC7BE,EAAUL,EAAYY,cAAc,qBAE1C,GAAIP,EAAS,CACX,MAAM7G,EAAQ,CACZ2G,eAAgB1G,EAAQ,EACxBE,aAAc0G,EAAQO,cAAc,iBAAiBlH,MAAWpE,OAAS,GACzEiP,OAAQlE,EAAQO,cAAc,WAAWlH,MAAWpE,OAAS,GAC7DkP,SAAUnE,EAAQO,cAAc,aAAalH,MAAWpE,OAAS,GACjE4Q,IAAK7F,EAAQO,cAAc,QAAQlH,MAAWpE,OAAS,GACvD6Q,gBAAiB9F,EAAQO,cAAc,oBAAoBlH,MAAWpE,OAAS,GAC/E8Q,KAAM/F,EAAQO,cAAc,SAASlH,MAAWpE,OAAS,GACzD+Q,QAAShG,EAAQO,cAAc,YAAYlH,MAAWpE,OAAS,GAC/DgR,KAAMjG,EAAQO,cAAc,SAASlH,MAAWpE,OAAS,GACzDiR,aAAclG,EAAQO,cAAc,iBAAiBlH,MAAWpE,OAAS,GACzEoF,UAAW2F,EAAQO,cAAc,cAAclH,MAAWpE,OAAS,GACnEsF,SAAUyF,EAAQO,cAAc,aAAalH,MAAWpE,OAAS,IAGnE2Q,EAAeO,KAAKhN,EACtB,IAIF,MAAM6N,EAAe,CACnB5C,YAAanT,SAAS8D,eAAe,gBAAgBE,OAAS,GAC9DoP,cAAepT,SAAS8D,eAAe,kBAAkBE,OAAS,GAClEqP,WAAYrT,SAAS8D,eAAe,eAAeE,OAAS,GAC5DoB,SAAUpF,SAAS8D,eAAe,aAAaE,OAAS,GACxDsB,QAAStF,SAAS8D,eAAe,YAAYE,OAAS,GACtD+G,OAAQ/K,SAAS8D,eAAe,WAAWE,OAAS,GACpDgH,gBAAiBhL,SAAS8D,eAAe,iBAAiBE,OAAS,GACnEiH,YAAajL,SAAS8D,eAAe,iBAAiBE,OAAS,GAC/DkH,QAASlL,SAAS8D,eAAe,qBAAqBE,OAAS,GAC/DmH,QAASnL,SAAS8D,eAAe,aAAaE,OAAS,GACvDoH,aAAcpL,SAAS8D,eAAe,iBAAiBE,OAAS,GAChEqH,aAAcrL,SAAS8D,eAAe,iBAAiBE,OAAS,GAChEsH,SAAUtL,SAAS8D,eAAe,WAAWE,OAAS,GACtDuH,aAAcyK,WAAWhW,SAAS8D,eAAe,eAAeE,QAAU,EAC1EwH,WAAYwK,WAAWhW,SAAS8D,eAAe,aAAaE,QAAU,EACtEyH,UAAWuK,WAAWhW,SAAS8D,eAAe,cAAcE,QAAU,EACtE0H,YAAasK,WAAWhW,SAAS8D,eAAe,eAAeE,QAAU,EACzE2H,SAAU3L,SAAS8D,eAAe,gBAAgBE,OAAS,GAC3D4H,YAAa5L,SAAS8D,eAAe,mBAAmBE,OAAS,GACjE6H,OAAQoK,SAASjW,SAAS8D,eAAe,YAAYE,QAAU,EAC/D8H,SAAUmK,SAASjW,SAAS8D,eAAe,UAAUE,QAAU,EAC/D+H,QAASkK,SAASjW,SAAS8D,eAAe,aAAaE,QAAU,EACjEgI,SAAUhM,SAAS8D,eAAe,cAAcE,OAAS,GACzD5B,gBAAiBpC,SAAS8D,eAAe,kBAAkBE,OAAS9B,EAAgBE,iBAAmB,GACvG+J,MAAO,MACL,MAAM+J,EAAclW,SAAS8D,eAAe,iBAAiBE,OAAS,GAChEmS,EAAiBnW,SAAS8D,eAAe,0BAA0BE,OAAS,GAC5EoS,EAASpW,SAAS8D,eAAe,iBAAiBE,OAAS,GAC3DqS,EAAYrW,SAAS8D,eAAe,oBAAoBE,OAAS,KACjEH,EAAU7D,SAAS8D,eAAe,aAAaE,OAAS,GACxDD,EAAW/D,SAAS8D,eAAe,cAAcE,OAAS,GAGhE,OAAKkS,GAAgBC,GAAmBC,GAAWvS,GAAYE,EAIxD,CACLwI,aAAc2J,EACd1J,gBAAiB2J,EACjB1J,OAAQ2J,EACR1J,UAAW2J,GAAa,KACxB1J,GAAI9I,EACJ+I,IAAK7I,GATE,IAWV,EArBM,GAsBP8I,QAAS7M,SAAS8D,eAAe,YAAYE,OAAS,GACtD8I,SAAU9M,SAAS8D,eAAe,aAAaE,OAAS,GACxD+I,YAAa/M,SAAS8D,eAAe,gBAAgBE,OAAS,IAI1DiC,EAAOH,OAAOC,QAAQC,QAAQC,KACpC8P,EAAazO,eAAiBrB,EAAKqB,gBAAkB,KAGrD,MAAM6F,EAAY,GACZC,EAAqBpN,SAAS8D,eAAe,sBAC/CsJ,GACoBA,EAAmBuC,iBAAiB,kBAC5C/K,QAAQ,CAACqB,EAAMkC,KAC3BgF,EAAU+H,KAAK,CACbzD,QAASzR,SAAS8D,eAAe,oBAAoBqE,MAAUnE,OAAS,GACxE2I,GAAI3M,SAAS8D,eAAe,eAAeqE,MAAUnE,OAAS,GAC9D4I,IAAK5M,SAAS8D,eAAe,gBAAgBqE,MAAUnE,OAAS,GAChE0N,IAAKuE,SAASjW,SAAS8D,eAAe,gBAAgBqE,MAAUnE,QAAU,EAC1E2N,QAASsE,SAASjW,SAAS8D,eAAe,oBAAoBqE,MAAUnE,QAAU,EAClFqJ,SAAUrN,SAAS8D,eAAe,qBAAqBqE,MAAUnE,OAAS,GAC1E8N,YAAa9R,SAAS8D,eAAe,wBAAwBqE,MAAUnE,OAAS,GAChFkB,OAAQlF,SAAS8D,eAAe,mBAAmBqE,MAAUnE,OAAS,OAI5E+R,EAAa9I,SAAWE,EAGxB,MAAMQ,EAAS,GACTC,EAAkB5N,SAAS8D,eAAe,mBAC5C8J,GACiBA,EAAgB+B,iBAAiB,eACzC/K,QAAQ,CAACqB,EAAMkC,KACxBwF,EAAOuH,KAAK,CACVnH,QAAS/N,SAAS8D,eAAe,iBAAiBqE,MAAUnE,OAAS,GACrEgK,aAAchO,SAAS8D,eAAe,sBAAsBqE,MAAUnE,OAAS,GAC/EiK,OAAQjO,SAAS8D,eAAe,gBAAgBqE,MAAUnE,OAAS,GACnEkK,YAAalO,SAAS8D,eAAe,qBAAqBqE,MAAUnE,OAAS,GAC7EmK,KAAMnO,SAAS8D,eAAe,cAAcqE,MAAUnE,OAAS,GAC/DoK,KAAMpO,SAAS8D,eAAe,cAAcqE,MAAUnE,OAAS,OAIrE+R,EAAatI,QAAUE,EAGvB,IAAI2I,EAAkB,GAGtB3B,EAAe/P,QAAQ,CAAC2R,EAAUpO,KAC3BoO,EAAStD,QAAqC,KAA3BsD,EAAStD,OAAOzI,QACtC8L,EAAgBpB,KAAK,YAAY/M,EAAQ,aAEtCoO,EAASrD,UAAyC,KAA7BqD,EAASrD,SAAS1I,QAC1C8L,EAAgBpB,KAAK,YAAY/M,EAAQ,iBAKxC4N,EAAa5C,aAAmD,KAApC4C,EAAa5C,YAAY3I,QACxD8L,EAAgBpB,KAAK,mBAElBa,EAAa3C,eAAuD,KAAtC2C,EAAa3C,cAAc5I,QAC5D8L,EAAgBpB,KAAK,UAElBa,EAAa1C,YAAiD,KAAnC0C,EAAa1C,WAAW7I,QACtD8L,EAAgBpB,KAAK,kBAElBa,EAAa3Q,UAA6C,KAAjC2Q,EAAa3Q,SAASoF,QAClD8L,EAAgBpB,KAAK,YAElBa,EAAazQ,SAA2C,KAAhCyQ,EAAazQ,QAAQkF,QAChD8L,EAAgBpB,KAAK,WAIvB,MAAMjJ,EAAejM,SAAS8D,eAAe,gBAC7C,GAAImI,GAA+C,SAA/BA,EAAapJ,MAAM8C,QAAoB,CACzD,MAAM6N,EAAcxT,SAAS8D,eAAe,gBACtC2P,EAAsBzT,SAAS8D,eAAe,yBAC9C4P,EAAc1T,SAAS8D,eAAe,gBACtCD,EAAU7D,SAAS8D,eAAe,YAClCC,EAAW/D,SAAS8D,eAAe,aAoBzC,IAjBI0P,GAAalH,UAAcyJ,EAAa5J,OAAOI,cAA2D,KAA3CwJ,EAAa5J,MAAMI,aAAa/B,QACjG8L,EAAgBpB,KAAK,kBAEnBzB,GAAqBnH,UAAcyJ,EAAa5J,OAAOK,iBAAiE,KAA9CuJ,EAAa5J,MAAMK,gBAAgBhC,QAC/G8L,EAAgBpB,KAAK,8BAEnBxB,GAAapH,UAAcyJ,EAAa5J,OAAOM,QAA+C,KAArCsJ,EAAa5J,MAAMM,OAAOjC,QACrF8L,EAAgBpB,KAAK,kBAEnBrR,GAASyI,UAAcyJ,EAAa5J,OAAOQ,IAAuC,KAAjCoJ,EAAa5J,MAAMQ,GAAGnC,QACzE8L,EAAgBpB,KAAK,yBAEnBnR,GAAUuI,UAAcyJ,EAAa5J,OAAOS,KAAyC,KAAlCmJ,EAAa5J,MAAMS,IAAIpC,QAC5E8L,EAAgBpB,KAAK,uBAInBa,EAAa5J,OAAOQ,IAAMoJ,EAAa5J,OAAOS,IAAK,CACrD,MAAM1I,EAAU,IAAIC,KAAK4R,EAAa5J,MAAMQ,IACtCvI,EAAW,IAAID,KAAK4R,EAAa5J,MAAMS,KAG7C,GAAIxI,GAAYF,EAEd,YADA5B,EAAe,oHAAqH,SAOtI,GAFuBiC,KAAKC,OAAOJ,EAAWF,GAAW,OAEpC,EAEnB,YADA5B,EAAe,+HAAgI,QAGnJ,CACF,CAGA,MAAM0K,EAAmBhN,SAAS8D,eAAe,oBACjD,GAAIkJ,GAAuD,SAAnCA,EAAiBnK,MAAM8C,QAC7C,GAAKoQ,EAAa9I,UAA6C,IAAjC8I,EAAa9I,SAAS1M,OAalDwV,EAAa9I,SAASrI,QAAQ,CAACyI,EAAUlF,KACvC,MAAMsJ,EAAUzR,SAAS8D,eAAe,oBAAoBqE,KACtD0L,EAAa7T,SAAS8D,eAAe,eAAeqE,KACpD2L,EAAc9T,SAAS8D,eAAe,gBAAgBqE,KACtDuJ,EAAM1R,SAAS8D,eAAe,gBAAgBqE,KAC9CwJ,EAAU3R,SAAS8D,eAAe,oBAAoBqE,KACtDqO,EAAgBxW,SAAS8D,eAAe,qBAAqBqE,KAC7D2J,EAAc9R,SAAS8D,eAAe,wBAAwBqE,KAC9DjD,EAASlF,SAAS8D,eAAe,mBAAmBqE,MAGtDsJ,GAASnF,UAAce,EAASoE,SAAuC,KAA5BpE,EAASoE,QAAQjH,QAC9D8L,EAAgBpB,KAAK,YAAY/M,EAAQ,eAEvC0L,GAAYvH,UAAce,EAASV,IAA6B,KAAvBU,EAASV,GAAGnC,QACvD8L,EAAgBpB,KAAK,YAAY/M,EAAQ,qBAEvC2L,GAAaxH,UAAce,EAAST,KAA+B,KAAxBS,EAAST,IAAIpC,QAC1D8L,EAAgBpB,KAAK,YAAY/M,EAAQ,oBAEvCuJ,GAAKpF,UAAce,EAASqE,KAAwB,IAAjBrE,EAASqE,KAC9C4E,EAAgBpB,KAAK,YAAY/M,EAAQ,cAEvCwJ,GAASrF,UAAce,EAASsE,SAAgC,IAArBtE,EAASsE,SACtD2E,EAAgBpB,KAAK,YAAY/M,EAAQ,gBAEvCqO,GAAelK,UAAce,EAASA,UAAyC,KAA7BA,EAASA,SAAS7C,QACtE8L,EAAgBpB,KAAK,YAAY/M,EAAQ,gBAEvC2J,GAAaxF,UAAce,EAASyE,aAA+C,KAAhCzE,EAASyE,YAAYtH,QAC1E8L,EAAgBpB,KAAK,YAAY/M,EAAQ,mBAEvCjD,GAAQoH,UAAce,EAASnI,QAAqC,KAA3BmI,EAASnI,OAAOsF,QAC3D8L,EAAgBpB,KAAK,YAAY/M,EAAQ,mBA9CmB,CAEhE,MAAMiF,EAAqBpN,SAAS8D,eAAe,sBACnD,GAAIsJ,EAAoB,CACtB,MAAMqJ,EAAiBrJ,EAAmBkC,cAAc,kBACpDmH,GACoBA,EAAenH,cAAc,eAEjDgH,EAAgBpB,KAAK,6CAG3B,CACF,CAyCF,GAAIoB,EAAgB/V,OAAS,EAK3B,YAJA+B,EACE,0DAA0DgU,EAAgBzE,KAAK,QAC/E,SAMJ,MAAM1P,GAA4D,IAAvCD,EAAgBC,mBAM3C,GAHA4C,QAAQC,IAAI,gDAAiD7C,EAAoB,mBAAoBD,GAGjGC,GAAsBD,EAAgBG,WAAY,CAEpD,MAAM8K,EAAY4I,EAAa9I,UAAY,GACrCd,EAAQ4J,EAAa5J,OAAS,KAG9BuK,EAjdZ,SAAuBrU,EAAYsU,EAAiBC,EAAiBC,GACnE,MAAMH,EAAU,CACd3D,WAAW,EACX5F,WAAW,EACXhB,OAAO,EACP2K,cAAc,GAGhB,IAAKzU,EACH,OAAOqU,EAIT,MAAMK,EAAsB1U,EAAWwF,YAAc,GACrD,GAAIkP,EAAoBxW,SAAWoW,EAAgBpW,OACjDmW,EAAQ3D,WAAY,EACpB2D,EAAQI,cAAe,OAGvB,IAAK,IAAItW,EAAI,EAAGA,EAAImW,EAAgBpW,OAAQC,IAAK,CAC/C,MAAMwW,EAAQL,EAAgBnW,GACxByW,EAAWF,EAAoBvW,GAErC,IAAKyW,GACDD,EAAM/D,UAAYgE,EAASzO,WAAa,KACxCwO,EAAM9D,YAAc+D,EAASxO,UAAY,KACzCuO,EAAMpC,OAASqC,EAASvO,gBAAkB,KAC1CsO,EAAMnC,mBAAqBoC,EAAStO,aAAe,IAAK,CAC1D+N,EAAQ3D,WAAY,EACpB2D,EAAQI,cAAe,EACvB,KACF,CACF,CAIF,MAAMI,EAAsB7U,EAAW4K,UAAY,GACnD,GAAIiK,EAAoB3W,SAAWqW,EAAgBrW,OACjDmW,EAAQvJ,WAAY,EACpBuJ,EAAQI,cAAe,OAGvB,IAAK,IAAItW,EAAI,EAAGA,EAAIoW,EAAgBrW,OAAQC,IAAK,CAC/C,MAAMwW,EAAQJ,EAAgBpW,GACxByW,EAAWC,EAAoB1W,GAErC,IAAKyW,GACDD,EAAMvF,WAAawF,EAASxF,SAAW,KACvCuF,EAAMrK,MAAQsK,EAAStK,IAAM,KAC7BqK,EAAMpK,OAASqK,EAASrK,KAAO,KAC/BoK,EAAM3J,YAAc4J,EAAS5J,UAAY,IAAK,CAChDqJ,EAAQvJ,WAAY,EACpBuJ,EAAQI,cAAe,EACvB,KACF,CACF,CAIF,MAAMK,EAAgB9U,EAAW8J,OAAS,KAe1C,OAduB,OAAlBgL,GAAyC,OAAfN,GACR,OAAlBM,GAAyC,OAAfN,GAC7BH,EAAQvK,OAAQ,EAChBuK,EAAQI,cAAe,GACdK,GAAiBN,IACtBM,EAAc5K,eAAiBsK,EAAWtK,cAC1C4K,EAAc1K,SAAWoK,EAAWpK,QACpC0K,EAAcxK,KAAOkK,EAAWlK,IAChCwK,EAAcvK,MAAQiK,EAAWjK,MACnC8J,EAAQvK,OAAQ,EAChBuK,EAAQI,cAAe,IAIpBJ,CACT,CAsYsBU,CAAclV,EAAgBG,WAAYsS,EAAgBxH,EAAWhB,GAGrF,GAAIuK,EAAQI,aAAc,CACxB,MAAMO,QAnYd,SAAkCX,GAChC,OAAO,IAAIY,QAASC,IAElB,MAAMC,EAAUxX,SAAS0C,cAAc,OACvC8U,EAAQ3U,MAAM4U,QAAU,yPAcxB,MAAMC,EAAQ1X,SAAS0C,cAAc,OACrCgV,EAAM7U,MAAM4U,QAAU,iLAUtB,MAAME,EAAe,GACjBjB,EAAQ3D,WAAW4E,EAAazC,KAAK,aACrCwB,EAAQvJ,WAAWwK,EAAazC,KAAK,aACrCwB,EAAQvK,OAAOwL,EAAazC,KAAK,SAErCwC,EAAM/S,UAAY,+UAMZgT,EAAa7N,IAAI7D,GAAQ,mCAAmCA,UAAa4L,KAAK,gwBA0BpF2F,EAAQhU,YAAYkU,GACpB1X,SAASuD,KAAKC,YAAYgU,GAG1BxX,SAAS8D,eAAe,iBAAiBkL,QAAU,KACjDhP,SAASuD,KAAKI,YAAY6T,GAC1BD,GAAQ,IAGVvX,SAAS8D,eAAe,kBAAkBkL,QAAU,KAClDhP,SAASuD,KAAKI,YAAY6T,GAC1BD,GAAQ,IAIVC,EAAQxI,QAAW5P,IACbA,EAAE6P,SAAWuI,IACfxX,SAASuD,KAAKI,YAAY6T,GAC1BD,GAAQ,MAIhB,CA2SgCK,CAAyBlB,GACjD,IAAKW,EAEH,MAEJ,CACF,CAMA/U,EAH6BH,EACzB,oDACA,mDACiC,QAzvBzC,WAEE,MAAMsM,EAAYzO,SAAS8D,eAAe,sBACtC2K,IACaA,EAAUkB,iBAAiB,iBACnC/K,QAAQiT,IACbA,EAAM7D,UAAW,EACjB6D,EAAMhV,MAAMiV,gBAAkB,UAC9BD,EAAMhV,MAAMqR,OAAS,gBAICzF,EAAUkB,iBAAiB,0BACnC/K,QAAQmT,IACtBA,EAAI/D,UAAW,EACf+D,EAAIlV,MAAMoR,QAAU,MACpB8D,EAAIlV,MAAMqR,OAAS,cACnB6D,EAAIlV,MAAMmV,cAAgB,UAKR,CAAC,cAAe,gBAAiB,aAAc,WAAY,WACnEpT,QAAQwH,IACpB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAM2H,UAAW,EACjB3H,EAAMxJ,MAAMiV,gBAAkB,UAC9BzL,EAAMxJ,MAAMqR,OAAS,iBAKzB,MAAM+D,EAAajY,SAAS8D,eAAe,mBACvCmU,IACFA,EAAWjE,UAAW,EACtBiE,EAAWpV,MAAMoR,QAAU,MAC3BgE,EAAWpV,MAAMqR,OAAS,eAI5B,MAAMgE,EAAalY,SAAS8D,eAAe,WACvCoU,IACFA,EAAWlE,UAAW,EACtBkE,EAAWrV,MAAMoR,QAAU,MAC3BiE,EAAWrV,MAAMqR,OAAS,cAE9B,CA6sBIiE,GAGA,MAAMC,EAAoBpY,SAAS8D,eAAe,gBAC9CsU,IACFA,EAAkBpE,UAAW,EAC7BoE,EAAkBvV,MAAMoR,QAAU,MAClCmE,EAAkB9I,cAAc,oBAAoB1M,YAAc,mBAIpE,MAAMP,EAAaF,EAAqBD,EAAgBG,WAAa,KAC/DgW,QFjkFH9S,eAAsCwN,EAAWgD,EAAe,CAAC,EAAGrD,GAAS,EAAOrQ,EAAa,MACtG,IAEE,MAAMiW,EAtFV,SAAiCvF,EAAWgD,EAAe,CAAC,EAAGrD,GAAS,EAAOrQ,EAAa,MAC1F,MAAMiW,EAAW,CACfzQ,WAAYkL,EAAUjJ,IAAIlJ,IAAK,CAC7B6H,SAAU7H,EAAEsS,UAAY,GACxB1K,UAAW5H,EAAEqS,QAAU,GACvB1K,QAA4B,WAAnB3H,EAAEyH,aAA4B,MAA2B,UAAnBzH,EAAEyH,aAA2B,MAAQ,MACpFO,UAAW3H,EAAeL,EAAEiU,iBAC5B1L,YAAavI,EAAEqU,cAAc9U,eAAiB,YAC9C8I,IAAgB,cAAXrI,EAAEoU,KAAuB,IAAiB,aAAXpU,EAAEoU,KAAsB,IAAM,IAClEtM,eAAgB9H,EAAEgU,KAAO,GACzB7L,aAAcnI,EAAEmU,SAAS5U,eAAiB,MAC1C0I,SAAUjI,EAAEkU,MAAQ,GACpBzL,YAAazI,EAAE0I,UAAY,GAC3BF,UAAWxI,EAAEwI,WAAa,MAE5B9B,eAAgByO,EAAazO,gBAAkB,KAC/CoC,gBAAiBqM,EAAa5C,aAAe,kBAC7C7M,OAAQyP,EAAa3C,eAAiB,iCACtCtI,OAAQiL,EAAazQ,SAAW,sBAChCoF,WAAYzJ,EAAe8U,EAAa1C,aAAe,aACvDzI,OAAQmL,EAAa3Q,UAAY,YACjC2F,OAAQgL,EAAahL,QAAU,GAC/BC,gBAAiB/J,EAAe8U,EAAa/K,kBAAoB,GACjEC,YAAahK,EAAe8U,EAAa9K,cAAgB,GACzDC,QAASjK,EAAe8U,EAAa7K,UAAY,GACjDC,QAAS4K,EAAa5K,SAAW,GACjCC,aAAc2K,EAAa3K,cAAgB,GAC3CC,aAAc0K,EAAa1K,cAAgB,GAC3CC,SAAUyK,EAAazK,UAAY,MACnCC,aAAcwK,EAAaxK,cAAgB,EAC3CC,WAAYuK,EAAavK,YAAc,EACvCC,UAAWsK,EAAatK,WAAa,EACrCC,YAAaqK,EAAarK,aAAe,EACzCC,SAAUoK,EAAapK,UAAY,GACnCC,YAAamK,EAAanK,aAAe,GACzCC,OAAQkK,EAAalK,QAAU,EAC/BC,SAAUiK,EAAajK,UAAY,EACnCC,QAASgK,EAAahK,SAAW,EACjCC,SAAU+J,EAAa/J,UAAY,GACnC5J,gBAAiB2T,EAAa3T,iBAAmB,GACjD+J,MAAO4J,EAAa5J,OAAuC,iBAAvB4J,EAAa5J,MAC7C4J,EAAa5J,MACZ4J,EAAa5J,MAAQ,CAAEI,aAAcwJ,EAAa5J,MAAOK,gBAAiB,GAAIC,OAAQ,GAAIC,UAAW,MAAS,KACnHG,QAAS5L,EAAe8U,EAAalJ,UAAY,GACjDC,SAAU7L,EAAe8U,EAAajJ,WAAa,GACnDC,YAAagJ,EAAahJ,aAAe,GACzCE,SAAU8I,EAAa9I,UAAY,GACnCQ,QAASsI,EAAatI,SAAW,GACjCnG,eAAgByO,EAAazO,gBAAkB,MAQjD,OAJIoL,GAAUrQ,IACZiW,EAASjW,WAAaA,GAGjBiW,CACT,CA6BqBC,CAAwBxF,EAAWgD,EAAcrD,EAAQrQ,GAGpEmW,EAAa9F,EApGnB5L,uGAJAA,yGA2GMF,QAAiBC,MAAM2R,EAAY,CACvCzR,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBzD,KAAM0D,KAAKC,UAAUoR,KAGvB,IAAK1R,EAASW,GACZ,MAAM,IAAI7G,MAAM,uBAAuBkG,EAASN,UAAUM,EAAS6R,cAGrE,MAAMJ,QAAkBzR,EAASa,OAEjC,MAAO,CACLiR,SAA+B,IAAtBL,EAAUK,QACnBhR,KAAM2Q,EAAU3Q,MAAQ2Q,EACxBjW,gBAAiBiW,EAAUjW,iBAAmB,KAC9CmM,QAAS8J,EAAU9J,UAAYmE,EAAS,2CAA6C,2CAGzF,CAAE,MAAOnR,GAEP,GAAIA,EAAMgN,QAAQrE,SAAS,SACzB,MAAM,IAAIxJ,MAAM,yFAGlB,MAAMa,CACR,CACF,CE2hF4BoX,CAAuBhE,EAAgBoB,EAAc5T,EAAoBE,GAG3FD,EAAkBiW,EAAU3Q,MAAMtF,iBAAmBiW,EAAUjW,iBAAmB,KAGxF,IAAIwW,EAAezW,EACf,6CACA,4CAEAC,IACFwW,GAAgB,0BAA0BxW,KAG5CE,EAAesW,EAAc,WA/pBjC,WAEE,MAAMnK,EAAYzO,SAAS8D,eAAe,sBACtC2K,GACgBA,EAAUkB,iBAAiB,sBAEnC/K,QAAS8J,IACjB,MAAMtG,EAASsG,EAAYE,QAAQC,eAC7BE,EAAUL,EAAYY,cAAc,qBAE1C,GAAIP,EAAS,CAEX,MAAM7G,EAAQ,CACZG,aAAc0G,EAAQO,cAAc,iBAAiBlH,MAAWpE,OAAS,GACzEiP,OAAQlE,EAAQO,cAAc,WAAWlH,MAAWpE,OAAS,GAC7DkP,SAAUnE,EAAQO,cAAc,aAAalH,MAAWpE,OAAS,GACjE4Q,IAAK7F,EAAQO,cAAc,QAAQlH,MAAWpE,OAAS,GACvD6Q,gBAAiB9F,EAAQO,cAAc,oBAAoBlH,MAAWpE,OAAS,GAC/E8Q,KAAM/F,EAAQO,cAAc,SAASlH,MAAWpE,OAAS,GACzD+Q,QAAShG,EAAQO,cAAc,YAAYlH,MAAWpE,OAAS,GAC/DgR,KAAMjG,EAAQO,cAAc,SAASlH,MAAWpE,OAAS,GACzDiR,aAAclG,EAAQO,cAAc,iBAAiBlH,MAAWpE,OAAS,GACzEoF,UAAW2F,EAAQO,cAAc,cAAclH,MAAWpE,OAAS,GACnEsF,SAAUyF,EAAQO,cAAc,aAAalH,MAAWpE,OAAS,IAInE+K,EAAQpK,UAAY,yGAGXuD,EAAMG,cAAgB,wHAItBH,EAAM+K,QAAU,0HAIhB/K,EAAMgL,UAAY,qHAIlBhL,EAAM0M,KAAO,qIAIb1M,EAAM2M,iBAAmB,sHAIzB3M,EAAM4M,MAAQ,mIAId5M,EAAM6M,SAAW,sHAIjB7M,EAAM8M,MAAQ,8HAId9M,EAAM+M,cAAgB,2HAItB/M,EAAMkB,WAAa,oIAInBlB,EAAMoB,UAAY,qCAG7B,CAGA,MAAMyI,EAAcrD,EAAYY,cAAc,0BAC1CyC,IACFA,EAAYlP,MAAM8C,QAAU,UAMlC,MAAMkT,EAAsB7Y,SAAS8D,eAAe,uBACpD,GAAI+U,EAAqB,CACvB,MAAM9C,EAAe,CACnB5C,YAAanT,SAAS8D,eAAe,gBAAgBE,OAAS,GAC9DoP,cAAepT,SAAS8D,eAAe,kBAAkBE,OAAS,GAClEqP,WAAYrT,SAAS8D,eAAe,eAAeE,OAAS,GAC5DoB,SAAUpF,SAAS8D,eAAe,aAAaE,OAAS,GACxDsB,QAAStF,SAAS8D,eAAe,YAAYE,OAAS,IA4BxD,GAzBA6U,EAAoBlU,UAAY,gIAIvBoR,EAAa5C,aAAe,wGAI5B4C,EAAa3C,eAAiB,gHAI9B2C,EAAa1C,YAAc,0GAI3B0C,EAAa3Q,UAAY,yGAIzB2Q,EAAazQ,SAAW,+BAK5BtF,SAAS8D,eAAe,oBAAqB,CAChD,MAAMgV,EAAiB9Y,SAAS0C,cAAc,UAC9CoW,EAAezG,GAAK,mBACpByG,EAAenW,UAAY,YAC3BmW,EAAejW,MAAM4U,QAAU,+IAC/BqB,EAAenU,UAAY,4DAC3BmU,EAAe9J,QAAU,YAhM/B,WAEE,MAAMnJ,EAAa7F,SAAS8D,eAAe,WACvC+B,IACFA,EAAWhD,MAAM8C,QAAU,QAI7B,MAAMD,EAAY1F,SAAS8D,eAAe,OACtC4B,IACFA,EAAU7C,MAAM8C,QAAU,SAI5B,MAAMiC,EAAkB5H,SAAS8D,eAAe,aAC5C8D,IACFA,EAAgB/E,MAAM8C,QAAU,QAIlC,MAAMoT,EAAqB/Y,SAAS8D,eAAe,sBAC/CiV,IACFA,EAAmBpU,UAAY,IAIjCzC,EAAkB,CAChBC,oBAAoB,EACpBC,gBAAiB,KACjBC,WAAY,MAIQ,CAAC,cAAe,gBAAiB,aAAc,WAAY,WACnEuC,QAAQwH,IACpB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMrI,MAAQ,MAKlB,MAAMiI,EAAejM,SAAS8D,eAAe,gBACzCmI,IACFA,EAAapJ,MAAM8C,QAAU,QAG/B,MAAMqH,EAAmBhN,SAAS8D,eAAe,oBAC7CkJ,IACFA,EAAiBnK,MAAM8C,QAAU,QAGnC,MAAM+H,EAAgB1N,SAAS8D,eAAe,iBAC1C4J,IACFA,EAAc7K,MAAM8C,QAAU,QAIhC,MAAMmT,EAAiB9Y,SAAS8D,eAAe,oBAC3CgV,GACFA,EAAelJ,QAEnB,CAmIQoJ,EACF,EAGAH,EAAoBrV,YAAYsV,EAClC,CACF,CAGA,MAAMb,EAAajY,SAAS8D,eAAe,mBACvCmU,IACFA,EAAWpV,MAAM8C,QAAU,QAI7B,MAAMuS,EAAalY,SAAS8D,eAAe,WACvCoU,IACFA,EAAWrV,MAAM8C,QAAU,QAI7B,MAAMsT,EAAkBjZ,SAAS8D,eAAe,gBAC5CmV,IACFA,EAAgBpW,MAAM8C,QAAU,OAEpC,CA2gBIuT,EAEF,CAAE,MAAO3X,GAKPe,GAJkE,IAAvCJ,EAAgBC,mBAEvC,4BAA8BZ,EAAMgN,QACpC,2BAA6BhN,EAAMgN,QACV,SASjC,WAEE,MAAME,EAAYzO,SAAS8D,eAAe,sBACtC2K,IACaA,EAAUkB,iBAAiB,iBACnC/K,QAAQiT,IACbA,EAAM7D,UAAW,EACjB6D,EAAMhV,MAAMiV,gBAAkB,UAC9BD,EAAMhV,MAAMqR,OAAS,SAICzF,EAAUkB,iBAAiB,0BACnC/K,QAAQmT,IACtBA,EAAI/D,UAAW,EACf+D,EAAIlV,MAAMoR,QAAU,IACpB8D,EAAIlV,MAAMqR,OAAS,UACnB6D,EAAIlV,MAAMmV,cAAgB,UAKR,CAAC,cAAe,gBAAiB,aAAc,WAAY,WACnEpT,QAAQwH,IACpB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAM2H,UAAW,EACjB3H,EAAMxJ,MAAMiV,gBAAkB,UAC9BzL,EAAMxJ,MAAMqR,OAAS,aAKzB,MAAM+D,EAAajY,SAAS8D,eAAe,mBACvCmU,IACFA,EAAWjE,UAAW,EACtBiE,EAAWpV,MAAMoR,QAAU,IAC3BgE,EAAWpV,MAAMqR,OAAS,WAI5B,MAAMgE,EAAalY,SAAS8D,eAAe,WACvCoU,IACFA,EAAWlE,UAAW,EACtBkE,EAAWrV,MAAMoR,QAAU,IAC3BiE,EAAWrV,MAAMqR,OAAS,WAI5B,MAAMkE,EAAoBpY,SAAS8D,eAAe,gBAClD,GAAIsU,EAAmB,CACrB,MAAMjW,GAA4D,IAAvCD,EAAgBC,mBAC3CiW,EAAkBpE,UAAW,EAC7BoE,EAAkBvV,MAAMoR,QAAU,IAClC3F,EAA4BnM,EAC9B,CACF,CA/DIgX,EACF,CACF,CAziFUC,EACF,EAEAtD,EAAmB9B,UAAW,EAC9B8B,EAAmBjT,MAAMoR,QAAU,MACnC6B,EAAmBjT,MAAMqR,OAAS,eAId,CAAC,cAAe,gBAAiB,aAAc,WAAY,WACnEtP,QAAQwH,IACpB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMoD,iBAAiB,SAAUlG,GACjC8C,EAAMoD,iBAAiB,QAASlG,MAKhB,CAAC,eAAgB,wBAAyB,eAAgB,WAAY,aAC9E3E,QAAQwH,IAClB,MAAMC,EAAQrM,SAAS8D,eAAesI,GAClCC,IACFA,EAAMoD,iBAAiB,SAAU,KAC/B7L,IACA2F,MAEF8C,EAAMoD,iBAAiB,QAAS,KAC9B7L,IACA2F,SA6DZhE,iBACE,IAEE,MAAM8T,EACFvS,8FAGEF,QAAiBC,MAAMwS,GAE7B,IAAKzS,EAASW,GAEZ,YADAxC,QAAQoF,KAAK,2EAIf,MAAM9D,QAAeO,EAASa,OAE1BpB,EAAOqS,SAAWrS,EAAOqB,OAC3BjG,EAAWC,QAAU2E,EAAOqB,KAAKhG,SAAW,GAC5CD,EAAWE,QAAU0E,EAAOqB,KAAK/F,SAAW,GAC5CF,EAAWG,SAAWyE,EAAOqB,KAAK9F,UAAY,GAC9CH,EAAWI,iBAAmBwE,EAAOqB,KAAK7F,kBAAoB,GAC9DJ,EAAWK,QAAUuE,EAAOqB,KAAK5F,SAAW,GAC5CL,EAAWM,cAAgBsE,EAAOqB,KAAK3F,eAAiB,GACxDN,EAAWO,UAAYqE,EAAOqB,KAAK1F,WAAa,GAChDP,EAAWQ,QAAS,EAEpB8C,QAAQC,IAAI,6BAA8B,CACxCsU,WAAY7X,EAAWC,QAAQnB,OAC/BgZ,SAAU9X,EAAWE,QAAQpB,OAC7BiZ,QAAS/X,EAAWG,SAASrB,OAC7BkZ,aAAchY,EAAWI,iBAAiBtB,OAC1CmZ,QAASjY,EAAWK,QAAQvB,OAC5BoZ,SAAUlY,EAAWM,cAAcxB,OACnCqZ,OAAQnY,EAAWO,UAAUzB,SAI/BkE,IAEJ,CAAE,MAAOlD,GACPwD,QAAQxD,MAAM,mCAAoCA,EACpD,CACF,CAjGMsY,EACF,CACF,CAAE,MAAOtY,GACP,G,ICnM6B,IAAIuY,IAAI,a","sources":["webpack://outlook-email-classifier-addin/webpack/bootstrap","webpack://outlook-email-classifier-addin/webpack/runtime/global","webpack://outlook-email-classifier-addin/webpack/runtime/hasOwnProperty shorthand","webpack://outlook-email-classifier-addin/webpack/runtime/publicPath","webpack://outlook-email-classifier-addin/webpack/runtime/jsonp chunk loading","webpack://outlook-email-classifier-addin/./src/taskpane/rpaClient.js","webpack://outlook-email-classifier-addin/./src/taskpane/servicesList.js","webpack://outlook-email-classifier-addin/./src/taskpane/taskpane.js","webpack://outlook-email-classifier-addin/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * Cliente HTTP para comunicarse con el backend RPA\n * Este archivo maneja la comunicación entre el add-in de Outlook y el servidor RPA\n */\n\n// URLs del servidor RPA (se configuran dinámicamente según el entorno)\n// En producción, estas URLs se inyectan durante el build de webpack\nconst RPA_CREATE_URL = typeof RPA_API_URL !== 'undefined' \n  ? RPA_API_URL + '/api/rpa/create-reservation'\n  : 'http://localhost:3001/api/rpa/create-reservation';\n\nconst RPA_EDIT_URL = typeof RPA_API_URL !== 'undefined' \n  ? RPA_API_URL + '/api/rpa/edit-reservation'\n  : 'http://localhost:3001/api/rpa/edit-reservation';\n\n/**\n * Transforma los datos del formulario al formato esperado por el RPA\n * @param {Array} pasajeros - Array de objetos con datos de pasajeros\n * @param {Object} datosReserva - Datos de la reserva del formulario\n * @param {boolean} isEdit - Si es true, incluye originData\n * @param {Object} originData - Data original de la extracción (solo para edición)\n * @returns {Object} Datos formateados para el RPA\n */\nfunction transformarDatosParaRPA(pasajeros, datosReserva = {}, isEdit = false, originData = null) {\n  const datosRPA = {\n    passengers: pasajeros.map(p => ({\n      lastName: p.apellido || '',\n      firstName: p.nombre || '',\n      paxType: p.tipoPasajero === 'adulto' ? 'ADU' : p.tipoPasajero === 'menor' ? 'CHD' : 'INF',\n      birthDate: formatearFecha(p.fechaNacimiento), // Convertir a MM/DD/AAAA\n      nationality: p.nacionalidad?.toUpperCase() || 'ARGENTINA',\n      sex: p.sexo === 'masculino' ? 'M' : p.sexo === 'femenino' ? 'F' : 'O',\n      documentNumber: p.dni || '',\n      documentType: p.tipoDoc?.toUpperCase() || 'DNI',\n      cuilCuit: p.cuil || '',\n      phoneNumber: p.telefono || '',\n      direccion: p.direccion || ''\n    })),\n    conversationId: datosReserva.conversationId || null,\n    reservationType: datosReserva.tipoReserva || 'AGENCIAS [COAG]',\n    status: datosReserva.estadoReserva || 'PENDIENTE DE CONFIRMACION [PC]',\n    client: datosReserva.cliente || 'DESPEGAR - TEST - 1',\n    travelDate: formatearFecha(datosReserva.fechaViaje) || '12/01/2026',\n    seller: datosReserva.vendedor || 'TEST TEST',\n    codigo: datosReserva.codigo || '',\n    reservationDate: formatearFecha(datosReserva.reservationDate) || '',\n    tourEndDate: formatearFecha(datosReserva.tourEndDate) || '',\n    dueDate: formatearFecha(datosReserva.dueDate) || '',\n    contact: datosReserva.contact || '',\n    contactEmail: datosReserva.contactEmail || '',\n    contactPhone: datosReserva.contactPhone || '',\n    currency: datosReserva.currency || 'ARS',\n    exchangeRate: datosReserva.exchangeRate || 0,\n    commission: datosReserva.commission || 0,\n    netAmount: datosReserva.netAmount || 0,\n    grossAmount: datosReserva.grossAmount || 0,\n    tripName: datosReserva.tripName || '',\n    productCode: datosReserva.productCode || '',\n    adults: datosReserva.adults || 0,\n    children: datosReserva.children || 0,\n    infants: datosReserva.infants || 0,\n    provider: datosReserva.provider || '',\n    reservationCode: datosReserva.reservationCode || '',\n    hotel: datosReserva.hotel && typeof datosReserva.hotel === 'object' \n      ? datosReserva.hotel \n      : (datosReserva.hotel ? { nombre_hotel: datosReserva.hotel, tipo_habitacion: '', Ciudad: '', Categoria: null } : null),\n    checkIn: formatearFecha(datosReserva.checkIn) || '',\n    checkOut: formatearFecha(datosReserva.checkOut) || '',\n    estadoDeuda: datosReserva.estadoDeuda || '',\n    services: datosReserva.services || [],\n    flights: datosReserva.flights || [],\n    conversationId: datosReserva.conversationId || null\n  };\n  \n  // Si es edición, incluir la data original\n  if (isEdit && originData) {\n    datosRPA.originData = originData;\n  }\n  \n  return datosRPA;\n}\n\n/**\n * Formatea una fecha de YYYY-MM-DD a MM/DD/YYYY\n * @param {string} fecha - Fecha en formato YYYY-MM-DD\n * @returns {string} Fecha en formato MM/DD/YYYY\n */\nfunction formatearFecha(fecha) {\n  if (!fecha) return '';\n  \n  try {\n    const [year, month, day] = fecha.split('-');\n    return `${month}/${day}/${year}`;\n  } catch (error) {\n    return '';\n  }\n}\n\n/**\n * Envía los datos al servicio RPA para crear o editar la reserva\n * @param {Array} pasajeros - Array de objetos con datos de pasajeros del formulario\n * @param {Object} datosReserva - Datos de la reserva del formulario\n * @param {boolean} isEdit - Si es true, edita la reserva; si es false, crea una nueva\n * @param {Object} originData - Data original de la extracción (solo para edición)\n * @returns {Promise<Object>} Resultado de la operación\n */\nexport async function crearReservaEnITraffic(pasajeros, datosReserva = {}, isEdit = false, originData = null) {\n  try {\n    // Transformar datos al formato del RPA\n    const datosRPA = transformarDatosParaRPA(pasajeros, datosReserva, isEdit, originData);\n    \n    // Seleccionar la URL según si es crear o editar\n    const serviceUrl = isEdit ? RPA_EDIT_URL : RPA_CREATE_URL;\n    \n    // Enviar petición al servidor RPA\n    const response = await fetch(serviceUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(datosRPA)\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Error del servidor: ${response.status} ${response.statusText}`);\n    }\n    \n    const resultado = await response.json();\n    \n    return {\n      success: resultado.success !== false,\n      data: resultado.data || resultado,\n      reservationCode: resultado.reservationCode || null,\n      message: resultado.message || (isEdit ? 'Reserva editada exitosamente en iTraffic' : 'Reserva creada exitosamente en iTraffic')\n    };\n    \n  } catch (error) {\n    // Si el servidor no está disponible, mostrar un mensaje más amigable\n    if (error.message.includes('fetch')) {\n      throw new Error('No se pudo conectar con el servicio RPA. Asegúrate de que el servidor esté corriendo.');\n    }\n    \n    throw error;\n  }\n}\n\n/**\n * Verifica si el servicio RPA está disponible\n * @returns {Promise<boolean>} true si el servicio está disponible\n */\nexport async function verificarServicioRPA() {\n  try {\n    const healthUrl = typeof RPA_API_URL !== 'undefined'\n      ? RPA_API_URL + '/api/rpa/health'\n      : 'http://localhost:3001/api/rpa/health';\n      \n    const response = await fetch(healthUrl, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      }\n    });\n    \n    return response.ok;\n  } catch (error) {\n    console.error('Error verificando servicio RPA:', error);\n    return false;\n  }\n}\n","export const servicesList =['1 BODEGA CON ALMUERZO LUJAN/MAIPU',\n  '2 BODEGAS CON ALMUERZO LUJAN/MAIPU',\n  '2 BODEGAS CON ALMUERZO VDU',\n  'ACTIVIDAD EN BODEGA',\n  'ACTIVIDAD EN BODEGAS CORPORATIVO 21%',\n  'ACTIVIDAD EN BODEGAS CORPORATIVO EXENTO',\n  'ALMUERZO EN BODEGA ALFACRUX',\n  'ALMUERZO EN RESTAURANTE',\n  'ALMUERZO EN VALLE ANDINO',\n  'ALMUERZO RESTAURANT',\n  'ALMUERZO THE VINES',\n  'ALMUERZO/CENA EN BODEGA',\n  'ALMUERZO/CENA EN BODEGA VU C/TRASLADO',\n  'ALMUERZO/CENA EN BODEGA ZC C/TRASLADO',\n  'ALMUERZO/CENA EN BODEGAS ZC',\n  'ALMUERZO/CENA EN RESTAURANTE',\n  'ALTA MONTAÑA',\n  'ALTA MONTAÑA EN PRIVADO',\n  'ATARDECER EN VIGIL',\n  'BODEGAS Y OLIVAS EN PRIVADO',\n  'BODEGAS ZONA MAIPU C ALMUERZO',\n  'CABALGATA AL ATARDECER + CENA',\n  'CABALGATA AL ATARDECER CON ASADO COMPLETO',\n  'CABALGATA CRIOLLA',\n  'CABALGATA ENTRE VIÑEDOS CON ASADO',\n  'CABALGATA RINCON DE LOS OSCUROS',\n  'CACHEUTA CIUDAD O*V',\n  'CACHEUTA POR TRAMO',\n  'CAÑON DEL ATUEL DESDE MENDOZA',\n  'CAÑON DEL ATUEL EN PRIVADO',\n  'CAÑON DEL ATUEL SAN RAFAEL',\n  'CATA DE BURBUJAS CON VINO Y PICADA',\n  'CENA DE FIN DE AÑO',\n  'CENA FIN DE AÑO EN SHERATON',\n  'CENA GOURMET EN RESTAURANT DE BODEGA',\n  'CITY HOTEL CENTRICO',\n  'CITY TOUR',\n  'CITY TOUR + BODEGA C/ALM',\n  'CITY TOUR + DEGUSTACIÓN',\n  'CITY TOUR EN PRIVADO',\n  'CIUDAD - SAN RAFAEL CON ESPERA',\n  'COMISIONES CLIENTE',\n  'COOKING CLASS VALLE DE UCO + ALMUERZO',\n  'COOKING CLASS ZONA CENTRO',\n  'COROLLA - CACHEUTA POR TRAMO',\n  'COROLLA - TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM',\n  'COROLLA - TRASLADO A 3 BODEGAS VALLE DE UCO',\n  'COROLLA - TRF IN/OUT AEROP CACHEUTA',\n  'COROLLA TRF IN AEROP BOD/POS ZC',\n  'COROLLA TRF IN AEROP- HOTEL CENTRICO',\n  'COROLLA TRF IN AEROP/CDAD A BOD/POS UCO',\n  'COROLLA TRF OUT AEROP/CDAD A BOD/POS UCO',\n  'COROLLA TRF OUT BOD/POS ZC AEROP',\n  'COROLLA TRF OUT HOTEL CENTRICO-AEROP',\n  'COSTUMBRES MENDOCINAS (AFA)',\n  'CRONOS - CACHEUTA POR TRAMO',\n  'CRONOS - TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM',\n  'CRONOS - TRASLADO A 3 BODEGAS VALLE DE UCO',\n  'CRONOS - TRF IN/OUT AEROP CACHEUTA',\n  'CRONOS TRF IN AEROP BOD/POS ZC',\n  'CRONOS TRF IN AEROP- HOTEL CENTRICO',\n  'CRONOS TRF IN AEROP/CDAD A BOD/POS UCO',\n  'CRONOS TRF OUT AEROP/CDAD A BOD/POS UCO',\n  'CRONOS TRF OUT BOD/POS ZC AEROP',\n  'CRONOS TRF OUT HOTEL CENTRICO-AEROP',\n  'DIA DE AVENTURA',\n  'DIQUE LOS REYUNOS SAN RAFAEL',\n  'ENOLOGO POR UN DIA C/ALM',\n  'ENTRADAS VENDIMIA 2026',\n  'ENTRE VIDES Y COPAS',\n  'EXCURSION ANDESTRUCK', \n  'EXCURSION BARREAL - PAMPA EL LEONCITO - CALINGASTA - OBSERVATORIO ASTRONOMICO',\n  'EXCURSION BODEGA PUTRUELE',\n  'EXCURSION CANOPY ADRENALINA',\n  'EXCURSION CANOPY BASE',\n  'EXCURSION CIUDAD - DIQUES Y QUEBRADA',\n  'EXCURSION DIQUES Y QUEBRADA CON ALMUERZO EN BODEGA',\n  'EXCURSION FULL DAY DE VINOS VALLE DE UCO',\n  'EXCURSION FULL DAY DE VINOS VALLE DE UCO PREMIUM',\n  'EXCURSION FULL DAY DE VINOS ZONA CENTRO',\n  'EXCURSION FULL DAY DE VINOS ZONA CENTRO PREMIUM',\n  'EXCURSION MENDOZA VINOS Y OLIVA',\n  'EXCURSION PARQUE ISCHIGUALASTO - VALLE DE LA LUNA (UAQ)',\n  'EXCURSION PARQUE NACIONAL TALAMPAYA (UAQ)',\n  'EXCURSION RAFTING MEDIO DIA',\n  'EXCURSION RUTA INTERLAGO – DIQUES QUEBRADAS Y MIRADORES',\n  'EXCURSION TREKKING CERRO NEGRO',\n  'EXCURSION TREKKING CON RAPPEL',\n  'EXCURSION VALLE DE LAS LEÑAS',\n  'EXCURSION VALLES IGLECIANOS JACHAL - RODEO - IGLESIA',\n  'EXCURSION VINOS Y SABORES DE MAIPU',\n  'EXCURSION VIÑEDOS Y BODEGAS - RUTA DEL VINO',\n  'EXPERIENCIA ACONCAGUA',\n  'EXPERIENCIA ALMUERZO O CENA EL ENEMIGO',\n  'EXPERIENCIA ALMUERZO O CENA EN ANGELICA',\n  'EXPERIENCIA CATENA ZAPATA CON ALMUERZO EN EL ENEMIGO',\n  'EXPERIENCIA CHOCOLATE',\n  'EXPERIENCIA VALLE DE UCO',\n  'FULL CATENA (DEGUSTACION CATENA+ ALM ANGELICA)',\n  'FULL DAY SALENTEIN',\n  'FULL DAY SPA SIN TRASLADO',\n  'FULL DAY SPA TERMAS CON TRASLADOS',\n  'FULL DAY SPA Y GLOBO PREMIUM',\n  'HASTA 3 BODEGAS S ALMUERZO',\n  'HOTEL - POTRERILLOS - HOTEL (5hs)',\n  'HOTEL CACHEUTA (5 HS)',\n  'LAGUNA DE LLANCANELO',\n  'LAS LEÑAS CIUDAD O*V',\n  'LOS VALLES HASTA LAS LEÑAS 1/2 DIA',\n  'MANQUI MALAL (s/ Entrada) 1/2 DIA',\n  'MINDFULNESS TERMAL CON TRASLADOS',\n  'PAQUETE TERMAS CON BODEGAS EN CORDÓN DEL PLATA',\n  'PAQUETE VENDIMIA -ENTRADA CHARDONNAY',\n  'PAQUETE VENDIMIA -ENTRADA MALBEC',\n  'PAQUETE VENDIMIA -ENTRADA TEMPRANILLO',\n  'PAQUETE VINOS Y MÁS',\n  'PARQUE DE AGUA CON TRASLADOS',\n  'PASEO EN GLOBO',\n  'PASEO EN VELERO CON QUESOS Y VINOS',\n  'PAYUNIA 4x4',\n  'POTRERILLOS CIUDAD O*V',\n  'PROGRAMA 1 SAN JUAN Y LA RIOJA',\n  'RAFTING CON TARDE DE SPA',\n  'RECARGO TC',\n  'RUTA DE SABORES',\n  'SAN RAFAEL - CIUDAD o*V',\n  'SERVICIO DE GUIA ALTA MONTAÑA',\n  'SERVICIO DE GUIA CAÑON DEL ATUEL',\n  'SERVICIO DE GUIA DIA COMPLETO',\n  'SERVICIO DE GUIA FULL DAY',\n  'SERVICIO DE GUIA FULL DAY VALLE DE UCO',\n  'SERVICIO DE GUIA IN / OUT HOTEL / POSADA VALLE DE UCO',\n  'SERVICIO DE GUIA IN / OUT HOTEL O POSADA LUJAN/MAIPU',\n  'SERVICIO DE GUIA MEDIO DIA',\n  'SERVICIO DE GUIA MEDIO DIA CITY',\n  'SERVICIO DE GUIA MEDIO DIA CON ALMUERZO',\n  'SERVICIO DE GUIA MEDIO DIA EXCURSION CONVENCIONAL',\n  'SERVICIO DE GUIA TRASLADO A CENA',\n  'SERVICIO DE GUIA TRASLADO A CENA CON ASISTENCIA',\n  'SERVICIO DE GUIA TRASLADO A CENA CON ESPERA',\n  'SERVICIO DE GUIA TRASLADO A CHILE',\n  'SERVICIO DE GUIA TRF IN / OUT HOTEL O POSADA LUJAN/MAIPU',\n  'SERVICIO DE GUIA TRF IN/ OUT HOTEL CENTRO',\n  'SERVICIO DE GUIA TRF IN/OUT HOTEL - VALLE DE UCO',\n  'SERVICIO FULL DAY',\n  'SERVICIO FULL DAY VALLE DE UCO',\n  'SERVICIOS EN LAS LEÑAS',\n  'SNACKS',\n  \"SPA HAMMAM - 8H CON ALMUERZO\",\n  \"TARDECITAS EN ANDELUNA\",\n  \"TICKET BUS TERRESTRE\",\n  \"TOUR CACHEUTA\",\n  \"TOUR CATENA Y VIGIL\",\n  \"TOUR DE BICI POR ZUCCARDI CON ALMUERZO PARRILLERO\",\n  \"TOUR ORGANICO - VIS. BODEGA CECCHIN Y VISITA CON PICNIC EN ALPAMANTA\",\n  \"TOUR POTRERILLOS c/ ALM EN EL HOTEL\",\n  \"TRASLADO A 1 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"TRASLADO A 1 BODEGAS MAIPU/LUJAN C/CENA\",\n  \"TRASLADO A 2 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"TRASLADO A 3 BODEGAS VALLE DE UCO\",\n  \"TRASLADO A CHILE\",\n  \"TRASLADO A PENITENTES CON ESPERA\",\n  \"TRASLADO A SANTIAGO DE CHILE\",\n  \"TRASLADO AEROP DE SAN RAFAEL A LAS LEÑAS\",\n  \"TRASLADO ALTA MONTAÑA\",\n  \"TRASLADO BODEGAS\",\n  \"TRASLADO CAÑON\",\n  \"TRASLADO CITY TOUR\",\n  \"TRASLADO CIUDAD USPALLATA / VALLECITOS O*V\",\n  \"TRASLADO CON ESPERA RESTO CIUDAD\",\n  \"TRASLADO CON ESPERA VALLE DE UCO HASTA 3 BODEGAS C/ALM\",\n  \"TRASLADO CON ESPERA ZONA MAIPU LUJAN HASTA 3 BODEGAS C/ALM\",\n  \"TRASLADO HOTEL CENTRICO RESTAURANTE ZC\",\n  \"TRASLADO PENITENTES / ACONCAGUA POR EL DÍA\",\n  \"TRASLADO RESTO-CIUDAD\",\n  \"TRASLADO TOUR  BODEGAS Y OLIVAS\",\n  \"TRASLADO VILLAVICENCIO\",\n  \"TRASLADOS VARIOS CORPORATIVO 10.5%\",\n  \"TRASLADOS VARIOS CORPORATIVO EXENTO\",\n  \"TREKKING CERRO ARENALES-VALLECITOS\",\n  \"TREKKING CERRO BAYOS\",\n  \"TREKKING CERRO CABRAS\",\n  \"TREKKING LAS CAMPANAS\",\n  \"TRF AEROPUERTO CACHEUTA IN/OUT\",\n  \"TRF HOTEL - POTRERILLOS - HOTEL (5hs)\",\n  \"TRF IN / OUT AEROPUERTO U HOTEL EN MENDOZA / AEROPUERTO U HOTEL SAN JUAN\",\n  \"TRF IN AEROP BOD/POS ZC\",\n  \"TRF IN AEROP UAQ- HOTEL CENTRICO\",\n  \"TRF IN AEROP- HOTEL CENTRICO\",\n  \"TRF IN AEROP/CDAD A BOD/POS UCO\",\n  \"TRF IN BOD/POS ZC AEROP\",\n  \"TRF IN HOTEL CENTRICO-AEROP\",\n  \"TRF IN HOTEL CENTRICO-TERMINAL\",\n  \"TRF IN TERMINAL- HOTEL CENTRICO\",\n  \"TRF IN/OUT AEROP CACHEUTA\",\n  \"TRF IN/OUT SAN RAFAEL AERO / HOTEL O*V\",\n  \"TRF IN/OUT SAN RAFAEL TERM / HOTEL O*V\",\n  \"TRF OUT AEROP- HOTEL CENTRICO\",\n  \"TRF OUT AEROP/CDAD A BOD/POS UCO\",\n  \"TRF OUT BOD/POS UCO A AERO\",\n  \"TRF OUT BOD/POS ZC AEROP\",\n  \"TRF OUT HOTEL CENTRICO-AEROP\",\n  \"TRF OUT HOTEL CENTRICO-AEROP UAQ\",\n  \"TRF OUT HOTEL CENTRICO-TERMINAL\",\n  \"TRF OUT TERMINAL- HOTEL CENTRICO\",\n  \"TRF TEST\",\n  \"USPALLATA POR TRAMO\",\n  \"VALLE DE UCO REGULAR\",\n  \"VALLE HERMOSO 1/2 DIA\",\n  \"VEHICULO A DISPOSICION HASTA 8 HS\",\n  \"VILLAVICENCIO\",\n  \"VILLAVICENCIO EN PRIVADO\",\n  \"VISITA A 2 BODEGAS CON DEGUSTACION\",\n  \"VISITA A BIANCHI c/ ALM EN ATAMISQUE\",\n  \"VISITA A NORTON CON ALMUERZO EN BELASCO\",\n  \"VISITA A ZUCCARDI CON ALMUERZO EN SALENTEIN\",\n  \"VISITA AL ENEMIGO c/ALM EN SANTA JULIA\",\n  \"VISITA AL ENEMIGO CON ALMUERZO EN ANGELICA\",\n  \"VISITA c/ PICADA EN BODEGA\",\n  \"VISITA CON DEGUSTACION EN BODEGA (ANAIA / VIÑA COBOS)\",\n  \"VISITA CON DEGUSTACION EN BODEGA EL ENEMIGO\",\n  \"VISITA Y ALMUERZO EN VDU (SALENTEIN / DIAMANDES / LA VIGILIA)\",\n  \"VISITA Y DEGUSTACION EN 2 BODEGAS ZC C/TRASLADO\",\n  \"VISITA Y DEGUSTACION EN BODEGAS\",\n  \"VISITA Y DEGUSTACION EN BODEGAS VUCO\",\n  \"VOLCAN MALA CARA\",\n  \"WINE & FOOD TOUR\",\n  \"WINE & RIDE CAMINOS DEL VIÑEDO\",\n  \"WINE & RIDE DESDE LUJAN CON ALMUERZO\",\n  \"WINE & RIDE DESDE MAIPU CON ALMUERZO EN ESENCIA\",\n  \"WINE & RIDE DESDE MAIPU CON ALMUERZO EN TRIVENTO\",\n  \"WINE & RIDE DESDE MAIPU SIN ALMUERZO\",\n  \"WINE & RIDE EXPERIENCIA CAROLINO\",\n  \"WINE & RIDE EXPERIENCIA DE LOS ANDES\",\n  \"WINE & RIDE LUJAN OPCION 1\",\n  \"WINE & RIDE LUJAN OPCION 2\",\n  \"WINE & RIDE LUJAN OPCION 3\",\n  \"WINE CLASSIC TOUR (Esencia o Villafañe)\",\n  \"WINE CLASSIC TOUR SUPERIOR (Pan y oliva o Hacienda del Plata)\",\n  \"WINE ECO TOURS - 2 BODEGAS CON ALMUERZO EN VALLE DE UCO\",\n  \"ZACTIVIDAD EN BODEGA\",\n  \"ZACTIVIDAD EN BODEGA VUCO + ALMUERZO\",\n  \"ZACTIVIDAD EN BODEGA ZC\",\n  \"ZALMUERZO BODEGA PENEDO\",\n  \"ZALMUERZO EN BODEGA\",\n  \"ZALMUERZO EN BODEGA GIMENEZ RIILI\",\n  \"ZALMUERZO EN BODEGA NIETO\",\n  \"ZALMUERZO EN BODEGA RUCA MALEN\",\n  \"ZALMUERZO EN BODEGA TONELES\",\n  \"ZALMUERZO EN BODEGAS ZC\",\n  \"ZALMUERZO EN RESTAURANTE\",\n  \"ZALMUERZO/CENA EN BODEGA\",\n  \"ZALMUERZO/CENA EN BODEGAS VUCO\",\n  \"ZALMUERZO/CENA EN BODEGAS ZC\",\n  \"ZCABALGATA COLIBRI\",\n  \"ZCABALGATA RANCHO VIEJO\",\n  \"ZCABALGATA RINCON DE LOS OSCUROS (2 HS)\",\n  \"ZCENA RINCON DE LOS OSCUROS (MENU 2)\",\n  \"ZENTRADAS MALBEC 2026\",\n  \"ZHASTA 3 BODEGAS S ALMUERZO\",\n  \"ZPASEO EN GLOBO\",\n  \"ZPASEO EN VELERO\",\n  \"ZREGALO PASAJERO\",\n  \"ZSERVICIO DE GUIA ALTA MONTAÑA\",\n  \"ZSERVICIO DE GUIA ALTA MONTAÑA x VILLAVICENCIO\",\n  \"ZSERVICIO DE GUIA CAÑON DEL ATUEL\",\n  \"ZSERVICIO DE GUIA FULL DAY\",\n  \"ZSERVICIO DE GUIA FULL DAY VALLE DE UCO\",\n  \"ZSERVICIO DE GUIA MEDIO DIA CON ALMUERZO\",\n  \"ZSERVICIO DE GUIA MEDIO DIA CONVENCIONAL\",\n  \"ZSERVICIO DE GUIA MEDIO DIA EXCURSION CONVENCIONAL\",\n  \"ZSERVICIO DE GUIA TRASLADO A CENA\",\n  \"ZSERVICIO DE GUIA TRASLADO A CENA CON ASISTENCIA\",\n  \"ZTOUR PANORÁMICO POTRERILLOS\",\n  \"ZTOUR POTRERILLOS MEDIO DÍA\",\n  \"ZTRASLADO A 1 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"ZTRASLADO A 2 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"ZTRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"ZTRASLADO A 3 BODEGAS VALLE DE UCO\",\n  \"ZTRASLADO A 3 BODEGAS VALLE DE UCO C/ CRUCE\",\n  \"ZTRASLADO A PENITENTES CON ESPERA\",\n  \"ZTRASLADO AL GLOBO\",\n  \"ZTRASLADO AL RINCON DE LOS OSCUROS (5HS)\",\n  \"ZTRASLADO ALTA MONTAÑA\",\n  \"ZTRASLADO CAÑON\",\n  \"ZTRASLADO CITY TOUR\",\n  \"ZTRASLADO HASTA 3 BODEGAS S/ALMUERZO\",\n  \"ZTRASLADO RANCHO VIEJO\",\n  \"ZTRASLADO RESTO-CIUDAD\",\n  \"ZTRASLADO TOUR  BODEGAS Y OLIVAS\",\n  \"ZTRASLADO TOUR CAÑON\",\n  \"ZTRASLADO TOUR VALLECITOS x EL DIA\",\n  \"ZTRASLADO VILLAVICENCIO\",\n  \"ZUCCARDI CON ALMUERZO EN SANTA JULIA (MENÚ SANTA JULIA)\",\n  \"ZVISITA Y DEGUSTACION EN BODEGA\",\n  \"ZVISITA Y DEGUSTACION EN BODEGAS\",\n  \"ZVISITA Y DEGUSTACION EN BODEGAS VUCO\",\n  \"ZVISITA Y DEGUSTACION EN BODEGAS ZC\",\n  \"ZVISITA Y DEGUSTACION EN CATENA ZAPATA\",\n  ]\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\n\nimport { crearReservaEnITraffic } from './rpaClient.js';\nimport { servicesList } from './servicesList.js';\n\n// Estado global para datos maestros\nconst masterData = {\n  sellers: [],\n  clients: [],\n  statuses: [],\n  reservationTypes: [],\n  genders: [],\n  documentTypes: [],\n  countries: [],\n  loaded: false\n};\n\n// Estado global para la extracción actual\nlet extractionState = {\n  didExtractionExist: false,\n  reservationCode: null,\n  originData: null // Data original de la extracción\n};\n\n// Función para mostrar mensajes al usuario\nfunction mostrarMensaje(mensaje, tipo = \"info\") {\n  // Crear elemento de mensaje\n  const mensajeDiv = document.createElement(\"div\");\n  mensajeDiv.className = `status-message ${tipo}`;\n  mensajeDiv.textContent = mensaje;\n  mensajeDiv.style.position = \"fixed\";\n  mensajeDiv.style.top = \"20px\";\n  mensajeDiv.style.left = \"50%\";\n  mensajeDiv.style.transform = \"translateX(-50%)\";\n  mensajeDiv.style.zIndex = \"10000\";\n  mensajeDiv.style.minWidth = \"200px\";\n  mensajeDiv.style.maxWidth = \"90%\";\n  mensajeDiv.style.textAlign = \"center\";\n  mensajeDiv.style.animation = \"slideDown 0.3s ease\";\n  \n  document.body.appendChild(mensajeDiv);\n  \n  // Remover después de 3 segundos\n  setTimeout(() => {\n    mensajeDiv.style.animation = \"slideUp 0.3s ease\";\n    setTimeout(() => {\n      if (mensajeDiv.parentNode) {\n        mensajeDiv.parentNode.removeChild(mensajeDiv);\n      }\n    }, 300);\n  }, 3000);\n}\n\nOffice.onReady((info) => {\n  try {\n  if (info.host === Office.HostType.Outlook) {\n      // Ocultar mensaje de sideload si existe\n      const sideloadMsg = document.getElementById(\"sideload-msg\");\n      if (sideloadMsg) {\n        sideloadMsg.style.display = \"none\";\n      }\n      \n      // Mostrar el cuerpo de la aplicación\n      const appBody = document.getElementById(\"app-body\");\n      if (appBody) {\n        appBody.style.display = \"flex\";\n      }\n      \n      // Asignar evento al botón de extraer\n      const runButton = document.getElementById(\"run\");\n      if (runButton) {\n        runButton.onclick = function() {\n          try {\n            run();\n          } catch (error) {\n            mostrarMensaje(\"Error al extraer datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botón de re-extraer\n      const reextractButton = document.getElementById(\"reextract\");\n      if (reextractButton) {\n        // Ocultar inicialmente (solo se muestra cuando hay resultados)\n        reextractButton.style.display = \"none\";\n        \n        reextractButton.onclick = function() {\n          try {\n            // Ocultar resultados y volver a extraer\n            const resultsDiv = document.getElementById(\"results\");\n            resultsDiv.style.display = \"none\";\n            // Ocultar botón de re-extracción mientras se procesa\n            reextractButton.style.display = \"none\";\n            // Llamar a run con isReExtract = true\n            run(true);\n          } catch (error) {\n            mostrarMensaje(\"Error al re-extraer datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botón de guardar\n      const guardarButton = document.getElementById(\"guardar\");\n      if (guardarButton) {\n        guardarButton.onclick = function() {\n          try {\n            guardarDatos();\n          } catch (error) {\n            mostrarMensaje(\"Error al guardar datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botón de agregar pasajero\n      const agregarButton = document.getElementById(\"agregarPasajero\");\n      if (agregarButton) {\n        agregarButton.onclick = function() {\n          try {\n            agregarNuevoPasajero();\n          } catch (error) {\n            mostrarMensaje(\"Error al agregar pasajero: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botón de agregar hotel\n      const agregarHotelButton = document.getElementById(\"agregarHotel\");\n      if (agregarHotelButton) {\n        agregarHotelButton.onclick = function() {\n          try {\n            mostrarSeccionHotel();\n          } catch (error) {\n            mostrarMensaje(\"Error al agregar hotel: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botón de agregar servicio\n      const agregarServicioButton = document.getElementById(\"agregarServicio\");\n      if (agregarServicioButton) {\n        agregarServicioButton.onclick = function() {\n          try {\n            agregarNuevoServicio();\n          } catch (error) {\n            mostrarMensaje(\"Error al agregar servicio: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botón de crear reserva\n      const crearReservaButton = document.getElementById(\"crearReserva\");\n      if (crearReservaButton) {\n        crearReservaButton.onclick = function() {\n          ejecutarCrearReserva();\n        };\n        // Deshabilitar el botón inicialmente\n        crearReservaButton.disabled = true;\n        crearReservaButton.style.opacity = \"0.5\";\n        crearReservaButton.style.cursor = \"not-allowed\";\n      }\n      \n      // Agregar event listeners para campos de reserva\n      const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n      camposReserva.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.addEventListener('change', actualizarEstadoBotonCrearReserva);\n          campo.addEventListener('input', actualizarEstadoBotonCrearReserva);\n        }\n      });\n      \n      // Agregar event listeners para campos de hotel\n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.addEventListener('change', () => {\n            validarFechasHotel();\n            actualizarEstadoBotonCrearReserva();\n          });\n          campo.addEventListener('input', () => {\n            validarFechasHotel();\n            actualizarEstadoBotonCrearReserva();\n          });\n        }\n      });\n      \n      // Cargar datos maestros al iniciar\n      cargarDatosMaestros();\n    }\n  } catch (error) {\n    // Error silencioso\n  }\n});\n\n/**\n * Valida las fechas del hotel en tiempo real\n */\nfunction validarFechasHotel() {\n  const hotelIn = document.getElementById(\"hotel_in\");\n  const hotelOut = document.getElementById(\"hotel_out\");\n  \n  // Solo validar si ambos campos tienen valores\n  if (!hotelIn || !hotelOut || !hotelIn.value || !hotelOut.value) {\n    // Limpiar estilos de error si no hay valores\n    if (hotelIn) hotelIn.style.borderColor = '';\n    if (hotelOut) hotelOut.style.borderColor = '';\n    return;\n  }\n  \n  const fechaIn = new Date(hotelIn.value);\n  const fechaOut = new Date(hotelOut.value);\n  \n  // Verificar que las fechas sean válidas\n  if (isNaN(fechaIn.getTime()) || isNaN(fechaOut.getTime())) {\n    return;\n  }\n  \n  // Verificar que la fecha de salida sea posterior a la de entrada\n  if (fechaOut <= fechaIn) {\n    // Mostrar error visual\n    hotelIn.style.borderColor = '#d32f2f';\n    hotelOut.style.borderColor = '#d32f2f';\n    return;\n  }\n  \n  // Calcular la diferencia en días\n  const diferenciaDias = Math.floor((fechaOut - fechaIn) / (1000 * 60 * 60 * 24));\n  \n  if (diferenciaDias < 1) {\n    // Mostrar error visual\n    hotelIn.style.borderColor = '#d32f2f';\n    hotelOut.style.borderColor = '#d32f2f';\n  } else {\n    // Limpiar estilos de error\n    hotelIn.style.borderColor = '';\n    hotelOut.style.borderColor = '';\n  }\n}\n\n/**\n * Cargar datos maestros desde el servidor\n */\nasync function cargarDatosMaestros() {\n  try {\n    // Usar la variable global RPA_API_URL inyectada por webpack\n    const masterDataUrl = typeof RPA_API_URL !== 'undefined'\n      ? RPA_API_URL + '/api/master-data'\n      : 'http://localhost:3001/api/master-data';\n    \n    const response = await fetch(masterDataUrl);\n    \n    if (!response.ok) {\n      console.warn('⚠️ No se pudieron cargar los datos maestros, usando valores por defecto');\n      return;\n    }\n    \n    const result = await response.json();\n    \n    if (result.success && result.data) {\n      masterData.sellers = result.data.sellers || [];\n      masterData.clients = result.data.clients || [];\n      masterData.statuses = result.data.statuses || [];\n      masterData.reservationTypes = result.data.reservationTypes || [];\n      masterData.genders = result.data.genders || [];\n      masterData.documentTypes = result.data.documentTypes || [];\n      masterData.countries = result.data.countries || [];\n      masterData.loaded = true;\n      \n      console.log('✅ Datos maestros cargados:', {\n        vendedores: masterData.sellers.length,\n        clientes: masterData.clients.length,\n        estados: masterData.statuses.length,\n        tiposReserva: masterData.reservationTypes.length,\n        generos: masterData.genders.length,\n        tiposDoc: masterData.documentTypes.length,\n        paises: masterData.countries.length\n      });\n      \n      // Poblar los selects de reserva\n      poblarSelectReserva();\n    }\n  } catch (error) {\n    console.error('❌ Error cargando datos maestros:', error);\n  }\n}\n\n/**\n * Poblar los selects de la sección de reserva\n */\nfunction poblarSelectReserva() {\n  // Tipo de Reserva\n  const tipoReservaSelect = document.getElementById('tipoReserva');\n  if (tipoReservaSelect && masterData.reservationTypes.length > 0) {\n    tipoReservaSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.reservationTypes.forEach(tipo => {\n      const option = document.createElement('option');\n      option.value = tipo.name;\n      option.textContent = tipo.name;\n      tipoReservaSelect.appendChild(option);\n    });\n    console.log(`📋 Tipo Reserva poblado con ${masterData.reservationTypes.length} opciones`);\n  } else if (tipoReservaSelect) {\n    // Opciones por defecto si no hay datos maestros\n    tipoReservaSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"AGENCIAS [COAG]\">AGENCIAS [COAG]</option>\n      <option value=\"MAYORISTA [COMA]\">MAYORISTA [COMA]</option>\n      <option value=\"DIRECTO [CODI]\">DIRECTO [CODI]</option>\n      <option value=\"CORPORATIVA [COCO]\">CORPORATIVA [COCO]</option>\n    `;\n    console.log(`📋 Tipo Reserva poblado con opciones por defecto`);\n  }\n  \n  // Estado\n  const estadoSelect = document.getElementById('estadoReserva');\n  if (estadoSelect && masterData.statuses.length > 0) {\n    estadoSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.statuses.forEach(estado => {\n      const option = document.createElement('option');\n      option.value = estado.name;\n      option.textContent = estado.name;\n      estadoSelect.appendChild(option);\n    });\n    console.log(`📋 Estado poblado con ${masterData.statuses.length} opciones`);\n  } else if (estadoSelect) {\n    // Opciones por defecto si no hay datos maestros\n    estadoSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"PENDIENTE DE CONFIRMACION [PC]\">PENDIENTE DE CONFIRMACION [PC]</option>\n      <option value=\"CONFIRMADA [CO]\">CONFIRMADA [CO]</option>\n      <option value=\"CANCELADA [CA]\">CANCELADA [CA]</option>\n    `;\n    console.log(`📋 Estado poblado con opciones por defecto`);\n  }\n  \n  // Vendedor\n  const vendedorSelect = document.getElementById('vendedor');\n  if (vendedorSelect && masterData.sellers.length > 0) {\n    vendedorSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.sellers.forEach(vendedor => {\n      const option = document.createElement('option');\n      option.value = vendedor.name;\n      option.textContent = vendedor.name;\n      vendedorSelect.appendChild(option);\n    });\n    console.log(`📋 Vendedor poblado con ${masterData.sellers.length} opciones`);\n  } else if (vendedorSelect) {\n    // Opciones por defecto si no hay datos maestros\n    vendedorSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"TEST TEST\">TEST TEST</option>\n    `;\n    console.log(`📋 Vendedor poblado con opciones por defecto`);\n  }\n  \n  // Cliente\n  const clienteSelect = document.getElementById('cliente');\n  if (clienteSelect && masterData.clients.length > 0) {\n    clienteSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.clients.forEach(cliente => {\n      const option = document.createElement('option');\n      option.value = cliente.name;\n      option.textContent = cliente.name;\n      clienteSelect.appendChild(option);\n    });\n    console.log(`📋 Cliente poblado con ${masterData.clients.length} opciones`);\n  } else if (clienteSelect) {\n    // Opciones por defecto si no hay datos maestros\n    clienteSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"DESPEGAR - TEST - 1\">DESPEGAR - TEST - 1</option>\n    `;\n    console.log(`📋 Cliente poblado con opciones por defecto`);\n  }\n}\n\n/**\n * Poblar los selects de un formulario de pasajero\n * @param {number} numero - Número del pasajero\n */\nfunction poblarSelectsPasajero(numero) {\n  // Sexo\n  const sexoSelect = document.getElementById(`sexo_${numero}`);\n  if (sexoSelect && masterData.genders.length > 0) {\n    const valorActual = sexoSelect.value;\n    sexoSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.genders.forEach(genero => {\n      const option = document.createElement('option');\n      option.value = genero.code;\n      option.textContent = genero.name;\n      sexoSelect.appendChild(option);\n    });\n    if (valorActual) sexoSelect.value = valorActual;\n    console.log(`📋 Sexo ${numero} poblado con ${masterData.genders.length} opciones`);\n  } else if (sexoSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    sexoSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"M\">MASCULINO</option>\n      <option value=\"F\">FEMENINO</option>\n    `;\n    console.log(`📋 Sexo ${numero} poblado con opciones por defecto`);\n  }\n  \n  // Tipo de Documento\n  const tipoDocSelect = document.getElementById(`tipoDoc_${numero}`);\n  if (tipoDocSelect && masterData.documentTypes.length > 0) {\n    const valorActual = tipoDocSelect.value;\n    tipoDocSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.documentTypes.forEach(tipo => {\n      const option = document.createElement('option');\n      option.value = tipo.code;\n      option.textContent = tipo.name;\n      tipoDocSelect.appendChild(option);\n    });\n    if (valorActual) tipoDocSelect.value = valorActual;\n    console.log(`📋 Tipo Doc ${numero} poblado con ${masterData.documentTypes.length} opciones`);\n  } else if (tipoDocSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    tipoDocSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"DNI\">DOCUMENTO NACIONAL DE IDENTIDAD</option>\n      <option value=\"PAS\">PASAPORTE</option>\n      <option value=\"CI\">CÉDULA DE IDENTIDAD</option>\n      <option value=\"LE\">LIBRETA DE ENROLAMIENTO</option>\n      <option value=\"LC\">LIBRETA CÍVICA</option>\n    `;\n    console.log(`📋 Tipo Doc ${numero} poblado con opciones por defecto`);\n  }\n  \n  // Nacionalidad\n  const nacionalidadSelect = document.getElementById(`nacionalidad_${numero}`);\n  if (nacionalidadSelect && masterData.countries.length > 0) {\n    const valorActual = nacionalidadSelect.value;\n    nacionalidadSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.countries.forEach(pais => {\n      const option = document.createElement('option');\n      option.value = pais.name;\n      option.textContent = pais.name;\n      nacionalidadSelect.appendChild(option);\n    });\n    if (valorActual) nacionalidadSelect.value = valorActual;\n    console.log(`📋 Nacionalidad ${numero} poblada con ${masterData.countries.length} opciones`);\n  } else if (nacionalidadSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    nacionalidadSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"ARGENTINA\">ARGENTINA</option>\n      <option value=\"BRASIL\">BRASIL</option>\n      <option value=\"CHILE\">CHILE</option>\n      <option value=\"URUGUAY\">URUGUAY</option>\n      <option value=\"PARAGUAY\">PARAGUAY</option>\n      <option value=\"BOLIVIA\">BOLIVIA</option>\n      <option value=\"PERU\">PERU</option>\n      <option value=\"COLOMBIA\">COLOMBIA</option>\n      <option value=\"VENEZUELA\">VENEZUELA</option>\n      <option value=\"ECUADOR\">ECUADOR</option>\n      <option value=\"MEXICO\">MEXICO</option>\n      <option value=\"ESPAÑA\">ESPAÑA</option>\n      <option value=\"ESTADOS UNIDOS\">ESTADOS UNIDOS</option>\n    `;\n    console.log(`📋 Nacionalidad ${numero} poblada con opciones por defecto`);\n  }\n}\n\nasync function run(isReExtract = false) {\n  try {\n    // Ocultar el botón de extraer\n    const runButton = document.getElementById(\"run\");\n    runButton.style.display = \"none\";\n    \n    // Mostrar el loader\n    const loader = document.getElementById(\"loader\");\n    loader.style.display = \"block\";\n    \n    // Ocultar los resultados mientras se extrae\n    const resultsDiv = document.getElementById(\"results\");\n    resultsDiv.style.display = \"none\";\n\n  const item = Office.context.mailbox.item;\n    \n    // Obtener el cuerpo del correo\n    Office.context.mailbox.item.body.getAsync(\n      Office.CoercionType.Text, \n      async (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          const cuerpoCorreo = result.value;\n          \n          try {\n            // Llamar al servicio de extracción con IA\n            const extractedData = await extraerDatosConIA(cuerpoCorreo, isReExtract);\n            \n            // Ocultar loader\n            loader.style.display = \"none\";\n            \n            // Mostrar resultados\n            resultsDiv.style.display = \"block\";\n            \n            // Mostrar botón de re-extracción cuando hay resultados\n            const reextractButton = document.getElementById(\"reextract\");\n            if (reextractButton) {\n              reextractButton.style.display = \"block\";\n            }\n            \n            if (extractedData && extractedData.passengers && extractedData.passengers.length > 0) {\n              // Convertir explícitamente a booleano (puede venir como string \"true\"/\"false\" o booleano)\n              const didExtractionExistRaw = extractedData.didExtractionExist;\n              const didExtractionExist = didExtractionExistRaw === true || didExtractionExistRaw === 'true' || didExtractionExistRaw === 1;\n              \n              // Log para debug\n              console.log('🔍 didExtractionExist recibido:', didExtractionExistRaw, 'tipo:', typeof didExtractionExistRaw);\n              console.log('🔍 didExtractionExist convertido:', didExtractionExist);\n              \n              // Guardar el estado de la extracción globalmente\n              extractionState.didExtractionExist = didExtractionExist;\n              extractionState.reservationCode = extractedData.reservationCode || null;\n              \n              // Guardar la data original completa de la extracción (para comparación al editar)\n              if (didExtractionExist) {\n                extractionState.originData = JSON.parse(JSON.stringify(extractedData)); // Deep copy\n              }\n              \n              // Log para verificar que se guardó correctamente\n              console.log('💾 extractionState.didExtractionExist guardado:', extractionState.didExtractionExist);\n              console.log('💾 extractionState.reservationCode guardado:', extractionState.reservationCode);\n              console.log('💾 extractionState.originData guardado:', extractionState.originData);\n              \n              // Crear formularios según el número de pasajeros extraídos\n              crearFormulariosPasajeros(extractedData.passengers.length, didExtractionExist);\n              \n              // Llenar los datos de los pasajeros\n              llenarDatosPasajeros(extractedData.passengers);\n              \n              // Llenar los datos de la reserva\n              llenarDatosReserva(extractedData);\n              \n              // Actualizar el texto del botón según si es crear o editar\n              actualizarTextoBotonReserva(didExtractionExist);\n              \n              if(didExtractionExist) {\n                mostrarMensaje(`✅ Hay una extracción de datos existente para el correo`, \"success\");\n              }else{\n                mostrarMensaje(`✅ Datos extraídos: ${extractedData.passengers.length} pasajero(s)`, \"success\");\n              }\n            } else {\n              // Si no se extrajeron pasajeros, crear un formulario vacío\n              crearFormulariosPasajeros(1);\n              mostrarMensaje(\"No se pudieron extraer datos. Por favor, llena el formulario manualmente.\", \"info\");\n            }\n          } catch (error) {\n            // Ocultar loader\n            loader.style.display = \"none\";\n            \n            // Mostrar resultados con formulario vacío\n            resultsDiv.style.display = \"block\";\n            \n            // Si falla la extracción, crear un formulario vacío\n            crearFormulariosPasajeros(1);\n            mostrarMensaje(\"Error al extraer datos: \" + error.message + \". Llena el formulario manualmente.\", \"error\");\n          }\n        } else {\n          // Ocultar loader\n          loader.style.display = \"none\";\n          \n          // Mostrar botón de nuevo\n          runButton.style.display = \"block\";\n          \n          mostrarMensaje(\"Error al obtener el contenido del correo\", \"error\");\n        }\n      }\n    );\n  } catch (error) {\n    // Ocultar loader\n    const loader = document.getElementById(\"loader\");\n    loader.style.display = \"none\";\n    \n    // Mostrar botón de nuevo\n    const runButton = document.getElementById(\"run\");\n    runButton.style.display = \"block\";\n    \n    mostrarMensaje(\"Error inesperado: \" + error.message, \"error\");\n  }\n}\n\n/**\n * Llama al servicio de extracción con IA\n */\nasync function extraerDatosConIA(emailContent, isReExtract = false) {\n  // Usar la variable global RPA_API_URL inyectada por webpack\n  const extractUrl = typeof RPA_API_URL !== 'undefined'\n    ? RPA_API_URL + '/api/extract'\n    : 'http://localhost:3001/api/extract';\n  const mailbox = Office.context.mailbox;\n  \n  // Log para verificar que isReExtract se está enviando\n  console.log('📤 Enviando extracción - isReExtract:', isReExtract, 'tipo:', typeof isReExtract);\n  \n  const response = await fetch(extractUrl, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      emailContent: emailContent,\n      userId: mailbox.userProfile.emailAddress || 'outlook-user',\n      conversationId: mailbox.item.conversationId || 'conversation-id',\n      isReExtract: isReExtract\n    })\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.error || 'Error al extraer datos');\n  }\n\n  const result = await response.json();\n  \n  // Incluir didExtractionExist del nivel superior en el objeto data\n  const dataWithExtractionState = {\n    ...result.data,\n    didExtractionExist: result.didExtractionExist || false\n  };\n  \n  return dataWithExtractionState;\n}\n\nfunction crearFormulariosPasajeros(numeroPasajeros, didExtractionExist = false) {\n  const container = document.getElementById(\"pasajerosContainer\");\n  container.innerHTML = \"\"; // Limpiar contenedor\n  \n  for (let i = 0; i < numeroPasajeros; i++) {\n    const pasajeroDiv = crearFormularioPasajero(i + 1);\n    container.appendChild(pasajeroDiv);\n  }\n  \n  // Actualizar estado del botón después de crear los formularios\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\nfunction crearFormularioPasajero(numero) {\n  const pasajeroDiv = document.createElement(\"div\");\n  pasajeroDiv.className = \"pasajero-acordeon\";\n  pasajeroDiv.dataset.numeroPasajero = numero;\n  \n  // Cabecera del acordeón (clickeable)\n  const header = document.createElement(\"div\");\n  header.className = \"pasajero-header\";\n  header.innerHTML = `\n    <span class=\"pasajero-titulo\">Pasajero ${numero}</span>\n    <div class=\"pasajero-actions\">\n      <span class=\"arrow\">▼</span>\n      <button class=\"btn-eliminar-pasajero\" title=\"Eliminar pasajero\">✕</button>\n    </div>\n  `;\n  \n  // Contenido del acordeón (formulario)\n  const content = document.createElement(\"div\");\n  content.className = \"pasajero-content\";\n  content.style.display = \"none\";\n  content.innerHTML = `\n    <div>\n      <label>Tipo de Pasajero:</label>\n      <select id=\"tipoPasajero_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"adulto\">Adulto</option>\n        <option value=\"menor\">Menor</option>\n        <option value=\"infante\">Infante</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nombre: <span style=\"color: red;\">*</span></label>\n      <input type=\"text\" id=\"nombre_${numero}\" placeholder=\"Ingrese el nombre\">\n    </div>\n\n    <div>\n      <label>Apellido: <span style=\"color: red;\">*</span></label>\n      <input type=\"text\" id=\"apellido_${numero}\" placeholder=\"Ingrese el apellido\">\n    </div>\n\n    <div>\n      <label>DNI:</label>\n      <input type=\"number\" id=\"dni_${numero}\" placeholder=\"Ingrese el DNI\">\n    </div>\n\n    <div>\n      <label>Fecha de Nacimiento:</label>\n      <input type=\"date\" id=\"fechaNacimiento_${numero}\">\n    </div>\n\n    <div>\n      <label>CUIL:</label>\n      <input type=\"number\" id=\"cuil_${numero}\" placeholder=\"Ingrese el CUIL\">\n    </div>\n\n    <div>\n      <label>Tipo de Documento:</label>\n      <select id=\"tipoDoc_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"dni\">DNI</option>\n        <option value=\"pasaporte\">Pasaporte</option>\n        <option value=\"cedula\">Cédula</option>\n        <option value=\"otro\">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Sexo:</label>\n      <select id=\"sexo_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"masculino\">Masculino</option>\n        <option value=\"femenino\">Femenino</option>\n        <option value=\"otro\">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nacionalidad:</label>\n      <select id=\"nacionalidad_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"argentina\">Argentina</option>\n        <option value=\"brasilera\">Brasilera</option>\n        <option value=\"chilena\">Chilena</option>\n        <option value=\"uruguaya\">Uruguaya</option>\n        <option value=\"paraguaya\">Paraguaya</option>\n        <option value=\"boliviana\">Boliviana</option>\n        <option value=\"peruana\">Peruana</option>\n        <option value=\"colombiana\">Colombiana</option>\n        <option value=\"venezolana\">Venezolana</option>\n        <option value=\"otra\">Otra</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Dirección:</label>\n      <input type=\"text\" id=\"direccion_${numero}\" placeholder=\"Ingrese la dirección\">\n    </div>\n\n    <div>\n      <label>Número de Teléfono:</label>\n      <input type=\"tel\" id=\"telefono_${numero}\" placeholder=\"Ingrese el teléfono\">\n    </div>\n  `;\n  \n  // Funcionalidad de acordeón (toggle)\n  header.onclick = function(e) {\n    // No hacer toggle si se clickeó el botón de eliminar\n    if (e.target.classList.contains('btn-eliminar-pasajero')) {\n      return;\n    }\n    \n    const isOpen = content.style.display === \"block\";\n    const arrow = header.querySelector(\".arrow\");\n    \n    if (isOpen) {\n      content.style.display = \"none\";\n      arrow.style.transform = \"rotate(0deg)\";\n    } else {\n      content.style.display = \"block\";\n      arrow.style.transform = \"rotate(180deg)\";\n    }\n  };\n  \n  // Agregar event listeners para validación en tiempo real (solo nombre y apellido)\n  setTimeout(() => {\n    const nombreInput = document.getElementById(`nombre_${numero}`);\n    const apellidoInput = document.getElementById(`apellido_${numero}`);\n    \n    if (nombreInput) {\n      nombreInput.addEventListener('input', actualizarEstadoBotonCrearReserva);\n    }\n    if (apellidoInput) {\n      apellidoInput.addEventListener('input', actualizarEstadoBotonCrearReserva);\n    }\n  }, 100);\n  \n  // Funcionalidad del botón eliminar\n  const btnEliminar = header.querySelector('.btn-eliminar-pasajero');\n  btnEliminar.onclick = function(e) {\n    e.stopPropagation(); // Evitar que se abra/cierre el acordeón\n    eliminarPasajero(pasajeroDiv);\n  };\n  \n  pasajeroDiv.appendChild(header);\n  pasajeroDiv.appendChild(content);\n  \n  // Poblar los selects con datos maestros después de crear el formulario\n  setTimeout(() => {\n    poblarSelectsPasajero(numero);\n  }, 50);\n  \n  return pasajeroDiv;\n}\n\nfunction eliminarPasajero(pasajeroDiv) {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    \n    // No permitir eliminar si solo hay un pasajero\n    if (pasajeros.length <= 1) {\n      mostrarMensaje(\"Debe haber al menos un pasajero\", \"info\");\n      return;\n    }\n    \n    // Eliminar directamente sin confirmación (o puedes crear un modal personalizado)\n    pasajeroDiv.remove();\n    renumerarPasajeros();\n    mostrarMensaje(\"Pasajero eliminado correctamente\", \"success\");\n    \n    // Actualizar estado del botón después de eliminar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    mostrarMensaje(\"Error al eliminar pasajero\", \"error\");\n  }\n}\n\nfunction renumerarPasajeros() {\n  const container = document.getElementById(\"pasajerosContainer\");\n  const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n  \n  pasajeros.forEach((pasajeroDiv, index) => {\n    const nuevoNumero = index + 1;\n    const titulo = pasajeroDiv.querySelector(\".pasajero-titulo\");\n    titulo.textContent = `Pasajero ${nuevoNumero}`;\n    pasajeroDiv.dataset.numeroPasajero = nuevoNumero;\n  });\n}\n\nfunction agregarNuevoPasajero() {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    const nuevoNumero = pasajeros.length + 1;\n    \n    const nuevoPasajero = crearFormularioPasajero(nuevoNumero);\n    container.appendChild(nuevoPasajero);\n    \n    // Abrir automáticamente el nuevo pasajero\n    const content = nuevoPasajero.querySelector(\".pasajero-content\");\n    const arrow = nuevoPasajero.querySelector(\".arrow\");\n    if (content && arrow) {\n      content.style.display = \"block\";\n      arrow.style.transform = \"rotate(180deg)\";\n    }\n    \n    // Scroll suave hacia el nuevo pasajero\n    if (nuevoPasajero.scrollIntoView) {\n      nuevoPasajero.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n    }\n    \n    // Actualizar estado del botón después de agregar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    throw error;\n  }\n}\n\nfunction guardarDatos() {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      mostrarMensaje(\"No se encontró el contenedor de pasajeros\", \"error\");\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    if (pasajeros.length === 0) {\n      mostrarMensaje(\"No hay pasajeros para guardar. Por favor, extraiga datos primero.\", \"info\");\n      return;\n    }\n    \n    const todosPasajeros = [];\n    \n    pasajeros.forEach((pasajeroDiv, index) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      \n      // Obtener valores directamente del DOM del pasajero\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      if (content) {\n        const datos = {\n          numeroPasajero: index + 1, // Número secuencial para el guardado\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        todosPasajeros.push(datos);\n      }\n    });\n    \n    // Aquí puedes enviar los datos a tu backend/base de datos\n    // Por ejemplo: enviar a Azure Function, API, etc.\n    // fetch('tu-api-url', {\n    //   method: 'POST',\n    //   headers: { 'Content-Type': 'application/json' },\n    //   body: JSON.stringify(todosPasajeros)\n    // });\n    \n    mostrarMensaje(`Datos de ${todosPasajeros.length} pasajero(s) guardados correctamente`, \"success\");\n  } catch (error) {\n    throw error;\n  }\n}\n\nfunction llenarDatosPasajeros(datosPasajeros) {\n  // Función auxiliar para llenar los datos extraídos por la IA\n  // Esperar un poco para asegurar que los selects estén poblados\n  setTimeout(() => {\n    datosPasajeros.forEach((datos, index) => {\n      const numero = index + 1;\n      \n      if (document.getElementById(`tipoPasajero_${numero}`)) {\n        // Mapear passengerType o paxType de la IA a tipoPasajero del formulario\n        let tipoPasajero = \"\";\n        const passengerType = datos.passengerType || datos.paxType;\n        if (passengerType === \"ADU\") tipoPasajero = \"adulto\";\n        else if (passengerType === \"CHD\") tipoPasajero = \"menor\";\n        else if (passengerType === \"INF\") tipoPasajero = \"infante\";\n        \n        // Los valores de sex, documentType y nationality ahora vienen normalizados del backend\n        // sex viene como código: \"M\" o \"F\"\n        // documentType viene como código: \"DNI\", \"PAS\", \"CI\", etc.\n        // nationality viene como nombre completo en mayúsculas: \"ARGENTINA\", \"BRASIL\", etc.\n        \n        document.getElementById(`tipoPasajero_${numero}`).value = tipoPasajero;\n        document.getElementById(`nombre_${numero}`).value = datos.firstName || \"\";\n        document.getElementById(`apellido_${numero}`).value = datos.lastName || \"\";\n        document.getElementById(`dni_${numero}`).value = datos.documentNumber || \"\";\n        // El backend envía dateOfBirth, no birthDate\n        document.getElementById(`fechaNacimiento_${numero}`).value = datos.dateOfBirth || datos.birthDate || \"\";\n        document.getElementById(`cuil_${numero}`).value = datos.cuilCuit || \"\";\n        \n        // Usar los códigos directamente tal como vienen del backend\n        const tipoDocSelect = document.getElementById(`tipoDoc_${numero}`);\n        if (tipoDocSelect && datos.documentType) {\n          tipoDocSelect.value = datos.documentType;\n          console.log(`✅ Tipo Doc ${numero}: ${datos.documentType} -> ${tipoDocSelect.value}`);\n        }\n        \n        const sexoSelect = document.getElementById(`sexo_${numero}`);\n        if (sexoSelect && datos.sex) {\n          sexoSelect.value = datos.sex;\n          console.log(`✅ Sexo ${numero}: ${datos.sex} -> ${sexoSelect.value}`);\n        }\n        \n        const nacionalidadSelect = document.getElementById(`nacionalidad_${numero}`);\n        if (nacionalidadSelect && datos.nationality) {\n          nacionalidadSelect.value = datos.nationality;\n          console.log(`✅ Nacionalidad ${numero}: ${datos.nationality} -> ${nacionalidadSelect.value}`);\n        }\n        \n        document.getElementById(`direccion_${numero}`).value = datos.direccion || \"\";\n        // El backend envía phoneNumber, no telefono\n        document.getElementById(`telefono_${numero}`).value = datos.phoneNumber || datos.telefono || \"\";\n      }\n    });\n    \n    // Actualizar estado del botón después de llenar los datos\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  }, 150); // Esperar 150ms para que los selects se pueblen primero\n}\n\n/**\n * Llena los datos de la reserva extraídos por la IA\n */\nfunction llenarDatosReserva(datosExtraidos) {\n  // Repoblar los selects de reserva primero para asegurar que tengan opciones\n  poblarSelectReserva();\n  \n  // Esperar un poco más para asegurar que los selects estén poblados\n  setTimeout(() => {\n    // Tipo de Reserva\n    const tipoReservaSelect = document.getElementById(\"tipoReserva\");\n    if (tipoReservaSelect) {\n      const valorTipoReserva = datosExtraidos.reservationType;\n      console.log(`🔍 Intentando asignar Tipo Reserva: \"${valorTipoReserva}\"`);\n      console.log(`📋 Opciones en select:`, Array.from(tipoReservaSelect.options).map(o => `\"${o.value}\"`));\n      \n      if (valorTipoReserva && valorTipoReserva !== 'null' && valorTipoReserva !== null) {\n        tipoReservaSelect.value = valorTipoReserva;\n        console.log(`✅ Tipo Reserva asignado: \"${valorTipoReserva}\" -> \"${tipoReservaSelect.value}\"`);\n        \n        // Si no se seleccionó, intentar buscar una coincidencia parcial\n        if (!tipoReservaSelect.value || tipoReservaSelect.value === \"\") {\n          const opciones = Array.from(tipoReservaSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorTipoReserva &&\n            (opt.value.toUpperCase().includes(valorTipoReserva.toUpperCase()) ||\n            valorTipoReserva.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            tipoReservaSelect.value = coincidencia.value;\n            console.log(`✅ Tipo Reserva (coincidencia): \"${valorTipoReserva}\" -> \"${tipoReservaSelect.value}\"`);\n          } else {\n            console.warn(`⚠️ No se encontró coincidencia para Tipo Reserva: \"${valorTipoReserva}\"`);\n          }\n        }\n      }\n    }\n    \n    // Estado\n    const estadoReservaSelect = document.getElementById(\"estadoReserva\");\n    if (estadoReservaSelect) {\n      const valorEstado = datosExtraidos.status;\n      const opcionesDisponibles = Array.from(estadoReservaSelect.options).map(o => o.value);\n      \n      console.log(`🔍 Intentando asignar Estado: \"${valorEstado}\"`);\n      console.log(`📋 Opciones disponibles en select Estado:`, opcionesDisponibles);\n      console.log(`📊 Total de opciones: ${opcionesDisponibles.length}`);\n      \n      if (valorEstado && valorEstado !== 'null' && valorEstado !== null) {\n        // Intentar asignación directa\n        estadoReservaSelect.value = valorEstado;\n        console.log(`🔄 Intento directo: \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n        \n        // Si no se seleccionó, intentar buscar una coincidencia\n        if (!estadoReservaSelect.value || estadoReservaSelect.value === \"\") {\n          console.log(`⚠️ Asignación directa falló, buscando coincidencia...`);\n          \n          const opciones = Array.from(estadoReservaSelect.options);\n          \n          // Intentar coincidencia exacta ignorando espacios y mayúsculas\n          let coincidencia = opciones.find(opt => \n            opt.value && \n            opt.value.trim().toUpperCase() === valorEstado.trim().toUpperCase()\n          );\n          \n          if (coincidencia) {\n            estadoReservaSelect.value = coincidencia.value;\n            console.log(`✅ Estado (coincidencia exacta): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n          } else {\n            // Intentar coincidencia parcial\n            coincidencia = opciones.find(opt => \n              opt.value && valorEstado &&\n              (opt.value.toUpperCase().includes(valorEstado.toUpperCase()) ||\n              valorEstado.toUpperCase().includes(opt.value.toUpperCase()))\n            );\n            \n            if (coincidencia) {\n              estadoReservaSelect.value = coincidencia.value;\n              console.log(`✅ Estado (coincidencia parcial): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n            } else {\n              // Intentar mapeo inteligente por palabras clave\n              const valorUpper = valorEstado.toUpperCase();\n              \n              if (valorUpper.includes('CONFIRMAD') || valorUpper.includes('CONFIRM')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('CONFIRMAD'));\n              } else if (valorUpper.includes('PENDIENTE') || valorUpper.includes('PENDING')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('PENDIENTE'));\n              } else if (valorUpper.includes('CANCELAD') || valorUpper.includes('CANCEL')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('CANCELAD'));\n              }\n              \n              if (coincidencia) {\n                estadoReservaSelect.value = coincidencia.value;\n                console.log(`✅ Estado (mapeo inteligente): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n              } else {\n                console.error(`❌ No se encontró ninguna coincidencia para Estado: \"${valorEstado}\"`);\n                console.log(`💡 Sugerencia: Verifica que el valor extraído coincida con alguna de estas opciones:`, opcionesDisponibles);\n              }\n            }\n          }\n        } else {\n          console.log(`✅ Estado asignado correctamente: \"${estadoReservaSelect.value}\"`);\n        }\n      } else {\n        console.log(`⚠️ Estado es null o inválido: \"${valorEstado}\"`);\n      }\n    }\n    \n    // Fecha de Viaje\n    if (document.getElementById(\"fechaViaje\")) {\n      document.getElementById(\"fechaViaje\").value = datosExtraidos.travelDate || \"\";\n      console.log(`✅ Fecha Viaje: ${datosExtraidos.travelDate}`);\n    }\n    \n    // Vendedor\n    const vendedorSelect = document.getElementById(\"vendedor\");\n    if (vendedorSelect) {\n      const valorVendedor = datosExtraidos.seller;\n      if (valorVendedor && valorVendedor !== 'null' && valorVendedor !== null) {\n        vendedorSelect.value = valorVendedor;\n        console.log(`✅ Vendedor: \"${valorVendedor}\" -> \"${vendedorSelect.value}\"`);\n        \n        // Si no se seleccionó, intentar buscar una coincidencia parcial\n        if (!vendedorSelect.value || vendedorSelect.value === \"\") {\n          const opciones = Array.from(vendedorSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorVendedor &&\n            (opt.value.toUpperCase().includes(valorVendedor.toUpperCase()) ||\n            valorVendedor.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            vendedorSelect.value = coincidencia.value;\n            console.log(`✅ Vendedor (coincidencia): \"${valorVendedor}\" -> \"${vendedorSelect.value}\"`);\n          }\n        }\n      } else {\n        console.log(`⚠️ Vendedor es null o inválido: \"${valorVendedor}\"`);\n      }\n    }\n    \n    // Cliente\n    const clienteSelect = document.getElementById(\"cliente\");\n    if (clienteSelect) {\n      const valorCliente = datosExtraidos.client;\n      if (valorCliente && valorCliente !== 'null' && valorCliente !== null) {\n        clienteSelect.value = valorCliente;\n        console.log(`✅ Cliente: \"${valorCliente}\" -> \"${clienteSelect.value}\"`);\n        \n        // Si no se seleccionó, intentar buscar una coincidencia parcial\n        if (!clienteSelect.value || clienteSelect.value === \"\") {\n          const opciones = Array.from(clienteSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorCliente &&\n            (opt.value.toUpperCase().includes(valorCliente.toUpperCase()) ||\n            valorCliente.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            clienteSelect.value = coincidencia.value;\n            console.log(`✅ Cliente (coincidencia): \"${valorCliente}\" -> \"${clienteSelect.value}\"`);\n          }\n        }\n      } else {\n        console.log(`⚠️ Cliente es null o inválido: \"${valorCliente}\"`);\n      }\n    }\n    \n    // Campos adicionales de la reserva\n    // Código\n    if (document.getElementById(\"codigo\")) {\n      document.getElementById(\"codigo\").value = datosExtraidos.codigo || \"\";\n    }\n    \n    // Fecha de Reserva\n    if (document.getElementById(\"fechaReserva\")) {\n      document.getElementById(\"fechaReserva\").value = datosExtraidos.reservationDate || \"\";\n    }\n    \n    // Fecha Fin de Tour\n    if (document.getElementById(\"fechaFinTour\")) {\n      document.getElementById(\"fechaFinTour\").value = datosExtraidos.tourEndDate || \"\";\n    }\n    \n    // Fecha de Vencimiento\n    if (document.getElementById(\"fechaVencimiento\")) {\n      document.getElementById(\"fechaVencimiento\").value = datosExtraidos.dueDate || \"\";\n    }\n    \n    // Contacto\n    if (document.getElementById(\"contacto\")) {\n      document.getElementById(\"contacto\").value = datosExtraidos.contact || \"\";\n    }\n    \n    // Email de Contacto\n    if (document.getElementById(\"contactEmail\")) {\n      document.getElementById(\"contactEmail\").value = datosExtraidos.contactEmail || \"\";\n    }\n    \n    // Teléfono de Contacto\n    if (document.getElementById(\"contactPhone\")) {\n      document.getElementById(\"contactPhone\").value = datosExtraidos.contactPhone || \"\";\n    }\n    \n    // Moneda\n    if (document.getElementById(\"moneda\")) {\n      document.getElementById(\"moneda\").value = datosExtraidos.currency || \"\";\n    }\n    \n    // Tipo de Cambio\n    if (document.getElementById(\"tipoCambio\")) {\n      document.getElementById(\"tipoCambio\").value = datosExtraidos.exchangeRate || \"\";\n    }\n    \n    // Comisión\n    if (document.getElementById(\"comision\")) {\n      document.getElementById(\"comision\").value = datosExtraidos.commission || \"\";\n    }\n    \n    // Monto Neto\n    if (document.getElementById(\"montoNeto\")) {\n      document.getElementById(\"montoNeto\").value = datosExtraidos.netAmount || \"\";\n    }\n    \n    // Monto Bruto\n    if (document.getElementById(\"montoBruto\")) {\n      document.getElementById(\"montoBruto\").value = datosExtraidos.grossAmount || \"\";\n    }\n    \n    // Nombre del Viaje\n    if (document.getElementById(\"nombreViaje\")) {\n      document.getElementById(\"nombreViaje\").value = datosExtraidos.tripName || \"\";\n    }\n    \n    // Código de Producto\n    if (document.getElementById(\"codigoProducto\")) {\n      document.getElementById(\"codigoProducto\").value = datosExtraidos.productCode || \"\";\n    }\n    \n    // Adultos\n    if (document.getElementById(\"adultos\")) {\n      document.getElementById(\"adultos\").value = datosExtraidos.adults || \"\";\n    }\n    \n    // Niños\n    if (document.getElementById(\"ninos\")) {\n      document.getElementById(\"ninos\").value = datosExtraidos.children || \"\";\n    }\n    \n    // Infantes\n    if (document.getElementById(\"infantes\")) {\n      document.getElementById(\"infantes\").value = datosExtraidos.infants || \"\";\n    }\n    \n    // Proveedor\n    if (document.getElementById(\"proveedor\")) {\n      document.getElementById(\"proveedor\").value = datosExtraidos.provider || \"\";\n    }\n    \n    // Código de Reserva\n    if (document.getElementById(\"codigoReserva\")) {\n      document.getElementById(\"codigoReserva\").value = datosExtraidos.reservationCode || \"\";\n    }\n    \n    // Hotel (ahora es un objeto) - Solo mostrar si viene de la extracción\n    const hotelSection = document.getElementById(\"hotelSection\");\n    const agregarHotelButton = document.getElementById(\"agregarHotel\");\n    \n    if (datosExtraidos.hotel && typeof datosExtraidos.hotel === 'object') {\n      // Mostrar sección de hotel y hacer campos required\n      if (hotelSection) {\n        hotelSection.style.display = \"block\";\n      }\n      if (agregarHotelButton) {\n        agregarHotelButton.style.display = \"none\";\n      }\n      \n      // Llenar campos y hacerlos required\n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.required = true;\n        }\n      });\n      \n      if (document.getElementById(\"hotel_nombre\")) {\n        document.getElementById(\"hotel_nombre\").value = datosExtraidos.hotel.nombre_hotel || \"\";\n      }\n      if (document.getElementById(\"hotel_tipo_habitacion\")) {\n        document.getElementById(\"hotel_tipo_habitacion\").value = datosExtraidos.hotel.tipo_habitacion || \"\";\n      }\n      if (document.getElementById(\"hotel_ciudad\")) {\n        document.getElementById(\"hotel_ciudad\").value = datosExtraidos.hotel.Ciudad || \"\";\n      }\n      if (document.getElementById(\"hotel_categoria\")) {\n        document.getElementById(\"hotel_categoria\").value = datosExtraidos.hotel.Categoria || \"\";\n      }\n      if (document.getElementById(\"hotel_in\")) {\n        document.getElementById(\"hotel_in\").value = datosExtraidos.hotel.in || \"\";\n      }\n      if (document.getElementById(\"hotel_out\")) {\n        document.getElementById(\"hotel_out\").value = datosExtraidos.hotel.out || \"\";\n      }\n    } else if (typeof datosExtraidos.hotel === 'string') {\n      // Compatibilidad con formato antiguo (solo texto)\n      if (hotelSection) {\n        hotelSection.style.display = \"block\";\n      }\n      if (agregarHotelButton) {\n        agregarHotelButton.style.display = \"none\";\n      }\n      \n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.required = true;\n        }\n      });\n      \n      if (document.getElementById(\"hotel_nombre\")) {\n        document.getElementById(\"hotel_nombre\").value = datosExtraidos.hotel || \"\";\n      }\n    } else {\n      // No hay hotel - ocultar sección y mostrar botón\n      if (hotelSection) {\n        hotelSection.style.display = \"none\";\n      }\n      if (agregarHotelButton) {\n        agregarHotelButton.style.display = \"block\";\n      }\n      \n      // Quitar required de campos de hotel\n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.required = false;\n          campo.value = \"\";\n        }\n      });\n    }\n    \n    // Check In\n    if (document.getElementById(\"checkIn\")) {\n      document.getElementById(\"checkIn\").value = datosExtraidos.checkIn || \"\";\n    }\n    \n    // Check Out\n    if (document.getElementById(\"checkOut\")) {\n      document.getElementById(\"checkOut\").value = datosExtraidos.checkOut || \"\";\n    }\n    \n    // Estado de Deuda\n    if (document.getElementById(\"estadoDeuda\")) {\n      document.getElementById(\"estadoDeuda\").value = datosExtraidos.estadoDeuda || \"\";\n    }\n    \n    // Llenar servicios si existen\n    const serviciosSection = document.getElementById(\"serviciosSection\");\n    const agregarServicioButton = document.getElementById(\"agregarServicio\");\n    \n    if (datosExtraidos.services && Array.isArray(datosExtraidos.services) && datosExtraidos.services.length > 0) {\n      if (serviciosSection) {\n        serviciosSection.style.display = \"block\";\n      }\n      llenarServicios(datosExtraidos.services);\n    } else {\n      // Si no hay servicios, ocultar la sección pero mantener el botón visible\n      if (serviciosSection) {\n        serviciosSection.style.display = \"none\";\n      }\n    }\n    \n    // El botón de agregar servicio siempre está visible (definido en HTML)\n    \n    // Llenar vuelos si existen\n    if (datosExtraidos.flights && Array.isArray(datosExtraidos.flights) && datosExtraidos.flights.length > 0) {\n      const vuelosSection = document.getElementById(\"vuelosSection\");\n      if (vuelosSection) {\n        vuelosSection.style.display = \"block\";\n      }\n      llenarVuelos(datosExtraidos.flights);\n    }\n    \n    // Actualizar estado del botón después de llenar los datos\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  }, 250); // Esperar 250ms para asegurar que los selects estén poblados\n}\n\n/**\n * Encuentra el mejor servicio coincidente usando regex y comparación de palabras\n * @param {string} servicioBackend - Nombre del servicio que viene del backend\n * @returns {string|null} - El servicio más coincidente o null si no hay coincidencias suficientes\n */\nfunction encontrarServicioCoincidente(servicioBackend) {\n  if (!servicioBackend || typeof servicioBackend !== 'string') {\n    return null;\n  }\n  \n  const servicioNormalizado = servicioBackend.trim().toUpperCase();\n  const palabrasBackend = servicioNormalizado.split(/\\s+/).filter(p => p.length > 0);\n  \n  if (palabrasBackend.length === 0) {\n    return null;\n  }\n  \n  let mejorCoincidencia = null;\n  let maxCoincidencias = 0;\n  let mejorPuntuacion = 0;\n  \n  // Palabras clave importantes que dan más peso a la coincidencia\n  const palabrasClave = ['BODEGA', 'BODEGAS', 'TRASLADO', 'EXCURSION', 'TOUR', 'ALMUERZO', 'CENA', 'HOTEL', 'SPA', 'CABALGATA'];\n  \n  servicesList.forEach(servicioLista => {\n    const servicioListaNormalizado = servicioLista.trim().toUpperCase();\n    const palabrasLista = servicioListaNormalizado.split(/\\s+/).filter(p => p.length > 0);\n    \n    // Contar palabras que coinciden\n    let coincidencias = 0;\n    let puntuacion = 0;\n    \n    palabrasBackend.forEach(palabraBackend => {\n      // Buscar la palabra en la lista (coincidencia exacta o parcial)\n      const encontrado = palabrasLista.some(palabraLista => {\n        // Coincidencia exacta\n        if (palabraLista === palabraBackend) {\n          // Dar más peso si es una palabra clave\n          if (palabrasClave.includes(palabraBackend)) {\n            puntuacion += 2;\n          } else {\n            puntuacion += 1;\n          }\n          return true;\n        }\n        // Coincidencia parcial (una contiene a la otra)\n        if (palabraLista.includes(palabraBackend) || palabraBackend.includes(palabraLista)) {\n          // Solo contar si ambas palabras tienen al menos 3 caracteres para evitar falsos positivos\n          if (palabraBackend.length >= 3 && palabraLista.length >= 3) {\n            // Dar peso reducido a coincidencias parciales\n            if (palabrasClave.includes(palabraBackend) || palabrasClave.includes(palabraLista)) {\n              puntuacion += 1;\n            } else {\n              puntuacion += 0.5;\n            }\n            return true;\n          }\n        }\n        return false;\n      });\n      \n      if (encontrado) {\n        coincidencias++;\n      }\n    });\n    \n    // Si hay más de una palabra coincidente, considerar esta opción\n    // O si hay una coincidencia muy significativa (palabra clave con alta puntuación)\n    if (coincidencias > maxCoincidencias && (coincidencias > 1 || puntuacion >= 2)) {\n      maxCoincidencias = coincidencias;\n      mejorPuntuacion = puntuacion;\n      mejorCoincidencia = servicioLista;\n    } else if (coincidencias === maxCoincidencias && puntuacion > mejorPuntuacion) {\n      // Si hay el mismo número de coincidencias, elegir el de mayor puntuación\n      mejorPuntuacion = puntuacion;\n      mejorCoincidencia = servicioLista;\n    }\n  });\n  \n  // Si encontramos al menos 2 palabras coincidentes, o una coincidencia muy significativa\n  if (maxCoincidencias >= 2 || mejorPuntuacion >= 2) {\n    return mejorCoincidencia;\n  }\n  \n  return null;\n}\n\n/**\n * Crea un elemento de servicio en el formulario\n * @param {number} index - Índice del servicio\n * @param {Object} servicio - Datos del servicio (opcional)\n * @param {boolean} esDeExtraccion - Si el servicio viene de la extracción de IA\n * @returns {HTMLElement} El elemento div del servicio\n */\nfunction crearElementoServicio(index, servicio = {}, esDeExtraccion = false) {\n  const servicioDiv = document.createElement(\"div\");\n  servicioDiv.className = \"servicio-item\";\n  \n  // Intentar encontrar el servicio coincidente\n  const servicioCoincidente = servicio.servicio \n    ? encontrarServicioCoincidente(servicio.servicio)\n    : null;\n  \n  // Crear el HTML con un datalist para autocompletado\n  const datalistId = `serviciosList_${index}`;\n  const requiredAttr = esDeExtraccion ? 'required' : '';\n  const requiredSpan = esDeExtraccion ? '<span style=\"color: red;\">*</span>' : '';\n  \n  servicioDiv.dataset.servicioIndex = index;\n  servicioDiv.innerHTML = `\n    <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;\">\n      <h4 style=\"margin: 0;\">Servicio ${index + 1}</h4>\n      <button class=\"btn-eliminar-servicio\" title=\"Eliminar servicio\" data-servicio-index=\"${index}\">✕</button>\n    </div>\n    <div class=\"form-group\">\n      <label>Destino: ${requiredSpan}</label>\n      <input type=\"text\" id=\"servicio_destino_${index}\" value=\"${servicio.destino || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Fecha Entrada: ${requiredSpan}</label>\n      <input type=\"date\" id=\"servicio_in_${index}\" value=\"${servicio.in || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Fecha Salida: ${requiredSpan}</label>\n      <input type=\"date\" id=\"servicio_out_${index}\" value=\"${servicio.out || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Noches: ${requiredSpan}</label>\n      <input type=\"number\" id=\"servicio_nts_${index}\" value=\"${servicio.nts || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Base Pax: ${requiredSpan}</label>\n      <input type=\"number\" id=\"servicio_basePax_${index}\" value=\"${servicio.basePax || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Servicio: ${requiredSpan}</label>\n      <input type=\"text\" id=\"servicio_servicio_${index}\" \n             list=\"${datalistId}\" \n             value=\"${servicioCoincidente || servicio.servicio || ''}\" \n             placeholder=\"Buscar o escribir servicio...\"\n             ${requiredAttr}>\n      <datalist id=\"${datalistId}\">\n        ${servicesList.map(s => `<option class=\"servicio-option\" value=\"${s}\">${s}</option>`).join('')}\n      </datalist>\n    </div>\n    <div class=\"form-group\">\n      <label>Descripción: ${requiredSpan}</label>\n      <textarea id=\"servicio_descripcion_${index}\" ${requiredAttr}>${servicio.descripcion || ''}</textarea>\n    </div>\n    <div class=\"form-group\">\n      <label>Estado: ${requiredSpan}</label>\n      <input type=\"text\" id=\"servicio_estado_${index}\" value=\"${servicio.estado || ''}\" ${requiredAttr}>\n    </div>\n  `;\n  \n  // Agregar event listeners para validación en tiempo real\n  setTimeout(() => {\n    const camposServicio = [\n      `servicio_destino_${index}`,\n      `servicio_in_${index}`,\n      `servicio_out_${index}`,\n      `servicio_nts_${index}`,\n      `servicio_basePax_${index}`,\n      `servicio_servicio_${index}`,\n      `servicio_descripcion_${index}`,\n      `servicio_estado_${index}`\n    ];\n    \n    camposServicio.forEach(campoId => {\n      const campo = document.getElementById(campoId);\n      if (campo) {\n        campo.addEventListener('change', actualizarEstadoBotonCrearReserva);\n        campo.addEventListener('input', actualizarEstadoBotonCrearReserva);\n      }\n    });\n    \n    // Agregar event listener al botón de eliminar\n    const btnEliminar = servicioDiv.querySelector('.btn-eliminar-servicio');\n    if (btnEliminar) {\n      btnEliminar.onclick = function(e) {\n        e.stopPropagation();\n        eliminarServicio(servicioDiv);\n      };\n    }\n  }, 100);\n  \n  return servicioDiv;\n}\n\n/**\n * Llena los servicios en el formulario\n * @param {Array} servicios - Array de servicios extraídos\n */\nfunction llenarServicios(servicios) {\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  if (!serviciosContainer) return;\n  \n  serviciosContainer.innerHTML = \"\";\n  \n  // Mostrar sección de servicios\n  if (serviciosSection) {\n    serviciosSection.style.display = \"block\";\n  }\n  \n  servicios.forEach((servicio, index) => {\n    const servicioDiv = crearElementoServicio(index, servicio, true);\n    serviciosContainer.appendChild(servicioDiv);\n  });\n  \n  // Actualizar estado del botón después de crear los servicios\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\n/**\n * Agrega un nuevo servicio manualmente\n */\nfunction agregarNuevoServicio() {\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  \n  if (!serviciosContainer) return;\n  \n  // Mostrar sección si está oculta\n  if (serviciosSection) {\n    serviciosSection.style.display = \"block\";\n  }\n  \n  // Contar servicios existentes\n  const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n  const nuevoIndex = servicioItems.length;\n  \n  // Crear nuevo servicio (sin required porque es manual)\n  const nuevoServicio = crearElementoServicio(nuevoIndex, {}, false);\n  serviciosContainer.appendChild(nuevoServicio);\n  \n  // Scroll suave hacia el nuevo servicio\n  if (nuevoServicio.scrollIntoView) {\n    nuevoServicio.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n  }\n  \n  // Actualizar estado del botón\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\n/**\n * Muestra la sección de hotel y hace los campos required\n */\nfunction mostrarSeccionHotel() {\n  const hotelSection = document.getElementById(\"hotelSection\");\n  const agregarHotelButton = document.getElementById(\"agregarHotel\");\n  \n  if (hotelSection) {\n    hotelSection.style.display = \"block\";\n  }\n  \n  if (agregarHotelButton) {\n    agregarHotelButton.style.display = \"none\";\n  }\n  \n  // Hacer campos required cuando se agrega manualmente\n  const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n  camposHotel.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.required = true;\n    }\n  });\n  \n  // Actualizar estado del botón\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\n/**\n * Elimina un servicio del formulario\n * @param {HTMLElement} servicioDiv - El elemento div del servicio a eliminar\n */\nfunction eliminarServicio(servicioDiv) {\n  try {\n    const serviciosContainer = document.getElementById(\"serviciosContainer\");\n    if (!serviciosContainer) return;\n    \n    const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n    \n    // No permitir eliminar si solo hay un servicio y es de extracción (required)\n    if (servicioItems.length <= 1) {\n      const primerCampo = servicioDiv.querySelector(\"[required]\");\n      if (primerCampo) {\n        mostrarMensaje(\"Debe haber al menos un servicio cuando vienen de la extracción\", \"info\");\n        return;\n      }\n    }\n    \n    // Eliminar el servicio\n    servicioDiv.remove();\n    \n    // Renumerar servicios\n    renumerarServicios();\n    \n    mostrarMensaje(\"Servicio eliminado correctamente\", \"success\");\n    \n    // Actualizar estado del botón después de eliminar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    mostrarMensaje(\"Error al eliminar servicio\", \"error\");\n  }\n}\n\n/**\n * Renumera los servicios después de eliminar uno\n */\nfunction renumerarServicios() {\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  if (!serviciosContainer) return;\n  \n  const servicioItems = Array.from(serviciosContainer.querySelectorAll(\".servicio-item\"));\n  \n  servicioItems.forEach((servicioDiv, index) => {\n    const nuevoIndex = index;\n    \n    // Actualizar el dataset\n    servicioDiv.dataset.servicioIndex = nuevoIndex;\n    \n    // Actualizar el título\n    const tituloDiv = servicioDiv.querySelector(\"div:first-child\");\n    if (tituloDiv) {\n      const titulo = tituloDiv.querySelector(\"h4\");\n      if (titulo) {\n        titulo.textContent = `Servicio ${nuevoIndex + 1}`;\n      }\n    }\n    \n    // Actualizar IDs de todos los campos - buscar por patrón dentro del div\n    const campos = [\n      'servicio_destino',\n      'servicio_in',\n      'servicio_out',\n      'servicio_nts',\n      'servicio_basePax',\n      'servicio_servicio',\n      'servicio_descripcion',\n      'servicio_estado'\n    ];\n    \n    campos.forEach(campoBase => {\n      // Buscar el campo dentro del servicioDiv por el patrón del ID\n      const campoViejo = servicioDiv.querySelector(`[id^=\"${campoBase}_\"]`);\n      if (campoViejo) {\n        campoViejo.id = `${campoBase}_${nuevoIndex}`;\n        \n        // Actualizar el list del datalist si es el campo servicio\n        if (campoBase === 'servicio_servicio') {\n          const datalistId = `serviciosList_${nuevoIndex}`;\n          campoViejo.setAttribute('list', datalistId);\n          \n          // Actualizar el datalist\n          const datalist = servicioDiv.querySelector('datalist');\n          if (datalist) {\n            datalist.id = datalistId;\n          }\n        }\n      }\n    });\n    \n    // Actualizar el data-servicio-index del botón eliminar\n    const btnEliminar = servicioDiv.querySelector('.btn-eliminar-servicio');\n    if (btnEliminar) {\n      btnEliminar.setAttribute('data-servicio-index', nuevoIndex);\n    }\n  });\n}\n\n/**\n * Llena los vuelos en el formulario\n * @param {Array} vuelos - Array de vuelos extraídos\n */\nfunction llenarVuelos(vuelos) {\n  const vuelosContainer = document.getElementById(\"vuelosContainer\");\n  if (!vuelosContainer) return;\n  \n  vuelosContainer.innerHTML = \"\";\n  \n  vuelos.forEach((vuelo, index) => {\n    const vueloDiv = document.createElement(\"div\");\n    vueloDiv.className = \"vuelo-item\";\n    vueloDiv.innerHTML = `\n      <h4>Vuelo ${index + 1}</h4>\n      <div class=\"form-group\">\n        <label>Aerolínea:</label>\n        <input type=\"text\" id=\"vuelo_airline_${index}\" value=\"${vuelo.airline || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Número de Vuelo:</label>\n        <input type=\"text\" id=\"vuelo_flightNumber_${index}\" value=\"${vuelo.flightNumber || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Origen:</label>\n        <input type=\"text\" id=\"vuelo_origin_${index}\" value=\"${vuelo.origin || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Destino:</label>\n        <input type=\"text\" id=\"vuelo_destination_${index}\" value=\"${vuelo.destination || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Fecha:</label>\n        <input type=\"date\" id=\"vuelo_date_${index}\" value=\"${vuelo.date || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Hora:</label>\n        <input type=\"time\" id=\"vuelo_time_${index}\" value=\"${vuelo.time || ''}\" readonly>\n      </div>\n    `;\n    vuelosContainer.appendChild(vueloDiv);\n  });\n}\n\n/**\n * Valida si todos los campos obligatorios están completos\n * @returns {boolean} true si todos los campos están completos\n */\nfunction validarCamposObligatorios() {\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (!container) return false;\n  \n  const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n  if (pasajeros.length === 0) return false;\n  \n  // Validar pasajeros (solo nombre y apellido)\n  let pasajerosValidos = true;\n  pasajeros.forEach((pasajeroDiv) => {\n    const numero = pasajeroDiv.dataset.numeroPasajero;\n    const content = pasajeroDiv.querySelector(\".pasajero-content\");\n    \n    if (content) {\n      const nombre = content.querySelector(`#nombre_${numero}`)?.value || \"\";\n      const apellido = content.querySelector(`#apellido_${numero}`)?.value || \"\";\n      \n      if (nombre.trim() === \"\" || apellido.trim() === \"\") {\n        pasajerosValidos = false;\n      }\n    }\n  });\n  \n  // Validar datos de reserva (todos obligatorios)\n  const tipoReserva = document.getElementById(\"tipoReserva\")?.value || \"\";\n  const estadoReserva = document.getElementById(\"estadoReserva\")?.value || \"\";\n  const fechaViaje = document.getElementById(\"fechaViaje\")?.value || \"\";\n  const vendedor = document.getElementById(\"vendedor\")?.value || \"\";\n  const cliente = document.getElementById(\"cliente\")?.value || \"\";\n  \n  const reservaValida = \n    tipoReserva.trim() !== \"\" &&\n    estadoReserva.trim() !== \"\" &&\n    fechaViaje.trim() !== \"\" &&\n    vendedor.trim() !== \"\" &&\n    cliente.trim() !== \"\";\n  \n  // Validar campos obligatorios del hotel (solo si la sección está visible)\n  const hotelSection = document.getElementById(\"hotelSection\");\n  let hotelValido = true;\n  \n  if (hotelSection && hotelSection.style.display !== \"none\") {\n    const hotelNombre = document.getElementById(\"hotel_nombre\");\n    const hotelTipoHabitacion = document.getElementById(\"hotel_tipo_habitacion\");\n    const hotelCiudad = document.getElementById(\"hotel_ciudad\");\n    const hotelIn = document.getElementById(\"hotel_in\");\n    const hotelOut = document.getElementById(\"hotel_out\");\n    \n    // Solo validar si los campos son required\n    if (hotelNombre?.required && (!hotelNombre.value || hotelNombre.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelTipoHabitacion?.required && (!hotelTipoHabitacion.value || hotelTipoHabitacion.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelCiudad?.required && (!hotelCiudad.value || hotelCiudad.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelIn?.required && (!hotelIn.value || hotelIn.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelOut?.required && (!hotelOut.value || hotelOut.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n  }\n  \n  // Validar campos obligatorios de servicios (solo si la sección está visible)\n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  let serviciosValidos = true;\n  \n  if (serviciosSection && serviciosSection.style.display !== \"none\" && serviciosContainer) {\n    const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n    \n    if (servicioItems.length > 0) {\n      servicioItems.forEach((item, index) => {\n        const destino = document.getElementById(`servicio_destino_${index}`);\n        const servicioIn = document.getElementById(`servicio_in_${index}`);\n        const servicioOut = document.getElementById(`servicio_out_${index}`);\n        const nts = document.getElementById(`servicio_nts_${index}`);\n        const basePax = document.getElementById(`servicio_basePax_${index}`);\n        const servicio = document.getElementById(`servicio_servicio_${index}`);\n        const descripcion = document.getElementById(`servicio_descripcion_${index}`);\n        const estado = document.getElementById(`servicio_estado_${index}`);\n        \n        // Solo validar si los campos son required\n        if (destino?.required && (!destino.value || destino.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (servicioIn?.required && (!servicioIn.value || servicioIn.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (servicioOut?.required && (!servicioOut.value || servicioOut.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (nts?.required && (!nts.value || nts.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (basePax?.required && (!basePax.value || basePax.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (servicio?.required && (!servicio.value || servicio.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (descripcion?.required && (!descripcion.value || descripcion.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (estado?.required && (!estado.value || estado.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n      });\n    }\n  }\n  \n  return pasajerosValidos && reservaValida && hotelValido && serviciosValidos;\n}\n\n/**\n * Actualiza el texto del botón según si es crear o editar\n * @param {boolean} isEdit - Si es true, muestra \"Editar Reserva\"; si es false, muestra \"Crear Reserva\"\n */\nfunction actualizarTextoBotonReserva(isEdit = false) {\n  const boton = document.getElementById(\"crearReserva\");\n  if (!boton) return;\n  \n  const label = boton.querySelector('.ms-Button-label');\n  if (label) {\n    const texto = isEdit \n      ? \"✏️ Editar Reserva en iTraffic\" \n      : \"🚀 Crear Reserva en iTraffic\";\n    label.textContent = texto;\n    console.log('📝 Texto del botón actualizado:', texto, 'isEdit:', isEdit);\n  }\n}\n\n/**\n * Actualiza el estado del botón \"Crear Reserva\" según la validación\n */\nfunction actualizarEstadoBotonCrearReserva() {\n  const boton = document.getElementById(\"crearReserva\");\n  if (!boton) return;\n  \n  const esValido = validarCamposObligatorios();\n  const didExtractionExist = extractionState.didExtractionExist === true;\n  \n  // Log para debug\n  console.log('🔄 actualizarEstadoBotonCrearReserva - didExtractionExist:', didExtractionExist, 'extractionState:', extractionState);\n  \n  // Actualizar el texto del botón según el estado\n  actualizarTextoBotonReserva(didExtractionExist);\n  \n  if (esValido) {\n    boton.disabled = false;\n    boton.style.opacity = \"1\";\n    boton.style.cursor = \"pointer\";\n  } else {\n    boton.disabled = true;\n    boton.style.opacity = \"0.5\";\n    boton.style.cursor = \"not-allowed\";\n  }\n}\n\n/**\n * Deshabilita todos los campos del formulario\n */\nfunction deshabilitarFormularios() {\n  // Deshabilitar campos de pasajeros\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const inputs = container.querySelectorAll(\"input, select\");\n    inputs.forEach(input => {\n      input.disabled = true;\n      input.style.backgroundColor = \"#f3f4f6\";\n      input.style.cursor = \"not-allowed\";\n    });\n    \n    // Deshabilitar botones de eliminar pasajero\n    const botonesEliminar = container.querySelectorAll(\".btn-eliminar-pasajero\");\n    botonesEliminar.forEach(btn => {\n      btn.disabled = true;\n      btn.style.opacity = \"0.3\";\n      btn.style.cursor = \"not-allowed\";\n      btn.style.pointerEvents = \"none\";\n    });\n  }\n  \n  // Deshabilitar campos de reserva\n  const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n  camposReserva.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.disabled = true;\n      campo.style.backgroundColor = \"#f3f4f6\";\n      campo.style.cursor = \"not-allowed\";\n    }\n  });\n  \n  // Deshabilitar botón de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.disabled = true;\n    btnAgregar.style.opacity = \"0.5\";\n    btnAgregar.style.cursor = \"not-allowed\";\n  }\n  \n  // Deshabilitar botón de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.disabled = true;\n    btnGuardar.style.opacity = \"0.5\";\n    btnGuardar.style.cursor = \"not-allowed\";\n  }\n}\n\n/**\n * Resetea la aplicación al estado inicial\n */\nfunction resetearAplicacion() {\n  // Ocultar resultados\n  const resultsDiv = document.getElementById(\"results\");\n  if (resultsDiv) {\n    resultsDiv.style.display = \"none\";\n  }\n  \n  // Mostrar botón de extraer\n  const runButton = document.getElementById(\"run\");\n  if (runButton) {\n    runButton.style.display = \"block\";\n  }\n  \n  // Ocultar botón de re-extracción\n  const reextractButton = document.getElementById(\"reextract\");\n  if (reextractButton) {\n    reextractButton.style.display = \"none\";\n  }\n  \n  // Limpiar contenedores\n  const pasajerosContainer = document.getElementById(\"pasajerosContainer\");\n  if (pasajerosContainer) {\n    pasajerosContainer.innerHTML = \"\";\n  }\n  \n  // Resetear estado de extracción\n  extractionState = {\n    didExtractionExist: false,\n    reservationCode: null,\n    originData: null\n  };\n  \n  // Limpiar formularios de reserva\n  const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n  camposReserva.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.value = \"\";\n    }\n  });\n  \n  // Ocultar secciones de hotel y servicios\n  const hotelSection = document.getElementById(\"hotelSection\");\n  if (hotelSection) {\n    hotelSection.style.display = \"none\";\n  }\n  \n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  if (serviciosSection) {\n    serviciosSection.style.display = \"none\";\n  }\n  \n  const vuelosSection = document.getElementById(\"vuelosSection\");\n  if (vuelosSection) {\n    vuelosSection.style.display = \"none\";\n  }\n  \n  // Ocultar botón de crear otra reserva si existe\n  const botonCrearOtra = document.getElementById(\"crearOtraReserva\");\n  if (botonCrearOtra) {\n    botonCrearOtra.remove();\n  }\n}\n\n/**\n * Convierte los formularios a modo lectura (texto plano)\n */\nfunction convertirAModoLectura() {\n  // Convertir pasajeros a modo lectura\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    \n    pasajeros.forEach((pasajeroDiv) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      \n      if (content) {\n        // Obtener valores actuales\n        const datos = {\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        // Crear HTML en modo lectura\n        content.innerHTML = `\n          <div class=\"campo-lectura\">\n            <label>Tipo de Pasajero:</label>\n            <p>${datos.tipoPasajero || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Nombre:</label>\n            <p>${datos.nombre || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Apellido:</label>\n            <p>${datos.apellido || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>DNI:</label>\n            <p>${datos.dni || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Fecha de Nacimiento:</label>\n            <p>${datos.fechaNacimiento || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>CUIL:</label>\n            <p>${datos.cuil || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Tipo de Documento:</label>\n            <p>${datos.tipoDoc || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Sexo:</label>\n            <p>${datos.sexo || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Nacionalidad:</label>\n            <p>${datos.nacionalidad || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Dirección:</label>\n            <p>${datos.direccion || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Número de Teléfono:</label>\n            <p>${datos.telefono || '-'}</p>\n          </div>\n        `;\n      }\n      \n      // Ocultar botón de eliminar\n      const btnEliminar = pasajeroDiv.querySelector(\".btn-eliminar-pasajero\");\n      if (btnEliminar) {\n        btnEliminar.style.display = \"none\";\n      }\n    });\n  }\n  \n  // Convertir datos de reserva a modo lectura\n  const datosReservaSection = document.getElementById(\"datosReservaSection\");\n  if (datosReservaSection) {\n    const datosReserva = {\n      tipoReserva: document.getElementById(\"tipoReserva\")?.value || \"\",\n      estadoReserva: document.getElementById(\"estadoReserva\")?.value || \"\",\n      fechaViaje: document.getElementById(\"fechaViaje\")?.value || \"\",\n      vendedor: document.getElementById(\"vendedor\")?.value || \"\",\n      cliente: document.getElementById(\"cliente\")?.value || \"\"\n    };\n    \n    datosReservaSection.innerHTML = `\n      <h3>Datos de la Reserva</h3>\n      <div class=\"campo-lectura\">\n        <label>Tipo de Reserva:</label>\n        <p>${datosReserva.tipoReserva || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Estado:</label>\n        <p>${datosReserva.estadoReserva || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Fecha de Viaje:</label>\n        <p>${datosReserva.fechaViaje || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Vendedor:</label>\n        <p>${datosReserva.vendedor || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Cliente:</label>\n        <p>${datosReserva.cliente || '-'}</p>\n      </div>\n    `;\n    \n    // Agregar botón \"Crear otra reserva\" dentro de la misma sección\n    if (!document.getElementById(\"crearOtraReserva\")) {\n      const botonCrearOtra = document.createElement(\"button\");\n      botonCrearOtra.id = \"crearOtraReserva\";\n      botonCrearOtra.className = \"ms-Button\";\n      botonCrearOtra.style.cssText = \"margin-top: 20px; padding: 12px 24px; background: #0078d4; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;\";\n      botonCrearOtra.innerHTML = '<span class=\"ms-Button-label\">➕ Crear otra reserva</span>';\n      botonCrearOtra.onclick = function() {\n        resetearAplicacion();\n      };\n      \n      // Insertar después de la sección de datos de reserva\n      datosReservaSection.appendChild(botonCrearOtra);\n    }\n  }\n  \n  // Ocultar botón de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.style.display = \"none\";\n  }\n  \n  // Ocultar botón de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.style.display = \"none\";\n  }\n  \n  // Ocultar botón de crear reserva\n  const btnCrearReserva = document.getElementById(\"crearReserva\");\n  if (btnCrearReserva) {\n    btnCrearReserva.style.display = \"none\";\n  }\n}\n\n/**\n * Compara dos objetos de datos para detectar cambios en pasajeros, servicios y hotel\n * @param {Object} originData - Data original de la extracción\n * @param {Array} nuevosPasajeros - Pasajeros actuales del formulario\n * @param {Array} nuevosServicios - Servicios actuales del formulario\n * @param {Object} nuevoHotel - Hotel actual del formulario\n * @returns {Object} Objeto con información sobre los cambios detectados\n */\nfunction compararDatos(originData, nuevosPasajeros, nuevosServicios, nuevoHotel) {\n  const cambios = {\n    pasajeros: false,\n    servicios: false,\n    hotel: false,\n    tieneCambios: false\n  };\n  \n  if (!originData) {\n    return cambios;\n  }\n  \n  // Comparar pasajeros\n  const pasajerosOriginales = originData.passengers || [];\n  if (pasajerosOriginales.length !== nuevosPasajeros.length) {\n    cambios.pasajeros = true;\n    cambios.tieneCambios = true;\n  } else {\n    // Comparar cada pasajero\n    for (let i = 0; i < nuevosPasajeros.length; i++) {\n      const nuevo = nuevosPasajeros[i];\n      const original = pasajerosOriginales[i];\n      \n      if (!original || \n          nuevo.nombre !== (original.firstName || '') ||\n          nuevo.apellido !== (original.lastName || '') ||\n          nuevo.dni !== (original.documentNumber || '') ||\n          nuevo.fechaNacimiento !== (original.dateOfBirth || '')) {\n        cambios.pasajeros = true;\n        cambios.tieneCambios = true;\n        break;\n      }\n    }\n  }\n  \n  // Comparar servicios\n  const serviciosOriginales = originData.services || [];\n  if (serviciosOriginales.length !== nuevosServicios.length) {\n    cambios.servicios = true;\n    cambios.tieneCambios = true;\n  } else {\n    // Comparar cada servicio\n    for (let i = 0; i < nuevosServicios.length; i++) {\n      const nuevo = nuevosServicios[i];\n      const original = serviciosOriginales[i];\n      \n      if (!original ||\n          nuevo.destino !== (original.destino || '') ||\n          nuevo.in !== (original.in || '') ||\n          nuevo.out !== (original.out || '') ||\n          nuevo.servicio !== (original.servicio || '')) {\n        cambios.servicios = true;\n        cambios.tieneCambios = true;\n        break;\n      }\n    }\n  }\n  \n  // Comparar hotel\n  const hotelOriginal = originData.hotel || null;\n  if ((hotelOriginal === null && nuevoHotel !== null) ||\n      (hotelOriginal !== null && nuevoHotel === null)) {\n    cambios.hotel = true;\n    cambios.tieneCambios = true;\n  } else if (hotelOriginal && nuevoHotel) {\n    if (hotelOriginal.nombre_hotel !== nuevoHotel.nombre_hotel ||\n        hotelOriginal.Ciudad !== nuevoHotel.Ciudad ||\n        hotelOriginal.in !== nuevoHotel.in ||\n        hotelOriginal.out !== nuevoHotel.out) {\n      cambios.hotel = true;\n      cambios.tieneCambios = true;\n    }\n  }\n  \n  return cambios;\n}\n\n/**\n * Muestra un modal de confirmación cuando hay cambios en pasajeros, servicios o hotel\n * @param {Object} cambios - Objeto con información sobre los cambios detectados\n * @returns {Promise<boolean>} true si el usuario confirma, false si cancela\n */\nfunction mostrarModalConfirmacion(cambios) {\n  return new Promise((resolve) => {\n    // Crear overlay\n    const overlay = document.createElement('div');\n    overlay.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.5);\n      z-index: 10001;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    `;\n    \n    // Crear modal\n    const modal = document.createElement('div');\n    modal.style.cssText = `\n      background: white;\n      padding: 24px;\n      border-radius: 8px;\n      max-width: 500px;\n      width: 90%;\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n    `;\n    \n    // Lista de cambios\n    const cambiosLista = [];\n    if (cambios.pasajeros) cambiosLista.push('Pasajeros');\n    if (cambios.servicios) cambiosLista.push('Servicios');\n    if (cambios.hotel) cambiosLista.push('Hotel');\n    \n    modal.innerHTML = `\n      <h3 style=\"margin-top: 0; margin-bottom: 16px; color: #d32f2f;\">⚠️ Advertencia</h3>\n      <p style=\"margin-bottom: 16px; line-height: 1.5;\">\n        Se detectaron cambios en los siguientes elementos que serán <strong>reemplazados</strong>:\n      </p>\n      <ul style=\"margin-bottom: 20px; padding-left: 20px;\">\n        ${cambiosLista.map(item => `<li style=\"margin-bottom: 8px;\">${item}</li>`).join('')}\n      </ul>\n      <p style=\"margin-bottom: 20px; color: #666; font-size: 14px;\">\n        ¿Desea continuar con la edición?\n      </p>\n      <div style=\"display: flex; gap: 12px; justify-content: flex-end;\">\n        <button id=\"modalCancelar\" style=\"\n          padding: 10px 20px;\n          border: 1px solid #ccc;\n          background: white;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n        \">Cancelar</button>\n        <button id=\"modalContinuar\" style=\"\n          padding: 10px 20px;\n          border: none;\n          background: #0078d4;\n          color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n        \">Continuar</button>\n      </div>\n    `;\n    \n    overlay.appendChild(modal);\n    document.body.appendChild(overlay);\n    \n    // Event listeners\n    document.getElementById('modalCancelar').onclick = () => {\n      document.body.removeChild(overlay);\n      resolve(false);\n    };\n    \n    document.getElementById('modalContinuar').onclick = () => {\n      document.body.removeChild(overlay);\n      resolve(true);\n    };\n    \n    // Cerrar al hacer click fuera del modal\n    overlay.onclick = (e) => {\n      if (e.target === overlay) {\n        document.body.removeChild(overlay);\n        resolve(false);\n      }\n    };\n  });\n}\n\n/**\n * Ejecuta la creación de reserva en iTraffic usando RPA\n */\nasync function ejecutarCrearReserva() {\n  try {\n    // Obtener datos de todos los pasajeros\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      mostrarMensaje(\"No se encontró el contenedor de pasajeros\", \"error\");\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    if (pasajeros.length === 0) {\n      mostrarMensaje(\"No hay pasajeros para crear la reserva. Por favor, extraiga datos primero.\", \"info\");\n      return;\n    }\n    \n    // Recopilar datos de todos los pasajeros\n    const todosPasajeros = [];\n    pasajeros.forEach((pasajeroDiv, index) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      \n      if (content) {\n        const datos = {\n          numeroPasajero: index + 1,\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        todosPasajeros.push(datos);\n      }\n    });\n    \n    // Capturar datos de la reserva\n    const datosReserva = {\n      tipoReserva: document.getElementById(\"tipoReserva\")?.value || \"\",\n      estadoReserva: document.getElementById(\"estadoReserva\")?.value || \"\",\n      fechaViaje: document.getElementById(\"fechaViaje\")?.value || \"\",\n      vendedor: document.getElementById(\"vendedor\")?.value || \"\",\n      cliente: document.getElementById(\"cliente\")?.value || \"\",\n      codigo: document.getElementById(\"codigo\")?.value || \"\",\n      reservationDate: document.getElementById(\"fechaReserva\")?.value || \"\",\n      tourEndDate: document.getElementById(\"fechaFinTour\")?.value || \"\",\n      dueDate: document.getElementById(\"fechaVencimiento\")?.value || \"\",\n      contact: document.getElementById(\"contacto\")?.value || \"\",\n      contactEmail: document.getElementById(\"contactEmail\")?.value || \"\",\n      contactPhone: document.getElementById(\"contactPhone\")?.value || \"\",\n      currency: document.getElementById(\"moneda\")?.value || \"\",\n      exchangeRate: parseFloat(document.getElementById(\"tipoCambio\")?.value) || 0,\n      commission: parseFloat(document.getElementById(\"comision\")?.value) || 0,\n      netAmount: parseFloat(document.getElementById(\"montoNeto\")?.value) || 0,\n      grossAmount: parseFloat(document.getElementById(\"montoBruto\")?.value) || 0,\n      tripName: document.getElementById(\"nombreViaje\")?.value || \"\",\n      productCode: document.getElementById(\"codigoProducto\")?.value || \"\",\n      adults: parseInt(document.getElementById(\"adultos\")?.value) || 0,\n      children: parseInt(document.getElementById(\"ninos\")?.value) || 0,\n      infants: parseInt(document.getElementById(\"infantes\")?.value) || 0,\n      provider: document.getElementById(\"proveedor\")?.value || \"\",\n      reservationCode: document.getElementById(\"codigoReserva\")?.value || extractionState.reservationCode || \"\",\n      hotel: (() => {\n        const nombreHotel = document.getElementById(\"hotel_nombre\")?.value || \"\";\n        const tipoHabitacion = document.getElementById(\"hotel_tipo_habitacion\")?.value || \"\";\n        const ciudad = document.getElementById(\"hotel_ciudad\")?.value || \"\";\n        const categoria = document.getElementById(\"hotel_categoria\")?.value || null;\n        const hotelIn = document.getElementById(\"hotel_in\")?.value || \"\";\n        const hotelOut = document.getElementById(\"hotel_out\")?.value || \"\";\n        \n        // Si todos los campos obligatorios están vacíos, retornar null\n        if (!nombreHotel && !tipoHabitacion && !ciudad && !hotelIn && !hotelOut) {\n          return null;\n        }\n        \n        return {\n          nombre_hotel: nombreHotel,\n          tipo_habitacion: tipoHabitacion,\n          Ciudad: ciudad,\n          Categoria: categoria || null,\n          in: hotelIn,\n          out: hotelOut\n        };\n      })(),\n      checkIn: document.getElementById(\"checkIn\")?.value || \"\",\n      checkOut: document.getElementById(\"checkOut\")?.value || \"\",\n      estadoDeuda: document.getElementById(\"estadoDeuda\")?.value || \"\"\n    };\n    \n    // Agregar conversationId del email actual\n    const item = Office.context.mailbox.item;\n    datosReserva.conversationId = item.conversationId || null;\n    \n    // Capturar servicios\n    const servicios = [];\n    const serviciosContainer = document.getElementById(\"serviciosContainer\");\n    if (serviciosContainer) {\n      const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n      servicioItems.forEach((item, index) => {\n        servicios.push({\n          destino: document.getElementById(`servicio_destino_${index}`)?.value || \"\",\n          in: document.getElementById(`servicio_in_${index}`)?.value || \"\",\n          out: document.getElementById(`servicio_out_${index}`)?.value || \"\",\n          nts: parseInt(document.getElementById(`servicio_nts_${index}`)?.value) || 0,\n          basePax: parseInt(document.getElementById(`servicio_basePax_${index}`)?.value) || 0,\n          servicio: document.getElementById(`servicio_servicio_${index}`)?.value || \"\",\n          descripcion: document.getElementById(`servicio_descripcion_${index}`)?.value || \"\",\n          estado: document.getElementById(`servicio_estado_${index}`)?.value || \"\"\n        });\n      });\n    }\n    datosReserva.services = servicios;\n    \n    // Capturar vuelos\n    const vuelos = [];\n    const vuelosContainer = document.getElementById(\"vuelosContainer\");\n    if (vuelosContainer) {\n      const vueloItems = vuelosContainer.querySelectorAll(\".vuelo-item\");\n      vueloItems.forEach((item, index) => {\n        vuelos.push({\n          airline: document.getElementById(`vuelo_airline_${index}`)?.value || \"\",\n          flightNumber: document.getElementById(`vuelo_flightNumber_${index}`)?.value || \"\",\n          origin: document.getElementById(`vuelo_origin_${index}`)?.value || \"\",\n          destination: document.getElementById(`vuelo_destination_${index}`)?.value || \"\",\n          date: document.getElementById(`vuelo_date_${index}`)?.value || \"\",\n          time: document.getElementById(`vuelo_time_${index}`)?.value || \"\"\n        });\n      });\n    }\n    datosReserva.flights = vuelos;\n    \n    // VALIDAR CAMPOS OBLIGATORIOS\n    let camposFaltantes = [];\n    \n    // Validar pasajeros (solo nombre y apellido son obligatorios)\n    todosPasajeros.forEach((pasajero, index) => {\n      if (!pasajero.nombre || pasajero.nombre.trim() === \"\") {\n        camposFaltantes.push(`Pasajero ${index + 1}: Nombre`);\n      }\n      if (!pasajero.apellido || pasajero.apellido.trim() === \"\") {\n        camposFaltantes.push(`Pasajero ${index + 1}: Apellido`);\n      }\n    });\n    \n    // Validar datos de reserva (todos obligatorios)\n    if (!datosReserva.tipoReserva || datosReserva.tipoReserva.trim() === \"\") {\n      camposFaltantes.push(\"Tipo de Reserva\");\n    }\n    if (!datosReserva.estadoReserva || datosReserva.estadoReserva.trim() === \"\") {\n      camposFaltantes.push(\"Estado\");\n    }\n    if (!datosReserva.fechaViaje || datosReserva.fechaViaje.trim() === \"\") {\n      camposFaltantes.push(\"Fecha de Viaje\");\n    }\n    if (!datosReserva.vendedor || datosReserva.vendedor.trim() === \"\") {\n      camposFaltantes.push(\"Vendedor\");\n    }\n    if (!datosReserva.cliente || datosReserva.cliente.trim() === \"\") {\n      camposFaltantes.push(\"Cliente\");\n    }\n    \n    // Validar campos obligatorios del hotel (solo si la sección está visible y tiene campos required)\n    const hotelSection = document.getElementById(\"hotelSection\");\n    if (hotelSection && hotelSection.style.display !== \"none\") {\n      const hotelNombre = document.getElementById(\"hotel_nombre\");\n      const hotelTipoHabitacion = document.getElementById(\"hotel_tipo_habitacion\");\n      const hotelCiudad = document.getElementById(\"hotel_ciudad\");\n      const hotelIn = document.getElementById(\"hotel_in\");\n      const hotelOut = document.getElementById(\"hotel_out\");\n      \n      // Solo validar si los campos son required\n      if (hotelNombre?.required && (!datosReserva.hotel?.nombre_hotel || datosReserva.hotel.nombre_hotel.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Nombre\");\n      }\n      if (hotelTipoHabitacion?.required && (!datosReserva.hotel?.tipo_habitacion || datosReserva.hotel.tipo_habitacion.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Tipo de Habitación\");\n      }\n      if (hotelCiudad?.required && (!datosReserva.hotel?.Ciudad || datosReserva.hotel.Ciudad.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Ciudad\");\n      }\n      if (hotelIn?.required && (!datosReserva.hotel?.in || datosReserva.hotel.in.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Fecha Entrada\");\n      }\n      if (hotelOut?.required && (!datosReserva.hotel?.out || datosReserva.hotel.out.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Fecha Salida\");\n      }\n      \n      // Validar que las fechas de entrada y salida tengan al menos un día de diferencia\n      if (datosReserva.hotel?.in && datosReserva.hotel?.out) {\n        const fechaIn = new Date(datosReserva.hotel.in);\n        const fechaOut = new Date(datosReserva.hotel.out);\n        \n        // Verificar que la fecha de salida sea posterior a la de entrada\n        if (fechaOut <= fechaIn) {\n          mostrarMensaje(\"Las fechas del hotel no son válidas. La fecha de salida debe ser al menos un día posterior a la fecha de entrada.\", \"error\");\n          return; // NO enviar al RPA\n        }\n        \n        // Calcular la diferencia en días\n        const diferenciaDias = Math.floor((fechaOut - fechaIn) / (1000 * 60 * 60 * 24));\n        \n        if (diferenciaDias < 1) {\n          mostrarMensaje(\"Las fechas del hotel deben tener al menos un día de diferencia. La fecha de salida debe ser posterior a la fecha de entrada.\", \"error\");\n          return; // NO enviar al RPA\n        }\n      }\n    }\n    \n    // Validar campos obligatorios de servicios (solo si la sección está visible)\n    const serviciosSection = document.getElementById(\"serviciosSection\");\n    if (serviciosSection && serviciosSection.style.display !== \"none\") {\n      if (!datosReserva.services || datosReserva.services.length === 0) {\n        // Solo requerir servicios si hay algún campo required en la sección\n        const serviciosContainer = document.getElementById(\"serviciosContainer\");\n        if (serviciosContainer) {\n          const primerServicio = serviciosContainer.querySelector(\".servicio-item\");\n          if (primerServicio) {\n            const tieneRequired = primerServicio.querySelector(\"[required]\");\n            if (tieneRequired) {\n              camposFaltantes.push(\"Servicios: Debe haber al menos un servicio\");\n            }\n          }\n        }\n      } else {\n        datosReserva.services.forEach((servicio, index) => {\n          const destino = document.getElementById(`servicio_destino_${index}`);\n          const servicioIn = document.getElementById(`servicio_in_${index}`);\n          const servicioOut = document.getElementById(`servicio_out_${index}`);\n          const nts = document.getElementById(`servicio_nts_${index}`);\n          const basePax = document.getElementById(`servicio_basePax_${index}`);\n          const servicioField = document.getElementById(`servicio_servicio_${index}`);\n          const descripcion = document.getElementById(`servicio_descripcion_${index}`);\n          const estado = document.getElementById(`servicio_estado_${index}`);\n          \n          // Solo validar si los campos son required\n          if (destino?.required && (!servicio.destino || servicio.destino.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Destino`);\n          }\n          if (servicioIn?.required && (!servicio.in || servicio.in.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Fecha Entrada`);\n          }\n          if (servicioOut?.required && (!servicio.out || servicio.out.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Fecha Salida`);\n          }\n          if (nts?.required && (!servicio.nts || servicio.nts === 0)) {\n            camposFaltantes.push(`Servicio ${index + 1}: Noches`);\n          }\n          if (basePax?.required && (!servicio.basePax || servicio.basePax === 0)) {\n            camposFaltantes.push(`Servicio ${index + 1}: Base Pax`);\n          }\n          if (servicioField?.required && (!servicio.servicio || servicio.servicio.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Servicio`);\n          }\n          if (descripcion?.required && (!servicio.descripcion || servicio.descripcion.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Descripción`);\n          }\n          if (estado?.required && (!servicio.estado || servicio.estado.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Estado`);\n          }\n        });\n      }\n    }\n    \n    // Si hay campos faltantes, mostrar error y no enviar\n    if (camposFaltantes.length > 0) {\n      mostrarMensaje(\n        `Por favor completa los siguientes campos obligatorios: ${camposFaltantes.join(', ')}`,\n        \"error\"\n      );\n      return; // NO enviar al RPA\n    }\n    \n    // Obtener el estado de si la extracción existía (convertir explícitamente a booleano)\n    const didExtractionExist = extractionState.didExtractionExist === true;\n    \n    // Log para debug\n    console.log('🚀 ejecutarCrearReserva - didExtractionExist:', didExtractionExist, 'extractionState:', extractionState);\n    \n    // Si es edición, validar cambios antes de continuar\n    if (didExtractionExist && extractionState.originData) {\n      // Capturar servicios y hotel para comparación\n      const servicios = datosReserva.services || [];\n      const hotel = datosReserva.hotel || null;\n      \n      // Comparar datos\n      const cambios = compararDatos(extractionState.originData, todosPasajeros, servicios, hotel);\n      \n      // Si hay cambios, mostrar modal de confirmación\n      if (cambios.tieneCambios) {\n        const confirmar = await mostrarModalConfirmacion(cambios);\n        if (!confirmar) {\n          // El usuario canceló, no hacer nada\n          return;\n        }\n      }\n    }\n    \n    // Mostrar mensaje de procesamiento según si es crear o editar\n    const mensajeProcesamiento = didExtractionExist \n      ? \"Editando reserva en iTraffic... Por favor espere.\" \n      : \"Creando reserva en iTraffic... Por favor espere.\";\n    mostrarMensaje(mensajeProcesamiento, \"info\");\n    \n    // DESHABILITAR TODOS LOS CAMPOS\n    deshabilitarFormularios();\n    \n    // Deshabilitar botón mientras se procesa\n    const botonCrearReserva = document.getElementById(\"crearReserva\");\n    if (botonCrearReserva) {\n      botonCrearReserva.disabled = true;\n      botonCrearReserva.style.opacity = \"0.6\";\n      botonCrearReserva.querySelector('.ms-Button-label').textContent = \"⏳ Procesando...\";\n    }\n    \n    // Llamar al servicio RPA con los datos de pasajeros y reserva, pasando el estado y la data original si es edición\n    const originData = didExtractionExist ? extractionState.originData : null;\n    const resultado = await crearReservaEnITraffic(todosPasajeros, datosReserva, didExtractionExist, originData);\n    \n    // Obtener reservationCode de la respuesta\n    const reservationCode = resultado.data?.reservationCode || resultado.reservationCode || null;\n    \n    // Mostrar mensaje de éxito según si es crear o editar, incluyendo el código de reserva si existe\n    let mensajeExito = didExtractionExist \n      ? \"¡Reserva editada exitosamente en iTraffic!\" \n      : \"¡Reserva creada exitosamente en iTraffic!\";\n    \n    if (reservationCode) {\n      mensajeExito += ` Código de la reserva: ${reservationCode}`;\n    }\n    \n    mostrarMensaje(mensajeExito, \"success\");\n    \n    // CONVERTIR A MODO LECTURA\n    convertirAModoLectura();\n    \n  } catch (error) {\n    const didExtractionExist = extractionState.didExtractionExist === true;\n    const mensajeError = didExtractionExist \n      ? \"Error al editar reserva: \" + error.message \n      : \"Error al crear reserva: \" + error.message;\n    mostrarMensaje(mensajeError, \"error\");\n    // En caso de error, rehabilitar los formularios\n    habilitarFormularios();\n  }\n}\n\n/**\n * Habilita todos los campos del formulario (en caso de error)\n */\nfunction habilitarFormularios() {\n  // Habilitar campos de pasajeros\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const inputs = container.querySelectorAll(\"input, select\");\n    inputs.forEach(input => {\n      input.disabled = false;\n      input.style.backgroundColor = \"#ffffff\";\n      input.style.cursor = \"text\";\n    });\n    \n    // Habilitar botones de eliminar pasajero\n    const botonesEliminar = container.querySelectorAll(\".btn-eliminar-pasajero\");\n    botonesEliminar.forEach(btn => {\n      btn.disabled = false;\n      btn.style.opacity = \"1\";\n      btn.style.cursor = \"pointer\";\n      btn.style.pointerEvents = \"auto\";\n    });\n  }\n  \n  // Habilitar campos de reserva\n  const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n  camposReserva.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.disabled = false;\n      campo.style.backgroundColor = \"#ffffff\";\n      campo.style.cursor = \"pointer\";\n    }\n  });\n  \n  // Habilitar botón de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.disabled = false;\n    btnAgregar.style.opacity = \"1\";\n    btnAgregar.style.cursor = \"pointer\";\n  }\n  \n  // Habilitar botón de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.disabled = false;\n    btnGuardar.style.opacity = \"1\";\n    btnGuardar.style.cursor = \"pointer\";\n  }\n  \n  // Habilitar botón de crear reserva\n  const botonCrearReserva = document.getElementById(\"crearReserva\");\n  if (botonCrearReserva) {\n    const didExtractionExist = extractionState.didExtractionExist === true;\n    botonCrearReserva.disabled = false;\n    botonCrearReserva.style.opacity = \"1\";\n    actualizarTextoBotonReserva(didExtractionExist);\n  }\n}\n\nexport { mostrarMensaje, run, crearFormulariosPasajeros, crearFormularioPasajero, guardarDatos, llenarDatosPasajeros, eliminarPasajero, renumerarPasajeros, agregarNuevoPasajero, ejecutarCrearReserva };\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\"> <h2>Extractor de Datos de Pasajero</h2> <p style=\\\"margin-bottom:20px;color:#666\\\">Haz clic en el botón para extraer la información del correo:</p> <button id=\\\"run\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">📧 Extraer Información</span> </button> <div id=\\\"loader\\\" style=\\\"display:none;text-align:center;padding:40px 20px\\\"> <div class=\\\"spinner\\\"></div> <p style=\\\"margin-top:20px;color:#666\\\">Extrayendo información del correo...</p> <p style=\\\"font-size:.9em;color:#999\\\">Por favor espera, esto puede tomar unos segundos</p> </div> <div id=\\\"results\\\" style=\\\"display:none\\\"> <div style=\\\"text-align:right;margin-bottom:10px\\\"> <button id=\\\"reextract\\\" class=\\\"ms-Button\\\" style=\\\"font-size:.85em;padding:6px 12px\\\"> <span class=\\\"ms-Button-label\\\">🔄 Re-extraer</span> </button> </div> <h3>Datos de Pasajeros</h3> <div id=\\\"pasajerosContainer\\\"></div> <button id=\\\"agregarPasajero\\\" class=\\\"ms-Button btn-secondary\\\"> <span class=\\\"ms-Button-label\\\">+ Agregar Pasajero</span> </button> <div id=\\\"datosReservaSection\\\" class=\\\"datos-reserva-section\\\"> <h3>Datos de la Reserva</h3> <div class=\\\"form-group\\\"> <label>Tipo de Reserva: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"tipoReserva\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"AGENCIAS [COAG]\\\">Agencias [COAG]</option> <option value=\\\"DIRECTA\\\">Directa</option> <option value=\\\"CORPORATIVA\\\">Corporativa</option> </select> </div> <div class=\\\"form-group\\\"> <label>Estado: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"estadoReserva\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"PENDIENTE DE CONFIRMACION [PC]\\\">Pendiente de Confirmación [PC]</option> <option value=\\\"CONFIRMADA\\\">Confirmada</option> <option value=\\\"CANCELADA\\\">Cancelada</option> </select> </div> <div class=\\\"form-group\\\"> <label>Fecha de Viaje: <span style=\\\"color:red\\\">*</span></label> <input type=\\\"date\\\" id=\\\"fechaViaje\\\" required> </div> <div class=\\\"form-group\\\"> <label>Vendedor: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"vendedor\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"TEST TEST\\\">TEST TEST</option> <option value=\\\"VENDEDOR 1\\\">Vendedor 1</option> <option value=\\\"VENDEDOR 2\\\">Vendedor 2</option> </select> </div> <div class=\\\"form-group\\\"> <label>Cliente: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"cliente\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"DESPEGAR - TEST - 1\\\">DESPEGAR - TEST - 1</option> <option value=\\\"CLIENTE 1\\\">Cliente 1</option> <option value=\\\"CLIENTE 2\\\">Cliente 2</option> </select> </div> <div class=\\\"form-group\\\"> <label>Fecha de Reserva:</label> <input type=\\\"date\\\" id=\\\"fechaReserva\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha Fin de Tour:</label> <input type=\\\"date\\\" id=\\\"fechaFinTour\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha de Vencimiento:</label> <input type=\\\"date\\\" id=\\\"fechaVencimiento\\\"> </div> <div id=\\\"hotelSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Hotel</h3> <div id=\\\"hotelContainer\\\"> <div class=\\\"form-group\\\"> <label>Nombre del Hotel: <span style=\\\"color:red\\\">*</span></label> <input type=\\\"text\\\" id=\\\"hotel_nombre\\\" placeholder=\\\"Nombre del hotel\\\"> </div> <div class=\\\"form-group\\\"> <label>Tipo de Habitación: <span style=\\\"color:red\\\">*</span></label> <input type=\\\"text\\\" id=\\\"hotel_tipo_habitacion\\\" placeholder=\\\"Ej: DWL, SGL, DBL\\\"> </div> <div class=\\\"form-group\\\"> <label>Ciudad: <span style=\\\"color:red\\\">*</span></label> <input type=\\\"text\\\" id=\\\"hotel_ciudad\\\" placeholder=\\\"Ej: MDZ, BUE\\\"> </div> <div class=\\\"form-group\\\"> <label>Categoría:</label> <input type=\\\"text\\\" id=\\\"hotel_categoria\\\" placeholder=\\\"Categoría del hotel\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha Entrada Hotel: <span style=\\\"color:red\\\">*</span></label> <input type=\\\"date\\\" id=\\\"hotel_in\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha Salida Hotel: <span style=\\\"color:red\\\">*</span></label> <input type=\\\"date\\\" id=\\\"hotel_out\\\"> </div> </div> </div> <button id=\\\"agregarHotel\\\" class=\\\"ms-Button btn-secondary\\\" style=\\\"margin-top:10px;display:none\\\"> <span class=\\\"ms-Button-label\\\">+ Agregar Hotel</span> </button> <div id=\\\"serviciosSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Servicios</h3> <div id=\\\"serviciosContainer\\\"></div> </div> <button id=\\\"agregarServicio\\\" class=\\\"ms-Button btn-secondary\\\" style=\\\"margin-top:10px\\\"> <span class=\\\"ms-Button-label\\\">+ Agregar Servicio</span> </button> <div id=\\\"vuelosSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Vuelos</h3> <div id=\\\"vuelosContainer\\\"></div> </div> </div> <button id=\\\"crearReserva\\\" class=\\\"ms-Button btn-crear-reserva\\\"> <span class=\\\"ms-Button-label\\\">🚀 Crear Reserva en iTraffic</span> </button> <button id=\\\"guardar\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Guardar Todos los Datos</span> </button> </div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","formatearFecha","fecha","year","month","day","split","error","servicesList","masterData","sellers","clients","statuses","reservationTypes","genders","documentTypes","countries","loaded","extractionState","didExtractionExist","reservationCode","originData","mostrarMensaje","mensaje","tipo","mensajeDiv","createElement","className","textContent","style","position","top","left","transform","zIndex","minWidth","maxWidth","textAlign","animation","body","appendChild","setTimeout","parentNode","removeChild","validarFechasHotel","hotelIn","getElementById","hotelOut","value","borderColor","fechaIn","Date","fechaOut","isNaN","getTime","Math","floor","poblarSelectReserva","tipoReservaSelect","innerHTML","forEach","option","name","console","log","estadoSelect","estado","vendedorSelect","vendedor","clienteSelect","cliente","async","run","isReExtract","runButton","display","loader","resultsDiv","Office","context","mailbox","item","getAsync","CoercionType","Text","result","status","AsyncResultStatus","Succeeded","cuerpoCorreo","extractedData","emailContent","response","fetch","RPA_API_URL","method","headers","JSON","stringify","userId","userProfile","emailAddress","conversationId","ok","errorData","json","data","extraerDatosConIA","reextractButton","passengers","didExtractionExistRaw","parse","crearFormulariosPasajeros","datosPasajeros","datos","index","numero","tipoPasajero","passengerType","paxType","firstName","lastName","documentNumber","dateOfBirth","birthDate","cuilCuit","tipoDocSelect","documentType","sexoSelect","sex","nacionalidadSelect","nationality","direccion","phoneNumber","telefono","actualizarEstadoBotonCrearReserva","datosExtraidos","valorTipoReserva","reservationType","Array","from","options","map","coincidencia","find","opt","includes","warn","estadoReservaSelect","valorEstado","opcionesDisponibles","opciones","trim","valorUpper","travelDate","valorVendedor","seller","valorCliente","client","codigo","reservationDate","tourEndDate","dueDate","contact","contactEmail","contactPhone","currency","exchangeRate","commission","netAmount","grossAmount","tripName","productCode","adults","children","infants","provider","hotelSection","agregarHotelButton","hotel","campoId","campo","required","nombre_hotel","tipo_habitacion","Ciudad","Categoria","in","out","checkIn","checkOut","estadoDeuda","serviciosSection","services","isArray","servicios","serviciosContainer","servicio","servicioDiv","crearElementoServicio","llenarServicios","flights","vuelosSection","vuelos","vuelosContainer","vuelo","vueloDiv","airline","flightNumber","origin","destination","date","time","llenarVuelos","actualizarTextoBotonReserva","message","numeroPasajeros","container","pasajeroDiv","crearFormularioPasajero","dataset","numeroPasajero","header","content","onclick","target","classList","contains","isOpen","arrow","querySelector","nombreInput","apellidoInput","addEventListener","stopPropagation","querySelectorAll","remove","nuevoNumero","eliminarPasajero","valorActual","genero","code","pais","poblarSelectsPasajero","esDeExtraccion","servicioCoincidente","servicioBackend","palabrasBackend","filter","mejorCoincidencia","maxCoincidencias","mejorPuntuacion","palabrasClave","servicioLista","palabrasLista","coincidencias","puntuacion","palabraBackend","some","palabraLista","encontrarServicioCoincidente","datalistId","requiredAttr","requiredSpan","servicioIndex","destino","nts","basePax","s","join","descripcion","btnEliminar","nuevoIndex","tituloDiv","titulo","campoBase","campoViejo","id","setAttribute","datalist","renumerarServicios","eliminarServicio","isEdit","boton","label","texto","esValido","pasajeros","pasajerosValidos","nombre","apellido","tipoReserva","estadoReserva","fechaViaje","reservaValida","hotelValido","hotelNombre","hotelTipoHabitacion","hotelCiudad","serviciosValidos","servicioItems","servicioIn","servicioOut","validarCamposObligatorios","disabled","opacity","cursor","onReady","info","host","HostType","Outlook","sideloadMsg","appBody","guardarButton","todosPasajeros","dni","fechaNacimiento","cuil","tipoDoc","sexo","nacionalidad","push","guardarDatos","agregarButton","nuevoPasajero","scrollIntoView","behavior","block","agregarNuevoPasajero","mostrarSeccionHotel","agregarServicioButton","nuevoServicio","agregarNuevoServicio","crearReservaButton","datosReserva","parseFloat","parseInt","nombreHotel","tipoHabitacion","ciudad","categoria","camposFaltantes","pasajero","servicioField","primerServicio","cambios","nuevosPasajeros","nuevosServicios","nuevoHotel","tieneCambios","pasajerosOriginales","nuevo","original","serviciosOriginales","hotelOriginal","compararDatos","confirmar","Promise","resolve","overlay","cssText","modal","cambiosLista","mostrarModalConfirmacion","input","backgroundColor","btn","pointerEvents","btnAgregar","btnGuardar","deshabilitarFormularios","botonCrearReserva","resultado","datosRPA","transformarDatosParaRPA","serviceUrl","statusText","success","crearReservaEnITraffic","mensajeExito","datosReservaSection","botonCrearOtra","pasajerosContainer","resetearAplicacion","btnCrearReserva","convertirAModoLectura","habilitarFormularios","ejecutarCrearReserva","masterDataUrl","vendedores","clientes","estados","tiposReserva","generos","tiposDoc","paises","cargarDatosMaestros","URL"],"ignoreList":[],"sourceRoot":""}