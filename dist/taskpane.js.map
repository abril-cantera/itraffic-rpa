{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://outlook-email-classifier-addin/webpack/bootstrap","webpack://outlook-email-classifier-addin/webpack/runtime/global","webpack://outlook-email-classifier-addin/webpack/runtime/hasOwnProperty shorthand","webpack://outlook-email-classifier-addin/webpack/runtime/publicPath","webpack://outlook-email-classifier-addin/webpack/runtime/jsonp chunk loading","webpack://outlook-email-classifier-addin/./src/taskpane/rpaClient.js","webpack://outlook-email-classifier-addin/./src/taskpane/taskpane.js","webpack://outlook-email-classifier-addin/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * Cliente HTTP para comunicarse con el backend RPA\n * Este archivo maneja la comunicaci√≥n entre el add-in de Outlook y el servidor RPA\n */\n\n// URL del servidor RPA (se configura din√°micamente seg√∫n el entorno)\n// En producci√≥n, esta URL se inyecta durante el build de webpack\nconst RPA_SERVICE_URL = typeof RPA_API_URL !== 'undefined' \n  ? RPA_API_URL + '/api/rpa/create-reservation'\n  : 'http://localhost:3001/api/rpa/create-reservation';\n\n/**\n * Transforma los datos del formulario al formato esperado por el RPA\n * @param {Array} pasajeros - Array de objetos con datos de pasajeros\n * @param {Object} datosReserva - Datos de la reserva del formulario\n * @returns {Object} Datos formateados para el RPA\n */\nfunction transformarDatosParaRPA(pasajeros, datosReserva = {}) {\n  return {\n    passengers: pasajeros.map(p => ({\n      lastName: p.apellido || '',\n      firstName: p.nombre || '',\n      paxType: p.tipoPasajero === 'adulto' ? 'ADU' : p.tipoPasajero === 'menor' ? 'CHD' : 'INF',\n      birthDate: formatearFecha(p.fechaNacimiento), // Convertir a MM/DD/AAAA\n      nationality: p.nacionalidad?.toUpperCase() || 'ARGENTINA',\n      sex: p.sexo === 'masculino' ? 'M' : p.sexo === 'femenino' ? 'F' : 'O',\n      documentNumber: p.dni || '',\n      documentType: p.tipoDoc?.toUpperCase() || 'DNI',\n      cuilCuit: p.cuil || '',\n      phoneNumber: p.telefono || '',\n      direccion: p.direccion || ''\n    })),\n    reservationType: datosReserva.tipoReserva || 'AGENCIAS [COAG]',\n    status: datosReserva.estadoReserva || 'PENDIENTE DE CONFIRMACION [PC]',\n    client: datosReserva.cliente || 'DESPEGAR - TEST - 1',\n    travelDate: formatearFecha(datosReserva.fechaViaje) || '12/01/2026',\n    seller: datosReserva.vendedor || 'TEST TEST',\n    codigo: datosReserva.codigo || '',\n    reservationDate: formatearFecha(datosReserva.reservationDate) || '',\n    tourEndDate: formatearFecha(datosReserva.tourEndDate) || '',\n    dueDate: formatearFecha(datosReserva.dueDate) || '',\n    contact: datosReserva.contact || '',\n    contactEmail: datosReserva.contactEmail || '',\n    contactPhone: datosReserva.contactPhone || '',\n    currency: datosReserva.currency || 'ARS',\n    exchangeRate: datosReserva.exchangeRate || 0,\n    commission: datosReserva.commission || 0,\n    netAmount: datosReserva.netAmount || 0,\n    grossAmount: datosReserva.grossAmount || 0,\n    tripName: datosReserva.tripName || '',\n    productCode: datosReserva.productCode || '',\n    adults: datosReserva.adults || 0,\n    children: datosReserva.children || 0,\n    infants: datosReserva.infants || 0,\n    provider: datosReserva.provider || '',\n    reservationCode: datosReserva.reservationCode || '',\n    hotel: datosReserva.hotel || '',\n    checkIn: formatearFecha(datosReserva.checkIn) || '',\n    checkOut: formatearFecha(datosReserva.checkOut) || '',\n    estadoDeuda: datosReserva.estadoDeuda || '',\n    services: datosReserva.services || [],\n    flights: datosReserva.flights || []\n  };\n}\n\n/**\n * Formatea una fecha de YYYY-MM-DD a MM/DD/YYYY\n * @param {string} fecha - Fecha en formato YYYY-MM-DD\n * @returns {string} Fecha en formato MM/DD/YYYY\n */\nfunction formatearFecha(fecha) {\n  if (!fecha) return '';\n  \n  try {\n    const [year, month, day] = fecha.split('-');\n    return `${month}/${day}/${year}`;\n  } catch (error) {\n    return '';\n  }\n}\n\n/**\n * Env√≠a los datos al servicio RPA para crear la reserva\n * @param {Array} pasajeros - Array de objetos con datos de pasajeros del formulario\n * @param {Object} datosReserva - Datos de la reserva del formulario\n * @returns {Promise<Object>} Resultado de la operaci√≥n\n */\nexport async function crearReservaEnITraffic(pasajeros, datosReserva = {}) {\n  try {\n    // Transformar datos al formato del RPA\n    const datosRPA = transformarDatosParaRPA(pasajeros, datosReserva);\n    \n    // Enviar petici√≥n al servidor RPA\n    const response = await fetch(RPA_SERVICE_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(datosRPA)\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Error del servidor: ${response.status} ${response.statusText}`);\n    }\n    \n    const resultado = await response.json();\n    \n    return {\n      success: true,\n      data: resultado,\n      message: 'Reserva creada exitosamente en iTraffic'\n    };\n    \n  } catch (error) {\n    // Si el servidor no est√° disponible, mostrar un mensaje m√°s amigable\n    if (error.message.includes('fetch')) {\n      throw new Error('No se pudo conectar con el servicio RPA. Aseg√∫rate de que el servidor est√© corriendo.');\n    }\n    \n    throw error;\n  }\n}\n\n/**\n * Verifica si el servicio RPA est√° disponible\n * @returns {Promise<boolean>} true si el servicio est√° disponible\n */\nexport async function verificarServicioRPA() {\n  try {\n    const healthUrl = typeof RPA_API_URL !== 'undefined'\n      ? RPA_API_URL + '/api/rpa/health'\n      : 'http://localhost:3001/api/rpa/health';\n      \n    const response = await fetch(healthUrl, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      }\n    });\n    \n    return response.ok;\n  } catch (error) {\n    console.error('Error verificando servicio RPA:', error);\n    return false;\n  }\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\n\nimport { crearReservaEnITraffic } from './rpaClient.js';\n\n// Estado global para datos maestros\nconst masterData = {\n  sellers: [],\n  clients: [],\n  statuses: [],\n  reservationTypes: [],\n  genders: [],\n  documentTypes: [],\n  countries: [],\n  loaded: false\n};\n\n// Funci√≥n para mostrar mensajes al usuario\nfunction mostrarMensaje(mensaje, tipo = \"info\") {\n  // Crear elemento de mensaje\n  const mensajeDiv = document.createElement(\"div\");\n  mensajeDiv.className = `status-message ${tipo}`;\n  mensajeDiv.textContent = mensaje;\n  mensajeDiv.style.position = \"fixed\";\n  mensajeDiv.style.top = \"20px\";\n  mensajeDiv.style.left = \"50%\";\n  mensajeDiv.style.transform = \"translateX(-50%)\";\n  mensajeDiv.style.zIndex = \"10000\";\n  mensajeDiv.style.minWidth = \"200px\";\n  mensajeDiv.style.maxWidth = \"90%\";\n  mensajeDiv.style.textAlign = \"center\";\n  mensajeDiv.style.animation = \"slideDown 0.3s ease\";\n  \n  document.body.appendChild(mensajeDiv);\n  \n  // Remover despu√©s de 3 segundos\n  setTimeout(() => {\n    mensajeDiv.style.animation = \"slideUp 0.3s ease\";\n    setTimeout(() => {\n      if (mensajeDiv.parentNode) {\n        mensajeDiv.parentNode.removeChild(mensajeDiv);\n      }\n    }, 300);\n  }, 3000);\n}\n\nOffice.onReady((info) => {\n  try {\n  if (info.host === Office.HostType.Outlook) {\n      // Ocultar mensaje de sideload si existe\n      const sideloadMsg = document.getElementById(\"sideload-msg\");\n      if (sideloadMsg) {\n        sideloadMsg.style.display = \"none\";\n      }\n      \n      // Mostrar el cuerpo de la aplicaci√≥n\n      const appBody = document.getElementById(\"app-body\");\n      if (appBody) {\n        appBody.style.display = \"flex\";\n      }\n      \n      // Asignar evento al bot√≥n de extraer\n      const runButton = document.getElementById(\"run\");\n      if (runButton) {\n        runButton.onclick = function() {\n          try {\n            run();\n          } catch (error) {\n            mostrarMensaje(\"Error al extraer datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al bot√≥n de re-extraer\n      const reextractButton = document.getElementById(\"reextract\");\n      if (reextractButton) {\n        reextractButton.onclick = function() {\n          try {\n            // Ocultar resultados y volver a extraer\n            const resultsDiv = document.getElementById(\"results\");\n            resultsDiv.style.display = \"none\";\n            run();\n          } catch (error) {\n            mostrarMensaje(\"Error al re-extraer datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al bot√≥n de guardar\n      const guardarButton = document.getElementById(\"guardar\");\n      if (guardarButton) {\n        guardarButton.onclick = function() {\n          try {\n            guardarDatos();\n          } catch (error) {\n            mostrarMensaje(\"Error al guardar datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al bot√≥n de agregar pasajero\n      const agregarButton = document.getElementById(\"agregarPasajero\");\n      if (agregarButton) {\n        agregarButton.onclick = function() {\n          try {\n            agregarNuevoPasajero();\n          } catch (error) {\n            mostrarMensaje(\"Error al agregar pasajero: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al bot√≥n de crear reserva\n      const crearReservaButton = document.getElementById(\"crearReserva\");\n      if (crearReservaButton) {\n        crearReservaButton.onclick = function() {\n          ejecutarCrearReserva();\n        };\n        // Deshabilitar el bot√≥n inicialmente\n        crearReservaButton.disabled = true;\n        crearReservaButton.style.opacity = \"0.5\";\n        crearReservaButton.style.cursor = \"not-allowed\";\n      }\n      \n      // Agregar event listeners para campos de reserva\n      const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n      camposReserva.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.addEventListener('change', actualizarEstadoBotonCrearReserva);\n          campo.addEventListener('input', actualizarEstadoBotonCrearReserva);\n        }\n      });\n      \n      // Cargar datos maestros al iniciar\n      cargarDatosMaestros();\n    }\n  } catch (error) {\n    // Error silencioso\n  }\n});\n\n/**\n * Cargar datos maestros desde el servidor\n */\nasync function cargarDatosMaestros() {\n  try {\n    // Usar la variable global RPA_API_URL inyectada por webpack\n    const masterDataUrl = typeof RPA_API_URL !== 'undefined'\n      ? RPA_API_URL + '/api/master-data'\n      : 'http://localhost:3001/api/master-data';\n    \n    const response = await fetch(masterDataUrl);\n    \n    if (!response.ok) {\n      console.warn('‚ö†Ô∏è No se pudieron cargar los datos maestros, usando valores por defecto');\n      return;\n    }\n    \n    const result = await response.json();\n    \n    if (result.success && result.data) {\n      masterData.sellers = result.data.sellers || [];\n      masterData.clients = result.data.clients || [];\n      masterData.statuses = result.data.statuses || [];\n      masterData.reservationTypes = result.data.reservationTypes || [];\n      masterData.genders = result.data.genders || [];\n      masterData.documentTypes = result.data.documentTypes || [];\n      masterData.countries = result.data.countries || [];\n      masterData.loaded = true;\n      \n      console.log('‚úÖ Datos maestros cargados:', {\n        vendedores: masterData.sellers.length,\n        clientes: masterData.clients.length,\n        estados: masterData.statuses.length,\n        tiposReserva: masterData.reservationTypes.length,\n        generos: masterData.genders.length,\n        tiposDoc: masterData.documentTypes.length,\n        paises: masterData.countries.length\n      });\n      \n      // Poblar los selects de reserva\n      poblarSelectReserva();\n    }\n  } catch (error) {\n    console.error('‚ùå Error cargando datos maestros:', error);\n  }\n}\n\n/**\n * Poblar los selects de la secci√≥n de reserva\n */\nfunction poblarSelectReserva() {\n  // Tipo de Reserva\n  const tipoReservaSelect = document.getElementById('tipoReserva');\n  if (tipoReservaSelect && masterData.reservationTypes.length > 0) {\n    tipoReservaSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.reservationTypes.forEach(tipo => {\n      const option = document.createElement('option');\n      option.value = tipo.name;\n      option.textContent = tipo.name;\n      tipoReservaSelect.appendChild(option);\n    });\n    console.log(`üìã Tipo Reserva poblado con ${masterData.reservationTypes.length} opciones`);\n  } else if (tipoReservaSelect) {\n    // Opciones por defecto si no hay datos maestros\n    tipoReservaSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"AGENCIAS [COAG]\">AGENCIAS [COAG]</option>\n      <option value=\"MAYORISTA [COMA]\">MAYORISTA [COMA]</option>\n      <option value=\"DIRECTO [CODI]\">DIRECTO [CODI]</option>\n      <option value=\"CORPORATIVA [COCO]\">CORPORATIVA [COCO]</option>\n    `;\n    console.log(`üìã Tipo Reserva poblado con opciones por defecto`);\n  }\n  \n  // Estado\n  const estadoSelect = document.getElementById('estadoReserva');\n  if (estadoSelect && masterData.statuses.length > 0) {\n    estadoSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.statuses.forEach(estado => {\n      const option = document.createElement('option');\n      option.value = estado.name;\n      option.textContent = estado.name;\n      estadoSelect.appendChild(option);\n    });\n    console.log(`üìã Estado poblado con ${masterData.statuses.length} opciones`);\n  } else if (estadoSelect) {\n    // Opciones por defecto si no hay datos maestros\n    estadoSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"PENDIENTE DE CONFIRMACION [PC]\">PENDIENTE DE CONFIRMACION [PC]</option>\n      <option value=\"CONFIRMADA [CO]\">CONFIRMADA [CO]</option>\n      <option value=\"CANCELADA [CA]\">CANCELADA [CA]</option>\n    `;\n    console.log(`üìã Estado poblado con opciones por defecto`);\n  }\n  \n  // Vendedor\n  const vendedorSelect = document.getElementById('vendedor');\n  if (vendedorSelect && masterData.sellers.length > 0) {\n    vendedorSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.sellers.forEach(vendedor => {\n      const option = document.createElement('option');\n      option.value = vendedor.name;\n      option.textContent = vendedor.name;\n      vendedorSelect.appendChild(option);\n    });\n    console.log(`üìã Vendedor poblado con ${masterData.sellers.length} opciones`);\n  } else if (vendedorSelect) {\n    // Opciones por defecto si no hay datos maestros\n    vendedorSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"TEST TEST\">TEST TEST</option>\n    `;\n    console.log(`üìã Vendedor poblado con opciones por defecto`);\n  }\n  \n  // Cliente\n  const clienteSelect = document.getElementById('cliente');\n  if (clienteSelect && masterData.clients.length > 0) {\n    clienteSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.clients.forEach(cliente => {\n      const option = document.createElement('option');\n      option.value = cliente.name;\n      option.textContent = cliente.name;\n      clienteSelect.appendChild(option);\n    });\n    console.log(`üìã Cliente poblado con ${masterData.clients.length} opciones`);\n  } else if (clienteSelect) {\n    // Opciones por defecto si no hay datos maestros\n    clienteSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"DESPEGAR - TEST - 1\">DESPEGAR - TEST - 1</option>\n    `;\n    console.log(`üìã Cliente poblado con opciones por defecto`);\n  }\n}\n\n/**\n * Poblar los selects de un formulario de pasajero\n * @param {number} numero - N√∫mero del pasajero\n */\nfunction poblarSelectsPasajero(numero) {\n  // Sexo\n  const sexoSelect = document.getElementById(`sexo_${numero}`);\n  if (sexoSelect && masterData.genders.length > 0) {\n    const valorActual = sexoSelect.value;\n    sexoSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.genders.forEach(genero => {\n      const option = document.createElement('option');\n      option.value = genero.code;\n      option.textContent = genero.name;\n      sexoSelect.appendChild(option);\n    });\n    if (valorActual) sexoSelect.value = valorActual;\n    console.log(`üìã Sexo ${numero} poblado con ${masterData.genders.length} opciones`);\n  } else if (sexoSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    sexoSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"M\">MASCULINO</option>\n      <option value=\"F\">FEMENINO</option>\n    `;\n    console.log(`üìã Sexo ${numero} poblado con opciones por defecto`);\n  }\n  \n  // Tipo de Documento\n  const tipoDocSelect = document.getElementById(`tipoDoc_${numero}`);\n  if (tipoDocSelect && masterData.documentTypes.length > 0) {\n    const valorActual = tipoDocSelect.value;\n    tipoDocSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.documentTypes.forEach(tipo => {\n      const option = document.createElement('option');\n      option.value = tipo.code;\n      option.textContent = tipo.name;\n      tipoDocSelect.appendChild(option);\n    });\n    if (valorActual) tipoDocSelect.value = valorActual;\n    console.log(`üìã Tipo Doc ${numero} poblado con ${masterData.documentTypes.length} opciones`);\n  } else if (tipoDocSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    tipoDocSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"DNI\">DOCUMENTO NACIONAL DE IDENTIDAD</option>\n      <option value=\"PAS\">PASAPORTE</option>\n      <option value=\"CI\">C√âDULA DE IDENTIDAD</option>\n      <option value=\"LE\">LIBRETA DE ENROLAMIENTO</option>\n      <option value=\"LC\">LIBRETA C√çVICA</option>\n    `;\n    console.log(`üìã Tipo Doc ${numero} poblado con opciones por defecto`);\n  }\n  \n  // Nacionalidad\n  const nacionalidadSelect = document.getElementById(`nacionalidad_${numero}`);\n  if (nacionalidadSelect && masterData.countries.length > 0) {\n    const valorActual = nacionalidadSelect.value;\n    nacionalidadSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.countries.forEach(pais => {\n      const option = document.createElement('option');\n      option.value = pais.name;\n      option.textContent = pais.name;\n      nacionalidadSelect.appendChild(option);\n    });\n    if (valorActual) nacionalidadSelect.value = valorActual;\n    console.log(`üìã Nacionalidad ${numero} poblada con ${masterData.countries.length} opciones`);\n  } else if (nacionalidadSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    nacionalidadSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"ARGENTINA\">ARGENTINA</option>\n      <option value=\"BRASIL\">BRASIL</option>\n      <option value=\"CHILE\">CHILE</option>\n      <option value=\"URUGUAY\">URUGUAY</option>\n      <option value=\"PARAGUAY\">PARAGUAY</option>\n      <option value=\"BOLIVIA\">BOLIVIA</option>\n      <option value=\"PERU\">PERU</option>\n      <option value=\"COLOMBIA\">COLOMBIA</option>\n      <option value=\"VENEZUELA\">VENEZUELA</option>\n      <option value=\"ECUADOR\">ECUADOR</option>\n      <option value=\"MEXICO\">MEXICO</option>\n      <option value=\"ESPA√ëA\">ESPA√ëA</option>\n      <option value=\"ESTADOS UNIDOS\">ESTADOS UNIDOS</option>\n    `;\n    console.log(`üìã Nacionalidad ${numero} poblada con opciones por defecto`);\n  }\n}\n\nasync function run() {\n  try {\n    // Ocultar el bot√≥n de extraer\n    const runButton = document.getElementById(\"run\");\n    runButton.style.display = \"none\";\n    \n    // Mostrar el loader\n    const loader = document.getElementById(\"loader\");\n    loader.style.display = \"block\";\n    \n    // Ocultar los resultados mientras se extrae\n    const resultsDiv = document.getElementById(\"results\");\n    resultsDiv.style.display = \"none\";\n\n  const item = Office.context.mailbox.item;\n    \n    // Obtener el cuerpo del correo\n    Office.context.mailbox.item.body.getAsync(\n      Office.CoercionType.Text, \n      async (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          const cuerpoCorreo = result.value;\n          \n          try {\n            // Llamar al servicio de extracci√≥n con IA\n            const extractedData = await extraerDatosConIA(cuerpoCorreo);\n            \n            // Ocultar loader\n            loader.style.display = \"none\";\n            \n            // Mostrar resultados\n            resultsDiv.style.display = \"block\";\n            \n            if (extractedData && extractedData.passengers && extractedData.passengers.length > 0) {\n              // Crear formularios seg√∫n el n√∫mero de pasajeros extra√≠dos\n              crearFormulariosPasajeros(extractedData.passengers.length);\n              \n              // Llenar los datos de los pasajeros\n              llenarDatosPasajeros(extractedData.passengers);\n              \n              // Llenar los datos de la reserva\n              llenarDatosReserva(extractedData);\n              \n              mostrarMensaje(`‚úÖ Datos extra√≠dos: ${extractedData.passengers.length} pasajero(s)`, \"success\");\n            } else {\n              // Si no se extrajeron pasajeros, crear un formulario vac√≠o\n              crearFormulariosPasajeros(1);\n              mostrarMensaje(\"No se pudieron extraer datos. Por favor, llena el formulario manualmente.\", \"info\");\n            }\n          } catch (error) {\n            // Ocultar loader\n            loader.style.display = \"none\";\n            \n            // Mostrar resultados con formulario vac√≠o\n            resultsDiv.style.display = \"block\";\n            \n            // Si falla la extracci√≥n, crear un formulario vac√≠o\n            crearFormulariosPasajeros(1);\n            mostrarMensaje(\"Error al extraer datos: \" + error.message + \". Llena el formulario manualmente.\", \"error\");\n          }\n        } else {\n          // Ocultar loader\n          loader.style.display = \"none\";\n          \n          // Mostrar bot√≥n de nuevo\n          runButton.style.display = \"block\";\n          \n          mostrarMensaje(\"Error al obtener el contenido del correo\", \"error\");\n        }\n      }\n    );\n  } catch (error) {\n    // Ocultar loader\n    const loader = document.getElementById(\"loader\");\n    loader.style.display = \"none\";\n    \n    // Mostrar bot√≥n de nuevo\n    const runButton = document.getElementById(\"run\");\n    runButton.style.display = \"block\";\n    \n    mostrarMensaje(\"Error inesperado: \" + error.message, \"error\");\n  }\n}\n\n/**\n * Llama al servicio de extracci√≥n con IA\n */\nasync function extraerDatosConIA(emailContent) {\n  // Usar la variable global RPA_API_URL inyectada por webpack\n  const extractUrl = typeof RPA_API_URL !== 'undefined'\n    ? RPA_API_URL + '/api/extract'\n    : 'http://localhost:3001/api/extract';\n  \n  const response = await fetch(extractUrl, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      emailContent: emailContent,\n      userId: Office.context.mailbox.userProfile.emailAddress || 'outlook-user'\n    })\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.error || 'Error al extraer datos');\n  }\n\n  const result = await response.json();\n  return result.data;\n}\n\nfunction crearFormulariosPasajeros(numeroPasajeros) {\n  const container = document.getElementById(\"pasajerosContainer\");\n  container.innerHTML = \"\"; // Limpiar contenedor\n  \n  for (let i = 0; i < numeroPasajeros; i++) {\n    const pasajeroDiv = crearFormularioPasajero(i + 1);\n    container.appendChild(pasajeroDiv);\n  }\n  \n  // Actualizar estado del bot√≥n despu√©s de crear los formularios\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\nfunction crearFormularioPasajero(numero) {\n  const pasajeroDiv = document.createElement(\"div\");\n  pasajeroDiv.className = \"pasajero-acordeon\";\n  pasajeroDiv.dataset.numeroPasajero = numero;\n  \n  // Cabecera del acorde√≥n (clickeable)\n  const header = document.createElement(\"div\");\n  header.className = \"pasajero-header\";\n  header.innerHTML = `\n    <span class=\"pasajero-titulo\">Pasajero ${numero}</span>\n    <div class=\"pasajero-actions\">\n      <span class=\"arrow\">‚ñº</span>\n      <button class=\"btn-eliminar-pasajero\" title=\"Eliminar pasajero\">‚úï</button>\n    </div>\n  `;\n  \n  // Contenido del acorde√≥n (formulario)\n  const content = document.createElement(\"div\");\n  content.className = \"pasajero-content\";\n  content.style.display = \"none\";\n  content.innerHTML = `\n    <div>\n      <label>Tipo de Pasajero:</label>\n      <select id=\"tipoPasajero_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"adulto\">Adulto</option>\n        <option value=\"menor\">Menor</option>\n        <option value=\"infante\">Infante</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nombre: <span style=\"color: red;\">*</span></label>\n      <input type=\"text\" id=\"nombre_${numero}\" placeholder=\"Ingrese el nombre\">\n    </div>\n\n    <div>\n      <label>Apellido: <span style=\"color: red;\">*</span></label>\n      <input type=\"text\" id=\"apellido_${numero}\" placeholder=\"Ingrese el apellido\">\n    </div>\n\n    <div>\n      <label>DNI:</label>\n      <input type=\"number\" id=\"dni_${numero}\" placeholder=\"Ingrese el DNI\">\n    </div>\n\n    <div>\n      <label>Fecha de Nacimiento:</label>\n      <input type=\"date\" id=\"fechaNacimiento_${numero}\">\n    </div>\n\n    <div>\n      <label>CUIL:</label>\n      <input type=\"number\" id=\"cuil_${numero}\" placeholder=\"Ingrese el CUIL\">\n    </div>\n\n    <div>\n      <label>Tipo de Documento:</label>\n      <select id=\"tipoDoc_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"dni\">DNI</option>\n        <option value=\"pasaporte\">Pasaporte</option>\n        <option value=\"cedula\">C√©dula</option>\n        <option value=\"otro\">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Sexo:</label>\n      <select id=\"sexo_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"masculino\">Masculino</option>\n        <option value=\"femenino\">Femenino</option>\n        <option value=\"otro\">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nacionalidad:</label>\n      <select id=\"nacionalidad_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"argentina\">Argentina</option>\n        <option value=\"brasilera\">Brasilera</option>\n        <option value=\"chilena\">Chilena</option>\n        <option value=\"uruguaya\">Uruguaya</option>\n        <option value=\"paraguaya\">Paraguaya</option>\n        <option value=\"boliviana\">Boliviana</option>\n        <option value=\"peruana\">Peruana</option>\n        <option value=\"colombiana\">Colombiana</option>\n        <option value=\"venezolana\">Venezolana</option>\n        <option value=\"otra\">Otra</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Direcci√≥n:</label>\n      <input type=\"text\" id=\"direccion_${numero}\" placeholder=\"Ingrese la direcci√≥n\">\n    </div>\n\n    <div>\n      <label>N√∫mero de Tel√©fono:</label>\n      <input type=\"tel\" id=\"telefono_${numero}\" placeholder=\"Ingrese el tel√©fono\">\n    </div>\n  `;\n  \n  // Funcionalidad de acorde√≥n (toggle)\n  header.onclick = function(e) {\n    // No hacer toggle si se clicke√≥ el bot√≥n de eliminar\n    if (e.target.classList.contains('btn-eliminar-pasajero')) {\n      return;\n    }\n    \n    const isOpen = content.style.display === \"block\";\n    const arrow = header.querySelector(\".arrow\");\n    \n    if (isOpen) {\n      content.style.display = \"none\";\n      arrow.style.transform = \"rotate(0deg)\";\n    } else {\n      content.style.display = \"block\";\n      arrow.style.transform = \"rotate(180deg)\";\n    }\n  };\n  \n  // Agregar event listeners para validaci√≥n en tiempo real (solo nombre y apellido)\n  setTimeout(() => {\n    const nombreInput = document.getElementById(`nombre_${numero}`);\n    const apellidoInput = document.getElementById(`apellido_${numero}`);\n    \n    if (nombreInput) {\n      nombreInput.addEventListener('input', actualizarEstadoBotonCrearReserva);\n    }\n    if (apellidoInput) {\n      apellidoInput.addEventListener('input', actualizarEstadoBotonCrearReserva);\n    }\n  }, 100);\n  \n  // Funcionalidad del bot√≥n eliminar\n  const btnEliminar = header.querySelector('.btn-eliminar-pasajero');\n  btnEliminar.onclick = function(e) {\n    e.stopPropagation(); // Evitar que se abra/cierre el acorde√≥n\n    eliminarPasajero(pasajeroDiv);\n  };\n  \n  pasajeroDiv.appendChild(header);\n  pasajeroDiv.appendChild(content);\n  \n  // Poblar los selects con datos maestros despu√©s de crear el formulario\n  setTimeout(() => {\n    poblarSelectsPasajero(numero);\n  }, 50);\n  \n  return pasajeroDiv;\n}\n\nfunction eliminarPasajero(pasajeroDiv) {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    \n    // No permitir eliminar si solo hay un pasajero\n    if (pasajeros.length <= 1) {\n      mostrarMensaje(\"Debe haber al menos un pasajero\", \"info\");\n      return;\n    }\n    \n    // Eliminar directamente sin confirmaci√≥n (o puedes crear un modal personalizado)\n    pasajeroDiv.remove();\n    renumerarPasajeros();\n    mostrarMensaje(\"Pasajero eliminado correctamente\", \"success\");\n    \n    // Actualizar estado del bot√≥n despu√©s de eliminar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    mostrarMensaje(\"Error al eliminar pasajero\", \"error\");\n  }\n}\n\nfunction renumerarPasajeros() {\n  const container = document.getElementById(\"pasajerosContainer\");\n  const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n  \n  pasajeros.forEach((pasajeroDiv, index) => {\n    const nuevoNumero = index + 1;\n    const titulo = pasajeroDiv.querySelector(\".pasajero-titulo\");\n    titulo.textContent = `Pasajero ${nuevoNumero}`;\n    pasajeroDiv.dataset.numeroPasajero = nuevoNumero;\n  });\n}\n\nfunction agregarNuevoPasajero() {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    const nuevoNumero = pasajeros.length + 1;\n    \n    const nuevoPasajero = crearFormularioPasajero(nuevoNumero);\n    container.appendChild(nuevoPasajero);\n    \n    // Abrir autom√°ticamente el nuevo pasajero\n    const content = nuevoPasajero.querySelector(\".pasajero-content\");\n    const arrow = nuevoPasajero.querySelector(\".arrow\");\n    if (content && arrow) {\n      content.style.display = \"block\";\n      arrow.style.transform = \"rotate(180deg)\";\n    }\n    \n    // Scroll suave hacia el nuevo pasajero\n    if (nuevoPasajero.scrollIntoView) {\n      nuevoPasajero.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n    }\n    \n    // Actualizar estado del bot√≥n despu√©s de agregar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    throw error;\n  }\n}\n\nfunction guardarDatos() {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      mostrarMensaje(\"No se encontr√≥ el contenedor de pasajeros\", \"error\");\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    if (pasajeros.length === 0) {\n      mostrarMensaje(\"No hay pasajeros para guardar. Por favor, extraiga datos primero.\", \"info\");\n      return;\n    }\n    \n    const todosPasajeros = [];\n    \n    pasajeros.forEach((pasajeroDiv, index) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      \n      // Obtener valores directamente del DOM del pasajero\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      if (content) {\n        const datos = {\n          numeroPasajero: index + 1, // N√∫mero secuencial para el guardado\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        todosPasajeros.push(datos);\n      }\n    });\n    \n    // Aqu√≠ puedes enviar los datos a tu backend/base de datos\n    // Por ejemplo: enviar a Azure Function, API, etc.\n    // fetch('tu-api-url', {\n    //   method: 'POST',\n    //   headers: { 'Content-Type': 'application/json' },\n    //   body: JSON.stringify(todosPasajeros)\n    // });\n    \n    mostrarMensaje(`Datos de ${todosPasajeros.length} pasajero(s) guardados correctamente`, \"success\");\n  } catch (error) {\n    throw error;\n  }\n}\n\nfunction llenarDatosPasajeros(datosPasajeros) {\n  // Funci√≥n auxiliar para llenar los datos extra√≠dos por la IA\n  // Esperar un poco para asegurar que los selects est√©n poblados\n  setTimeout(() => {\n    datosPasajeros.forEach((datos, index) => {\n      const numero = index + 1;\n      \n      if (document.getElementById(`tipoPasajero_${numero}`)) {\n        // Mapear passengerType o paxType de la IA a tipoPasajero del formulario\n        let tipoPasajero = \"\";\n        const passengerType = datos.passengerType || datos.paxType;\n        if (passengerType === \"ADU\") tipoPasajero = \"adulto\";\n        else if (passengerType === \"CHD\") tipoPasajero = \"menor\";\n        else if (passengerType === \"INF\") tipoPasajero = \"infante\";\n        \n        // Los valores de sex, documentType y nationality ahora vienen normalizados del backend\n        // sex viene como c√≥digo: \"M\" o \"F\"\n        // documentType viene como c√≥digo: \"DNI\", \"PAS\", \"CI\", etc.\n        // nationality viene como nombre completo en may√∫sculas: \"ARGENTINA\", \"BRASIL\", etc.\n        \n        document.getElementById(`tipoPasajero_${numero}`).value = tipoPasajero;\n        document.getElementById(`nombre_${numero}`).value = datos.firstName || \"\";\n        document.getElementById(`apellido_${numero}`).value = datos.lastName || \"\";\n        document.getElementById(`dni_${numero}`).value = datos.documentNumber || \"\";\n        // El backend env√≠a dateOfBirth, no birthDate\n        document.getElementById(`fechaNacimiento_${numero}`).value = datos.dateOfBirth || datos.birthDate || \"\";\n        document.getElementById(`cuil_${numero}`).value = datos.cuilCuit || \"\";\n        \n        // Usar los c√≥digos directamente tal como vienen del backend\n        const tipoDocSelect = document.getElementById(`tipoDoc_${numero}`);\n        if (tipoDocSelect && datos.documentType) {\n          tipoDocSelect.value = datos.documentType;\n          console.log(`‚úÖ Tipo Doc ${numero}: ${datos.documentType} -> ${tipoDocSelect.value}`);\n        }\n        \n        const sexoSelect = document.getElementById(`sexo_${numero}`);\n        if (sexoSelect && datos.sex) {\n          sexoSelect.value = datos.sex;\n          console.log(`‚úÖ Sexo ${numero}: ${datos.sex} -> ${sexoSelect.value}`);\n        }\n        \n        const nacionalidadSelect = document.getElementById(`nacionalidad_${numero}`);\n        if (nacionalidadSelect && datos.nationality) {\n          nacionalidadSelect.value = datos.nationality;\n          console.log(`‚úÖ Nacionalidad ${numero}: ${datos.nationality} -> ${nacionalidadSelect.value}`);\n        }\n        \n        document.getElementById(`direccion_${numero}`).value = datos.direccion || \"\";\n        // El backend env√≠a phoneNumber, no telefono\n        document.getElementById(`telefono_${numero}`).value = datos.phoneNumber || datos.telefono || \"\";\n      }\n    });\n    \n    // Actualizar estado del bot√≥n despu√©s de llenar los datos\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  }, 150); // Esperar 150ms para que los selects se pueblen primero\n}\n\n/**\n * Llena los datos de la reserva extra√≠dos por la IA\n */\nfunction llenarDatosReserva(datosExtraidos) {\n  // Repoblar los selects de reserva primero para asegurar que tengan opciones\n  poblarSelectReserva();\n  \n  // Esperar un poco m√°s para asegurar que los selects est√©n poblados\n  setTimeout(() => {\n    // Tipo de Reserva\n    const tipoReservaSelect = document.getElementById(\"tipoReserva\");\n    if (tipoReservaSelect) {\n      const valorTipoReserva = datosExtraidos.reservationType;\n      console.log(`üîç Intentando asignar Tipo Reserva: \"${valorTipoReserva}\"`);\n      console.log(`üìã Opciones en select:`, Array.from(tipoReservaSelect.options).map(o => `\"${o.value}\"`));\n      \n      if (valorTipoReserva && valorTipoReserva !== 'null' && valorTipoReserva !== null) {\n        tipoReservaSelect.value = valorTipoReserva;\n        console.log(`‚úÖ Tipo Reserva asignado: \"${valorTipoReserva}\" -> \"${tipoReservaSelect.value}\"`);\n        \n        // Si no se seleccion√≥, intentar buscar una coincidencia parcial\n        if (!tipoReservaSelect.value || tipoReservaSelect.value === \"\") {\n          const opciones = Array.from(tipoReservaSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorTipoReserva &&\n            (opt.value.toUpperCase().includes(valorTipoReserva.toUpperCase()) ||\n            valorTipoReserva.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            tipoReservaSelect.value = coincidencia.value;\n            console.log(`‚úÖ Tipo Reserva (coincidencia): \"${valorTipoReserva}\" -> \"${tipoReservaSelect.value}\"`);\n          } else {\n            console.warn(`‚ö†Ô∏è No se encontr√≥ coincidencia para Tipo Reserva: \"${valorTipoReserva}\"`);\n          }\n        }\n      }\n    }\n    \n    // Estado\n    const estadoReservaSelect = document.getElementById(\"estadoReserva\");\n    if (estadoReservaSelect) {\n      const valorEstado = datosExtraidos.status;\n      const opcionesDisponibles = Array.from(estadoReservaSelect.options).map(o => o.value);\n      \n      console.log(`üîç Intentando asignar Estado: \"${valorEstado}\"`);\n      console.log(`üìã Opciones disponibles en select Estado:`, opcionesDisponibles);\n      console.log(`üìä Total de opciones: ${opcionesDisponibles.length}`);\n      \n      if (valorEstado && valorEstado !== 'null' && valorEstado !== null) {\n        // Intentar asignaci√≥n directa\n        estadoReservaSelect.value = valorEstado;\n        console.log(`üîÑ Intento directo: \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n        \n        // Si no se seleccion√≥, intentar buscar una coincidencia\n        if (!estadoReservaSelect.value || estadoReservaSelect.value === \"\") {\n          console.log(`‚ö†Ô∏è Asignaci√≥n directa fall√≥, buscando coincidencia...`);\n          \n          const opciones = Array.from(estadoReservaSelect.options);\n          \n          // Intentar coincidencia exacta ignorando espacios y may√∫sculas\n          let coincidencia = opciones.find(opt => \n            opt.value && \n            opt.value.trim().toUpperCase() === valorEstado.trim().toUpperCase()\n          );\n          \n          if (coincidencia) {\n            estadoReservaSelect.value = coincidencia.value;\n            console.log(`‚úÖ Estado (coincidencia exacta): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n          } else {\n            // Intentar coincidencia parcial\n            coincidencia = opciones.find(opt => \n              opt.value && valorEstado &&\n              (opt.value.toUpperCase().includes(valorEstado.toUpperCase()) ||\n              valorEstado.toUpperCase().includes(opt.value.toUpperCase()))\n            );\n            \n            if (coincidencia) {\n              estadoReservaSelect.value = coincidencia.value;\n              console.log(`‚úÖ Estado (coincidencia parcial): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n            } else {\n              // Intentar mapeo inteligente por palabras clave\n              const valorUpper = valorEstado.toUpperCase();\n              \n              if (valorUpper.includes('CONFIRMAD') || valorUpper.includes('CONFIRM')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('CONFIRMAD'));\n              } else if (valorUpper.includes('PENDIENTE') || valorUpper.includes('PENDING')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('PENDIENTE'));\n              } else if (valorUpper.includes('CANCELAD') || valorUpper.includes('CANCEL')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('CANCELAD'));\n              }\n              \n              if (coincidencia) {\n                estadoReservaSelect.value = coincidencia.value;\n                console.log(`‚úÖ Estado (mapeo inteligente): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n              } else {\n                console.error(`‚ùå No se encontr√≥ ninguna coincidencia para Estado: \"${valorEstado}\"`);\n                console.log(`üí° Sugerencia: Verifica que el valor extra√≠do coincida con alguna de estas opciones:`, opcionesDisponibles);\n              }\n            }\n          }\n        } else {\n          console.log(`‚úÖ Estado asignado correctamente: \"${estadoReservaSelect.value}\"`);\n        }\n      } else {\n        console.log(`‚ö†Ô∏è Estado es null o inv√°lido: \"${valorEstado}\"`);\n      }\n    }\n    \n    // Fecha de Viaje\n    if (document.getElementById(\"fechaViaje\")) {\n      document.getElementById(\"fechaViaje\").value = datosExtraidos.travelDate || \"\";\n      console.log(`‚úÖ Fecha Viaje: ${datosExtraidos.travelDate}`);\n    }\n    \n    // Vendedor\n    const vendedorSelect = document.getElementById(\"vendedor\");\n    if (vendedorSelect) {\n      const valorVendedor = datosExtraidos.seller;\n      if (valorVendedor && valorVendedor !== 'null' && valorVendedor !== null) {\n        vendedorSelect.value = valorVendedor;\n        console.log(`‚úÖ Vendedor: \"${valorVendedor}\" -> \"${vendedorSelect.value}\"`);\n        \n        // Si no se seleccion√≥, intentar buscar una coincidencia parcial\n        if (!vendedorSelect.value || vendedorSelect.value === \"\") {\n          const opciones = Array.from(vendedorSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorVendedor &&\n            (opt.value.toUpperCase().includes(valorVendedor.toUpperCase()) ||\n            valorVendedor.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            vendedorSelect.value = coincidencia.value;\n            console.log(`‚úÖ Vendedor (coincidencia): \"${valorVendedor}\" -> \"${vendedorSelect.value}\"`);\n          }\n        }\n      } else {\n        console.log(`‚ö†Ô∏è Vendedor es null o inv√°lido: \"${valorVendedor}\"`);\n      }\n    }\n    \n    // Cliente\n    const clienteSelect = document.getElementById(\"cliente\");\n    if (clienteSelect) {\n      const valorCliente = datosExtraidos.client;\n      if (valorCliente && valorCliente !== 'null' && valorCliente !== null) {\n        clienteSelect.value = valorCliente;\n        console.log(`‚úÖ Cliente: \"${valorCliente}\" -> \"${clienteSelect.value}\"`);\n        \n        // Si no se seleccion√≥, intentar buscar una coincidencia parcial\n        if (!clienteSelect.value || clienteSelect.value === \"\") {\n          const opciones = Array.from(clienteSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorCliente &&\n            (opt.value.toUpperCase().includes(valorCliente.toUpperCase()) ||\n            valorCliente.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            clienteSelect.value = coincidencia.value;\n            console.log(`‚úÖ Cliente (coincidencia): \"${valorCliente}\" -> \"${clienteSelect.value}\"`);\n          }\n        }\n      } else {\n        console.log(`‚ö†Ô∏è Cliente es null o inv√°lido: \"${valorCliente}\"`);\n      }\n    }\n    \n    // Campos adicionales de la reserva\n    // C√≥digo\n    if (document.getElementById(\"codigo\")) {\n      document.getElementById(\"codigo\").value = datosExtraidos.codigo || \"\";\n    }\n    \n    // Fecha de Reserva\n    if (document.getElementById(\"fechaReserva\")) {\n      document.getElementById(\"fechaReserva\").value = datosExtraidos.reservationDate || \"\";\n    }\n    \n    // Fecha Fin de Tour\n    if (document.getElementById(\"fechaFinTour\")) {\n      document.getElementById(\"fechaFinTour\").value = datosExtraidos.tourEndDate || \"\";\n    }\n    \n    // Fecha de Vencimiento\n    if (document.getElementById(\"fechaVencimiento\")) {\n      document.getElementById(\"fechaVencimiento\").value = datosExtraidos.dueDate || \"\";\n    }\n    \n    // Contacto\n    if (document.getElementById(\"contacto\")) {\n      document.getElementById(\"contacto\").value = datosExtraidos.contact || \"\";\n    }\n    \n    // Email de Contacto\n    if (document.getElementById(\"contactEmail\")) {\n      document.getElementById(\"contactEmail\").value = datosExtraidos.contactEmail || \"\";\n    }\n    \n    // Tel√©fono de Contacto\n    if (document.getElementById(\"contactPhone\")) {\n      document.getElementById(\"contactPhone\").value = datosExtraidos.contactPhone || \"\";\n    }\n    \n    // Moneda\n    if (document.getElementById(\"moneda\")) {\n      document.getElementById(\"moneda\").value = datosExtraidos.currency || \"\";\n    }\n    \n    // Tipo de Cambio\n    if (document.getElementById(\"tipoCambio\")) {\n      document.getElementById(\"tipoCambio\").value = datosExtraidos.exchangeRate || \"\";\n    }\n    \n    // Comisi√≥n\n    if (document.getElementById(\"comision\")) {\n      document.getElementById(\"comision\").value = datosExtraidos.commission || \"\";\n    }\n    \n    // Monto Neto\n    if (document.getElementById(\"montoNeto\")) {\n      document.getElementById(\"montoNeto\").value = datosExtraidos.netAmount || \"\";\n    }\n    \n    // Monto Bruto\n    if (document.getElementById(\"montoBruto\")) {\n      document.getElementById(\"montoBruto\").value = datosExtraidos.grossAmount || \"\";\n    }\n    \n    // Nombre del Viaje\n    if (document.getElementById(\"nombreViaje\")) {\n      document.getElementById(\"nombreViaje\").value = datosExtraidos.tripName || \"\";\n    }\n    \n    // C√≥digo de Producto\n    if (document.getElementById(\"codigoProducto\")) {\n      document.getElementById(\"codigoProducto\").value = datosExtraidos.productCode || \"\";\n    }\n    \n    // Adultos\n    if (document.getElementById(\"adultos\")) {\n      document.getElementById(\"adultos\").value = datosExtraidos.adults || \"\";\n    }\n    \n    // Ni√±os\n    if (document.getElementById(\"ninos\")) {\n      document.getElementById(\"ninos\").value = datosExtraidos.children || \"\";\n    }\n    \n    // Infantes\n    if (document.getElementById(\"infantes\")) {\n      document.getElementById(\"infantes\").value = datosExtraidos.infants || \"\";\n    }\n    \n    // Proveedor\n    if (document.getElementById(\"proveedor\")) {\n      document.getElementById(\"proveedor\").value = datosExtraidos.provider || \"\";\n    }\n    \n    // C√≥digo de Reserva\n    if (document.getElementById(\"codigoReserva\")) {\n      document.getElementById(\"codigoReserva\").value = datosExtraidos.reservationCode || \"\";\n    }\n    \n    // Hotel\n    if (document.getElementById(\"hotel\")) {\n      document.getElementById(\"hotel\").value = datosExtraidos.hotel || \"\";\n    }\n    \n    // Check In\n    if (document.getElementById(\"checkIn\")) {\n      document.getElementById(\"checkIn\").value = datosExtraidos.checkIn || \"\";\n    }\n    \n    // Check Out\n    if (document.getElementById(\"checkOut\")) {\n      document.getElementById(\"checkOut\").value = datosExtraidos.checkOut || \"\";\n    }\n    \n    // Estado de Deuda\n    if (document.getElementById(\"estadoDeuda\")) {\n      document.getElementById(\"estadoDeuda\").value = datosExtraidos.estadoDeuda || \"\";\n    }\n    \n    // Llenar servicios si existen\n    if (datosExtraidos.services && Array.isArray(datosExtraidos.services) && datosExtraidos.services.length > 0) {\n      const serviciosSection = document.getElementById(\"serviciosSection\");\n      if (serviciosSection) {\n        serviciosSection.style.display = \"block\";\n      }\n      llenarServicios(datosExtraidos.services);\n    }\n    \n    // Llenar vuelos si existen\n    if (datosExtraidos.flights && Array.isArray(datosExtraidos.flights) && datosExtraidos.flights.length > 0) {\n      const vuelosSection = document.getElementById(\"vuelosSection\");\n      if (vuelosSection) {\n        vuelosSection.style.display = \"block\";\n      }\n      llenarVuelos(datosExtraidos.flights);\n    }\n    \n    // Actualizar estado del bot√≥n despu√©s de llenar los datos\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  }, 250); // Esperar 250ms para asegurar que los selects est√©n poblados\n}\n\n/**\n * Llena los servicios en el formulario\n * @param {Array} servicios - Array de servicios extra√≠dos\n */\nfunction llenarServicios(servicios) {\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  if (!serviciosContainer) return;\n  \n  serviciosContainer.innerHTML = \"\";\n  \n  servicios.forEach((servicio, index) => {\n    const servicioDiv = document.createElement(\"div\");\n    servicioDiv.className = \"servicio-item\";\n    servicioDiv.innerHTML = `\n      <h4>Servicio ${index + 1}</h4>\n      <div class=\"form-group\">\n        <label>Destino:</label>\n        <input type=\"text\" id=\"servicio_destino_${index}\" value=\"${servicio.destino || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Fecha Entrada:</label>\n        <input type=\"date\" id=\"servicio_in_${index}\" value=\"${servicio.in || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Fecha Salida:</label>\n        <input type=\"date\" id=\"servicio_out_${index}\" value=\"${servicio.out || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Noches:</label>\n        <input type=\"number\" id=\"servicio_nts_${index}\" value=\"${servicio.nts || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Base Pax:</label>\n        <input type=\"number\" id=\"servicio_basePax_${index}\" value=\"${servicio.basePax || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Servicio:</label>\n        <input type=\"text\" id=\"servicio_servicio_${index}\" value=\"${servicio.servicio || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Descripci√≥n:</label>\n        <textarea id=\"servicio_descripcion_${index}\" readonly>${servicio.descripcion || ''}</textarea>\n      </div>\n      <div class=\"form-group\">\n        <label>Estado:</label>\n        <input type=\"text\" id=\"servicio_estado_${index}\" value=\"${servicio.estado || ''}\" readonly>\n      </div>\n    `;\n    serviciosContainer.appendChild(servicioDiv);\n  });\n}\n\n/**\n * Llena los vuelos en el formulario\n * @param {Array} vuelos - Array de vuelos extra√≠dos\n */\nfunction llenarVuelos(vuelos) {\n  const vuelosContainer = document.getElementById(\"vuelosContainer\");\n  if (!vuelosContainer) return;\n  \n  vuelosContainer.innerHTML = \"\";\n  \n  vuelos.forEach((vuelo, index) => {\n    const vueloDiv = document.createElement(\"div\");\n    vueloDiv.className = \"vuelo-item\";\n    vueloDiv.innerHTML = `\n      <h4>Vuelo ${index + 1}</h4>\n      <div class=\"form-group\">\n        <label>Aerol√≠nea:</label>\n        <input type=\"text\" id=\"vuelo_airline_${index}\" value=\"${vuelo.airline || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>N√∫mero de Vuelo:</label>\n        <input type=\"text\" id=\"vuelo_flightNumber_${index}\" value=\"${vuelo.flightNumber || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Origen:</label>\n        <input type=\"text\" id=\"vuelo_origin_${index}\" value=\"${vuelo.origin || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Destino:</label>\n        <input type=\"text\" id=\"vuelo_destination_${index}\" value=\"${vuelo.destination || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Fecha:</label>\n        <input type=\"date\" id=\"vuelo_date_${index}\" value=\"${vuelo.date || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Hora:</label>\n        <input type=\"time\" id=\"vuelo_time_${index}\" value=\"${vuelo.time || ''}\" readonly>\n      </div>\n    `;\n    vuelosContainer.appendChild(vueloDiv);\n  });\n}\n\n/**\n * Valida si todos los campos obligatorios est√°n completos\n * @returns {boolean} true si todos los campos est√°n completos\n */\nfunction validarCamposObligatorios() {\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (!container) return false;\n  \n  const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n  if (pasajeros.length === 0) return false;\n  \n  // Validar pasajeros (solo nombre y apellido)\n  let pasajerosValidos = true;\n  pasajeros.forEach((pasajeroDiv) => {\n    const numero = pasajeroDiv.dataset.numeroPasajero;\n    const content = pasajeroDiv.querySelector(\".pasajero-content\");\n    \n    if (content) {\n      const nombre = content.querySelector(`#nombre_${numero}`)?.value || \"\";\n      const apellido = content.querySelector(`#apellido_${numero}`)?.value || \"\";\n      \n      if (nombre.trim() === \"\" || apellido.trim() === \"\") {\n        pasajerosValidos = false;\n      }\n    }\n  });\n  \n  // Validar datos de reserva (todos obligatorios)\n  const tipoReserva = document.getElementById(\"tipoReserva\")?.value || \"\";\n  const estadoReserva = document.getElementById(\"estadoReserva\")?.value || \"\";\n  const fechaViaje = document.getElementById(\"fechaViaje\")?.value || \"\";\n  const vendedor = document.getElementById(\"vendedor\")?.value || \"\";\n  const cliente = document.getElementById(\"cliente\")?.value || \"\";\n  \n  const reservaValida = \n    tipoReserva.trim() !== \"\" &&\n    estadoReserva.trim() !== \"\" &&\n    fechaViaje.trim() !== \"\" &&\n    vendedor.trim() !== \"\" &&\n    cliente.trim() !== \"\";\n  \n  return pasajerosValidos && reservaValida;\n}\n\n/**\n * Actualiza el estado del bot√≥n \"Crear Reserva\" seg√∫n la validaci√≥n\n */\nfunction actualizarEstadoBotonCrearReserva() {\n  const boton = document.getElementById(\"crearReserva\");\n  if (!boton) return;\n  \n  const esValido = validarCamposObligatorios();\n  \n  if (esValido) {\n    boton.disabled = false;\n    boton.style.opacity = \"1\";\n    boton.style.cursor = \"pointer\";\n  } else {\n    boton.disabled = true;\n    boton.style.opacity = \"0.5\";\n    boton.style.cursor = \"not-allowed\";\n  }\n}\n\n/**\n * Deshabilita todos los campos del formulario\n */\nfunction deshabilitarFormularios() {\n  // Deshabilitar campos de pasajeros\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const inputs = container.querySelectorAll(\"input, select\");\n    inputs.forEach(input => {\n      input.disabled = true;\n      input.style.backgroundColor = \"#f3f4f6\";\n      input.style.cursor = \"not-allowed\";\n    });\n    \n    // Deshabilitar botones de eliminar pasajero\n    const botonesEliminar = container.querySelectorAll(\".btn-eliminar-pasajero\");\n    botonesEliminar.forEach(btn => {\n      btn.disabled = true;\n      btn.style.opacity = \"0.3\";\n      btn.style.cursor = \"not-allowed\";\n      btn.style.pointerEvents = \"none\";\n    });\n  }\n  \n  // Deshabilitar campos de reserva\n  const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n  camposReserva.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.disabled = true;\n      campo.style.backgroundColor = \"#f3f4f6\";\n      campo.style.cursor = \"not-allowed\";\n    }\n  });\n  \n  // Deshabilitar bot√≥n de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.disabled = true;\n    btnAgregar.style.opacity = \"0.5\";\n    btnAgregar.style.cursor = \"not-allowed\";\n  }\n  \n  // Deshabilitar bot√≥n de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.disabled = true;\n    btnGuardar.style.opacity = \"0.5\";\n    btnGuardar.style.cursor = \"not-allowed\";\n  }\n}\n\n/**\n * Convierte los formularios a modo lectura (texto plano)\n */\nfunction convertirAModoLectura() {\n  // Convertir pasajeros a modo lectura\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    \n    pasajeros.forEach((pasajeroDiv) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      \n      if (content) {\n        // Obtener valores actuales\n        const datos = {\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        // Crear HTML en modo lectura\n        content.innerHTML = `\n          <div class=\"campo-lectura\">\n            <label>Tipo de Pasajero:</label>\n            <p>${datos.tipoPasajero || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Nombre:</label>\n            <p>${datos.nombre || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Apellido:</label>\n            <p>${datos.apellido || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>DNI:</label>\n            <p>${datos.dni || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Fecha de Nacimiento:</label>\n            <p>${datos.fechaNacimiento || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>CUIL:</label>\n            <p>${datos.cuil || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Tipo de Documento:</label>\n            <p>${datos.tipoDoc || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Sexo:</label>\n            <p>${datos.sexo || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Nacionalidad:</label>\n            <p>${datos.nacionalidad || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Direcci√≥n:</label>\n            <p>${datos.direccion || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>N√∫mero de Tel√©fono:</label>\n            <p>${datos.telefono || '-'}</p>\n          </div>\n        `;\n      }\n      \n      // Ocultar bot√≥n de eliminar\n      const btnEliminar = pasajeroDiv.querySelector(\".btn-eliminar-pasajero\");\n      if (btnEliminar) {\n        btnEliminar.style.display = \"none\";\n      }\n    });\n  }\n  \n  // Convertir datos de reserva a modo lectura\n  const datosReservaSection = document.getElementById(\"datosReservaSection\");\n  if (datosReservaSection) {\n    const datosReserva = {\n      tipoReserva: document.getElementById(\"tipoReserva\")?.value || \"\",\n      estadoReserva: document.getElementById(\"estadoReserva\")?.value || \"\",\n      fechaViaje: document.getElementById(\"fechaViaje\")?.value || \"\",\n      vendedor: document.getElementById(\"vendedor\")?.value || \"\",\n      cliente: document.getElementById(\"cliente\")?.value || \"\"\n    };\n    \n    datosReservaSection.innerHTML = `\n      <h3>Datos de la Reserva</h3>\n      <div class=\"campo-lectura\">\n        <label>Tipo de Reserva:</label>\n        <p>${datosReserva.tipoReserva || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Estado:</label>\n        <p>${datosReserva.estadoReserva || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Fecha de Viaje:</label>\n        <p>${datosReserva.fechaViaje || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Vendedor:</label>\n        <p>${datosReserva.vendedor || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Cliente:</label>\n        <p>${datosReserva.cliente || '-'}</p>\n      </div>\n    `;\n  }\n  \n  // Ocultar bot√≥n de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.style.display = \"none\";\n  }\n  \n  // Ocultar bot√≥n de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.style.display = \"none\";\n  }\n  \n  // Ocultar bot√≥n de crear reserva\n  const btnCrearReserva = document.getElementById(\"crearReserva\");\n  if (btnCrearReserva) {\n    btnCrearReserva.style.display = \"none\";\n  }\n}\n\n/**\n * Ejecuta la creaci√≥n de reserva en iTraffic usando RPA\n */\nasync function ejecutarCrearReserva() {\n  try {\n    // Obtener datos de todos los pasajeros\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      mostrarMensaje(\"No se encontr√≥ el contenedor de pasajeros\", \"error\");\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    if (pasajeros.length === 0) {\n      mostrarMensaje(\"No hay pasajeros para crear la reserva. Por favor, extraiga datos primero.\", \"info\");\n      return;\n    }\n    \n    // Recopilar datos de todos los pasajeros\n    const todosPasajeros = [];\n    pasajeros.forEach((pasajeroDiv, index) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      \n      if (content) {\n        const datos = {\n          numeroPasajero: index + 1,\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        todosPasajeros.push(datos);\n      }\n    });\n    \n    // Capturar datos de la reserva\n    const datosReserva = {\n      tipoReserva: document.getElementById(\"tipoReserva\")?.value || \"\",\n      estadoReserva: document.getElementById(\"estadoReserva\")?.value || \"\",\n      fechaViaje: document.getElementById(\"fechaViaje\")?.value || \"\",\n      vendedor: document.getElementById(\"vendedor\")?.value || \"\",\n      cliente: document.getElementById(\"cliente\")?.value || \"\",\n      codigo: document.getElementById(\"codigo\")?.value || \"\",\n      reservationDate: document.getElementById(\"fechaReserva\")?.value || \"\",\n      tourEndDate: document.getElementById(\"fechaFinTour\")?.value || \"\",\n      dueDate: document.getElementById(\"fechaVencimiento\")?.value || \"\",\n      contact: document.getElementById(\"contacto\")?.value || \"\",\n      contactEmail: document.getElementById(\"contactEmail\")?.value || \"\",\n      contactPhone: document.getElementById(\"contactPhone\")?.value || \"\",\n      currency: document.getElementById(\"moneda\")?.value || \"\",\n      exchangeRate: parseFloat(document.getElementById(\"tipoCambio\")?.value) || 0,\n      commission: parseFloat(document.getElementById(\"comision\")?.value) || 0,\n      netAmount: parseFloat(document.getElementById(\"montoNeto\")?.value) || 0,\n      grossAmount: parseFloat(document.getElementById(\"montoBruto\")?.value) || 0,\n      tripName: document.getElementById(\"nombreViaje\")?.value || \"\",\n      productCode: document.getElementById(\"codigoProducto\")?.value || \"\",\n      adults: parseInt(document.getElementById(\"adultos\")?.value) || 0,\n      children: parseInt(document.getElementById(\"ninos\")?.value) || 0,\n      infants: parseInt(document.getElementById(\"infantes\")?.value) || 0,\n      provider: document.getElementById(\"proveedor\")?.value || \"\",\n      reservationCode: document.getElementById(\"codigoReserva\")?.value || \"\",\n      hotel: document.getElementById(\"hotel\")?.value || \"\",\n      checkIn: document.getElementById(\"checkIn\")?.value || \"\",\n      checkOut: document.getElementById(\"checkOut\")?.value || \"\",\n      estadoDeuda: document.getElementById(\"estadoDeuda\")?.value || \"\"\n    };\n    \n    // Capturar servicios\n    const servicios = [];\n    const serviciosContainer = document.getElementById(\"serviciosContainer\");\n    if (serviciosContainer) {\n      const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n      servicioItems.forEach((item, index) => {\n        servicios.push({\n          destino: document.getElementById(`servicio_destino_${index}`)?.value || \"\",\n          in: document.getElementById(`servicio_in_${index}`)?.value || \"\",\n          out: document.getElementById(`servicio_out_${index}`)?.value || \"\",\n          nts: parseInt(document.getElementById(`servicio_nts_${index}`)?.value) || 0,\n          basePax: parseInt(document.getElementById(`servicio_basePax_${index}`)?.value) || 0,\n          servicio: document.getElementById(`servicio_servicio_${index}`)?.value || \"\",\n          descripcion: document.getElementById(`servicio_descripcion_${index}`)?.value || \"\",\n          estado: document.getElementById(`servicio_estado_${index}`)?.value || \"\"\n        });\n      });\n    }\n    datosReserva.services = servicios;\n    \n    // Capturar vuelos\n    const vuelos = [];\n    const vuelosContainer = document.getElementById(\"vuelosContainer\");\n    if (vuelosContainer) {\n      const vueloItems = vuelosContainer.querySelectorAll(\".vuelo-item\");\n      vueloItems.forEach((item, index) => {\n        vuelos.push({\n          airline: document.getElementById(`vuelo_airline_${index}`)?.value || \"\",\n          flightNumber: document.getElementById(`vuelo_flightNumber_${index}`)?.value || \"\",\n          origin: document.getElementById(`vuelo_origin_${index}`)?.value || \"\",\n          destination: document.getElementById(`vuelo_destination_${index}`)?.value || \"\",\n          date: document.getElementById(`vuelo_date_${index}`)?.value || \"\",\n          time: document.getElementById(`vuelo_time_${index}`)?.value || \"\"\n        });\n      });\n    }\n    datosReserva.flights = vuelos;\n    \n    // VALIDAR CAMPOS OBLIGATORIOS\n    let camposFaltantes = [];\n    \n    // Validar pasajeros (solo nombre y apellido son obligatorios)\n    todosPasajeros.forEach((pasajero, index) => {\n      if (!pasajero.nombre || pasajero.nombre.trim() === \"\") {\n        camposFaltantes.push(`Pasajero ${index + 1}: Nombre`);\n      }\n      if (!pasajero.apellido || pasajero.apellido.trim() === \"\") {\n        camposFaltantes.push(`Pasajero ${index + 1}: Apellido`);\n      }\n    });\n    \n    // Validar datos de reserva (todos obligatorios)\n    if (!datosReserva.tipoReserva || datosReserva.tipoReserva.trim() === \"\") {\n      camposFaltantes.push(\"Tipo de Reserva\");\n    }\n    if (!datosReserva.estadoReserva || datosReserva.estadoReserva.trim() === \"\") {\n      camposFaltantes.push(\"Estado\");\n    }\n    if (!datosReserva.fechaViaje || datosReserva.fechaViaje.trim() === \"\") {\n      camposFaltantes.push(\"Fecha de Viaje\");\n    }\n    if (!datosReserva.vendedor || datosReserva.vendedor.trim() === \"\") {\n      camposFaltantes.push(\"Vendedor\");\n    }\n    if (!datosReserva.cliente || datosReserva.cliente.trim() === \"\") {\n      camposFaltantes.push(\"Cliente\");\n    }\n    \n    // Si hay campos faltantes, mostrar error y no enviar\n    if (camposFaltantes.length > 0) {\n      mostrarMensaje(\n        `Por favor completa los siguientes campos obligatorios: ${camposFaltantes.join(', ')}`,\n        \"error\"\n      );\n      return; // NO enviar al RPA\n    }\n    \n    // Mostrar mensaje de procesamiento\n    mostrarMensaje(\"Creando reserva en iTraffic... Por favor espere.\", \"info\");\n    \n    // DESHABILITAR TODOS LOS CAMPOS\n    deshabilitarFormularios();\n    \n    // Deshabilitar bot√≥n mientras se procesa\n    const botonCrearReserva = document.getElementById(\"crearReserva\");\n    if (botonCrearReserva) {\n      botonCrearReserva.disabled = true;\n      botonCrearReserva.style.opacity = \"0.6\";\n      botonCrearReserva.querySelector('.ms-Button-label').textContent = \"‚è≥ Procesando...\";\n    }\n    \n    // Llamar al servicio RPA con los datos de pasajeros y reserva\n    const resultado = await crearReservaEnITraffic(todosPasajeros, datosReserva);\n    \n    mostrarMensaje(\"¬°Reserva creada exitosamente en iTraffic!\", \"success\");\n    \n    // CONVERTIR A MODO LECTURA\n    convertirAModoLectura();\n    \n  } catch (error) {\n    mostrarMensaje(\"Error al crear reserva: \" + error.message, \"error\");\n    // En caso de error, rehabilitar los formularios\n    habilitarFormularios();\n  }\n}\n\n/**\n * Habilita todos los campos del formulario (en caso de error)\n */\nfunction habilitarFormularios() {\n  // Habilitar campos de pasajeros\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const inputs = container.querySelectorAll(\"input, select\");\n    inputs.forEach(input => {\n      input.disabled = false;\n      input.style.backgroundColor = \"#ffffff\";\n      input.style.cursor = \"text\";\n    });\n    \n    // Habilitar botones de eliminar pasajero\n    const botonesEliminar = container.querySelectorAll(\".btn-eliminar-pasajero\");\n    botonesEliminar.forEach(btn => {\n      btn.disabled = false;\n      btn.style.opacity = \"1\";\n      btn.style.cursor = \"pointer\";\n      btn.style.pointerEvents = \"auto\";\n    });\n  }\n  \n  // Habilitar campos de reserva\n  const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n  camposReserva.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.disabled = false;\n      campo.style.backgroundColor = \"#ffffff\";\n      campo.style.cursor = \"pointer\";\n    }\n  });\n  \n  // Habilitar bot√≥n de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.disabled = false;\n    btnAgregar.style.opacity = \"1\";\n    btnAgregar.style.cursor = \"pointer\";\n  }\n  \n  // Habilitar bot√≥n de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.disabled = false;\n    btnGuardar.style.opacity = \"1\";\n    btnGuardar.style.cursor = \"pointer\";\n  }\n  \n  // Habilitar bot√≥n de crear reserva\n  const botonCrearReserva = document.getElementById(\"crearReserva\");\n  if (botonCrearReserva) {\n    botonCrearReserva.disabled = false;\n    botonCrearReserva.style.opacity = \"1\";\n    botonCrearReserva.querySelector('.ms-Button-label').textContent = \"üöÄ Crear Reserva en iTraffic\";\n  }\n}\n\nexport { mostrarMensaje, run, crearFormulariosPasajeros, crearFormularioPasajero, guardarDatos, llenarDatosPasajeros, eliminarPasajero, renumerarPasajeros, agregarNuevoPasajero, ejecutarCrearReserva };\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\"> <h2>Extractor de Datos de Pasajero</h2> <p style=\\\"margin-bottom:20px;color:#666\\\">Haz clic en el bot√≥n para extraer la informaci√≥n del correo:</p> <button id=\\\"run\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">üìß Extraer Informaci√≥n</span> </button> <div id=\\\"loader\\\" style=\\\"display:none;text-align:center;padding:40px 20px\\\"> <div class=\\\"spinner\\\"></div> <p style=\\\"margin-top:20px;color:#666\\\">Extrayendo informaci√≥n del correo...</p> <p style=\\\"font-size:.9em;color:#999\\\">Por favor espera, esto puede tomar unos segundos</p> </div> <div id=\\\"results\\\" style=\\\"display:none\\\"> <div style=\\\"text-align:right;margin-bottom:10px\\\"> <button id=\\\"reextract\\\" class=\\\"ms-Button\\\" style=\\\"font-size:.85em;padding:6px 12px\\\"> <span class=\\\"ms-Button-label\\\">üîÑ Re-extraer</span> </button> </div> <h3>Datos de Pasajeros</h3> <div id=\\\"pasajerosContainer\\\"></div> <button id=\\\"agregarPasajero\\\" class=\\\"ms-Button btn-secondary\\\"> <span class=\\\"ms-Button-label\\\">+ Agregar Pasajero</span> </button> <div id=\\\"datosReservaSection\\\" class=\\\"datos-reserva-section\\\"> <h3>Datos de la Reserva</h3> <div class=\\\"form-group\\\"> <label>Tipo de Reserva: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"tipoReserva\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"AGENCIAS [COAG]\\\">Agencias [COAG]</option> <option value=\\\"DIRECTA\\\">Directa</option> <option value=\\\"CORPORATIVA\\\">Corporativa</option> </select> </div> <div class=\\\"form-group\\\"> <label>Estado: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"estadoReserva\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"PENDIENTE DE CONFIRMACION [PC]\\\">Pendiente de Confirmaci√≥n [PC]</option> <option value=\\\"CONFIRMADA\\\">Confirmada</option> <option value=\\\"CANCELADA\\\">Cancelada</option> </select> </div> <div class=\\\"form-group\\\"> <label>Fecha de Viaje: <span style=\\\"color:red\\\">*</span></label> <input type=\\\"date\\\" id=\\\"fechaViaje\\\" required> </div> <div class=\\\"form-group\\\"> <label>Vendedor: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"vendedor\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"TEST TEST\\\">TEST TEST</option> <option value=\\\"VENDEDOR 1\\\">Vendedor 1</option> <option value=\\\"VENDEDOR 2\\\">Vendedor 2</option> </select> </div> <div class=\\\"form-group\\\"> <label>Cliente: <span style=\\\"color:red\\\">*</span></label> <select id=\\\"cliente\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"DESPEGAR - TEST - 1\\\">DESPEGAR - TEST - 1</option> <option value=\\\"CLIENTE 1\\\">Cliente 1</option> <option value=\\\"CLIENTE 2\\\">Cliente 2</option> </select> </div> <div class=\\\"form-group\\\"> <label>Fecha de Reserva:</label> <input type=\\\"date\\\" id=\\\"fechaReserva\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha Fin de Tour:</label> <input type=\\\"date\\\" id=\\\"fechaFinTour\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha de Vencimiento:</label> <input type=\\\"date\\\" id=\\\"fechaVencimiento\\\"> </div> <div class=\\\"form-group\\\"> <label>Hotel:</label> <input type=\\\"text\\\" id=\\\"hotel\\\" placeholder=\\\"Nombre del hotel\\\"> </div> <div id=\\\"serviciosSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Servicios</h3> <div id=\\\"serviciosContainer\\\"></div> </div> <div id=\\\"vuelosSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Vuelos</h3> <div id=\\\"vuelosContainer\\\"></div> </div> </div> <button id=\\\"crearReserva\\\" class=\\\"ms-Button btn-crear-reserva\\\"> <span class=\\\"ms-Button-label\\\">üöÄ Crear Reserva en iTraffic</span> </button> <button id=\\\"guardar\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Guardar Todos los Datos</span> </button> </div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","formatearFecha","fecha","year","month","day","split","error","masterData","sellers","clients","statuses","reservationTypes","genders","documentTypes","countries","loaded","mostrarMensaje","mensaje","tipo","mensajeDiv","createElement","className","textContent","style","position","top","left","transform","zIndex","minWidth","maxWidth","textAlign","animation","body","appendChild","setTimeout","parentNode","removeChild","poblarSelectReserva","tipoReservaSelect","getElementById","innerHTML","forEach","option","value","name","console","log","estadoSelect","estado","vendedorSelect","vendedor","clienteSelect","cliente","async","run","runButton","display","loader","resultsDiv","Office","context","mailbox","item","getAsync","CoercionType","Text","result","status","AsyncResultStatus","Succeeded","cuerpoCorreo","extractedData","emailContent","response","fetch","RPA_API_URL","method","headers","JSON","stringify","userId","userProfile","emailAddress","ok","errorData","json","data","extraerDatosConIA","passengers","crearFormulariosPasajeros","datosPasajeros","datos","index","numero","tipoPasajero","passengerType","paxType","firstName","lastName","documentNumber","dateOfBirth","birthDate","cuilCuit","tipoDocSelect","documentType","sexoSelect","sex","nacionalidadSelect","nationality","direccion","phoneNumber","telefono","actualizarEstadoBotonCrearReserva","datosExtraidos","valorTipoReserva","reservationType","Array","from","options","map","coincidencia","find","opt","includes","warn","estadoReservaSelect","valorEstado","opcionesDisponibles","opciones","trim","valorUpper","travelDate","valorVendedor","seller","valorCliente","client","codigo","reservationDate","tourEndDate","dueDate","contact","contactEmail","contactPhone","currency","exchangeRate","commission","netAmount","grossAmount","tripName","productCode","adults","children","infants","provider","reservationCode","hotel","checkIn","checkOut","estadoDeuda","services","isArray","serviciosSection","servicios","serviciosContainer","servicio","servicioDiv","destino","in","out","nts","basePax","descripcion","llenarServicios","flights","vuelosSection","vuelos","vuelosContainer","vuelo","vueloDiv","airline","flightNumber","origin","destination","date","time","llenarVuelos","message","numeroPasajeros","container","pasajeroDiv","crearFormularioPasajero","dataset","numeroPasajero","header","content","onclick","target","classList","contains","isOpen","arrow","querySelector","nombreInput","apellidoInput","addEventListener","stopPropagation","querySelectorAll","remove","nuevoNumero","eliminarPasajero","valorActual","genero","code","pais","poblarSelectsPasajero","boton","pasajeros","pasajerosValidos","nombre","apellido","tipoReserva","estadoReserva","fechaViaje","reservaValida","validarCamposObligatorios","disabled","opacity","cursor","onReady","info","host","HostType","Outlook","sideloadMsg","appBody","reextractButton","guardarButton","todosPasajeros","dni","fechaNacimiento","cuil","tipoDoc","sexo","nacionalidad","push","guardarDatos","agregarButton","nuevoPasajero","scrollIntoView","behavior","block","agregarNuevoPasajero","crearReservaButton","datosReserva","parseFloat","parseInt","camposFaltantes","pasajero","join","input","backgroundColor","btn","pointerEvents","campoId","campo","btnAgregar","btnGuardar","deshabilitarFormularios","botonCrearReserva","datosRPA","transformarDatosParaRPA","statusText","success","crearReservaEnITraffic","btnEliminar","datosReservaSection","btnCrearReserva","convertirAModoLectura","habilitarFormularios","ejecutarCrearReserva","masterDataUrl","vendedores","clientes","estados","tiposReserva","generos","tiposDoc","paises","cargarDatosMaestros","URL"],"ignoreList":[],"sourceRoot":""}