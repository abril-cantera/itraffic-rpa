{"version":3,"file":"taskpane.js","mappings":"iGACIA,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,CAGAJ,EAAoBO,EAAID,ECzBxBN,EAAoBQ,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAChB,CAAE,MAAOC,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBb,EAAoBc,EAAI,SAASC,EAAKC,GAAQ,OAAOC,OAAOC,UAAUC,eAAeC,KAAKL,EAAKC,EAAO,E,WCAtG,IAAIK,EACArB,EAAoBQ,EAAEc,gBAAeD,EAAYrB,EAAoBQ,EAAEe,SAAW,IACtF,IAAIC,EAAWxB,EAAoBQ,EAAEgB,SACrC,IAAKH,GAAaG,IACbA,EAASC,eAAkE,WAAjDD,EAASC,cAAcC,QAAQC,gBAC5DN,EAAYG,EAASC,cAAcG,MAC/BP,GAAW,CACf,IAAIQ,EAAUL,EAASM,qBAAqB,UAC5C,GAAGD,EAAQE,OAEV,IADA,IAAIC,EAAIH,EAAQE,OAAS,EAClBC,GAAK,KAAOX,IAAc,aAAaY,KAAKZ,KAAaA,EAAYQ,EAAQG,KAAKJ,GAE3F,CAID,IAAKP,EAAW,MAAM,IAAIa,MAAM,yDAChCb,EAAYA,EAAUc,QAAQ,SAAU,IAAIA,QAAQ,OAAQ,IAAIA,QAAQ,QAAS,IAAIA,QAAQ,YAAa,KAC1GnC,EAAoBoC,EAAIf,C,IClBxBrB,EAAoBqC,EAAyB,oBAAbb,UAA4BA,SAASc,SAAYC,KAAKhB,SAASiB,K,WCuF/F,SAASC,EAAeC,GACtB,IAAKA,EAAO,MAAO,GAEnB,IACE,MAAOC,EAAMC,EAAOC,GAAOH,EAAMI,MAAM,KACvC,MAAO,GAAGF,KAASC,KAAOF,GAC5B,CAAE,MAAOI,GACP,MAAO,EACT,CACF,CChGO,MAAMC,EAAc,CAAC,oCAC1B,qCACA,6BACA,sBACA,uCACA,0CACA,8BACA,0BACA,2BACA,sBACA,qBACA,0BACA,wCACA,wCACA,8BACA,+BACA,eACA,0BACA,qBACA,8BACA,gCACA,gCACA,4CACA,oBACA,oCACA,kCACA,sBACA,qBACA,gCACA,6BACA,6BACA,qCACA,qBACA,8BACA,uCACA,sBACA,YACA,2BACA,0BACA,uBACA,iCACA,qBACA,wCACA,4BACA,+BACA,mDACA,8CACA,sCACA,kCACA,uCACA,0CACA,2CACA,mCACA,uCACA,8BACA,8BACA,kDACA,6CACA,qCACA,iCACA,sCACA,yCACA,0CACA,kCACA,sCACA,kBACA,+BACA,2BACA,yBACA,sBACA,uBACA,gFACA,4BACA,8BACA,wBACA,uCACA,qDACA,2CACA,mDACA,0CACA,kDACA,kCACA,0DACA,4CACA,8BACA,0DACA,iCACA,gCACA,+BACA,uDACA,qCACA,8CACA,wBACA,yCACA,0CACA,uDACA,wBACA,2BACA,iDACA,qBACA,4BACA,oCACA,+BACA,6BACA,oCACA,wBACA,uBACA,uBACA,qCACA,oCACA,mCACA,iDACA,uCACA,mCACA,wCACA,sBACA,+BACA,iBACA,qCACA,cACA,yBACA,iCACA,2BACA,aACA,kBACA,0BACA,gCACA,mCACA,gCACA,4BACA,yCACA,wDACA,uDACA,6BACA,kCACA,0CACA,oDACA,mCACA,kDACA,8CACA,oCACA,2DACA,4CACA,mDACA,oBACA,iCACA,yBACA,SACA,+BACA,yBACA,uBACA,gBACA,sBACA,oDACA,uEACA,sCACA,yCACA,0CACA,yCACA,yCACA,oCACA,mBACA,mCACA,+BACA,2CACA,wBACA,mBACA,iBACA,qBACA,6CACA,mCACA,yDACA,6DACA,yCACA,6CACA,wBACA,kCACA,yBACA,qCACA,sCACA,qCACA,uBACA,wBACA,wBACA,iCACA,wCACA,2EACA,0BACA,mCACA,+BACA,kCACA,0BACA,8BACA,iCACA,kCACA,4BACA,yCACA,yCACA,gCACA,mCACA,6BACA,2BACA,+BACA,mCACA,kCACA,mCACA,WACA,sBACA,uBACA,wBACA,oCACA,gBACA,2BACA,qCACA,uCACA,0CACA,8CACA,yCACA,6CACA,6BACA,wDACA,8CACA,gEACA,kDACA,kCACA,uCACA,mBACA,mBACA,iCACA,uCACA,kDACA,mDACA,uCACA,mCACA,uCACA,6BACA,6BACA,6BACA,0CACA,gEACA,0DACA,uBACA,uCACA,0BACA,0BACA,sBACA,oCACA,4BACA,iCACA,8BACA,0BACA,2BACA,2BACA,iCACA,+BACA,qBACA,0BACA,0CACA,uCACA,wBACA,8BACA,kBACA,mBACA,mBACA,iCACA,iDACA,oCACA,6BACA,0CACA,2CACA,2CACA,qDACA,oCACA,mDACA,+BACA,8BACA,0CACA,0CACA,0CACA,qCACA,8CACA,oCACA,qBACA,2CACA,yBACA,kBACA,sBACA,uCACA,yBACA,yBACA,mCACA,uBACA,qCACA,0BACA,0DACA,kCACA,mCACA,wCACA,sCACA,0CC/RIC,EAAa,CACjBC,QAAS,GACTC,QAAS,GACTC,SAAU,GACVC,iBAAkB,GAClBC,QAAS,GACTC,cAAe,GACfC,UAAW,GACXC,QAAQ,GAIV,IAAIC,EAAkB,CACpBC,oBAAoB,EACpBC,sBAAsB,EACtBC,gBAAiB,KACjBC,WAAY,KACZC,uBAAwB,MAItBC,EAAkC,KAGtC,SAASC,EAAeC,EAASC,EAAO,QAEtC,MAAMC,EAAa5C,SAAS6C,cAAc,OAC1CD,EAAWE,UAAY,kBAAkBH,IACzCC,EAAWG,YAAcL,EACzBE,EAAWI,MAAMC,SAAW,QAC5BL,EAAWI,MAAME,IAAM,OACvBN,EAAWI,MAAMG,KAAO,MACxBP,EAAWI,MAAMI,UAAY,mBAC7BR,EAAWI,MAAMK,OAAS,QAC1BT,EAAWI,MAAMM,SAAW,QAC5BV,EAAWI,MAAMO,SAAW,MAC5BX,EAAWI,MAAMQ,UAAY,SAC7BZ,EAAWI,MAAMS,UAAY,sBAE7BzD,SAAS0D,KAAKC,YAAYf,GAG1BgB,WAAW,KACThB,EAAWI,MAAMS,UAAY,oBAC7BG,WAAW,KACLhB,EAAWiB,YACbjB,EAAWiB,WAAWC,YA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","sources":["webpack://outlook-email-classifier-addin/webpack/bootstrap","webpack://outlook-email-classifier-addin/webpack/runtime/global","webpack://outlook-email-classifier-addin/webpack/runtime/hasOwnProperty shorthand","webpack://outlook-email-classifier-addin/webpack/runtime/publicPath","webpack://outlook-email-classifier-addin/webpack/runtime/jsonp chunk loading","webpack://outlook-email-classifier-addin/./src/taskpane/rpaClient.js","webpack://outlook-email-classifier-addin/./src/taskpane/servicesList.js","webpack://outlook-email-classifier-addin/./src/taskpane/taskpane.js","webpack://outlook-email-classifier-addin/./src/taskpane/clienteMatcher.js","webpack://outlook-email-classifier-addin/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * Cliente HTTP para comunicarse con el backend RPA\n * Este archivo maneja la comunicacin entre el add-in de Outlook y el servidor RPA\n */\n\n// URLs del servidor RPA (se configuran dinmicamente segn el entorno)\n// En produccin, estas URLs se inyectan durante el build de webpack\nconst RPA_CREATE_URL = typeof RPA_API_URL !== 'undefined' \n  ? RPA_API_URL + '/api/rpa/create-reservation'\n  : 'http://localhost:3001/api/rpa/create-reservation';\n\nconst RPA_EDIT_URL = typeof RPA_API_URL !== 'undefined' \n  ? RPA_API_URL + '/api/rpa/edit-reservation'\n  : 'http://localhost:3001/api/rpa/edit-reservation';\n\n/**\n * Transforma los datos del formulario al formato esperado por el RPA\n * @param {Array} pasajeros - Array de objetos con datos de pasajeros\n * @param {Object} datosReserva - Datos de la reserva del formulario\n * @param {boolean} isEdit - Si es true, incluye originData\n * @param {Object} originData - Data original de la extraccin (solo para edicin)\n * @returns {Object} Datos formateados para el RPA\n */\nfunction transformarDatosParaRPA(pasajeros, datosReserva = {}, isEdit = false, originData = null) {\n  const datosRPA = {\n    passengers: pasajeros.map(p => ({\n      lastName: p.apellido || '',\n      firstName: p.nombre || '',\n      paxType: p.tipoPasajero === 'adulto' ? 'ADU' : p.tipoPasajero === 'menor' ? 'CHD' : 'INF',\n      birthDate: formatearFecha(p.fechaNacimiento), // Convertir a MM/DD/AAAA\n      nationality: p.nacionalidad?.toUpperCase() || 'ARGENTINA',\n      sex: p.sexo === 'masculino' ? 'M' : p.sexo === 'femenino' ? 'F' : 'O',\n      documentNumber: p.dni || '',\n      documentType: p.tipoDoc?.toUpperCase() || 'DNI',\n      cuilCuit: p.cuil || '',\n      phoneNumber: p.telefono || '',\n      direccion: p.direccion || ''\n    })),\n    conversationId: datosReserva.conversationId || null,\n    emailId: datosReserva.itemId || null, // ID del email para Graph API\n    reservationType: datosReserva.tipoReserva || 'AGENCIAS [COAG]',\n    status: datosReserva.estadoReserva || 'PENDIENTE DE CONFIRMACION [PC]',\n    client: datosReserva.cliente || 'DESPEGAR - TEST - 1',\n    travelDate: formatearFecha(datosReserva.fechaViaje) || '12/01/2026',\n    seller: datosReserva.vendedor || 'TEST TEST',\n    codigo: datosReserva.codigo || '',\n    reservationDate: formatearFecha(datosReserva.reservationDate) || '',\n    tourEndDate: formatearFecha(datosReserva.tourEndDate) || '',\n    dueDate: formatearFecha(datosReserva.dueDate) || '',\n    contact: datosReserva.contact || '',\n    contactEmail: datosReserva.contactEmail || '',\n    contactPhone: datosReserva.contactPhone || '',\n    currency: datosReserva.currency || 'ARS',\n    exchangeRate: datosReserva.exchangeRate || 0,\n    commission: datosReserva.commission || 0,\n    netAmount: datosReserva.netAmount || 0,\n    grossAmount: datosReserva.grossAmount || 0,\n    tripName: datosReserva.tripName || '',\n    productCode: datosReserva.productCode || '',\n    adults: datosReserva.adults || 0,\n    children: datosReserva.children || 0,\n    infants: datosReserva.infants || 0,\n    provider: datosReserva.provider || '',\n    reservationCode: datosReserva.reservationCode || '',\n    hotel: datosReserva.hotel && typeof datosReserva.hotel === 'object' \n      ? datosReserva.hotel \n      : (datosReserva.hotel ? { nombre_hotel: datosReserva.hotel, tipo_habitacion: '', Ciudad: '', Categoria: null } : null),\n    checkIn: formatearFecha(datosReserva.checkIn) || '',\n    checkOut: formatearFecha(datosReserva.checkOut) || '',\n    estadoDeuda: datosReserva.estadoDeuda || '',\n    services: datosReserva.services || [],\n    flights: datosReserva.flights || []\n  };\n  \n  // Si es edicin, incluir la data original\n  if (isEdit && originData) {\n    datosRPA.originData = originData;\n  }\n  \n  return datosRPA;\n}\n\n/**\n * Formatea una fecha de YYYY-MM-DD a MM/DD/YYYY\n * @param {string} fecha - Fecha en formato YYYY-MM-DD\n * @returns {string} Fecha en formato MM/DD/YYYY\n */\nfunction formatearFecha(fecha) {\n  if (!fecha) return '';\n  \n  try {\n    const [year, month, day] = fecha.split('-');\n    return `${month}/${day}/${year}`;\n  } catch (error) {\n    return '';\n  }\n}\n\n/**\n * Enva los datos al servicio RPA para crear o editar la reserva\n * @param {Array} pasajeros - Array de objetos con datos de pasajeros del formulario\n * @param {Object} datosReserva - Datos de la reserva del formulario\n * @param {boolean} isEdit - Si es true, edita la reserva; si es false, crea una nueva\n * @param {Object} originData - Data original de la extraccin (solo para edicin)\n * @returns {Promise<Object>} Resultado de la operacin\n */\nexport async function crearReservaEnITraffic(pasajeros, datosReserva = {}, isEdit = false, originData = null) {\n  try {\n    // Transformar datos al formato del RPA\n    const datosRPA = transformarDatosParaRPA(pasajeros, datosReserva, isEdit, originData);\n    \n    // Seleccionar la URL segn si es crear o editar\n    const serviceUrl = isEdit ? RPA_EDIT_URL : RPA_CREATE_URL;\n    \n    // Enviar peticin al servidor RPA\n    const response = await fetch(serviceUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(datosRPA)\n    });\n    \n    const resultado = await response.json();\n    \n    // Si la respuesta no es exitosa o success es false, lanzar error con el mensaje del backend\n    if (!response.ok || resultado.success === false) {\n      const errorMessage = resultado.error || resultado.message || `Error del servidor: ${response.status} ${response.statusText}`;\n      throw new Error(errorMessage);\n    }\n    \n    return {\n      success: resultado.success !== false,\n      data: resultado.data || resultado,\n      reservationCode: resultado.reservationCode || null,\n      message: resultado.message || (isEdit ? 'Reserva editada exitosamente en iTraffic' : 'Reserva creada exitosamente en iTraffic')\n    };\n    \n  } catch (error) {\n    // Si el servidor no est disponible, mostrar un mensaje ms amigable\n    if (error.message.includes('fetch')) {\n      throw new Error('No se pudo conectar con el servicio RPA. Asegrate de que el servidor est corriendo.');\n    }\n    \n    throw error;\n  }\n}\n\n/**\n * Verifica si el servicio RPA est disponible\n * @returns {Promise<boolean>} true si el servicio est disponible\n */\nexport async function verificarServicioRPA() {\n  try {\n    const healthUrl = typeof RPA_API_URL !== 'undefined'\n      ? RPA_API_URL + '/api/rpa/health'\n      : 'http://localhost:3001/api/rpa/health';\n      \n    const response = await fetch(healthUrl, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      }\n    });\n    \n    return response.ok;\n  } catch (error) {\n    console.error('Error verificando servicio RPA:', error);\n    return false;\n  }\n}\n","export const servicesList =['1 BODEGA CON ALMUERZO LUJAN/MAIPU',\n  '2 BODEGAS CON ALMUERZO LUJAN/MAIPU',\n  '2 BODEGAS CON ALMUERZO VDU',\n  'ACTIVIDAD EN BODEGA',\n  'ACTIVIDAD EN BODEGAS CORPORATIVO 21%',\n  'ACTIVIDAD EN BODEGAS CORPORATIVO EXENTO',\n  'ALMUERZO EN BODEGA ALFACRUX',\n  'ALMUERZO EN RESTAURANTE',\n  'ALMUERZO EN VALLE ANDINO',\n  'ALMUERZO RESTAURANT',\n  'ALMUERZO THE VINES',\n  'ALMUERZO/CENA EN BODEGA',\n  'ALMUERZO/CENA EN BODEGA VU C/TRASLADO',\n  'ALMUERZO/CENA EN BODEGA ZC C/TRASLADO',\n  'ALMUERZO/CENA EN BODEGAS ZC',\n  'ALMUERZO/CENA EN RESTAURANTE',\n  'ALTA MONTAA',\n  'ALTA MONTAA EN PRIVADO',\n  'ATARDECER EN VIGIL',\n  'BODEGAS Y OLIVAS EN PRIVADO',\n  'BODEGAS ZONA MAIPU C ALMUERZO',\n  'CABALGATA AL ATARDECER + CENA',\n  'CABALGATA AL ATARDECER CON ASADO COMPLETO',\n  'CABALGATA CRIOLLA',\n  'CABALGATA ENTRE VIEDOS CON ASADO',\n  'CABALGATA RINCON DE LOS OSCUROS',\n  'CACHEUTA CIUDAD O*V',\n  'CACHEUTA POR TRAMO',\n  'CAON DEL ATUEL DESDE MENDOZA',\n  'CAON DEL ATUEL EN PRIVADO',\n  'CAON DEL ATUEL SAN RAFAEL',\n  'CATA DE BURBUJAS CON VINO Y PICADA',\n  'CENA DE FIN DE AO',\n  'CENA FIN DE AO EN SHERATON',\n  'CENA GOURMET EN RESTAURANT DE BODEGA',\n  'CITY HOTEL CENTRICO',\n  'CITY TOUR',\n  'CITY TOUR + BODEGA C/ALM',\n  'CITY TOUR + DEGUSTACIN',\n  'CITY TOUR EN PRIVADO',\n  'CIUDAD - SAN RAFAEL CON ESPERA',\n  'COMISIONES CLIENTE',\n  'COOKING CLASS VALLE DE UCO + ALMUERZO',\n  'COOKING CLASS ZONA CENTRO',\n  'COROLLA - CACHEUTA POR TRAMO',\n  'COROLLA - TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM',\n  'COROLLA - TRASLADO A 3 BODEGAS VALLE DE UCO',\n  'COROLLA - TRF IN/OUT AEROP CACHEUTA',\n  'COROLLA TRF IN AEROP BOD/POS ZC',\n  'COROLLA TRF IN AEROP- HOTEL CENTRICO',\n  'COROLLA TRF IN AEROP/CDAD A BOD/POS UCO',\n  'COROLLA TRF OUT AEROP/CDAD A BOD/POS UCO',\n  'COROLLA TRF OUT BOD/POS ZC AEROP',\n  'COROLLA TRF OUT HOTEL CENTRICO-AEROP',\n  'COSTUMBRES MENDOCINAS (AFA)',\n  'CRONOS - CACHEUTA POR TRAMO',\n  'CRONOS - TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM',\n  'CRONOS - TRASLADO A 3 BODEGAS VALLE DE UCO',\n  'CRONOS - TRF IN/OUT AEROP CACHEUTA',\n  'CRONOS TRF IN AEROP BOD/POS ZC',\n  'CRONOS TRF IN AEROP- HOTEL CENTRICO',\n  'CRONOS TRF IN AEROP/CDAD A BOD/POS UCO',\n  'CRONOS TRF OUT AEROP/CDAD A BOD/POS UCO',\n  'CRONOS TRF OUT BOD/POS ZC AEROP',\n  'CRONOS TRF OUT HOTEL CENTRICO-AEROP',\n  'DIA DE AVENTURA',\n  'DIQUE LOS REYUNOS SAN RAFAEL',\n  'ENOLOGO POR UN DIA C/ALM',\n  'ENTRADAS VENDIMIA 2026',\n  'ENTRE VIDES Y COPAS',\n  'EXCURSION ANDESTRUCK', \n  'EXCURSION BARREAL - PAMPA EL LEONCITO - CALINGASTA - OBSERVATORIO ASTRONOMICO',\n  'EXCURSION BODEGA PUTRUELE',\n  'EXCURSION CANOPY ADRENALINA',\n  'EXCURSION CANOPY BASE',\n  'EXCURSION CIUDAD - DIQUES Y QUEBRADA',\n  'EXCURSION DIQUES Y QUEBRADA CON ALMUERZO EN BODEGA',\n  'EXCURSION FULL DAY DE VINOS VALLE DE UCO',\n  'EXCURSION FULL DAY DE VINOS VALLE DE UCO PREMIUM',\n  'EXCURSION FULL DAY DE VINOS ZONA CENTRO',\n  'EXCURSION FULL DAY DE VINOS ZONA CENTRO PREMIUM',\n  'EXCURSION MENDOZA VINOS Y OLIVA',\n  'EXCURSION PARQUE ISCHIGUALASTO - VALLE DE LA LUNA (UAQ)',\n  'EXCURSION PARQUE NACIONAL TALAMPAYA (UAQ)',\n  'EXCURSION RAFTING MEDIO DIA',\n  'EXCURSION RUTA INTERLAGO  DIQUES QUEBRADAS Y MIRADORES',\n  'EXCURSION TREKKING CERRO NEGRO',\n  'EXCURSION TREKKING CON RAPPEL',\n  'EXCURSION VALLE DE LAS LEAS',\n  'EXCURSION VALLES IGLECIANOS JACHAL - RODEO - IGLESIA',\n  'EXCURSION VINOS Y SABORES DE MAIPU',\n  'EXCURSION VIEDOS Y BODEGAS - RUTA DEL VINO',\n  'EXPERIENCIA ACONCAGUA',\n  'EXPERIENCIA ALMUERZO O CENA EL ENEMIGO',\n  'EXPERIENCIA ALMUERZO O CENA EN ANGELICA',\n  'EXPERIENCIA CATENA ZAPATA CON ALMUERZO EN EL ENEMIGO',\n  'EXPERIENCIA CHOCOLATE',\n  'EXPERIENCIA VALLE DE UCO',\n  'FULL CATENA (DEGUSTACION CATENA+ ALM ANGELICA)',\n  'FULL DAY SALENTEIN',\n  'FULL DAY SPA SIN TRASLADO',\n  'FULL DAY SPA TERMAS CON TRASLADOS',\n  'FULL DAY SPA Y GLOBO PREMIUM',\n  'HASTA 3 BODEGAS S ALMUERZO',\n  'HOTEL - POTRERILLOS - HOTEL (5hs)',\n  'HOTEL CACHEUTA (5 HS)',\n  'LAGUNA DE LLANCANELO',\n  'LAS LEAS CIUDAD O*V',\n  'LOS VALLES HASTA LAS LEAS 1/2 DIA',\n  'MANQUI MALAL (s/ Entrada) 1/2 DIA',\n  'MINDFULNESS TERMAL CON TRASLADOS',\n  'PAQUETE TERMAS CON BODEGAS EN CORDN DEL PLATA',\n  'PAQUETE VENDIMIA -ENTRADA CHARDONNAY',\n  'PAQUETE VENDIMIA -ENTRADA MALBEC',\n  'PAQUETE VENDIMIA -ENTRADA TEMPRANILLO',\n  'PAQUETE VINOS Y MS',\n  'PARQUE DE AGUA CON TRASLADOS',\n  'PASEO EN GLOBO',\n  'PASEO EN VELERO CON QUESOS Y VINOS',\n  'PAYUNIA 4x4',\n  'POTRERILLOS CIUDAD O*V',\n  'PROGRAMA 1 SAN JUAN Y LA RIOJA',\n  'RAFTING CON TARDE DE SPA',\n  'RECARGO TC',\n  'RUTA DE SABORES',\n  'SAN RAFAEL - CIUDAD o*V',\n  'SERVICIO DE GUIA ALTA MONTAA',\n  'SERVICIO DE GUIA CAON DEL ATUEL',\n  'SERVICIO DE GUIA DIA COMPLETO',\n  'SERVICIO DE GUIA FULL DAY',\n  'SERVICIO DE GUIA FULL DAY VALLE DE UCO',\n  'SERVICIO DE GUIA IN / OUT HOTEL / POSADA VALLE DE UCO',\n  'SERVICIO DE GUIA IN / OUT HOTEL O POSADA LUJAN/MAIPU',\n  'SERVICIO DE GUIA MEDIO DIA',\n  'SERVICIO DE GUIA MEDIO DIA CITY',\n  'SERVICIO DE GUIA MEDIO DIA CON ALMUERZO',\n  'SERVICIO DE GUIA MEDIO DIA EXCURSION CONVENCIONAL',\n  'SERVICIO DE GUIA TRASLADO A CENA',\n  'SERVICIO DE GUIA TRASLADO A CENA CON ASISTENCIA',\n  'SERVICIO DE GUIA TRASLADO A CENA CON ESPERA',\n  'SERVICIO DE GUIA TRASLADO A CHILE',\n  'SERVICIO DE GUIA TRF IN / OUT HOTEL O POSADA LUJAN/MAIPU',\n  'SERVICIO DE GUIA TRF IN/ OUT HOTEL CENTRO',\n  'SERVICIO DE GUIA TRF IN/OUT HOTEL - VALLE DE UCO',\n  'SERVICIO FULL DAY',\n  'SERVICIO FULL DAY VALLE DE UCO',\n  'SERVICIOS EN LAS LEAS',\n  'SNACKS',\n  \"SPA HAMMAM - 8H CON ALMUERZO\",\n  \"TARDECITAS EN ANDELUNA\",\n  \"TICKET BUS TERRESTRE\",\n  \"TOUR CACHEUTA\",\n  \"TOUR CATENA Y VIGIL\",\n  \"TOUR DE BICI POR ZUCCARDI CON ALMUERZO PARRILLERO\",\n  \"TOUR ORGANICO - VIS. BODEGA CECCHIN Y VISITA CON PICNIC EN ALPAMANTA\",\n  \"TOUR POTRERILLOS c/ ALM EN EL HOTEL\",\n  \"TRASLADO A 1 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"TRASLADO A 1 BODEGAS MAIPU/LUJAN C/CENA\",\n  \"TRASLADO A 2 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"TRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"TRASLADO A 3 BODEGAS VALLE DE UCO\",\n  \"TRASLADO A CHILE\",\n  \"TRASLADO A PENITENTES CON ESPERA\",\n  \"TRASLADO A SANTIAGO DE CHILE\",\n  \"TRASLADO AEROP DE SAN RAFAEL A LAS LEAS\",\n  \"TRASLADO ALTA MONTAA\",\n  \"TRASLADO BODEGAS\",\n  \"TRASLADO CAON\",\n  \"TRASLADO CITY TOUR\",\n  \"TRASLADO CIUDAD USPALLATA / VALLECITOS O*V\",\n  \"TRASLADO CON ESPERA RESTO CIUDAD\",\n  \"TRASLADO CON ESPERA VALLE DE UCO HASTA 3 BODEGAS C/ALM\",\n  \"TRASLADO CON ESPERA ZONA MAIPU LUJAN HASTA 3 BODEGAS C/ALM\",\n  \"TRASLADO HOTEL CENTRICO RESTAURANTE ZC\",\n  \"TRASLADO PENITENTES / ACONCAGUA POR EL DA\",\n  \"TRASLADO RESTO-CIUDAD\",\n  \"TRASLADO TOUR  BODEGAS Y OLIVAS\",\n  \"TRASLADO VILLAVICENCIO\",\n  \"TRASLADOS VARIOS CORPORATIVO 10.5%\",\n  \"TRASLADOS VARIOS CORPORATIVO EXENTO\",\n  \"TREKKING CERRO ARENALES-VALLECITOS\",\n  \"TREKKING CERRO BAYOS\",\n  \"TREKKING CERRO CABRAS\",\n  \"TREKKING LAS CAMPANAS\",\n  \"TRF AEROPUERTO CACHEUTA IN/OUT\",\n  \"TRF HOTEL - POTRERILLOS - HOTEL (5hs)\",\n  \"TRF IN / OUT AEROPUERTO U HOTEL EN MENDOZA / AEROPUERTO U HOTEL SAN JUAN\",\n  \"TRF IN AEROP BOD/POS ZC\",\n  \"TRF IN AEROP UAQ- HOTEL CENTRICO\",\n  \"TRF IN AEROP- HOTEL CENTRICO\",\n  \"TRF IN AEROP/CDAD A BOD/POS UCO\",\n  \"TRF IN BOD/POS ZC AEROP\",\n  \"TRF IN HOTEL CENTRICO-AEROP\",\n  \"TRF IN HOTEL CENTRICO-TERMINAL\",\n  \"TRF IN TERMINAL- HOTEL CENTRICO\",\n  \"TRF IN/OUT AEROP CACHEUTA\",\n  \"TRF IN/OUT SAN RAFAEL AERO / HOTEL O*V\",\n  \"TRF IN/OUT SAN RAFAEL TERM / HOTEL O*V\",\n  \"TRF OUT AEROP- HOTEL CENTRICO\",\n  \"TRF OUT AEROP/CDAD A BOD/POS UCO\",\n  \"TRF OUT BOD/POS UCO A AERO\",\n  \"TRF OUT BOD/POS ZC AEROP\",\n  \"TRF OUT HOTEL CENTRICO-AEROP\",\n  \"TRF OUT HOTEL CENTRICO-AEROP UAQ\",\n  \"TRF OUT HOTEL CENTRICO-TERMINAL\",\n  \"TRF OUT TERMINAL- HOTEL CENTRICO\",\n  \"TRF TEST\",\n  \"USPALLATA POR TRAMO\",\n  \"VALLE DE UCO REGULAR\",\n  \"VALLE HERMOSO 1/2 DIA\",\n  \"VEHICULO A DISPOSICION HASTA 8 HS\",\n  \"VILLAVICENCIO\",\n  \"VILLAVICENCIO EN PRIVADO\",\n  \"VISITA A 2 BODEGAS CON DEGUSTACION\",\n  \"VISITA A BIANCHI c/ ALM EN ATAMISQUE\",\n  \"VISITA A NORTON CON ALMUERZO EN BELASCO\",\n  \"VISITA A ZUCCARDI CON ALMUERZO EN SALENTEIN\",\n  \"VISITA AL ENEMIGO c/ALM EN SANTA JULIA\",\n  \"VISITA AL ENEMIGO CON ALMUERZO EN ANGELICA\",\n  \"VISITA c/ PICADA EN BODEGA\",\n  \"VISITA CON DEGUSTACION EN BODEGA (ANAIA / VIA COBOS)\",\n  \"VISITA CON DEGUSTACION EN BODEGA EL ENEMIGO\",\n  \"VISITA Y ALMUERZO EN VDU (SALENTEIN / DIAMANDES / LA VIGILIA)\",\n  \"VISITA Y DEGUSTACION EN 2 BODEGAS ZC C/TRASLADO\",\n  \"VISITA Y DEGUSTACION EN BODEGAS\",\n  \"VISITA Y DEGUSTACION EN BODEGAS VUCO\",\n  \"VOLCAN MALA CARA\",\n  \"WINE & FOOD TOUR\",\n  \"WINE & RIDE CAMINOS DEL VIEDO\",\n  \"WINE & RIDE DESDE LUJAN CON ALMUERZO\",\n  \"WINE & RIDE DESDE MAIPU CON ALMUERZO EN ESENCIA\",\n  \"WINE & RIDE DESDE MAIPU CON ALMUERZO EN TRIVENTO\",\n  \"WINE & RIDE DESDE MAIPU SIN ALMUERZO\",\n  \"WINE & RIDE EXPERIENCIA CAROLINO\",\n  \"WINE & RIDE EXPERIENCIA DE LOS ANDES\",\n  \"WINE & RIDE LUJAN OPCION 1\",\n  \"WINE & RIDE LUJAN OPCION 2\",\n  \"WINE & RIDE LUJAN OPCION 3\",\n  \"WINE CLASSIC TOUR (Esencia o Villafae)\",\n  \"WINE CLASSIC TOUR SUPERIOR (Pan y oliva o Hacienda del Plata)\",\n  \"WINE ECO TOURS - 2 BODEGAS CON ALMUERZO EN VALLE DE UCO\",\n  \"ZACTIVIDAD EN BODEGA\",\n  \"ZACTIVIDAD EN BODEGA VUCO + ALMUERZO\",\n  \"ZACTIVIDAD EN BODEGA ZC\",\n  \"ZALMUERZO BODEGA PENEDO\",\n  \"ZALMUERZO EN BODEGA\",\n  \"ZALMUERZO EN BODEGA GIMENEZ RIILI\",\n  \"ZALMUERZO EN BODEGA NIETO\",\n  \"ZALMUERZO EN BODEGA RUCA MALEN\",\n  \"ZALMUERZO EN BODEGA TONELES\",\n  \"ZALMUERZO EN BODEGAS ZC\",\n  \"ZALMUERZO EN RESTAURANTE\",\n  \"ZALMUERZO/CENA EN BODEGA\",\n  \"ZALMUERZO/CENA EN BODEGAS VUCO\",\n  \"ZALMUERZO/CENA EN BODEGAS ZC\",\n  \"ZCABALGATA COLIBRI\",\n  \"ZCABALGATA RANCHO VIEJO\",\n  \"ZCABALGATA RINCON DE LOS OSCUROS (2 HS)\",\n  \"ZCENA RINCON DE LOS OSCUROS (MENU 2)\",\n  \"ZENTRADAS MALBEC 2026\",\n  \"ZHASTA 3 BODEGAS S ALMUERZO\",\n  \"ZPASEO EN GLOBO\",\n  \"ZPASEO EN VELERO\",\n  \"ZREGALO PASAJERO\",\n  \"ZSERVICIO DE GUIA ALTA MONTAA\",\n  \"ZSERVICIO DE GUIA ALTA MONTAA x VILLAVICENCIO\",\n  \"ZSERVICIO DE GUIA CAON DEL ATUEL\",\n  \"ZSERVICIO DE GUIA FULL DAY\",\n  \"ZSERVICIO DE GUIA FULL DAY VALLE DE UCO\",\n  \"ZSERVICIO DE GUIA MEDIO DIA CON ALMUERZO\",\n  \"ZSERVICIO DE GUIA MEDIO DIA CONVENCIONAL\",\n  \"ZSERVICIO DE GUIA MEDIO DIA EXCURSION CONVENCIONAL\",\n  \"ZSERVICIO DE GUIA TRASLADO A CENA\",\n  \"ZSERVICIO DE GUIA TRASLADO A CENA CON ASISTENCIA\",\n  \"ZTOUR PANORMICO POTRERILLOS\",\n  \"ZTOUR POTRERILLOS MEDIO DA\",\n  \"ZTRASLADO A 1 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"ZTRASLADO A 2 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"ZTRASLADO A 3 BODEGAS MAIPU/LUJAN C/ALM\",\n  \"ZTRASLADO A 3 BODEGAS VALLE DE UCO\",\n  \"ZTRASLADO A 3 BODEGAS VALLE DE UCO C/ CRUCE\",\n  \"ZTRASLADO A PENITENTES CON ESPERA\",\n  \"ZTRASLADO AL GLOBO\",\n  \"ZTRASLADO AL RINCON DE LOS OSCUROS (5HS)\",\n  \"ZTRASLADO ALTA MONTAA\",\n  \"ZTRASLADO CAON\",\n  \"ZTRASLADO CITY TOUR\",\n  \"ZTRASLADO HASTA 3 BODEGAS S/ALMUERZO\",\n  \"ZTRASLADO RANCHO VIEJO\",\n  \"ZTRASLADO RESTO-CIUDAD\",\n  \"ZTRASLADO TOUR  BODEGAS Y OLIVAS\",\n  \"ZTRASLADO TOUR CAON\",\n  \"ZTRASLADO TOUR VALLECITOS x EL DIA\",\n  \"ZTRASLADO VILLAVICENCIO\",\n  \"ZUCCARDI CON ALMUERZO EN SANTA JULIA (MEN SANTA JULIA)\",\n  \"ZVISITA Y DEGUSTACION EN BODEGA\",\n  \"ZVISITA Y DEGUSTACION EN BODEGAS\",\n  \"ZVISITA Y DEGUSTACION EN BODEGAS VUCO\",\n  \"ZVISITA Y DEGUSTACION EN BODEGAS ZC\",\n  \"ZVISITA Y DEGUSTACION EN CATENA ZAPATA\",\n  ]\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\n\nimport { crearReservaEnITraffic } from './rpaClient.js';\nimport { servicesList } from './servicesList.js';\nimport { encontrarClienteCoincidente } from './clienteMatcher.js';\n\n// Estado global para datos maestros\nconst masterData = {\n  sellers: [],\n  clients: [],\n  statuses: [],\n  reservationTypes: [],\n  genders: [],\n  documentTypes: [],\n  countries: [],\n  loaded: false\n};\n\n// Estado global para la extraccin actual\nlet extractionState = {\n  didExtractionExist: false, // Si existe una extraccin (para isReExtract)\n  doesReservationExist: false, // Si existe una reserva (para determinar crear/editar)\n  reservationCode: null,\n  originData: null, // Data original de la extraccin\n  createdReservationCode: null // Cdigo de reserva creada/editada\n};\n\n// Guardar HTML original de datosReservaSection para restaurarlo\nlet datosReservaSectionOriginalHTML = null;\n\n// Funcin para mostrar mensajes al usuario\nfunction mostrarMensaje(mensaje, tipo = \"info\") {\n  // Crear elemento de mensaje\n  const mensajeDiv = document.createElement(\"div\");\n  mensajeDiv.className = `status-message ${tipo}`;\n  mensajeDiv.textContent = mensaje;\n  mensajeDiv.style.position = \"fixed\";\n  mensajeDiv.style.top = \"20px\";\n  mensajeDiv.style.left = \"50%\";\n  mensajeDiv.style.transform = \"translateX(-50%)\";\n  mensajeDiv.style.zIndex = \"10000\";\n  mensajeDiv.style.minWidth = \"200px\";\n  mensajeDiv.style.maxWidth = \"90%\";\n  mensajeDiv.style.textAlign = \"center\";\n  mensajeDiv.style.animation = \"slideDown 0.3s ease\";\n  \n  document.body.appendChild(mensajeDiv);\n  \n  // Remover despus de 3 segundos\n  setTimeout(() => {\n    mensajeDiv.style.animation = \"slideUp 0.3s ease\";\n    setTimeout(() => {\n      if (mensajeDiv.parentNode) {\n        mensajeDiv.parentNode.removeChild(mensajeDiv);\n      }\n    }, 300);\n  }, 3000);\n}\n\nOffice.onReady((info) => {\n  try {\n  if (info.host === Office.HostType.Outlook) {\n      // Guardar HTML original de datosReservaSection\n      const datosReservaSection = document.getElementById(\"datosReservaSection\");\n      if (datosReservaSection) {\n        datosReservaSectionOriginalHTML = datosReservaSection.innerHTML;\n      }\n      // Ocultar mensaje de sideload si existe\n      const sideloadMsg = document.getElementById(\"sideload-msg\");\n      if (sideloadMsg) {\n        sideloadMsg.style.display = \"none\";\n      }\n      \n      // Mostrar el cuerpo de la aplicacin\n      const appBody = document.getElementById(\"app-body\");\n      if (appBody) {\n        appBody.style.display = \"flex\";\n      }\n      \n      // Controlar scroll inicial - no mostrar scroll cuando solo hay ttulo y botn\n      const mainContainer = document.querySelector(\".ms-welcome__main\");\n      if (mainContainer) {\n        mainContainer.classList.add(\"no-scroll\");\n      }\n      \n      // Asignar evento al botn de extraer\n      const runButton = document.getElementById(\"run\");\n      if (runButton) {\n        runButton.onclick = function() {\n          try {\n            run();\n          } catch (error) {\n            mostrarMensaje(\"Error al extraer datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botn de re-extraer\n      const reextractButton = document.getElementById(\"reextract\");\n      if (reextractButton) {\n        // Ocultar inicialmente (solo se muestra cuando hay resultados)\n        reextractButton.style.display = \"none\";\n        \n        reextractButton.onclick = function() {\n          try {\n            // Ocultar resultados y volver a extraer\n            const resultsDiv = document.getElementById(\"results\");\n            resultsDiv.style.display = \"none\";\n            // Ocultar botn de re-extraccin mientras se procesa\n            reextractButton.style.display = \"none\";\n            // Llamar a run con isReExtract = true\n            run(true);\n          } catch (error) {\n            mostrarMensaje(\"Error al re-extraer datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botn de guardar\n      const guardarButton = document.getElementById(\"guardar\");\n      if (guardarButton) {\n        guardarButton.onclick = function() {\n          try {\n            guardarDatos();\n          } catch (error) {\n            mostrarMensaje(\"Error al guardar datos: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botn de agregar pasajero\n      const agregarButton = document.getElementById(\"agregarPasajero\");\n      if (agregarButton) {\n        agregarButton.onclick = function() {\n          try {\n            agregarNuevoPasajero();\n          } catch (error) {\n            mostrarMensaje(\"Error al agregar pasajero: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botn de agregar hotel\n      const agregarHotelButton = document.getElementById(\"agregarHotel\");\n      if (agregarHotelButton) {\n        agregarHotelButton.onclick = function() {\n          try {\n            mostrarSeccionHotel();\n          } catch (error) {\n            mostrarMensaje(\"Error al agregar hotel: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botn de agregar servicio\n      const agregarServicioButton = document.getElementById(\"agregarServicio\");\n      if (agregarServicioButton) {\n        agregarServicioButton.onclick = function() {\n          try {\n            agregarNuevoServicio();\n          } catch (error) {\n            mostrarMensaje(\"Error al agregar servicio: \" + error.message, \"error\");\n          }\n        };\n      }\n      \n      // Asignar evento al botn de crear reserva\n      const crearReservaButton = document.getElementById(\"crearReserva\");\n      if (crearReservaButton) {\n        crearReservaButton.onclick = function() {\n          ejecutarCrearReserva();\n        };\n        // Deshabilitar el botn inicialmente\n        crearReservaButton.disabled = true;\n        crearReservaButton.style.opacity = \"0.5\";\n        crearReservaButton.style.cursor = \"not-allowed\";\n      }\n      \n      // Agregar event listeners para campos de reserva\n      const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n      camposReserva.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.addEventListener('change', actualizarEstadoBotonCrearReserva);\n          campo.addEventListener('input', actualizarEstadoBotonCrearReserva);\n        }\n      });\n      \n      // Agregar event listeners para campos de hotel\n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.addEventListener('change', () => {\n            validarFechasHotel();\n            actualizarEstadoBotonCrearReserva();\n          });\n          campo.addEventListener('input', () => {\n            validarFechasHotel();\n            actualizarEstadoBotonCrearReserva();\n          });\n        }\n      });\n      \n      // Cargar datos maestros al iniciar\n      cargarDatosMaestros();\n    }\n  } catch (error) {\n    // Error silencioso\n  }\n});\n\n/**\n * Valida las fechas del hotel en tiempo real\n */\nfunction validarFechasHotel() {\n  const hotelIn = document.getElementById(\"hotel_in\");\n  const hotelOut = document.getElementById(\"hotel_out\");\n  \n  // Solo validar si ambos campos tienen valores\n  if (!hotelIn || !hotelOut || !hotelIn.value || !hotelOut.value) {\n    // Limpiar estilos de error si no hay valores\n    if (hotelIn) hotelIn.style.borderColor = '';\n    if (hotelOut) hotelOut.style.borderColor = '';\n    return;\n  }\n  \n  const fechaIn = new Date(hotelIn.value);\n  const fechaOut = new Date(hotelOut.value);\n  \n  // Verificar que las fechas sean vlidas\n  if (isNaN(fechaIn.getTime()) || isNaN(fechaOut.getTime())) {\n    return;\n  }\n  \n  // Verificar que la fecha de salida sea posterior a la de entrada\n  if (fechaOut <= fechaIn) {\n    // Mostrar error visual\n    hotelIn.style.borderColor = '#d32f2f';\n    hotelOut.style.borderColor = '#d32f2f';\n    return;\n  }\n  \n  // Calcular la diferencia en das\n  const diferenciaDias = Math.floor((fechaOut - fechaIn) / (1000 * 60 * 60 * 24));\n  \n  if (diferenciaDias < 1) {\n    // Mostrar error visual\n    hotelIn.style.borderColor = '#d32f2f';\n    hotelOut.style.borderColor = '#d32f2f';\n  } else {\n    // Limpiar estilos de error\n    hotelIn.style.borderColor = '';\n    hotelOut.style.borderColor = '';\n  }\n}\n\n/**\n * Cargar datos maestros desde el servidor\n */\nasync function cargarDatosMaestros() {\n  try {\n    // Usar la variable global RPA_API_URL inyectada por webpack\n    const masterDataUrl = typeof RPA_API_URL !== 'undefined'\n      ? RPA_API_URL + '/api/master-data'\n      : 'http://localhost:3001/api/master-data';\n    \n    const response = await fetch(masterDataUrl);\n    \n    if (!response.ok) {\n      console.warn(' No se pudieron cargar los datos maestros, usando valores por defecto');\n      return;\n    }\n    \n    const result = await response.json();\n    \n    if (result.success && result.data) {\n      masterData.sellers = result.data.sellers || [];\n      masterData.clients = result.data.clients || [];\n      masterData.statuses = result.data.statuses || [];\n      masterData.reservationTypes = result.data.reservationTypes || [];\n      masterData.genders = result.data.genders || [];\n      masterData.documentTypes = result.data.documentTypes || [];\n      masterData.countries = result.data.countries || [];\n      masterData.loaded = true;\n      \n      console.log(' Datos maestros cargados:', {\n        vendedores: masterData.sellers.length,\n        clientes: masterData.clients.length,\n        estados: masterData.statuses.length,\n        tiposReserva: masterData.reservationTypes.length,\n        generos: masterData.genders.length,\n        tiposDoc: masterData.documentTypes.length,\n        paises: masterData.countries.length\n      });\n      \n      // Poblar los selects de reserva\n      poblarSelectReserva();\n    }\n  } catch (error) {\n    console.error(' Error cargando datos maestros:', error);\n  }\n}\n\n/**\n * Poblar los selects de la seccin de reserva\n */\nfunction poblarSelectReserva() {\n  // Tipo de Reserva\n  const tipoReservaSelect = document.getElementById('tipoReserva');\n  if (tipoReservaSelect && masterData.reservationTypes.length > 0) {\n    tipoReservaSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.reservationTypes.forEach(tipo => {\n      const option = document.createElement('option');\n      option.value = tipo.name;\n      option.textContent = tipo.name;\n      tipoReservaSelect.appendChild(option);\n    });\n    console.log(` Tipo Reserva poblado con ${masterData.reservationTypes.length} opciones`);\n  } else if (tipoReservaSelect) {\n    // Opciones por defecto si no hay datos maestros\n    tipoReservaSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"AGENCIAS [COAG]\">AGENCIAS [COAG]</option>\n      <option value=\"MAYORISTA [COMA]\">MAYORISTA [COMA]</option>\n      <option value=\"DIRECTO [CODI]\">DIRECTO [CODI]</option>\n      <option value=\"CORPORATIVA [COCO]\">CORPORATIVA [COCO]</option>\n    `;\n    console.log(` Tipo Reserva poblado con opciones por defecto`);\n  }\n  \n  // Estado\n  const estadoSelect = document.getElementById('estadoReserva');\n  if (estadoSelect && masterData.statuses.length > 0) {\n    estadoSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.statuses.forEach(estado => {\n      const option = document.createElement('option');\n      option.value = estado.name;\n      option.textContent = estado.name;\n      estadoSelect.appendChild(option);\n    });\n    console.log(` Estado poblado con ${masterData.statuses.length} opciones`);\n  } else if (estadoSelect) {\n    // Opciones por defecto si no hay datos maestros\n    estadoSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"PENDIENTE DE CONFIRMACION [PC]\">PENDIENTE DE CONFIRMACION [PC]</option>\n      <option value=\"CONFIRMADA [CO]\">CONFIRMADA [CO]</option>\n      <option value=\"CANCELADA [CA]\">CANCELADA [CA]</option>\n    `;\n    console.log(` Estado poblado con opciones por defecto`);\n  }\n  \n  // Vendedor\n  const vendedorSelect = document.getElementById('vendedor');\n  if (vendedorSelect && masterData.sellers.length > 0) {\n    vendedorSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.sellers.forEach(vendedor => {\n      const option = document.createElement('option');\n      option.value = vendedor.name;\n      option.textContent = vendedor.name;\n      vendedorSelect.appendChild(option);\n    });\n    console.log(` Vendedor poblado con ${masterData.sellers.length} opciones`);\n  } else if (vendedorSelect) {\n    // Opciones por defecto si no hay datos maestros\n    vendedorSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"TEST TEST\">TEST TEST</option>\n    `;\n    console.log(` Vendedor poblado con opciones por defecto`);\n  }\n  \n  // Cliente\n  const clienteSelect = document.getElementById('cliente');\n  if (clienteSelect && masterData.clients.length > 0) {\n    clienteSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.clients.forEach(cliente => {\n      const option = document.createElement('option');\n      option.value = cliente.name;\n      option.textContent = cliente.name;\n      clienteSelect.appendChild(option);\n    });\n    console.log(` Cliente poblado con ${masterData.clients.length} opciones`);\n  } else if (clienteSelect) {\n    // Opciones por defecto si no hay datos maestros\n    clienteSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"DESPEGAR - TEST - 1\">DESPEGAR - TEST - 1</option>\n    `;\n    console.log(` Cliente poblado con opciones por defecto`);\n  }\n}\n\n/**\n * Poblar los selects de un formulario de pasajero\n * @param {number} numero - Nmero del pasajero\n */\nfunction poblarSelectsPasajero(numero) {\n  // Sexo\n  const sexoSelect = document.getElementById(`sexo_${numero}`);\n  if (sexoSelect && masterData.genders.length > 0) {\n    const valorActual = sexoSelect.value;\n    sexoSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.genders.forEach(genero => {\n      const option = document.createElement('option');\n      option.value = genero.code;\n      option.textContent = genero.name;\n      sexoSelect.appendChild(option);\n    });\n    if (valorActual) sexoSelect.value = valorActual;\n    console.log(` Sexo ${numero} poblado con ${masterData.genders.length} opciones`);\n  } else if (sexoSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    sexoSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"M\">MASCULINO</option>\n      <option value=\"F\">FEMENINO</option>\n    `;\n    console.log(` Sexo ${numero} poblado con opciones por defecto`);\n  }\n  \n  // Tipo de Documento\n  const tipoDocSelect = document.getElementById(`tipoDoc_${numero}`);\n  if (tipoDocSelect && masterData.documentTypes.length > 0) {\n    const valorActual = tipoDocSelect.value;\n    tipoDocSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.documentTypes.forEach(tipo => {\n      const option = document.createElement('option');\n      option.value = tipo.code;\n      option.textContent = tipo.name;\n      tipoDocSelect.appendChild(option);\n    });\n    if (valorActual) tipoDocSelect.value = valorActual;\n    console.log(` Tipo Doc ${numero} poblado con ${masterData.documentTypes.length} opciones`);\n  } else if (tipoDocSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    tipoDocSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"DNI\">DOCUMENTO NACIONAL DE IDENTIDAD</option>\n      <option value=\"PAS\">PASAPORTE</option>\n      <option value=\"CI\">CDULA DE IDENTIDAD</option>\n      <option value=\"LE\">LIBRETA DE ENROLAMIENTO</option>\n      <option value=\"LC\">LIBRETA CVICA</option>\n    `;\n    console.log(` Tipo Doc ${numero} poblado con opciones por defecto`);\n  }\n  \n  // Nacionalidad\n  const nacionalidadSelect = document.getElementById(`nacionalidad_${numero}`);\n  if (nacionalidadSelect && masterData.countries.length > 0) {\n    const valorActual = nacionalidadSelect.value;\n    nacionalidadSelect.innerHTML = '<option value=\"\">Seleccione...</option>';\n    masterData.countries.forEach(pais => {\n      const option = document.createElement('option');\n      option.value = pais.name;\n      option.textContent = pais.name;\n      nacionalidadSelect.appendChild(option);\n    });\n    if (valorActual) nacionalidadSelect.value = valorActual;\n    console.log(` Nacionalidad ${numero} poblada con ${masterData.countries.length} opciones`);\n  } else if (nacionalidadSelect) {\n    // Si no hay datos maestros, usar opciones por defecto\n    nacionalidadSelect.innerHTML = `\n      <option value=\"\">Seleccione...</option>\n      <option value=\"ARGENTINA\">ARGENTINA</option>\n      <option value=\"BRASIL\">BRASIL</option>\n      <option value=\"CHILE\">CHILE</option>\n      <option value=\"URUGUAY\">URUGUAY</option>\n      <option value=\"PARAGUAY\">PARAGUAY</option>\n      <option value=\"BOLIVIA\">BOLIVIA</option>\n      <option value=\"PERU\">PERU</option>\n      <option value=\"COLOMBIA\">COLOMBIA</option>\n      <option value=\"VENEZUELA\">VENEZUELA</option>\n      <option value=\"ECUADOR\">ECUADOR</option>\n      <option value=\"MEXICO\">MEXICO</option>\n      <option value=\"ESPAA\">ESPAA</option>\n      <option value=\"ESTADOS UNIDOS\">ESTADOS UNIDOS</option>\n    `;\n    console.log(` Nacionalidad ${numero} poblada con opciones por defecto`);\n  }\n}\n\nasync function run(isReExtract = false) {\n  try {\n    // Ocultar el botn de extraer\n    const runButton = document.getElementById(\"run\");\n    runButton.style.display = \"none\";\n    \n    // Mostrar el loader\n    const loader = document.getElementById(\"loader\");\n    loader.style.display = \"block\";\n    \n    // Ocultar los resultados mientras se extrae\n    const resultsDiv = document.getElementById(\"results\");\n    resultsDiv.style.display = \"none\";\n\n  const item = Office.context.mailbox.item;\n    \n    // Obtener el cuerpo del correo\n    Office.context.mailbox.item.body.getAsync(\n      Office.CoercionType.Text, \n      async (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          const cuerpoCorreo = result.value;\n          \n          try {\n            // Extraer imgenes del email\n            let images = [];\n            try {\n              images = await extraerImagenesDelEmail();\n              if (images.length > 0) {\n                console.log(` ${images.length} imagen(es) extrada(s) del email`);\n              }\n            } catch (imageError) {\n              console.warn(' Error al extraer imgenes, continuando sin ellas:', imageError);\n              // Continuar sin imgenes para no romper el flujo\n            }\n            \n            // Llamar al servicio de extraccin con IA (incluyendo imgenes si las hay)\n            const extractedData = await extraerDatosConIA(cuerpoCorreo, isReExtract, images);\n            \n            // Ocultar loader\n            loader.style.display = \"none\";\n            \n            // Mostrar resultados\n            resultsDiv.style.display = \"block\";\n            \n            // Habilitar scroll cuando hay resultados\n            const mainContainer = document.querySelector(\".ms-welcome__main\");\n            if (mainContainer) {\n              mainContainer.classList.remove(\"no-scroll\");\n            }\n            \n            // Mostrar botn de re-extraccin cuando hay resultados\n            const reextractButton = document.getElementById(\"reextract\");\n            if (reextractButton) {\n              reextractButton.style.display = \"block\";\n            }\n            \n            if (extractedData && extractedData.passengers && extractedData.passengers.length > 0) {\n              // Convertir explcitamente a booleano (puede venir como string \"true\"/\"false\" o booleano)\n              const didExtractionExistRaw = extractedData.didExtractionExist;\n              const didExtractionExist = didExtractionExistRaw === true || didExtractionExistRaw === 'true' || didExtractionExistRaw === 1;\n              \n              // Convertir doesReservationExist a booleano\n              const doesReservationExistRaw = extractedData.doesReservationExist;\n              const doesReservationExist = doesReservationExistRaw === true || doesReservationExistRaw === 'true' || doesReservationExistRaw === 1;\n              \n              // Log para debug\n              console.log(' didExtractionExist recibido:', didExtractionExistRaw, 'tipo:', typeof didExtractionExistRaw);\n              console.log(' didExtractionExist convertido:', didExtractionExist);\n              console.log(' doesReservationExist recibido:', doesReservationExistRaw, 'tipo:', typeof doesReservationExistRaw);\n              console.log(' doesReservationExist convertido:', doesReservationExist);\n              \n              // Guardar el estado de la extraccin globalmente\n              extractionState.didExtractionExist = didExtractionExist;\n              extractionState.doesReservationExist = doesReservationExist;\n              extractionState.reservationCode = extractedData.reservationCode || null;\n              \n              // Guardar la data original completa de la extraccin (para comparacin al editar)\n              // Solo si existe una reserva (doesReservationExist), no solo una extraccin\n              if (doesReservationExist) {\n                extractionState.originData = JSON.parse(JSON.stringify(extractedData)); // Deep copy\n              }\n              \n              // Log para verificar que se guard correctamente\n              console.log(' extractionState.didExtractionExist guardado:', extractionState.didExtractionExist);\n              console.log(' extractionState.doesReservationExist guardado:', extractionState.doesReservationExist);\n              console.log(' extractionState.reservationCode guardado:', extractionState.reservationCode);\n              console.log(' extractionState.originData guardado:', extractionState.originData);\n              \n              // Crear formularios segn el nmero de pasajeros extrados\n              crearFormulariosPasajeros(extractedData.passengers.length, didExtractionExist);\n              \n              // Llenar los datos de los pasajeros\n              llenarDatosPasajeros(extractedData.passengers);\n              \n              // Llenar los datos de la reserva\n              llenarDatosReserva(extractedData);\n              \n              // Actualizar el texto del botn segn si es crear o editar (usar doesReservationExist)\n              actualizarTextoBotonReserva(doesReservationExist);\n              \n              if(didExtractionExist) {\n                mostrarMensaje(` Hay una extraccin de datos existente para el correo`, \"success\");\n              }else{\n                mostrarMensaje(` Datos extrados: ${extractedData.passengers.length} pasajero(s)`, \"success\");\n              }\n            } else {\n              // Si no se extrajeron pasajeros, crear un formulario vaco\n              crearFormulariosPasajeros(1);\n              mostrarMensaje(\"No se pudieron extraer datos. Por favor, llena el formulario manualmente.\", \"info\");\n            }\n          } catch (error) {\n            // Ocultar loader\n            loader.style.display = \"none\";\n            \n            // Mostrar resultados con formulario vaco\n            resultsDiv.style.display = \"block\";\n            \n            // Habilitar scroll cuando hay resultados (incluso si es error)\n            const mainContainer = document.querySelector(\".ms-welcome__main\");\n            if (mainContainer) {\n              mainContainer.classList.remove(\"no-scroll\");\n            }\n            \n            // Si falla la extraccin, crear un formulario vaco\n            crearFormulariosPasajeros(1);\n            mostrarMensaje(\"Error al extraer datos: \" + error.message + \". Llena el formulario manualmente.\", \"error\");\n          }\n        } else {\n          // Ocultar loader\n          loader.style.display = \"none\";\n          \n          // Mostrar botn de nuevo\n          runButton.style.display = \"block\";\n          \n          mostrarMensaje(\"Error al obtener el contenido del correo\", \"error\");\n        }\n      }\n    );\n  } catch (error) {\n    // Ocultar loader\n    const loader = document.getElementById(\"loader\");\n    loader.style.display = \"none\";\n    \n    // Mostrar botn de nuevo\n    const runButton = document.getElementById(\"run\");\n    runButton.style.display = \"block\";\n    \n    mostrarMensaje(\"Error inesperado: \" + error.message, \"error\");\n  }\n}\n\n/**\n * Extrae imgenes del email actual (attachments e inline)\n * @returns {Promise<File[]>} Array de archivos de imagen\n */\nasync function extraerImagenesDelEmail() {\n  const images = [];\n  const item = Office.context.mailbox.item;\n  const MAX_IMAGE_SIZE = 10 * 1024 * 1024; // 10MB por imagen\n  const MAX_TOTAL_SIZE = 50 * 1024 * 1024; // 50MB total\n  let totalSize = 0;\n  \n  try {\n    // Validar que el item existe\n    if (!item) {\n      console.warn(' No se pudo acceder al item del email');\n      return [];\n    }\n    // 1. Extraer attachments de tipo imagen\n    if (item.attachments && item.attachments.length > 0) {\n      for (let i = 0; i < item.attachments.length; i++) {\n        const attachment = item.attachments[i];\n        \n        // Verificar si es una imagen por extensin\n        const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp', '.svg'];\n        const isImage = imageExtensions.some(ext => \n          attachment.name.toLowerCase().endsWith(ext)\n        );\n        \n        if (isImage) {\n          try {\n            // Obtener el attachment como base64\n            const attachmentData = await new Promise((resolve, reject) => {\n              item.getAttachmentContentAsync(attachment.id, (result) => {\n                if (result.status === Office.AsyncResultStatus.Succeeded) {\n                  resolve(result.value);\n                } else {\n                  reject(new Error(result.error.message));\n                }\n              });\n            });\n            \n            // Convertir base64 a Blob\n            const contentType = attachmentData.contentType || 'image/jpeg';\n            const base64Data = attachmentData.content;\n            const binaryString = atob(base64Data);\n            const bytes = new Uint8Array(binaryString.length);\n            for (let j = 0; j < binaryString.length; j++) {\n              bytes[j] = binaryString.charCodeAt(j);\n            }\n            const blob = new Blob([bytes], { type: contentType });\n            \n            // Validar tamao individual\n            if (blob.size > MAX_IMAGE_SIZE) {\n              console.warn(` Imagen ${attachment.name} es muy grande (${(blob.size / 1024 / 1024).toFixed(2)}MB), se comprimir`);\n              const compressedBlob = await comprimirImagen(blob, attachment.name);\n              if (compressedBlob && compressedBlob.size > 0) {\n                // Validar tamao total\n                if (totalSize + compressedBlob.size > MAX_TOTAL_SIZE) {\n                  console.warn(` Lmite total de tamao alcanzado. Se omitir ${attachment.name}`);\n                  continue;\n                }\n                const file = new File([compressedBlob], attachment.name, { type: compressedBlob.type });\n                images.push(file);\n                totalSize += compressedBlob.size;\n              } else {\n                console.warn(` No se pudo comprimir ${attachment.name}, se omitir`);\n              }\n            } else {\n              // Validar tamao total\n              if (totalSize + blob.size > MAX_TOTAL_SIZE) {\n                console.warn(` Lmite total de tamao alcanzado. Se omitir ${attachment.name}`);\n                continue;\n              }\n              const file = new File([blob], attachment.name, { type: contentType });\n              images.push(file);\n              totalSize += blob.size;\n            }\n          } catch (error) {\n            console.warn(` Error al extraer attachment ${attachment.name}:`, error);\n            // Continuar con otros attachments sin romper el flujo\n          }\n        }\n      }\n    }\n    \n    // 2. Extraer imgenes inline del HTML del body\n    try {\n      const htmlBody = await new Promise((resolve, reject) => {\n        item.body.getAsync(Office.CoercionType.Html, (result) => {\n          if (result.status === Office.AsyncResultStatus.Succeeded) {\n            resolve(result.value);\n          } else {\n            reject(new Error(result.error.message));\n          }\n        });\n      });\n      \n      // Parsear HTML y buscar imgenes\n      const parser = new DOMParser();\n      const doc = parser.parseFromString(htmlBody, 'text/html');\n      const imgTags = doc.querySelectorAll('img');\n      \n      for (const img of imgTags) {\n        const src = img.getAttribute('src');\n        if (!src) continue;\n        \n        // Si es base64 (data:image/...)\n        if (src.startsWith('data:image/')) {\n          try {\n            const [header, base64Data] = src.split(',');\n            const contentTypeMatch = header.match(/data:image\\/([^;]+)/);\n            const contentType = contentTypeMatch ? `image/${contentTypeMatch[1]}` : 'image/png';\n            \n            const binaryString = atob(base64Data);\n            const bytes = new Uint8Array(binaryString.length);\n            for (let j = 0; j < binaryString.length; j++) {\n              bytes[j] = binaryString.charCodeAt(j);\n            }\n            const blob = new Blob([bytes], { type: contentType });\n            \n            // Validar tamao individual\n            if (blob.size > MAX_IMAGE_SIZE) {\n              console.warn(` Imagen inline es muy grande (${(blob.size / 1024 / 1024).toFixed(2)}MB), se comprimir`);\n              const compressedBlob = await comprimirImagen(blob, `inline-image-${images.length}.png`);\n              if (compressedBlob && compressedBlob.size > 0) {\n                // Validar tamao total\n                if (totalSize + compressedBlob.size > MAX_TOTAL_SIZE) {\n                  console.warn(` Lmite total de tamao alcanzado. Se omitir imagen inline`);\n                  continue;\n                }\n                const file = new File([compressedBlob], `inline-image-${images.length}.png`, { type: compressedBlob.type });\n                images.push(file);\n                totalSize += compressedBlob.size;\n              } else {\n                console.warn(` No se pudo comprimir imagen inline, se omitir`);\n              }\n            } else {\n              // Validar tamao total\n              if (totalSize + blob.size > MAX_TOTAL_SIZE) {\n                console.warn(` Lmite total de tamao alcanzado. Se omitir imagen inline`);\n                continue;\n              }\n              const fileName = `inline-image-${images.length}.${contentType.split('/')[1] || 'png'}`;\n              const file = new File([blob], fileName, { type: contentType });\n              images.push(file);\n              totalSize += blob.size;\n            }\n          } catch (error) {\n            console.warn(` Error al procesar imagen inline:`, error);\n            // Continuar sin romper el flujo\n          }\n        }\n        // Si es una URL externa, no la podemos extraer directamente\n        // (requerira permisos adicionales o Graph API)\n      }\n    } catch (error) {\n      console.warn(' Error al extraer imgenes inline del HTML:', error);\n      // Continuar sin romper el flujo\n    }\n    \n    console.log(` Imgenes extradas: ${images.length} (${(totalSize / 1024 / 1024).toFixed(2)}MB total)`);\n    \n    if (images.length > 0 && totalSize > MAX_TOTAL_SIZE * 0.8) {\n      console.warn(` Advertencia: Se est usando ${((totalSize / MAX_TOTAL_SIZE) * 100).toFixed(1)}% del lmite total de tamao`);\n    }\n    \n    return images;\n    \n  } catch (error) {\n    console.error(' Error al extraer imgenes:', error);\n    // Retornar array vaco para no romper el flujo principal\n    // No mostrar error al usuario ya que las imgenes son opcionales\n    return [];\n  }\n}\n\n/**\n * Comprime una imagen usando Canvas API\n * @param {Blob} imageBlob - Blob de la imagen\n * @param {string} fileName - Nombre del archivo\n * @returns {Promise<Blob|null>} Blob comprimido o null si falla\n */\nasync function comprimirImagen(imageBlob, fileName) {\n  return new Promise((resolve) => {\n    try {\n      const img = new Image();\n      const url = URL.createObjectURL(imageBlob);\n      \n      // Timeout para evitar que se quede colgado\n      const timeout = setTimeout(() => {\n        URL.revokeObjectURL(url);\n        console.warn(' Timeout al comprimir imagen');\n        resolve(null);\n      }, 30000); // 30 segundos\n      \n      img.onload = () => {\n        clearTimeout(timeout);\n        URL.revokeObjectURL(url);\n        \n        try {\n          // Calcular nuevo tamao (mximo 1920px de ancho o alto)\n          const maxDimension = 1920;\n          let width = img.width;\n          let height = img.height;\n          \n          if (width > maxDimension || height > maxDimension) {\n            if (width > height) {\n              height = (height / width) * maxDimension;\n              width = maxDimension;\n            } else {\n              width = (width / height) * maxDimension;\n              height = maxDimension;\n            }\n          }\n          \n          // Validar dimensiones mnimas\n          if (width < 1 || height < 1) {\n            console.warn(' Dimensiones invlidas para compresin');\n            resolve(null);\n            return;\n          }\n          \n          // Crear canvas y comprimir\n          const canvas = document.createElement('canvas');\n          canvas.width = width;\n          canvas.height = height;\n          const ctx = canvas.getContext('2d');\n          \n          if (!ctx) {\n            console.warn(' No se pudo obtener contexto del canvas');\n            resolve(null);\n            return;\n          }\n          \n          ctx.drawImage(img, 0, 0, width, height);\n          \n          // Convertir a blob con calidad 0.8\n          canvas.toBlob((blob) => {\n            if (blob && blob.size > 0) {\n              resolve(blob);\n            } else {\n              console.warn(' Error al generar blob comprimido');\n              resolve(null);\n            }\n          }, 'image/jpeg', 0.8);\n        } catch (error) {\n          console.warn(' Error durante la compresin:', error);\n          resolve(null);\n        }\n      };\n      \n      img.onerror = () => {\n        clearTimeout(timeout);\n        URL.revokeObjectURL(url);\n        console.warn(' Error al cargar imagen para compresin');\n        resolve(null);\n      };\n      \n      img.src = url;\n    } catch (error) {\n      console.warn(' Error al iniciar compresin:', error);\n      resolve(null);\n    }\n  });\n}\n\n/**\n * Llama al servicio de extraccin con IA\n * @param {string} emailContent - Contenido del email\n * @param {boolean} isReExtract - Si es re-extraccin\n * @param {File[]} images - Array de imgenes extradas (opcional)\n */\nasync function extraerDatosConIA(emailContent, isReExtract = false, images = []) {\n  // Usar la variable global RPA_API_URL inyectada por webpack\n  const extractUrl = typeof RPA_API_URL !== 'undefined'\n    ? RPA_API_URL + '/api/extract'\n    : 'http://localhost:3001/api/extract';\n  const mailbox = Office.context.mailbox;\n  \n  // Log para verificar que isReExtract se est enviando\n  console.log(' Enviando extraccin - isReExtract:', isReExtract, 'tipo:', typeof isReExtract);\n  console.log(' Imgenes a enviar:', images.length);\n  \n  // Si hay imgenes, usar FormData; si no, usar JSON\n  if (images && images.length > 0) {\n    try {\n      const formData = new FormData();\n      formData.append('emailContent', emailContent);\n      formData.append('userId', mailbox.userProfile.emailAddress || 'outlook-user');\n      formData.append('conversationId', mailbox.item.conversationId || 'conversation-id');\n      formData.append('isReExtract', isReExtract.toString());\n      \n      // Validar y agregar cada imagen\n      let validImagesCount = 0;\n      images.forEach((image, index) => {\n        // Validar que la imagen existe y tiene tamao vlido\n        if (image && image.size > 0 && image.size <= 50 * 1024 * 1024) {\n          formData.append('images', image, image.name);\n          validImagesCount++;\n        } else {\n          console.warn(` Imagen ${image?.name || index} invlida o muy grande, se omitir`);\n        }\n      });\n      \n      if (validImagesCount === 0) {\n        console.warn(' No hay imgenes vlidas, se enviar sin imgenes');\n        // Continuar con JSON si no hay imgenes vlidas\n        images = [];\n      } else {\n        console.log(` Enviando ${validImagesCount} imagen(es) con FormData`);\n        \n        const response = await fetch(extractUrl, {\n          method: 'POST',\n          body: formData\n          // No establecer Content-Type, el navegador lo har automticamente con el boundary\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({ error: 'Error al extraer datos' }));\n          throw new Error(errorData.error || 'Error al extraer datos');\n        }\n\n        const result = await response.json();\n        \n        // Incluir didExtractionExist y doesReservationExist del nivel superior en el objeto data\n        const dataWithExtractionState = {\n          ...result.data,\n          didExtractionExist: result.didExtractionExist || false,\n          doesReservationExist: result.doesReservationExist || false\n        };\n        \n        return dataWithExtractionState;\n      }\n    } catch (error) {\n      console.error(' Error al enviar FormData con imgenes:', error);\n      // Si falla el envo con FormData, intentar sin imgenes\n      console.warn(' Reintentando sin imgenes...');\n      images = [];\n    }\n  }\n  \n  // Sin imgenes o fallback, usar JSON como antes\n  const response = await fetch(extractUrl, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      emailContent: emailContent,\n      userId: mailbox.userProfile.emailAddress || 'outlook-user',\n      conversationId: mailbox.item.conversationId || 'conversation-id',\n      isReExtract: isReExtract\n    })\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.error || 'Error al extraer datos');\n  }\n\n  const result = await response.json();\n  \n  // Incluir didExtractionExist y doesReservationExist del nivel superior en el objeto data\n  const dataWithExtractionState = {\n    ...result.data,\n    didExtractionExist: result.didExtractionExist || false,\n    doesReservationExist: result.doesReservationExist || false\n  };\n  \n  return dataWithExtractionState;\n}\n\nfunction crearFormulariosPasajeros(numeroPasajeros, didExtractionExist = false) {\n  const container = document.getElementById(\"pasajerosContainer\");\n  container.innerHTML = \"\"; // Limpiar contenedor\n  \n  for (let i = 0; i < numeroPasajeros; i++) {\n    const pasajeroDiv = crearFormularioPasajero(i + 1);\n    container.appendChild(pasajeroDiv);\n  }\n  \n  // Actualizar estado del botn despus de crear los formularios\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\nfunction crearFormularioPasajero(numero) {\n  const pasajeroDiv = document.createElement(\"div\");\n  pasajeroDiv.className = \"pasajero-acordeon\";\n  pasajeroDiv.dataset.numeroPasajero = numero;\n  \n  // Cabecera del acorden (clickeable)\n  const header = document.createElement(\"div\");\n  header.className = \"pasajero-header\";\n  header.innerHTML = `\n    <span class=\"pasajero-titulo\">Pasajero ${numero}</span>\n    <div class=\"pasajero-actions\">\n      <span class=\"arrow\"></span>\n      <button class=\"btn-eliminar-pasajero\" title=\"Eliminar pasajero\"></button>\n    </div>\n  `;\n  \n  // Contenido del acorden (formulario)\n  const content = document.createElement(\"div\");\n  content.className = \"pasajero-content\";\n  content.style.display = \"none\";\n  content.innerHTML = `\n    <div>\n      <label>Tipo de Pasajero:</label>\n      <select id=\"tipoPasajero_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"adulto\">Adulto</option>\n        <option value=\"menor\">Menor</option>\n        <option value=\"infante\">Infante</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nombre: <span style=\"color: red;\">*</span></label>\n      <input type=\"text\" id=\"nombre_${numero}\" placeholder=\"Ingrese el nombre\">\n    </div>\n\n    <div>\n      <label>Apellido: <span style=\"color: red;\">*</span></label>\n      <input type=\"text\" id=\"apellido_${numero}\" placeholder=\"Ingrese el apellido\">\n    </div>\n\n    <div>\n      <label>DNI:</label>\n      <input type=\"number\" id=\"dni_${numero}\" placeholder=\"Ingrese el DNI\">\n    </div>\n\n    <div>\n      <label>Fecha de Nacimiento:</label>\n      <input type=\"date\" id=\"fechaNacimiento_${numero}\">\n    </div>\n\n    <div>\n      <label>CUIL:</label>\n      <input type=\"number\" id=\"cuil_${numero}\" placeholder=\"Ingrese el CUIL\">\n    </div>\n\n    <div>\n      <label>Tipo de Documento:</label>\n      <select id=\"tipoDoc_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"dni\">DNI</option>\n        <option value=\"pasaporte\">Pasaporte</option>\n        <option value=\"cedula\">Cdula</option>\n        <option value=\"otro\">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Sexo:</label>\n      <select id=\"sexo_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"masculino\">Masculino</option>\n        <option value=\"femenino\">Femenino</option>\n        <option value=\"otro\">Otro</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Nacionalidad:</label>\n      <select id=\"nacionalidad_${numero}\">\n        <option value=\"\">Seleccione...</option>\n        <option value=\"argentina\">Argentina</option>\n        <option value=\"brasilera\">Brasilera</option>\n        <option value=\"chilena\">Chilena</option>\n        <option value=\"uruguaya\">Uruguaya</option>\n        <option value=\"paraguaya\">Paraguaya</option>\n        <option value=\"boliviana\">Boliviana</option>\n        <option value=\"peruana\">Peruana</option>\n        <option value=\"colombiana\">Colombiana</option>\n        <option value=\"venezolana\">Venezolana</option>\n        <option value=\"otra\">Otra</option>\n      </select>\n    </div>\n\n    <div>\n      <label>Direccin:</label>\n      <input type=\"text\" id=\"direccion_${numero}\" placeholder=\"Ingrese la direccin\">\n    </div>\n\n    <div>\n      <label>Nmero de Telfono:</label>\n      <input type=\"tel\" id=\"telefono_${numero}\" placeholder=\"Ingrese el telfono\">\n    </div>\n  `;\n  \n  // Funcionalidad de acorden (toggle)\n  header.onclick = function(e) {\n    // No hacer toggle si se clicke el botn de eliminar\n    if (e.target.classList.contains('btn-eliminar-pasajero')) {\n      return;\n    }\n    \n    const isOpen = content.style.display === \"block\";\n    const arrow = header.querySelector(\".arrow\");\n    \n    if (isOpen) {\n      content.style.display = \"none\";\n      arrow.style.transform = \"rotate(0deg)\";\n    } else {\n      content.style.display = \"block\";\n      arrow.style.transform = \"rotate(180deg)\";\n    }\n  };\n  \n  // Agregar event listeners para validacin en tiempo real (solo nombre y apellido)\n  setTimeout(() => {\n    const nombreInput = document.getElementById(`nombre_${numero}`);\n    const apellidoInput = document.getElementById(`apellido_${numero}`);\n    \n    if (nombreInput) {\n      nombreInput.addEventListener('input', actualizarEstadoBotonCrearReserva);\n    }\n    if (apellidoInput) {\n      apellidoInput.addEventListener('input', actualizarEstadoBotonCrearReserva);\n    }\n  }, 100);\n  \n  // Funcionalidad del botn eliminar\n  const btnEliminar = header.querySelector('.btn-eliminar-pasajero');\n  btnEliminar.onclick = function(e) {\n    e.stopPropagation(); // Evitar que se abra/cierre el acorden\n    eliminarPasajero(pasajeroDiv);\n  };\n  \n  pasajeroDiv.appendChild(header);\n  pasajeroDiv.appendChild(content);\n  \n  // Poblar los selects con datos maestros despus de crear el formulario\n  setTimeout(() => {\n    poblarSelectsPasajero(numero);\n  }, 50);\n  \n  return pasajeroDiv;\n}\n\nfunction eliminarPasajero(pasajeroDiv) {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    \n    // No permitir eliminar si solo hay un pasajero\n    if (pasajeros.length <= 1) {\n      mostrarMensaje(\"Debe haber al menos un pasajero\", \"info\");\n      return;\n    }\n    \n    // Eliminar directamente sin confirmacin (o puedes crear un modal personalizado)\n    pasajeroDiv.remove();\n    renumerarPasajeros();\n    mostrarMensaje(\"Pasajero eliminado correctamente\", \"success\");\n    \n    // Actualizar estado del botn despus de eliminar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    mostrarMensaje(\"Error al eliminar pasajero\", \"error\");\n  }\n}\n\nfunction renumerarPasajeros() {\n  const container = document.getElementById(\"pasajerosContainer\");\n  const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n  \n  pasajeros.forEach((pasajeroDiv, index) => {\n    const nuevoNumero = index + 1;\n    const titulo = pasajeroDiv.querySelector(\".pasajero-titulo\");\n    titulo.textContent = `Pasajero ${nuevoNumero}`;\n    pasajeroDiv.dataset.numeroPasajero = nuevoNumero;\n  });\n}\n\nfunction agregarNuevoPasajero() {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    const nuevoNumero = pasajeros.length + 1;\n    \n    const nuevoPasajero = crearFormularioPasajero(nuevoNumero);\n    container.appendChild(nuevoPasajero);\n    \n    // Abrir automticamente el nuevo pasajero\n    const content = nuevoPasajero.querySelector(\".pasajero-content\");\n    const arrow = nuevoPasajero.querySelector(\".arrow\");\n    if (content && arrow) {\n      content.style.display = \"block\";\n      arrow.style.transform = \"rotate(180deg)\";\n    }\n    \n    // Scroll suave hacia el nuevo pasajero\n    if (nuevoPasajero.scrollIntoView) {\n      nuevoPasajero.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n    }\n    \n    // Actualizar estado del botn despus de agregar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    throw error;\n  }\n}\n\nfunction guardarDatos() {\n  try {\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      mostrarMensaje(\"No se encontr el contenedor de pasajeros\", \"error\");\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    if (pasajeros.length === 0) {\n      mostrarMensaje(\"No hay pasajeros para guardar. Por favor, extraiga datos primero.\", \"info\");\n      return;\n    }\n    \n    const todosPasajeros = [];\n    \n    pasajeros.forEach((pasajeroDiv, index) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      \n      // Obtener valores directamente del DOM del pasajero\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      if (content) {\n        const datos = {\n          numeroPasajero: index + 1, // Nmero secuencial para el guardado\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        todosPasajeros.push(datos);\n      }\n    });\n    \n    // Aqu puedes enviar los datos a tu backend/base de datos\n    // Por ejemplo: enviar a Azure Function, API, etc.\n    // fetch('tu-api-url', {\n    //   method: 'POST',\n    //   headers: { 'Content-Type': 'application/json' },\n    //   body: JSON.stringify(todosPasajeros)\n    // });\n    \n    mostrarMensaje(`Datos de ${todosPasajeros.length} pasajero(s) guardados correctamente`, \"success\");\n  } catch (error) {\n    throw error;\n  }\n}\n\nfunction llenarDatosPasajeros(datosPasajeros) {\n  // Funcin auxiliar para llenar los datos extrados por la IA\n  // Esperar un poco para asegurar que los selects estn poblados\n  setTimeout(() => {\n    datosPasajeros.forEach((datos, index) => {\n      const numero = index + 1;\n      \n      if (document.getElementById(`tipoPasajero_${numero}`)) {\n        // Mapear passengerType o paxType de la IA a tipoPasajero del formulario\n        let tipoPasajero = \"\";\n        const passengerType = datos.passengerType || datos.paxType;\n        if (passengerType === \"ADU\") tipoPasajero = \"adulto\";\n        else if (passengerType === \"CHD\") tipoPasajero = \"menor\";\n        else if (passengerType === \"INF\") tipoPasajero = \"infante\";\n        \n        // Los valores de sex, documentType y nationality ahora vienen normalizados del backend\n        // sex viene como cdigo: \"M\" o \"F\"\n        // documentType viene como cdigo: \"DNI\", \"PAS\", \"CI\", etc.\n        // nationality viene como nombre completo en maysculas: \"ARGENTINA\", \"BRASIL\", etc.\n        \n        document.getElementById(`tipoPasajero_${numero}`).value = tipoPasajero;\n        document.getElementById(`nombre_${numero}`).value = datos.firstName || \"\";\n        document.getElementById(`apellido_${numero}`).value = datos.lastName || \"\";\n        document.getElementById(`dni_${numero}`).value = datos.documentNumber || \"\";\n        // El backend enva dateOfBirth, no birthDate\n        document.getElementById(`fechaNacimiento_${numero}`).value = datos.dateOfBirth || datos.birthDate || \"\";\n        document.getElementById(`cuil_${numero}`).value = datos.cuilCuit || \"\";\n        \n        // Usar los cdigos directamente tal como vienen del backend\n        const tipoDocSelect = document.getElementById(`tipoDoc_${numero}`);\n        if (tipoDocSelect && datos.documentType) {\n          tipoDocSelect.value = datos.documentType;\n          console.log(` Tipo Doc ${numero}: ${datos.documentType} -> ${tipoDocSelect.value}`);\n        }\n        \n        const sexoSelect = document.getElementById(`sexo_${numero}`);\n        if (sexoSelect && datos.sex) {\n          sexoSelect.value = datos.sex;\n          console.log(` Sexo ${numero}: ${datos.sex} -> ${sexoSelect.value}`);\n        }\n        \n        const nacionalidadSelect = document.getElementById(`nacionalidad_${numero}`);\n        if (nacionalidadSelect && datos.nationality) {\n          nacionalidadSelect.value = datos.nationality;\n          console.log(` Nacionalidad ${numero}: ${datos.nationality} -> ${nacionalidadSelect.value}`);\n        }\n        \n        document.getElementById(`direccion_${numero}`).value = datos.direccion || \"\";\n        // El backend enva phoneNumber, no telefono\n        document.getElementById(`telefono_${numero}`).value = datos.phoneNumber || datos.telefono || \"\";\n      }\n    });\n    \n    // Actualizar estado del botn despus de llenar los datos\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  }, 150); // Esperar 150ms para que los selects se pueblen primero\n}\n\n/**\n * Llena los datos de la reserva extrados por la IA\n */\nfunction llenarDatosReserva(datosExtraidos) {\n  // Repoblar los selects de reserva primero para asegurar que tengan opciones\n  poblarSelectReserva();\n  \n  // Esperar un poco ms para asegurar que los selects estn poblados\n  setTimeout(() => {\n    // Tipo de Reserva\n    const tipoReservaSelect = document.getElementById(\"tipoReserva\");\n    if (tipoReservaSelect) {\n      const valorTipoReserva = datosExtraidos.reservationType;\n      console.log(` Intentando asignar Tipo Reserva: \"${valorTipoReserva}\"`);\n      console.log(` Opciones en select:`, Array.from(tipoReservaSelect.options).map(o => `\"${o.value}\"`));\n      \n      if (valorTipoReserva && valorTipoReserva !== 'null' && valorTipoReserva !== null) {\n        tipoReservaSelect.value = valorTipoReserva;\n        console.log(` Tipo Reserva asignado: \"${valorTipoReserva}\" -> \"${tipoReservaSelect.value}\"`);\n        \n        // Si no se seleccion, intentar buscar una coincidencia parcial\n        if (!tipoReservaSelect.value || tipoReservaSelect.value === \"\") {\n          const opciones = Array.from(tipoReservaSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorTipoReserva &&\n            (opt.value.toUpperCase().includes(valorTipoReserva.toUpperCase()) ||\n            valorTipoReserva.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            tipoReservaSelect.value = coincidencia.value;\n            console.log(` Tipo Reserva (coincidencia): \"${valorTipoReserva}\" -> \"${tipoReservaSelect.value}\"`);\n          } else {\n            console.warn(` No se encontr coincidencia para Tipo Reserva: \"${valorTipoReserva}\"`);\n          }\n        }\n      }\n    }\n    \n    // Estado\n    const estadoReservaSelect = document.getElementById(\"estadoReserva\");\n    if (estadoReservaSelect) {\n      const valorEstado = datosExtraidos.status;\n      const opcionesDisponibles = Array.from(estadoReservaSelect.options).map(o => o.value);\n      \n      console.log(` Intentando asignar Estado: \"${valorEstado}\"`);\n      console.log(` Opciones disponibles en select Estado:`, opcionesDisponibles);\n      console.log(` Total de opciones: ${opcionesDisponibles.length}`);\n      \n      if (valorEstado && valorEstado !== 'null' && valorEstado !== null) {\n        // Intentar asignacin directa\n        estadoReservaSelect.value = valorEstado;\n        console.log(` Intento directo: \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n        \n        // Si no se seleccion, intentar buscar una coincidencia\n        if (!estadoReservaSelect.value || estadoReservaSelect.value === \"\") {\n          console.log(` Asignacin directa fall, buscando coincidencia...`);\n          \n          const opciones = Array.from(estadoReservaSelect.options);\n          \n          // Intentar coincidencia exacta ignorando espacios y maysculas\n          let coincidencia = opciones.find(opt => \n            opt.value && \n            opt.value.trim().toUpperCase() === valorEstado.trim().toUpperCase()\n          );\n          \n          if (coincidencia) {\n            estadoReservaSelect.value = coincidencia.value;\n            console.log(` Estado (coincidencia exacta): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n          } else {\n            // Intentar coincidencia parcial\n            coincidencia = opciones.find(opt => \n              opt.value && valorEstado &&\n              (opt.value.toUpperCase().includes(valorEstado.toUpperCase()) ||\n              valorEstado.toUpperCase().includes(opt.value.toUpperCase()))\n            );\n            \n            if (coincidencia) {\n              estadoReservaSelect.value = coincidencia.value;\n              console.log(` Estado (coincidencia parcial): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n            } else {\n              // Intentar mapeo inteligente por palabras clave\n              const valorUpper = valorEstado.toUpperCase();\n              \n              if (valorUpper.includes('CONFIRMAD') || valorUpper.includes('CONFIRM')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('CONFIRMAD'));\n              } else if (valorUpper.includes('PENDIENTE') || valorUpper.includes('PENDING')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('PENDIENTE'));\n              } else if (valorUpper.includes('CANCELAD') || valorUpper.includes('CANCEL')) {\n                coincidencia = opciones.find(opt => opt.value && opt.value.toUpperCase().includes('CANCELAD'));\n              }\n              \n              if (coincidencia) {\n                estadoReservaSelect.value = coincidencia.value;\n                console.log(` Estado (mapeo inteligente): \"${valorEstado}\" -> \"${estadoReservaSelect.value}\"`);\n              } else {\n                console.error(` No se encontr ninguna coincidencia para Estado: \"${valorEstado}\"`);\n                console.log(` Sugerencia: Verifica que el valor extrado coincida con alguna de estas opciones:`, opcionesDisponibles);\n              }\n            }\n          }\n        } else {\n          console.log(` Estado asignado correctamente: \"${estadoReservaSelect.value}\"`);\n        }\n      } else {\n        console.log(` Estado es null o invlido: \"${valorEstado}\"`);\n      }\n    }\n    \n    // Fecha de Viaje\n    if (document.getElementById(\"fechaViaje\")) {\n      document.getElementById(\"fechaViaje\").value = datosExtraidos.travelDate || \"\";\n      console.log(` Fecha Viaje: ${datosExtraidos.travelDate}`);\n    }\n    \n    // Vendedor\n    const vendedorSelect = document.getElementById(\"vendedor\");\n    if (vendedorSelect) {\n      const valorVendedor = datosExtraidos.seller;\n      if (valorVendedor && valorVendedor !== 'null' && valorVendedor !== null) {\n        vendedorSelect.value = valorVendedor;\n        console.log(` Vendedor: \"${valorVendedor}\" -> \"${vendedorSelect.value}\"`);\n        \n        // Si no se seleccion, intentar buscar una coincidencia parcial\n        if (!vendedorSelect.value || vendedorSelect.value === \"\") {\n          const opciones = Array.from(vendedorSelect.options);\n          const coincidencia = opciones.find(opt => \n            opt.value && valorVendedor &&\n            (opt.value.toUpperCase().includes(valorVendedor.toUpperCase()) ||\n            valorVendedor.toUpperCase().includes(opt.value.toUpperCase()))\n          );\n          if (coincidencia) {\n            vendedorSelect.value = coincidencia.value;\n            console.log(` Vendedor (coincidencia): \"${valorVendedor}\" -> \"${vendedorSelect.value}\"`);\n          }\n        }\n      } else {\n        console.log(` Vendedor es null o invlido: \"${valorVendedor}\"`);\n      }\n    }\n    \n    // Cliente\n    const clienteSelect = document.getElementById(\"cliente\");\n    if (clienteSelect) {\n      const valorCliente = datosExtraidos.client;\n      if (valorCliente && valorCliente !== 'null' && valorCliente !== null) {\n        // Intentar asignacin directa primero\n        clienteSelect.value = valorCliente;\n        \n        // Si no se seleccion, usar la funcin de coincidencia inteligente\n        if (!clienteSelect.value || clienteSelect.value === \"\") {\n          const clienteCoincidente = encontrarClienteCoincidente(valorCliente, masterData.clients);\n          if (clienteCoincidente) {\n            clienteSelect.value = clienteCoincidente;\n            console.log(` Cliente (coincidencia inteligente): \"${valorCliente}\" -> \"${clienteSelect.value}\"`);\n          } else {\n            console.warn(` No se encontr coincidencia para Cliente: \"${valorCliente}\"`);\n          }\n        } else {\n          console.log(` Cliente asignado correctamente: \"${clienteSelect.value}\"`);\n        }\n      } else {\n        console.log(` Cliente es null o invlido: \"${valorCliente}\"`);\n      }\n    }\n    \n    // Campos adicionales de la reserva\n    // Cdigo\n    if (document.getElementById(\"codigo\")) {\n      document.getElementById(\"codigo\").value = datosExtraidos.codigo || \"\";\n    }\n    \n    // Fecha de Reserva\n    if (document.getElementById(\"fechaReserva\")) {\n      document.getElementById(\"fechaReserva\").value = datosExtraidos.reservationDate || \"\";\n    }\n    \n    // Fecha Fin de Tour\n    if (document.getElementById(\"fechaFinTour\")) {\n      document.getElementById(\"fechaFinTour\").value = datosExtraidos.tourEndDate || \"\";\n    }\n    \n    // Fecha de Vencimiento\n    if (document.getElementById(\"fechaVencimiento\")) {\n      document.getElementById(\"fechaVencimiento\").value = datosExtraidos.dueDate || \"\";\n    }\n    \n    // Contacto\n    if (document.getElementById(\"contacto\")) {\n      document.getElementById(\"contacto\").value = datosExtraidos.contact || \"\";\n    }\n    \n    // Email de Contacto\n    if (document.getElementById(\"contactEmail\")) {\n      document.getElementById(\"contactEmail\").value = datosExtraidos.contactEmail || \"\";\n    }\n    \n    // Telfono de Contacto\n    if (document.getElementById(\"contactPhone\")) {\n      document.getElementById(\"contactPhone\").value = datosExtraidos.contactPhone || \"\";\n    }\n    \n    // Moneda\n    if (document.getElementById(\"moneda\")) {\n      document.getElementById(\"moneda\").value = datosExtraidos.currency || \"\";\n    }\n    \n    // Tipo de Cambio\n    if (document.getElementById(\"tipoCambio\")) {\n      document.getElementById(\"tipoCambio\").value = datosExtraidos.exchangeRate || \"\";\n    }\n    \n    // Comisin\n    if (document.getElementById(\"comision\")) {\n      document.getElementById(\"comision\").value = datosExtraidos.commission || \"\";\n    }\n    \n    // Monto Neto\n    if (document.getElementById(\"montoNeto\")) {\n      document.getElementById(\"montoNeto\").value = datosExtraidos.netAmount || \"\";\n    }\n    \n    // Monto Bruto\n    if (document.getElementById(\"montoBruto\")) {\n      document.getElementById(\"montoBruto\").value = datosExtraidos.grossAmount || \"\";\n    }\n    \n    // Nombre del Viaje\n    if (document.getElementById(\"nombreViaje\")) {\n      document.getElementById(\"nombreViaje\").value = datosExtraidos.tripName || \"\";\n    }\n    \n    // Cdigo de Producto\n    if (document.getElementById(\"codigoProducto\")) {\n      document.getElementById(\"codigoProducto\").value = datosExtraidos.productCode || \"\";\n    }\n    \n    // Adultos\n    if (document.getElementById(\"adultos\")) {\n      document.getElementById(\"adultos\").value = datosExtraidos.adults || \"\";\n    }\n    \n    // Nios\n    if (document.getElementById(\"ninos\")) {\n      document.getElementById(\"ninos\").value = datosExtraidos.children || \"\";\n    }\n    \n    // Infantes\n    if (document.getElementById(\"infantes\")) {\n      document.getElementById(\"infantes\").value = datosExtraidos.infants || \"\";\n    }\n    \n    // Proveedor\n    if (document.getElementById(\"proveedor\")) {\n      document.getElementById(\"proveedor\").value = datosExtraidos.provider || \"\";\n    }\n    \n    // Cdigo de Reserva\n    if (document.getElementById(\"codigoReserva\")) {\n      document.getElementById(\"codigoReserva\").value = datosExtraidos.reservationCode || \"\";\n    }\n    \n    // Hotel (ahora es un objeto) - Solo mostrar si viene de la extraccin\n    const hotelSection = document.getElementById(\"hotelSection\");\n    const agregarHotelButton = document.getElementById(\"agregarHotel\");\n    \n    if (datosExtraidos.hotel && typeof datosExtraidos.hotel === 'object') {\n      // Mostrar seccin de hotel y hacer campos required\n      if (hotelSection) {\n        hotelSection.style.display = \"block\";\n      }\n      if (agregarHotelButton) {\n        agregarHotelButton.style.display = \"none\";\n      }\n      \n      // Llenar campos y hacerlos required\n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.required = true;\n        }\n      });\n      \n      if (document.getElementById(\"hotel_nombre\")) {\n        document.getElementById(\"hotel_nombre\").value = datosExtraidos.hotel.nombre_hotel || \"\";\n      }\n      if (document.getElementById(\"hotel_tipo_habitacion\")) {\n        document.getElementById(\"hotel_tipo_habitacion\").value = datosExtraidos.hotel.tipo_habitacion || \"\";\n      }\n      if (document.getElementById(\"hotel_ciudad\")) {\n        document.getElementById(\"hotel_ciudad\").value = datosExtraidos.hotel.Ciudad || \"\";\n      }\n      if (document.getElementById(\"hotel_categoria\")) {\n        document.getElementById(\"hotel_categoria\").value = datosExtraidos.hotel.Categoria || \"\";\n      }\n      if (document.getElementById(\"hotel_in\")) {\n        document.getElementById(\"hotel_in\").value = datosExtraidos.hotel.in || \"\";\n      }\n      if (document.getElementById(\"hotel_out\")) {\n        document.getElementById(\"hotel_out\").value = datosExtraidos.hotel.out || \"\";\n      }\n    } else if (typeof datosExtraidos.hotel === 'string') {\n      // Compatibilidad con formato antiguo (solo texto)\n      if (hotelSection) {\n        hotelSection.style.display = \"block\";\n      }\n      if (agregarHotelButton) {\n        agregarHotelButton.style.display = \"none\";\n      }\n      \n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.required = true;\n        }\n      });\n      \n      if (document.getElementById(\"hotel_nombre\")) {\n        document.getElementById(\"hotel_nombre\").value = datosExtraidos.hotel || \"\";\n      }\n    } else {\n      // No hay hotel - ocultar seccin y mostrar botn\n      if (hotelSection) {\n        hotelSection.style.display = \"none\";\n      }\n      if (agregarHotelButton) {\n        agregarHotelButton.style.display = \"block\";\n      }\n      \n      // Quitar required de campos de hotel\n      const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n      camposHotel.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.required = false;\n          campo.value = \"\";\n        }\n      });\n    }\n    \n    // Check In\n    if (document.getElementById(\"checkIn\")) {\n      document.getElementById(\"checkIn\").value = datosExtraidos.checkIn || \"\";\n    }\n    \n    // Check Out\n    if (document.getElementById(\"checkOut\")) {\n      document.getElementById(\"checkOut\").value = datosExtraidos.checkOut || \"\";\n    }\n    \n    // Estado de Deuda\n    if (document.getElementById(\"estadoDeuda\")) {\n      document.getElementById(\"estadoDeuda\").value = datosExtraidos.estadoDeuda || \"\";\n    }\n    \n    // Llenar servicios si existen\n    const serviciosSection = document.getElementById(\"serviciosSection\");\n    const agregarServicioButton = document.getElementById(\"agregarServicio\");\n    \n    if (datosExtraidos.services && Array.isArray(datosExtraidos.services) && datosExtraidos.services.length > 0) {\n      if (serviciosSection) {\n        serviciosSection.style.display = \"block\";\n      }\n      llenarServicios(datosExtraidos.services);\n    } else {\n      // Si no hay servicios, ocultar la seccin pero mantener el botn visible\n      if (serviciosSection) {\n        serviciosSection.style.display = \"none\";\n      }\n    }\n    \n    // El botn de agregar servicio siempre est visible (definido en HTML)\n    \n    // Llenar vuelos si existen\n    if (datosExtraidos.flights && Array.isArray(datosExtraidos.flights) && datosExtraidos.flights.length > 0) {\n      const vuelosSection = document.getElementById(\"vuelosSection\");\n      if (vuelosSection) {\n        vuelosSection.style.display = \"block\";\n      }\n      llenarVuelos(datosExtraidos.flights);\n    }\n    \n    // Actualizar estado del botn despus de llenar los datos\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  }, 250); // Esperar 250ms para asegurar que los selects estn poblados\n}\n\n/**\n * Encuentra el mejor servicio coincidente usando regex y comparacin de palabras\n * @param {string} servicioBackend - Nombre del servicio que viene del backend\n * @returns {string|null} - El servicio ms coincidente o null si no hay coincidencias suficientes\n */\nfunction encontrarServicioCoincidente(servicioBackend) {\n  if (!servicioBackend || typeof servicioBackend !== 'string') {\n    return null;\n  }\n  \n  const servicioNormalizado = servicioBackend.trim().toUpperCase();\n  const palabrasBackend = servicioNormalizado.split(/\\s+/).filter(p => p.length > 0);\n  \n  if (palabrasBackend.length === 0) {\n    return null;\n  }\n  \n  let mejorCoincidencia = null;\n  let maxCoincidencias = 0;\n  let mejorPuntuacion = 0;\n  \n  // Palabras clave importantes que dan ms peso a la coincidencia\n  const palabrasClave = ['BODEGA', 'BODEGAS', 'TRASLADO', 'EXCURSION', 'TOUR', 'ALMUERZO', 'CENA', 'HOTEL', 'SPA', 'CABALGATA'];\n  \n  servicesList.forEach(servicioLista => {\n    const servicioListaNormalizado = servicioLista.trim().toUpperCase();\n    const palabrasLista = servicioListaNormalizado.split(/\\s+/).filter(p => p.length > 0);\n    \n    // Contar palabras que coinciden\n    let coincidencias = 0;\n    let puntuacion = 0;\n    \n    palabrasBackend.forEach(palabraBackend => {\n      // Buscar la palabra en la lista (coincidencia exacta o parcial)\n      const encontrado = palabrasLista.some(palabraLista => {\n        // Coincidencia exacta\n        if (palabraLista === palabraBackend) {\n          // Dar ms peso si es una palabra clave\n          if (palabrasClave.includes(palabraBackend)) {\n            puntuacion += 2;\n          } else {\n            puntuacion += 1;\n          }\n          return true;\n        }\n        // Coincidencia parcial (una contiene a la otra)\n        if (palabraLista.includes(palabraBackend) || palabraBackend.includes(palabraLista)) {\n          // Solo contar si ambas palabras tienen al menos 3 caracteres para evitar falsos positivos\n          if (palabraBackend.length >= 3 && palabraLista.length >= 3) {\n            // Dar peso reducido a coincidencias parciales\n            if (palabrasClave.includes(palabraBackend) || palabrasClave.includes(palabraLista)) {\n              puntuacion += 1;\n            } else {\n              puntuacion += 0.5;\n            }\n            return true;\n          }\n        }\n        return false;\n      });\n      \n      if (encontrado) {\n        coincidencias++;\n      }\n    });\n    \n    // Si hay ms de una palabra coincidente, considerar esta opcin\n    // O si hay una coincidencia muy significativa (palabra clave con alta puntuacin)\n    if (coincidencias > maxCoincidencias && (coincidencias > 1 || puntuacion >= 2)) {\n      maxCoincidencias = coincidencias;\n      mejorPuntuacion = puntuacion;\n      mejorCoincidencia = servicioLista;\n    } else if (coincidencias === maxCoincidencias && puntuacion > mejorPuntuacion) {\n      // Si hay el mismo nmero de coincidencias, elegir el de mayor puntuacin\n      mejorPuntuacion = puntuacion;\n      mejorCoincidencia = servicioLista;\n    }\n  });\n  \n  // Si encontramos al menos 2 palabras coincidentes, o una coincidencia muy significativa\n  if (maxCoincidencias >= 2 || mejorPuntuacion >= 2) {\n    return mejorCoincidencia;\n  }\n  \n  return null;\n}\n\n/**\n * Normaliza el estado del servicio a su cdigo (ej: \"LI - LIBERADO [LI]\" -> \"LI\")\n * @param {string} estado - Estado del servicio (puede venir en diferentes formatos)\n * @returns {string} Cdigo del estado o string vaco\n */\nfunction normalizarEstadoServicio(estado) {\n  if (!estado || typeof estado !== 'string') return '';\n  \n  // Si ya es un cdigo de 2 letras, retornarlo\n  if (estado.length === 2 && /^[A-Z]{2}$/.test(estado)) {\n    return estado;\n  }\n  \n  // Intentar extraer el cdigo del formato \"XX - DESCRIPCION [XX]\"\n  const match = estado.match(/^([A-Z]{2})\\s*-/);\n  if (match) {\n    return match[1];\n  }\n  \n  // Intentar extraer de formato \"[XX]\"\n  const match2 = estado.match(/\\[([A-Z]{2})\\]/);\n  if (match2) {\n    return match2[1];\n  }\n  \n  return '';\n}\n\n/**\n * Crea un elemento de servicio en el formulario\n * @param {number} index - ndice del servicio\n * @param {Object} servicio - Datos del servicio (opcional)\n * @param {boolean} esDeExtraccion - Si el servicio viene de la extraccin de IA\n * @returns {HTMLElement} El elemento div del servicio\n */\nfunction crearElementoServicio(index, servicio = {}, esDeExtraccion = false) {\n  const servicioDiv = document.createElement(\"div\");\n  servicioDiv.className = \"servicio-item\";\n  \n  // Intentar encontrar el servicio coincidente\n  const servicioCoincidente = servicio.servicio \n    ? encontrarServicioCoincidente(servicio.servicio)\n    : null;\n  \n  // Normalizar el estado del servicio\n  const estadoNormalizado = normalizarEstadoServicio(servicio.estado || '');\n  \n  // Crear el HTML con un datalist para autocompletado\n  const datalistId = `serviciosList_${index}`;\n  const requiredAttr = esDeExtraccion ? 'required' : '';\n  const requiredSpan = esDeExtraccion ? '<span style=\"color: red;\">*</span>' : '';\n  \n  servicioDiv.dataset.servicioIndex = index;\n  servicioDiv.innerHTML = `\n    <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;\">\n      <h4 style=\"margin: 0;\">Servicio ${index + 1}</h4>\n      <button class=\"btn-eliminar-servicio\" title=\"Eliminar servicio\" data-servicio-index=\"${index}\"></button>\n    </div>\n    <div class=\"form-group\">\n      <label>Destino: ${requiredSpan}</label>\n      <input type=\"text\" id=\"servicio_destino_${index}\" value=\"${servicio.destino || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Fecha Entrada: ${requiredSpan}</label>\n      <input type=\"date\" id=\"servicio_in_${index}\" value=\"${servicio.in || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Fecha Salida: ${requiredSpan}</label>\n      <input type=\"date\" id=\"servicio_out_${index}\" value=\"${servicio.out || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Noches: ${requiredSpan}</label>\n      <input type=\"number\" id=\"servicio_nts_${index}\" value=\"${servicio.nts !== undefined && servicio.nts !== null ? servicio.nts : ''}\" min=\"0\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Base Pax: ${requiredSpan}</label>\n      <input type=\"number\" id=\"servicio_basePax_${index}\" value=\"${servicio.basePax || ''}\" ${requiredAttr}>\n    </div>\n    <div class=\"form-group\">\n      <label>Servicio: ${requiredSpan}</label>\n      <input type=\"text\" id=\"servicio_servicio_${index}\" \n             list=\"${datalistId}\" \n             value=\"${servicioCoincidente || servicio.servicio || ''}\" \n             placeholder=\"Buscar o escribir servicio...\"\n             ${requiredAttr}>\n      <datalist id=\"${datalistId}\">\n        ${servicesList.map(s => `<option class=\"servicio-option\" value=\"${s}\">${s}</option>`).join('')}\n      </datalist>\n    </div>\n    <div class=\"form-group\">\n      <label>Descripcin: ${requiredSpan}</label>\n      <textarea id=\"servicio_descripcion_${index}\" ${requiredAttr}>${servicio.descripcion || ''}</textarea>\n    </div>\n    <div class=\"form-group\">\n      <label>Estado: ${requiredSpan}</label>\n      <select id=\"servicio_estado_${index}\" ${requiredAttr}>\n        <option value=\"\">Seleccione...</option>\n        <option value=\"LI\" ${estadoNormalizado === 'LI' ? 'selected' : ''}>LI - LIBERADO [LI]</option>\n        <option value=\"OK\" ${estadoNormalizado === 'OK' ? 'selected' : ''}>OK - CONFIRMADO [OK]</option>\n        <option value=\"WL\" ${estadoNormalizado === 'WL' ? 'selected' : ''}>WL - LISTA DE ESPERA [WL]</option>\n        <option value=\"RM\" ${estadoNormalizado === 'RM' ? 'selected' : ''}>RM - FAVOR MODIFICAR [RM]</option>\n        <option value=\"NN\" ${estadoNormalizado === 'NN' ? 'selected' : ''}>NN - FAVOR RESERVAR [NN]</option>\n        <option value=\"RQ\" ${estadoNormalizado === 'RQ' ? 'selected' : ''}>RQ - REQUERIDO [RQ]</option>\n        <option value=\"LK\" ${estadoNormalizado === 'LK' ? 'selected' : ''}>LK - RVA OK S/LIQUIDAR [LK]</option>\n        <option value=\"RE\" ${estadoNormalizado === 'RE' ? 'selected' : ''}>RE - RECHAZADO [RE]</option>\n        <option value=\"MQ\" ${estadoNormalizado === 'MQ' ? 'selected' : ''}>MQ - MODIFICACION REQUERIDA [MQ]</option>\n        <option value=\"CL\" ${estadoNormalizado === 'CL' ? 'selected' : ''}>CL - FAVOR CANCELAR [CL]</option>\n        <option value=\"CA\" ${estadoNormalizado === 'CA' ? 'selected' : ''}>CA - CANCELACION SOLICITADA [CA]</option>\n        <option value=\"CX\" ${estadoNormalizado === 'CX' ? 'selected' : ''}>CX - CANCELADO [CX]</option>\n        <option value=\"EM\" ${estadoNormalizado === 'EM' ? 'selected' : ''}>EM - EMITIDO [EM]</option>\n        <option value=\"EN\" ${estadoNormalizado === 'EN' ? 'selected' : ''}>EN - ENTREGADO [EN]</option>\n        <option value=\"AR\" ${estadoNormalizado === 'AR' ? 'selected' : ''}>AR - FAVOR RESERVAR [AR]</option>\n        <option value=\"HK\" ${estadoNormalizado === 'HK' ? 'selected' : ''}>HK - OK CUPO [HK]</option>\n        <option value=\"PE\" ${estadoNormalizado === 'PE' ? 'selected' : ''}>PE - PENALIDAD [PE]</option>\n        <option value=\"NO\" ${estadoNormalizado === 'NO' ? 'selected' : ''}>NO - NEGADO [NO]</option>\n        <option value=\"NC\" ${estadoNormalizado === 'NC' ? 'selected' : ''}>NC - NO CONFORMIDAD [NC]</option>\n        <option value=\"PF\" ${estadoNormalizado === 'PF' ? 'selected' : ''}>PF - PENDIENTE DE FC. COMISION [PF]</option>\n        <option value=\"AO\" ${estadoNormalizado === 'AO' ? 'selected' : ''}>AO - REQUERIR ON LINE [AO]</option>\n        <option value=\"CO\" ${estadoNormalizado === 'CO' ? 'selected' : ''}>CO - CANCELAR ONLINE [CO]</option>\n        <option value=\"GX\" ${estadoNormalizado === 'GX' ? 'selected' : ''}>GX - GASTOS CANCELACION ONLINE [GX]</option>\n        <option value=\"EO\" ${estadoNormalizado === 'EO' ? 'selected' : ''}>EO - EN TRAFICO [EO]</option>\n        <option value=\"KL\" ${estadoNormalizado === 'KL' ? 'selected' : ''}>KL - REQUERIDO CUPO [KL]</option>\n        <option value=\"MI\" ${estadoNormalizado === 'MI' ? 'selected' : ''}>MI - RESERVA MIGRADA [MI]</option>\n        <option value=\"VO\" ${estadoNormalizado === 'VO' ? 'selected' : ''}>VO - VOID [VO]</option>\n      </select>\n    </div>\n  `;\n  \n  // Agregar event listeners para validacin en tiempo real\n  setTimeout(() => {\n    const camposServicio = [\n      `servicio_destino_${index}`,\n      `servicio_in_${index}`,\n      `servicio_out_${index}`,\n      `servicio_nts_${index}`,\n      `servicio_basePax_${index}`,\n      `servicio_servicio_${index}`,\n      `servicio_descripcion_${index}`,\n      `servicio_estado_${index}`\n    ];\n    \n    camposServicio.forEach(campoId => {\n      const campo = document.getElementById(campoId);\n      if (campo) {\n        campo.addEventListener('change', actualizarEstadoBotonCrearReserva);\n        campo.addEventListener('input', actualizarEstadoBotonCrearReserva);\n      }\n    });\n    \n    // Agregar event listener al botn de eliminar\n    const btnEliminar = servicioDiv.querySelector('.btn-eliminar-servicio');\n    if (btnEliminar) {\n      btnEliminar.onclick = function(e) {\n        e.stopPropagation();\n        eliminarServicio(servicioDiv);\n      };\n    }\n  }, 100);\n  \n  return servicioDiv;\n}\n\n/**\n * Llena los servicios en el formulario\n * @param {Array} servicios - Array de servicios extrados\n */\nfunction llenarServicios(servicios) {\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  if (!serviciosContainer) return;\n  \n  serviciosContainer.innerHTML = \"\";\n  \n  // Mostrar seccin de servicios\n  if (serviciosSection) {\n    serviciosSection.style.display = \"block\";\n  }\n  \n  servicios.forEach((servicio, index) => {\n    const servicioDiv = crearElementoServicio(index, servicio, true);\n    serviciosContainer.appendChild(servicioDiv);\n  });\n  \n  // Actualizar estado del botn despus de crear los servicios\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\n/**\n * Agrega un nuevo servicio manualmente\n */\nfunction agregarNuevoServicio() {\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  \n  if (!serviciosContainer) return;\n  \n  // Mostrar seccin si est oculta\n  if (serviciosSection) {\n    serviciosSection.style.display = \"block\";\n  }\n  \n  // Contar servicios existentes\n  const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n  const nuevoIndex = servicioItems.length;\n  \n  // Crear nuevo servicio (sin required porque es manual)\n  const nuevoServicio = crearElementoServicio(nuevoIndex, {}, false);\n  serviciosContainer.appendChild(nuevoServicio);\n  \n  // Scroll suave hacia el nuevo servicio\n  if (nuevoServicio.scrollIntoView) {\n    nuevoServicio.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n  }\n  \n  // Actualizar estado del botn\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\n/**\n * Muestra la seccin de hotel y hace los campos required\n */\nfunction mostrarSeccionHotel() {\n  const hotelSection = document.getElementById(\"hotelSection\");\n  const agregarHotelButton = document.getElementById(\"agregarHotel\");\n  \n  if (hotelSection) {\n    hotelSection.style.display = \"block\";\n  }\n  \n  if (agregarHotelButton) {\n    agregarHotelButton.style.display = \"none\";\n  }\n  \n  // Hacer campos required cuando se agrega manualmente\n  const camposHotel = ['hotel_nombre', 'hotel_tipo_habitacion', 'hotel_ciudad', 'hotel_in', 'hotel_out'];\n  camposHotel.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.required = true;\n    }\n  });\n  \n  // Actualizar estado del botn\n  setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n}\n\n/**\n * Elimina un servicio del formulario\n * @param {HTMLElement} servicioDiv - El elemento div del servicio a eliminar\n */\nfunction eliminarServicio(servicioDiv) {\n  try {\n    const serviciosContainer = document.getElementById(\"serviciosContainer\");\n    if (!serviciosContainer) return;\n    \n    const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n    \n    // No permitir eliminar si solo hay un servicio y es de extraccin (required)\n    if (servicioItems.length <= 1) {\n      const primerCampo = servicioDiv.querySelector(\"[required]\");\n      if (primerCampo) {\n        mostrarMensaje(\"Debe haber al menos un servicio cuando vienen de la extraccin\", \"info\");\n        return;\n      }\n    }\n    \n    // Eliminar el servicio\n    servicioDiv.remove();\n    \n    // Renumerar servicios\n    renumerarServicios();\n    \n    mostrarMensaje(\"Servicio eliminado correctamente\", \"success\");\n    \n    // Actualizar estado del botn despus de eliminar\n    setTimeout(() => actualizarEstadoBotonCrearReserva(), 200);\n  } catch (error) {\n    mostrarMensaje(\"Error al eliminar servicio\", \"error\");\n  }\n}\n\n/**\n * Renumera los servicios despus de eliminar uno\n */\nfunction renumerarServicios() {\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  if (!serviciosContainer) return;\n  \n  const servicioItems = Array.from(serviciosContainer.querySelectorAll(\".servicio-item\"));\n  \n  servicioItems.forEach((servicioDiv, index) => {\n    const nuevoIndex = index;\n    \n    // Actualizar el dataset\n    servicioDiv.dataset.servicioIndex = nuevoIndex;\n    \n    // Actualizar el ttulo\n    const tituloDiv = servicioDiv.querySelector(\"div:first-child\");\n    if (tituloDiv) {\n      const titulo = tituloDiv.querySelector(\"h4\");\n      if (titulo) {\n        titulo.textContent = `Servicio ${nuevoIndex + 1}`;\n      }\n    }\n    \n    // Actualizar IDs de todos los campos - buscar por patrn dentro del div\n    const campos = [\n      'servicio_destino',\n      'servicio_in',\n      'servicio_out',\n      'servicio_nts',\n      'servicio_basePax',\n      'servicio_servicio',\n      'servicio_descripcion',\n      'servicio_estado'\n    ];\n    \n    campos.forEach(campoBase => {\n      // Buscar el campo dentro del servicioDiv por el patrn del ID\n      const campoViejo = servicioDiv.querySelector(`[id^=\"${campoBase}_\"]`);\n      if (campoViejo) {\n        // Guardar el valor actual antes de cambiar el ID (especialmente para select)\n        const valorActual = campoViejo.value;\n        \n        campoViejo.id = `${campoBase}_${nuevoIndex}`;\n        \n        // Restaurar el valor despus de cambiar el ID\n        campoViejo.value = valorActual;\n        \n        // Actualizar el list del datalist si es el campo servicio\n        if (campoBase === 'servicio_servicio') {\n          const datalistId = `serviciosList_${nuevoIndex}`;\n          campoViejo.setAttribute('list', datalistId);\n          \n          // Actualizar el datalist\n          const datalist = servicioDiv.querySelector('datalist');\n          if (datalist) {\n            datalist.id = datalistId;\n          }\n        }\n      }\n    });\n    \n    // Actualizar el data-servicio-index del botn eliminar\n    const btnEliminar = servicioDiv.querySelector('.btn-eliminar-servicio');\n    if (btnEliminar) {\n      btnEliminar.setAttribute('data-servicio-index', nuevoIndex);\n    }\n  });\n}\n\n/**\n * Llena los vuelos en el formulario\n * @param {Array} vuelos - Array de vuelos extrados\n */\nfunction llenarVuelos(vuelos) {\n  const vuelosContainer = document.getElementById(\"vuelosContainer\");\n  if (!vuelosContainer) return;\n  \n  vuelosContainer.innerHTML = \"\";\n  \n  vuelos.forEach((vuelo, index) => {\n    const vueloDiv = document.createElement(\"div\");\n    vueloDiv.className = \"vuelo-item\";\n    vueloDiv.innerHTML = `\n      <h4>Vuelo ${index + 1}</h4>\n      <div class=\"form-group\">\n        <label>Aerolnea:</label>\n        <input type=\"text\" id=\"vuelo_airline_${index}\" value=\"${vuelo.airline || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Nmero de Vuelo:</label>\n        <input type=\"text\" id=\"vuelo_flightNumber_${index}\" value=\"${vuelo.flightNumber || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Origen:</label>\n        <input type=\"text\" id=\"vuelo_origin_${index}\" value=\"${vuelo.origin || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Destino:</label>\n        <input type=\"text\" id=\"vuelo_destination_${index}\" value=\"${vuelo.destination || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Fecha:</label>\n        <input type=\"date\" id=\"vuelo_date_${index}\" value=\"${vuelo.date || ''}\" readonly>\n      </div>\n      <div class=\"form-group\">\n        <label>Hora:</label>\n        <input type=\"time\" id=\"vuelo_time_${index}\" value=\"${vuelo.time || ''}\" readonly>\n      </div>\n    `;\n    vuelosContainer.appendChild(vueloDiv);\n  });\n}\n\n/**\n * Valida si todos los campos obligatorios estn completos\n * @returns {boolean} true si todos los campos estn completos\n */\nfunction validarCamposObligatorios() {\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (!container) return false;\n  \n  const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n  if (pasajeros.length === 0) return false;\n  \n  // Validar pasajeros (solo nombre y apellido)\n  let pasajerosValidos = true;\n  pasajeros.forEach((pasajeroDiv) => {\n    const numero = pasajeroDiv.dataset.numeroPasajero;\n    const content = pasajeroDiv.querySelector(\".pasajero-content\");\n    \n    if (content) {\n      const nombre = content.querySelector(`#nombre_${numero}`)?.value || \"\";\n      const apellido = content.querySelector(`#apellido_${numero}`)?.value || \"\";\n      \n      if (nombre.trim() === \"\" || apellido.trim() === \"\") {\n        pasajerosValidos = false;\n      }\n    }\n  });\n  \n  // Validar datos de reserva (todos obligatorios)\n  const tipoReserva = document.getElementById(\"tipoReserva\")?.value || \"\";\n  const estadoReserva = document.getElementById(\"estadoReserva\")?.value || \"\";\n  const fechaViaje = document.getElementById(\"fechaViaje\")?.value || \"\";\n  const vendedor = document.getElementById(\"vendedor\")?.value || \"\";\n  const cliente = document.getElementById(\"cliente\")?.value || \"\";\n  \n  const reservaValida = \n    tipoReserva.trim() !== \"\" &&\n    estadoReserva.trim() !== \"\" &&\n    fechaViaje.trim() !== \"\" &&\n    vendedor.trim() !== \"\" &&\n    cliente.trim() !== \"\";\n  \n  // Validar campos obligatorios del hotel (solo si la seccin est visible)\n  const hotelSection = document.getElementById(\"hotelSection\");\n  let hotelValido = true;\n  \n  if (hotelSection && hotelSection.style.display !== \"none\") {\n    const hotelNombre = document.getElementById(\"hotel_nombre\");\n    const hotelTipoHabitacion = document.getElementById(\"hotel_tipo_habitacion\");\n    const hotelCiudad = document.getElementById(\"hotel_ciudad\");\n    const hotelIn = document.getElementById(\"hotel_in\");\n    const hotelOut = document.getElementById(\"hotel_out\");\n    \n    // Solo validar si los campos son required\n    if (hotelNombre?.required && (!hotelNombre.value || hotelNombre.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelTipoHabitacion?.required && (!hotelTipoHabitacion.value || hotelTipoHabitacion.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelCiudad?.required && (!hotelCiudad.value || hotelCiudad.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelIn?.required && (!hotelIn.value || hotelIn.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n    if (hotelOut?.required && (!hotelOut.value || hotelOut.value.trim() === \"\")) {\n      hotelValido = false;\n    }\n  }\n  \n  // Validar campos obligatorios de servicios (solo si la seccin est visible)\n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  const serviciosContainer = document.getElementById(\"serviciosContainer\");\n  let serviciosValidos = true;\n  \n  if (serviciosSection && serviciosSection.style.display !== \"none\" && serviciosContainer) {\n    const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n    \n    if (servicioItems.length > 0) {\n      servicioItems.forEach((item, index) => {\n        const destino = document.getElementById(`servicio_destino_${index}`);\n        const servicioIn = document.getElementById(`servicio_in_${index}`);\n        const servicioOut = document.getElementById(`servicio_out_${index}`);\n        const nts = document.getElementById(`servicio_nts_${index}`);\n        const basePax = document.getElementById(`servicio_basePax_${index}`);\n        const servicio = document.getElementById(`servicio_servicio_${index}`);\n        const descripcion = document.getElementById(`servicio_descripcion_${index}`);\n        const estado = document.getElementById(`servicio_estado_${index}`);\n        \n        // Solo validar si los campos son required\n        if (destino?.required && (!destino.value || destino.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (servicioIn?.required && (!servicioIn.value || servicioIn.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (servicioOut?.required && (!servicioOut.value || servicioOut.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (nts?.required && (nts.value === null || nts.value === undefined || nts.value === \"\")) {\n          serviciosValidos = false;\n        }\n        if (basePax?.required && (!basePax.value || basePax.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (servicio?.required && (!servicio.value || servicio.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (descripcion?.required && (!descripcion.value || descripcion.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n        if (estado?.required && (!estado.value || estado.value.trim() === \"\")) {\n          serviciosValidos = false;\n        }\n      });\n    }\n  }\n  \n  return pasajerosValidos && reservaValida && hotelValido && serviciosValidos;\n}\n\n/**\n * Actualiza el texto del botn segn si es crear o editar\n * @param {boolean} isEdit - Si es true, muestra \"Editar Reserva\"; si es false, muestra \"Crear Reserva\"\n */\nfunction actualizarTextoBotonReserva(isEdit = false) {\n  const boton = document.getElementById(\"crearReserva\");\n  if (!boton) return;\n  \n  const label = boton.querySelector('.ms-Button-label');\n  if (label) {\n    const texto = isEdit \n      ? \" Editar Reserva en iTraffic\" \n      : \" Crear Reserva en iTraffic\";\n    label.textContent = texto;\n    console.log(' Texto del botn actualizado:', texto, 'isEdit:', isEdit);\n  }\n}\n\n/**\n * Actualiza el estado del botn \"Crear Reserva\" segn la validacin\n */\nfunction actualizarEstadoBotonCrearReserva() {\n  const boton = document.getElementById(\"crearReserva\");\n  if (!boton) return;\n  \n  const esValido = validarCamposObligatorios();\n  const doesReservationExist = extractionState.doesReservationExist === true;\n  \n  // Log para debug\n  console.log(' actualizarEstadoBotonCrearReserva - doesReservationExist:', doesReservationExist, 'extractionState:', extractionState);\n  \n  // Actualizar el texto del botn segn el estado (usar doesReservationExist para crear/editar)\n  actualizarTextoBotonReserva(doesReservationExist);\n  \n  if (esValido) {\n    boton.disabled = false;\n    boton.style.opacity = \"1\";\n    boton.style.cursor = \"pointer\";\n  } else {\n    boton.disabled = true;\n    boton.style.opacity = \"0.5\";\n    boton.style.cursor = \"not-allowed\";\n  }\n}\n\n/**\n * Deshabilita todos los campos del formulario\n */\nfunction deshabilitarFormularios() {\n  // Deshabilitar campos de pasajeros\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const inputs = container.querySelectorAll(\"input, select\");\n    inputs.forEach(input => {\n      input.disabled = true;\n      input.style.backgroundColor = \"#f3f4f6\";\n      input.style.cursor = \"not-allowed\";\n    });\n    \n    // Deshabilitar botones de eliminar pasajero\n    const botonesEliminar = container.querySelectorAll(\".btn-eliminar-pasajero\");\n    botonesEliminar.forEach(btn => {\n      btn.disabled = true;\n      btn.style.opacity = \"0.3\";\n      btn.style.cursor = \"not-allowed\";\n      btn.style.pointerEvents = \"none\";\n    });\n  }\n  \n  // Deshabilitar campos de reserva\n  const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n  camposReserva.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.disabled = true;\n      campo.style.backgroundColor = \"#f3f4f6\";\n      campo.style.cursor = \"not-allowed\";\n    }\n  });\n  \n  // Deshabilitar botn de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.disabled = true;\n    btnAgregar.style.opacity = \"0.5\";\n    btnAgregar.style.cursor = \"not-allowed\";\n  }\n  \n  // Deshabilitar botn de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.disabled = true;\n    btnGuardar.style.opacity = \"0.5\";\n    btnGuardar.style.cursor = \"not-allowed\";\n  }\n}\n\n/**\n * Resetea la aplicacin al estado inicial\n */\nfunction resetearAplicacion() {\n  // Ocultar resultados\n  const resultsDiv = document.getElementById(\"results\");\n  if (resultsDiv) {\n    resultsDiv.style.display = \"none\";\n  }\n  \n  // Mostrar botn de extraer\n  const runButton = document.getElementById(\"run\");\n  if (runButton) {\n    runButton.style.display = \"block\";\n  }\n  \n  // Ocultar botn de re-extraccin\n  const reextractButton = document.getElementById(\"reextract\");\n  if (reextractButton) {\n    reextractButton.style.display = \"none\";\n  }\n  \n  // Limpiar contenedores y asegurar que estn habilitados\n  const pasajerosContainer = document.getElementById(\"pasajerosContainer\");\n  if (pasajerosContainer) {\n    pasajerosContainer.innerHTML = \"\";\n    // Asegurar que el contenedor est visible\n    const resultsDiv = document.getElementById(\"results\");\n    if (resultsDiv) {\n      // No forzar display aqu, se mostrar cuando se extraiga\n    }\n  }\n  \n  // Resetear estado de extraccin\n  extractionState = {\n    didExtractionExist: false,\n    doesReservationExist: false,\n    reservationCode: null,\n    originData: null,\n    createdReservationCode: null\n  };\n  \n  // Restaurar HTML original de datosReservaSection\n  const datosReservaSection = document.getElementById(\"datosReservaSection\");\n  if (datosReservaSection && datosReservaSectionOriginalHTML) {\n    datosReservaSection.innerHTML = datosReservaSectionOriginalHTML;\n    // Repoblar los selects despus de restaurar\n    setTimeout(() => {\n      poblarSelectReserva();\n      // Asegurar que los campos estn habilitados\n      const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n      camposReserva.forEach(campoId => {\n        const campo = document.getElementById(campoId);\n        if (campo) {\n          campo.disabled = false;\n          campo.style.backgroundColor = \"\";\n          campo.style.cursor = \"\";\n          campo.value = \"\";\n        }\n      });\n    }, 100);\n  } else {\n    // Si no hay HTML original guardado, limpiar campos manualmente\n    const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n    camposReserva.forEach(campoId => {\n      const campo = document.getElementById(campoId);\n      if (campo) {\n        campo.disabled = false;\n        campo.style.backgroundColor = \"\";\n        campo.style.cursor = \"\";\n        campo.value = \"\";\n      }\n    });\n  }\n  \n  // Ocultar secciones de hotel y servicios\n  const hotelSection = document.getElementById(\"hotelSection\");\n  if (hotelSection) {\n    hotelSection.style.display = \"none\";\n  }\n  \n  const serviciosSection = document.getElementById(\"serviciosSection\");\n  if (serviciosSection) {\n    serviciosSection.style.display = \"none\";\n  }\n  \n  const vuelosSection = document.getElementById(\"vuelosSection\");\n  if (vuelosSection) {\n    vuelosSection.style.display = \"none\";\n  }\n  \n  // Ocultar botn de crear otra reserva si existe\n  const botonCrearOtra = document.getElementById(\"crearOtraReserva\");\n  if (botonCrearOtra) {\n    botonCrearOtra.remove();\n  }\n}\n\n/**\n * Convierte los formularios a modo lectura (texto plano)\n * @param {string} reservationCode - Cdigo de la reserva creada/editada\n */\nfunction convertirAModoLectura(reservationCode = null) {\n  // Convertir pasajeros a modo lectura\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    \n    pasajeros.forEach((pasajeroDiv) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      \n      if (content) {\n        // Obtener valores actuales\n        const datos = {\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        // Crear HTML en modo lectura\n        content.innerHTML = `\n          <div class=\"campo-lectura\">\n            <label>Tipo de Pasajero:</label>\n            <p>${datos.tipoPasajero || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Nombre:</label>\n            <p>${datos.nombre || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Apellido:</label>\n            <p>${datos.apellido || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>DNI:</label>\n            <p>${datos.dni || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Fecha de Nacimiento:</label>\n            <p>${datos.fechaNacimiento || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>CUIL:</label>\n            <p>${datos.cuil || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Tipo de Documento:</label>\n            <p>${datos.tipoDoc || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Sexo:</label>\n            <p>${datos.sexo || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Nacionalidad:</label>\n            <p>${datos.nacionalidad || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Direccin:</label>\n            <p>${datos.direccion || '-'}</p>\n          </div>\n          <div class=\"campo-lectura\">\n            <label>Nmero de Telfono:</label>\n            <p>${datos.telefono || '-'}</p>\n          </div>\n        `;\n      }\n      \n      // Ocultar botn de eliminar\n      const btnEliminar = pasajeroDiv.querySelector(\".btn-eliminar-pasajero\");\n      if (btnEliminar) {\n        btnEliminar.style.display = \"none\";\n      }\n    });\n  }\n  \n  // Convertir datos de reserva a modo lectura\n  const datosReservaSection = document.getElementById(\"datosReservaSection\");\n  if (datosReservaSection) {\n    // Usar el cdigo de reserva pasado como parmetro o el guardado en el estado\n    const codigoReserva = reservationCode || extractionState.createdReservationCode || null;\n    \n    const datosReserva = {\n      tipoReserva: document.getElementById(\"tipoReserva\")?.value || \"\",\n      estadoReserva: document.getElementById(\"estadoReserva\")?.value || \"\",\n      fechaViaje: document.getElementById(\"fechaViaje\")?.value || \"\",\n      vendedor: document.getElementById(\"vendedor\")?.value || \"\",\n      cliente: document.getElementById(\"cliente\")?.value || \"\"\n    };\n    \n    datosReservaSection.innerHTML = `\n      <h3>Datos de la Reserva</h3>\n      ${codigoReserva ? `\n      <div class=\"campo-lectura\">\n        <label>Cdigo de Reserva:</label>\n        <p><strong>${codigoReserva}</strong></p>\n      </div>\n      ` : ''}\n      <div class=\"campo-lectura\">\n        <label>Tipo de Reserva:</label>\n        <p>${datosReserva.tipoReserva || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Estado:</label>\n        <p>${datosReserva.estadoReserva || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Fecha de Viaje:</label>\n        <p>${datosReserva.fechaViaje || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Vendedor:</label>\n        <p>${datosReserva.vendedor || '-'}</p>\n      </div>\n      <div class=\"campo-lectura\">\n        <label>Cliente:</label>\n        <p>${datosReserva.cliente || '-'}</p>\n      </div>\n    `;\n    \n    // Agregar botn \"Crear otra reserva\" dentro de la misma seccin\n    if (!document.getElementById(\"crearOtraReserva\")) {\n      const botonCrearOtra = document.createElement(\"button\");\n      botonCrearOtra.id = \"crearOtraReserva\";\n      botonCrearOtra.className = \"ms-Button\";\n      botonCrearOtra.style.cssText = \"margin-top: 20px; padding: 12px 24px; background: #0078d4; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;\";\n      botonCrearOtra.innerHTML = '<span class=\"ms-Button-label\"> Crear otra reserva</span>';\n      botonCrearOtra.onclick = function() {\n        resetearAplicacion();\n      };\n      \n      // Insertar despus de la seccin de datos de reserva\n      datosReservaSection.appendChild(botonCrearOtra);\n    }\n  }\n  \n  // Ocultar botn de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.style.display = \"none\";\n  }\n  \n  // Ocultar botn de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.style.display = \"none\";\n  }\n  \n  // Ocultar botn de crear reserva\n  const btnCrearReserva = document.getElementById(\"crearReserva\");\n  if (btnCrearReserva) {\n    btnCrearReserva.style.display = \"none\";\n  }\n}\n\n/**\n * Compara dos objetos de datos para detectar cambios en pasajeros, servicios y hotel\n * @param {Object} originData - Data original de la extraccin\n * @param {Array} nuevosPasajeros - Pasajeros actuales del formulario\n * @param {Array} nuevosServicios - Servicios actuales del formulario\n * @param {Object} nuevoHotel - Hotel actual del formulario\n * @returns {Object} Objeto con informacin sobre los cambios detectados\n */\nfunction compararDatos(originData, nuevosPasajeros, nuevosServicios, nuevoHotel) {\n  const cambios = {\n    pasajeros: false,\n    servicios: false,\n    hotel: false,\n    tieneCambios: false\n  };\n  \n  if (!originData) {\n    return cambios;\n  }\n  \n  // Comparar pasajeros\n  const pasajerosOriginales = originData.passengers || [];\n  if (pasajerosOriginales.length !== nuevosPasajeros.length) {\n    cambios.pasajeros = true;\n    cambios.tieneCambios = true;\n  } else {\n    // Comparar cada pasajero\n    for (let i = 0; i < nuevosPasajeros.length; i++) {\n      const nuevo = nuevosPasajeros[i];\n      const original = pasajerosOriginales[i];\n      \n      if (!original || \n          nuevo.nombre !== (original.firstName || '') ||\n          nuevo.apellido !== (original.lastName || '') ||\n          nuevo.dni !== (original.documentNumber || '') ||\n          nuevo.fechaNacimiento !== (original.dateOfBirth || '')) {\n        cambios.pasajeros = true;\n        cambios.tieneCambios = true;\n        break;\n      }\n    }\n  }\n  \n  // Comparar servicios\n  const serviciosOriginales = originData.services || [];\n  if (serviciosOriginales.length !== nuevosServicios.length) {\n    cambios.servicios = true;\n    cambios.tieneCambios = true;\n  } else {\n    // Comparar cada servicio\n    for (let i = 0; i < nuevosServicios.length; i++) {\n      const nuevo = nuevosServicios[i];\n      const original = serviciosOriginales[i];\n      \n      if (!original ||\n          nuevo.destino !== (original.destino || '') ||\n          nuevo.in !== (original.in || '') ||\n          nuevo.out !== (original.out || '') ||\n          nuevo.servicio !== (original.servicio || '')) {\n        cambios.servicios = true;\n        cambios.tieneCambios = true;\n        break;\n      }\n    }\n  }\n  \n  // Comparar hotel\n  const hotelOriginal = originData.hotel || null;\n  if ((hotelOriginal === null && nuevoHotel !== null) ||\n      (hotelOriginal !== null && nuevoHotel === null)) {\n    cambios.hotel = true;\n    cambios.tieneCambios = true;\n  } else if (hotelOriginal && nuevoHotel) {\n    if (hotelOriginal.nombre_hotel !== nuevoHotel.nombre_hotel ||\n        hotelOriginal.Ciudad !== nuevoHotel.Ciudad ||\n        hotelOriginal.in !== nuevoHotel.in ||\n        hotelOriginal.out !== nuevoHotel.out) {\n      cambios.hotel = true;\n      cambios.tieneCambios = true;\n    }\n  }\n  \n  return cambios;\n}\n\n/**\n * Muestra un modal de confirmacin cuando hay cambios en pasajeros, servicios o hotel\n * @param {Object} cambios - Objeto con informacin sobre los cambios detectados\n * @returns {Promise<boolean>} true si el usuario confirma, false si cancela\n */\nfunction mostrarModalConfirmacion(cambios) {\n  return new Promise((resolve) => {\n    // Crear overlay\n    const overlay = document.createElement('div');\n    overlay.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.5);\n      z-index: 10001;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    `;\n    \n    // Crear modal\n    const modal = document.createElement('div');\n    modal.style.cssText = `\n      background: white;\n      padding: 24px;\n      border-radius: 8px;\n      max-width: 500px;\n      width: 90%;\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n    `;\n    \n    // Lista de cambios\n    const cambiosLista = [];\n    if (cambios.pasajeros) cambiosLista.push('Pasajeros');\n    if (cambios.servicios) cambiosLista.push('Servicios');\n    if (cambios.hotel) cambiosLista.push('Hotel');\n    \n    modal.innerHTML = `\n      <h3 style=\"margin-top: 0; margin-bottom: 16px; color: #d32f2f;\"> Advertencia</h3>\n      <p style=\"margin-bottom: 16px; line-height: 1.5;\">\n        Se detectaron cambios en los siguientes elementos que sern <strong>reemplazados</strong>:\n      </p>\n      <ul style=\"margin-bottom: 20px; padding-left: 20px;\">\n        ${cambiosLista.map(item => `<li style=\"margin-bottom: 8px;\">${item}</li>`).join('')}\n      </ul>\n      <p style=\"margin-bottom: 20px; color: #666; font-size: 14px;\">\n        Desea continuar con la edicin?\n      </p>\n      <div style=\"display: flex; gap: 12px; justify-content: flex-end;\">\n        <button id=\"modalCancelar\" style=\"\n          padding: 10px 20px;\n          border: 1px solid #ccc;\n          background: white;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n        \">Cancelar</button>\n        <button id=\"modalContinuar\" style=\"\n          padding: 10px 20px;\n          border: none;\n          background: #0078d4;\n          color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n        \">Continuar</button>\n      </div>\n    `;\n    \n    overlay.appendChild(modal);\n    document.body.appendChild(overlay);\n    \n    // Event listeners\n    document.getElementById('modalCancelar').onclick = () => {\n      document.body.removeChild(overlay);\n      resolve(false);\n    };\n    \n    document.getElementById('modalContinuar').onclick = () => {\n      document.body.removeChild(overlay);\n      resolve(true);\n    };\n    \n    // Cerrar al hacer click fuera del modal\n    overlay.onclick = (e) => {\n      if (e.target === overlay) {\n        document.body.removeChild(overlay);\n        resolve(false);\n      }\n    };\n  });\n}\n\n/**\n * Ejecuta la creacin de reserva en iTraffic usando RPA\n */\nasync function ejecutarCrearReserva() {\n  try {\n    // Obtener datos de todos los pasajeros\n    const container = document.getElementById(\"pasajerosContainer\");\n    if (!container) {\n      mostrarMensaje(\"No se encontr el contenedor de pasajeros\", \"error\");\n      return;\n    }\n    \n    const pasajeros = container.querySelectorAll(\".pasajero-acordeon\");\n    if (pasajeros.length === 0) {\n      mostrarMensaje(\"No hay pasajeros para crear la reserva. Por favor, extraiga datos primero.\", \"info\");\n      return;\n    }\n    \n    // Recopilar datos de todos los pasajeros\n    const todosPasajeros = [];\n    pasajeros.forEach((pasajeroDiv, index) => {\n      const numero = pasajeroDiv.dataset.numeroPasajero;\n      const content = pasajeroDiv.querySelector(\".pasajero-content\");\n      \n      if (content) {\n        const datos = {\n          numeroPasajero: index + 1,\n          tipoPasajero: content.querySelector(`#tipoPasajero_${numero}`)?.value || \"\",\n          nombre: content.querySelector(`#nombre_${numero}`)?.value || \"\",\n          apellido: content.querySelector(`#apellido_${numero}`)?.value || \"\",\n          dni: content.querySelector(`#dni_${numero}`)?.value || \"\",\n          fechaNacimiento: content.querySelector(`#fechaNacimiento_${numero}`)?.value || \"\",\n          cuil: content.querySelector(`#cuil_${numero}`)?.value || \"\",\n          tipoDoc: content.querySelector(`#tipoDoc_${numero}`)?.value || \"\",\n          sexo: content.querySelector(`#sexo_${numero}`)?.value || \"\",\n          nacionalidad: content.querySelector(`#nacionalidad_${numero}`)?.value || \"\",\n          direccion: content.querySelector(`#direccion_${numero}`)?.value || \"\",\n          telefono: content.querySelector(`#telefono_${numero}`)?.value || \"\"\n        };\n        \n        todosPasajeros.push(datos);\n      }\n    });\n    \n    // Capturar datos de la reserva\n    const datosReserva = {\n      tipoReserva: document.getElementById(\"tipoReserva\")?.value || \"\",\n      estadoReserva: document.getElementById(\"estadoReserva\")?.value || \"\",\n      fechaViaje: document.getElementById(\"fechaViaje\")?.value || \"\",\n      vendedor: document.getElementById(\"vendedor\")?.value || \"\",\n      cliente: document.getElementById(\"cliente\")?.value || \"\",\n      codigo: document.getElementById(\"codigo\")?.value || \"\",\n      reservationDate: document.getElementById(\"fechaReserva\")?.value || \"\",\n      tourEndDate: document.getElementById(\"fechaFinTour\")?.value || \"\",\n      dueDate: document.getElementById(\"fechaVencimiento\")?.value || \"\",\n      contact: document.getElementById(\"contacto\")?.value || \"\",\n      contactEmail: document.getElementById(\"contactEmail\")?.value || \"\",\n      contactPhone: document.getElementById(\"contactPhone\")?.value || \"\",\n      currency: document.getElementById(\"moneda\")?.value || \"\",\n      exchangeRate: parseFloat(document.getElementById(\"tipoCambio\")?.value) || 0,\n      commission: parseFloat(document.getElementById(\"comision\")?.value) || 0,\n      netAmount: parseFloat(document.getElementById(\"montoNeto\")?.value) || 0,\n      grossAmount: parseFloat(document.getElementById(\"montoBruto\")?.value) || 0,\n      tripName: document.getElementById(\"nombreViaje\")?.value || \"\",\n      productCode: document.getElementById(\"codigoProducto\")?.value || \"\",\n      adults: parseInt(document.getElementById(\"adultos\")?.value) || 0,\n      children: parseInt(document.getElementById(\"ninos\")?.value) || 0,\n      infants: parseInt(document.getElementById(\"infantes\")?.value) || 0,\n      provider: document.getElementById(\"proveedor\")?.value || \"\",\n      reservationCode: document.getElementById(\"codigoReserva\")?.value || extractionState.reservationCode || \"\",\n      hotel: (() => {\n        const nombreHotel = document.getElementById(\"hotel_nombre\")?.value || \"\";\n        const tipoHabitacion = document.getElementById(\"hotel_tipo_habitacion\")?.value || \"\";\n        const ciudad = document.getElementById(\"hotel_ciudad\")?.value || \"\";\n        const categoria = document.getElementById(\"hotel_categoria\")?.value || null;\n        const hotelIn = document.getElementById(\"hotel_in\")?.value || \"\";\n        const hotelOut = document.getElementById(\"hotel_out\")?.value || \"\";\n        \n        // Si todos los campos obligatorios estn vacos, retornar null\n        if (!nombreHotel && !tipoHabitacion && !ciudad && !hotelIn && !hotelOut) {\n          return null;\n        }\n        \n        return {\n          nombre_hotel: nombreHotel,\n          tipo_habitacion: tipoHabitacion,\n          Ciudad: ciudad,\n          Categoria: categoria || null,\n          in: hotelIn,\n          out: hotelOut\n        };\n      })(),\n      checkIn: document.getElementById(\"checkIn\")?.value || \"\",\n      checkOut: document.getElementById(\"checkOut\")?.value || \"\",\n      estadoDeuda: document.getElementById(\"estadoDeuda\")?.value || \"\"\n    };\n    \n    // Agregar conversationId e itemId del email actual\n    const item = Office.context.mailbox.item;\n    datosReserva.conversationId = item.conversationId || null;\n    datosReserva.itemId = item.itemId || null; // ID del email para Graph API\n    \n    // Capturar servicios\n    const servicios = [];\n    const serviciosContainer = document.getElementById(\"serviciosContainer\");\n    if (serviciosContainer) {\n      const servicioItems = serviciosContainer.querySelectorAll(\".servicio-item\");\n      servicioItems.forEach((item, index) => {\n        servicios.push({\n          destino: document.getElementById(`servicio_destino_${index}`)?.value || \"\",\n          in: document.getElementById(`servicio_in_${index}`)?.value || \"\",\n          out: document.getElementById(`servicio_out_${index}`)?.value || \"\",\n          nts: parseInt(document.getElementById(`servicio_nts_${index}`)?.value) || 0,\n          basePax: parseInt(document.getElementById(`servicio_basePax_${index}`)?.value) || 0,\n          servicio: document.getElementById(`servicio_servicio_${index}`)?.value || \"\",\n          descripcion: document.getElementById(`servicio_descripcion_${index}`)?.value || \"\",\n          estado: document.getElementById(`servicio_estado_${index}`)?.value || \"\"\n        });\n      });\n    }\n    datosReserva.services = servicios;\n    \n    // Capturar vuelos\n    const vuelos = [];\n    const vuelosContainer = document.getElementById(\"vuelosContainer\");\n    if (vuelosContainer) {\n      const vueloItems = vuelosContainer.querySelectorAll(\".vuelo-item\");\n      vueloItems.forEach((item, index) => {\n        vuelos.push({\n          airline: document.getElementById(`vuelo_airline_${index}`)?.value || \"\",\n          flightNumber: document.getElementById(`vuelo_flightNumber_${index}`)?.value || \"\",\n          origin: document.getElementById(`vuelo_origin_${index}`)?.value || \"\",\n          destination: document.getElementById(`vuelo_destination_${index}`)?.value || \"\",\n          date: document.getElementById(`vuelo_date_${index}`)?.value || \"\",\n          time: document.getElementById(`vuelo_time_${index}`)?.value || \"\"\n        });\n      });\n    }\n    datosReserva.flights = vuelos;\n    \n    // VALIDAR CAMPOS OBLIGATORIOS\n    let camposFaltantes = [];\n    \n    // Validar pasajeros (solo nombre y apellido son obligatorios)\n    todosPasajeros.forEach((pasajero, index) => {\n      if (!pasajero.nombre || pasajero.nombre.trim() === \"\") {\n        camposFaltantes.push(`Pasajero ${index + 1}: Nombre`);\n      }\n      if (!pasajero.apellido || pasajero.apellido.trim() === \"\") {\n        camposFaltantes.push(`Pasajero ${index + 1}: Apellido`);\n      }\n    });\n    \n    // Validar datos de reserva (todos obligatorios)\n    if (!datosReserva.tipoReserva || datosReserva.tipoReserva.trim() === \"\") {\n      camposFaltantes.push(\"Tipo de Reserva\");\n    }\n    if (!datosReserva.estadoReserva || datosReserva.estadoReserva.trim() === \"\") {\n      camposFaltantes.push(\"Estado\");\n    }\n    if (!datosReserva.fechaViaje || datosReserva.fechaViaje.trim() === \"\") {\n      camposFaltantes.push(\"Fecha de Viaje\");\n    }\n    if (!datosReserva.vendedor || datosReserva.vendedor.trim() === \"\") {\n      camposFaltantes.push(\"Vendedor\");\n    }\n    if (!datosReserva.cliente || datosReserva.cliente.trim() === \"\") {\n      camposFaltantes.push(\"Cliente\");\n    }\n    \n    // Validar campos obligatorios del hotel (solo si la seccin est visible y tiene campos required)\n    const hotelSection = document.getElementById(\"hotelSection\");\n    if (hotelSection && hotelSection.style.display !== \"none\") {\n      const hotelNombre = document.getElementById(\"hotel_nombre\");\n      const hotelTipoHabitacion = document.getElementById(\"hotel_tipo_habitacion\");\n      const hotelCiudad = document.getElementById(\"hotel_ciudad\");\n      const hotelIn = document.getElementById(\"hotel_in\");\n      const hotelOut = document.getElementById(\"hotel_out\");\n      \n      // Solo validar si los campos son required\n      if (hotelNombre?.required && (!datosReserva.hotel?.nombre_hotel || datosReserva.hotel.nombre_hotel.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Nombre\");\n      }\n      if (hotelTipoHabitacion?.required && (!datosReserva.hotel?.tipo_habitacion || datosReserva.hotel.tipo_habitacion.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Tipo de Habitacin\");\n      }\n      if (hotelCiudad?.required && (!datosReserva.hotel?.Ciudad || datosReserva.hotel.Ciudad.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Ciudad\");\n      }\n      if (hotelIn?.required && (!datosReserva.hotel?.in || datosReserva.hotel.in.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Fecha Entrada\");\n      }\n      if (hotelOut?.required && (!datosReserva.hotel?.out || datosReserva.hotel.out.trim() === \"\")) {\n        camposFaltantes.push(\"Hotel: Fecha Salida\");\n      }\n      \n      // Validar que las fechas de entrada y salida tengan al menos un da de diferencia\n      if (datosReserva.hotel?.in && datosReserva.hotel?.out) {\n        const fechaIn = new Date(datosReserva.hotel.in);\n        const fechaOut = new Date(datosReserva.hotel.out);\n        \n        // Verificar que la fecha de salida sea posterior a la de entrada\n        if (fechaOut <= fechaIn) {\n          mostrarMensaje(\"Las fechas del hotel no son vlidas. La fecha de salida debe ser al menos un da posterior a la fecha de entrada.\", \"error\");\n          return; // NO enviar al RPA\n        }\n        \n        // Calcular la diferencia en das\n        const diferenciaDias = Math.floor((fechaOut - fechaIn) / (1000 * 60 * 60 * 24));\n        \n        if (diferenciaDias < 1) {\n          mostrarMensaje(\"Las fechas del hotel deben tener al menos un da de diferencia. La fecha de salida debe ser posterior a la fecha de entrada.\", \"error\");\n          return; // NO enviar al RPA\n        }\n      }\n    }\n    \n    // Validar campos obligatorios de servicios (solo si la seccin est visible)\n    const serviciosSection = document.getElementById(\"serviciosSection\");\n    if (serviciosSection && serviciosSection.style.display !== \"none\") {\n      if (!datosReserva.services || datosReserva.services.length === 0) {\n        // Solo requerir servicios si hay algn campo required en la seccin\n        const serviciosContainer = document.getElementById(\"serviciosContainer\");\n        if (serviciosContainer) {\n          const primerServicio = serviciosContainer.querySelector(\".servicio-item\");\n          if (primerServicio) {\n            const tieneRequired = primerServicio.querySelector(\"[required]\");\n            if (tieneRequired) {\n              camposFaltantes.push(\"Servicios: Debe haber al menos un servicio\");\n            }\n          }\n        }\n      } else {\n        datosReserva.services.forEach((servicio, index) => {\n          const destino = document.getElementById(`servicio_destino_${index}`);\n          const servicioIn = document.getElementById(`servicio_in_${index}`);\n          const servicioOut = document.getElementById(`servicio_out_${index}`);\n          const nts = document.getElementById(`servicio_nts_${index}`);\n          const basePax = document.getElementById(`servicio_basePax_${index}`);\n          const servicioField = document.getElementById(`servicio_servicio_${index}`);\n          const descripcion = document.getElementById(`servicio_descripcion_${index}`);\n          const estado = document.getElementById(`servicio_estado_${index}`);\n          \n          // Solo validar si los campos son required\n          if (destino?.required && (!servicio.destino || servicio.destino.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Destino`);\n          }\n          if (servicioIn?.required && (!servicio.in || servicio.in.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Fecha Entrada`);\n          }\n          if (servicioOut?.required && (!servicio.out || servicio.out.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Fecha Salida`);\n          }\n          if (nts?.required && (nts.value === null || nts.value === undefined || nts.value === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Noches`);\n          }\n          if (basePax?.required && (!servicio.basePax || servicio.basePax === 0)) {\n            camposFaltantes.push(`Servicio ${index + 1}: Base Pax`);\n          }\n          if (servicioField?.required && (!servicio.servicio || servicio.servicio.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Servicio`);\n          }\n          if (descripcion?.required && (!servicio.descripcion || servicio.descripcion.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Descripcin`);\n          }\n          if (estado?.required && (!servicio.estado || servicio.estado.trim() === \"\")) {\n            camposFaltantes.push(`Servicio ${index + 1}: Estado`);\n          }\n        });\n      }\n    }\n    \n    // Si hay campos faltantes, mostrar error y no enviar\n    if (camposFaltantes.length > 0) {\n      mostrarMensaje(\n        `Por favor completa los siguientes campos obligatorios: ${camposFaltantes.join(', ')}`,\n        \"error\"\n      );\n      return; // NO enviar al RPA\n    }\n    \n    // Obtener el estado de si la reserva existe (convertir explcitamente a booleano)\n    const doesReservationExist = extractionState.doesReservationExist === true;\n    \n    // Log para debug\n    console.log(' ejecutarCrearReserva - doesReservationExist:', doesReservationExist, 'extractionState:', extractionState);\n    \n    // Si es edicin, validar cambios antes de continuar (usar doesReservationExist)\n    if (doesReservationExist && extractionState.originData) {\n      // Capturar servicios y hotel para comparacin\n      const servicios = datosReserva.services || [];\n      const hotel = datosReserva.hotel || null;\n      \n      // Comparar datos\n      const cambios = compararDatos(extractionState.originData, todosPasajeros, servicios, hotel);\n      \n      // Si hay cambios, mostrar modal de confirmacin\n      if (cambios.tieneCambios) {\n        const confirmar = await mostrarModalConfirmacion(cambios);\n        if (!confirmar) {\n          // El usuario cancel, no hacer nada\n          return;\n        }\n      }\n    }\n    \n    // Mostrar mensaje de procesamiento segn si es crear o editar (usar doesReservationExist)\n    const mensajeProcesamiento = doesReservationExist \n      ? \"Editando reserva en iTraffic... Por favor espere.\" \n      : \"Creando reserva en iTraffic... Por favor espere.\";\n    mostrarMensaje(mensajeProcesamiento, \"info\");\n    \n    // DESHABILITAR TODOS LOS CAMPOS\n    deshabilitarFormularios();\n    \n    // Deshabilitar botn mientras se procesa\n    const botonCrearReserva = document.getElementById(\"crearReserva\");\n    if (botonCrearReserva) {\n      botonCrearReserva.disabled = true;\n      botonCrearReserva.style.opacity = \"0.6\";\n      botonCrearReserva.querySelector('.ms-Button-label').textContent = \" Procesando...\";\n    }\n    \n    // Llamar al servicio RPA con los datos de pasajeros y reserva, pasando el estado y la data original si es edicin\n    const originData = doesReservationExist ? extractionState.originData : null;\n    const resultado = await crearReservaEnITraffic(todosPasajeros, datosReserva, doesReservationExist, originData);\n    \n    // Obtener reservationCode de la respuesta\n    const reservationCode = resultado.data?.reservationCode || resultado.reservationCode || null;\n    \n    // Guardar el cdigo de reserva en el estado\n    if (reservationCode) {\n      extractionState.createdReservationCode = reservationCode;\n    }\n    \n    // Mostrar mensaje de xito segn si es crear o editar, incluyendo el cdigo de reserva si existe (usar doesReservationExist)\n    let mensajeExito = doesReservationExist \n      ? \"Reserva editada exitosamente en iTraffic!\" \n      : \"Reserva creada exitosamente en iTraffic!\";\n    \n    if (reservationCode) {\n      mensajeExito += ` Cdigo de la reserva: ${reservationCode}`;\n    }\n    \n    mostrarMensaje(mensajeExito, \"success\");\n    \n    // CONVERTIR A MODO LECTURA (pasar el cdigo de reserva)\n    convertirAModoLectura(reservationCode);\n    \n  } catch (error) {\n    const doesReservationExist = extractionState.doesReservationExist === true;\n    const mensajeError = doesReservationExist \n      ? \"Error al editar reserva: \" + error.message \n      : \"Error al crear reserva: \" + error.message;\n    mostrarMensaje(mensajeError, \"error\");\n    // En caso de error, rehabilitar los formularios\n    habilitarFormularios();\n  }\n}\n\n/**\n * Habilita todos los campos del formulario (en caso de error)\n */\nfunction habilitarFormularios() {\n  // Habilitar campos de pasajeros\n  const container = document.getElementById(\"pasajerosContainer\");\n  if (container) {\n    const inputs = container.querySelectorAll(\"input, select\");\n    inputs.forEach(input => {\n      input.disabled = false;\n      input.style.backgroundColor = \"#ffffff\";\n      input.style.cursor = \"text\";\n    });\n    \n    // Habilitar botones de eliminar pasajero\n    const botonesEliminar = container.querySelectorAll(\".btn-eliminar-pasajero\");\n    botonesEliminar.forEach(btn => {\n      btn.disabled = false;\n      btn.style.opacity = \"1\";\n      btn.style.cursor = \"pointer\";\n      btn.style.pointerEvents = \"auto\";\n    });\n  }\n  \n  // Habilitar campos de reserva\n  const camposReserva = ['tipoReserva', 'estadoReserva', 'fechaViaje', 'vendedor', 'cliente'];\n  camposReserva.forEach(campoId => {\n    const campo = document.getElementById(campoId);\n    if (campo) {\n      campo.disabled = false;\n      campo.style.backgroundColor = \"#ffffff\";\n      campo.style.cursor = \"pointer\";\n    }\n  });\n  \n  // Habilitar botn de agregar pasajero\n  const btnAgregar = document.getElementById(\"agregarPasajero\");\n  if (btnAgregar) {\n    btnAgregar.disabled = false;\n    btnAgregar.style.opacity = \"1\";\n    btnAgregar.style.cursor = \"pointer\";\n  }\n  \n  // Habilitar botn de guardar\n  const btnGuardar = document.getElementById(\"guardar\");\n  if (btnGuardar) {\n    btnGuardar.disabled = false;\n    btnGuardar.style.opacity = \"1\";\n    btnGuardar.style.cursor = \"pointer\";\n  }\n  \n  // Habilitar botn de crear reserva\n  const botonCrearReserva = document.getElementById(\"crearReserva\");\n  if (botonCrearReserva) {\n    const doesReservationExist = extractionState.doesReservationExist === true;\n    botonCrearReserva.disabled = false;\n    botonCrearReserva.style.opacity = \"1\";\n    actualizarTextoBotonReserva(doesReservationExist);\n  }\n}\n\nexport { mostrarMensaje, run, crearFormulariosPasajeros, crearFormularioPasajero, guardarDatos, llenarDatosPasajeros, eliminarPasajero, renumerarPasajeros, agregarNuevoPasajero, ejecutarCrearReserva };\n","/**\n * Encuentra el mejor cliente coincidente usando regex y comparacin de palabras\n * @param {string} clienteBackend - Nombre del cliente que viene del backend/IA\n * @param {Array} clientsList - Array de objetos cliente con propiedad 'name'\n * @returns {string|null} - El nombre del cliente ms coincidente o null si no hay coincidencias suficientes\n */\nexport function encontrarClienteCoincidente(clienteBackend, clientsList) {\n  // Validar parmetros\n  if (!clienteBackend || typeof clienteBackend !== 'string') {\n    return null;\n  }\n  \n  if (!clientsList || !Array.isArray(clientsList) || clientsList.length === 0) {\n    return null;\n  }\n  \n  const clienteNormalizado = clienteBackend.trim();\n  if (clienteNormalizado.length === 0) {\n    return null;\n  }\n  \n  // Paso 1: Coincidencia exacta (case-insensitive)\n  const clienteLower = clienteNormalizado.toLowerCase();\n  for (const cliente of clientsList) {\n    if (cliente && cliente.name && typeof cliente.name === 'string') {\n      const clienteNameLower = cliente.name.trim().toLowerCase();\n      if (clienteNameLower === clienteLower) {\n        return cliente.name; // Retornar el nombre original del cliente\n      }\n    }\n  }\n  \n  // Paso 2: Comparacin por palabras con regex\n  const clienteUpper = clienteNormalizado.toUpperCase();\n  // Dividir en palabras usando regex (espacios, guiones, etc.)\n  const palabrasBackend = clienteUpper.split(/\\s+|[-]/).filter(p => p.length > 0);\n  \n  if (palabrasBackend.length === 0) {\n    return null;\n  }\n  \n  let mejorCoincidencia = null;\n  let maxCoincidencias = 0;\n  let mejorPuntuacion = 0;\n  \n  // Paso 3: Manejo de variaciones sin espacios\n  // Normalizar removiendo espacios para comparacin\n  const clienteSinEspacios = clienteUpper.replace(/\\s+/g, '');\n  \n  for (const cliente of clientsList) {\n    if (!cliente || !cliente.name || typeof cliente.name !== 'string') {\n      continue;\n    }\n    \n    const clienteName = cliente.name.trim();\n    const clienteNameUpper = clienteName.toUpperCase();\n    const clienteNameSinEspacios = clienteNameUpper.replace(/\\s+/g, '');\n    \n    // Verificar coincidencia sin espacios (bidireccional)\n    let tieneCoincidenciaSinEspacios = false;\n    if (clienteSinEspacios.length > 0 && clienteNameSinEspacios.length > 0) {\n      if (clienteSinEspacios === clienteNameSinEspacios) {\n        // Coincidencia exacta sin espacios - retornar inmediatamente\n        return cliente.name;\n      }\n      // Verificar includes bidireccional\n      if (clienteSinEspacios.includes(clienteNameSinEspacios) || \n          clienteNameSinEspacios.includes(clienteSinEspacios)) {\n        tieneCoincidenciaSinEspacios = true;\n      }\n    }\n    \n    // Dividir nombre del cliente en palabras\n    const palabrasLista = clienteNameUpper.split(/\\s+|[-]/).filter(p => p.length > 0);\n    \n    if (palabrasLista.length === 0) {\n      continue;\n    }\n    \n    // Contar palabras que coinciden\n    let coincidencias = 0;\n    let puntuacion = 0;\n    \n    palabrasBackend.forEach(palabraBackend => {\n      // Buscar la palabra en la lista (coincidencia exacta o parcial)\n      const encontrado = palabrasLista.some(palabraLista => {\n        // Coincidencia exacta\n        if (palabraLista === palabraBackend) {\n          puntuacion += 2;\n          return true;\n        }\n        // Coincidencia parcial (una contiene a la otra)\n        if (palabraLista.includes(palabraBackend) || palabraBackend.includes(palabraLista)) {\n          // Solo contar si ambas palabras tienen al menos 3 caracteres para evitar falsos positivos\n          if (palabraBackend.length >= 3 && palabraLista.length >= 3) {\n            puntuacion += 1;\n            return true;\n          }\n        }\n        return false;\n      });\n      \n      if (encontrado) {\n        coincidencias++;\n      }\n    });\n    \n    // Agregar puntuacin por coincidencia sin espacios\n    if (tieneCoincidenciaSinEspacios) {\n      puntuacion += 1.5;\n    }\n    \n    // Si hay ms de una palabra coincidente, considerar esta opcin\n    // O si hay una coincidencia muy significativa (alta puntuacin)\n    if (coincidencias > maxCoincidencias && (coincidencias > 1 || puntuacion >= 2)) {\n      maxCoincidencias = coincidencias;\n      mejorPuntuacion = puntuacion;\n      mejorCoincidencia = cliente.name;\n    } else if (coincidencias === maxCoincidencias && puntuacion > mejorPuntuacion) {\n      // Si hay el mismo nmero de coincidencias, elegir el de mayor puntuacin\n      mejorPuntuacion = puntuacion;\n      mejorCoincidencia = cliente.name;\n    }\n  }\n  \n  // Paso 4: Retornar mejor coincidencia si supera el umbral mnimo\n  // Mnimo requerido: 2 puntos o al menos 2 palabras coincidentes\n  if (maxCoincidencias >= 2 || mejorPuntuacion >= 2) {\n    return mejorCoincidencia;\n  }\n  \n  return null;\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\"> <h2>Extractor de Datos de Pasajero</h2> <p style=\\\"margin-bottom:24px;color:#64748b;font-weight:500\\\">Haz clic en el botn para extraer la informacin del correo:</p> <button id=\\\"run\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\"> Extraer Informacin</span> </button> <div id=\\\"loader\\\" style=\\\"display:none;text-align:center;padding:50px 20px\\\"> <div class=\\\"spinner\\\"></div> <p style=\\\"margin-top:24px;color:#475569;font-weight:600;font-size:1rem\\\">Extrayendo informacin del correo...</p> <p style=\\\"font-size:.9em;color:#94a3b8;margin-top:8px\\\">Por favor espera, esto puede tomar unos segundos</p> </div> <div id=\\\"results\\\" style=\\\"display:none\\\"> <div style=\\\"text-align:right;margin-bottom:16px\\\"> <button id=\\\"reextract\\\" class=\\\"ms-Button btn-secondary\\\" style=\\\"font-size:.9em;padding:10px 18px;width:auto;display:inline-block\\\"> <span class=\\\"ms-Button-label\\\"> Re-extraer</span> </button> </div> <h3>Datos de Pasajeros</h3> <div id=\\\"pasajerosContainer\\\"></div> <button id=\\\"agregarPasajero\\\" class=\\\"ms-Button btn-secondary\\\"> <span class=\\\"ms-Button-label\\\">+ Agregar Pasajero</span> </button> <div id=\\\"datosReservaSection\\\" class=\\\"datos-reserva-section\\\"> <h3>Datos de la Reserva</h3> <div class=\\\"form-group\\\"> <label>Tipo de Reserva: <span style=\\\"color:#ef4444\\\">*</span></label> <select id=\\\"tipoReserva\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"AGENCIAS [COAG]\\\">Agencias [COAG]</option> <option value=\\\"DIRECTA\\\">Directa</option> <option value=\\\"CORPORATIVA\\\">Corporativa</option> </select> </div> <div class=\\\"form-group\\\"> <label>Estado: <span style=\\\"color:#ef4444\\\">*</span></label> <select id=\\\"estadoReserva\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"PENDIENTE DE CONFIRMACION [PC]\\\">Pendiente de Confirmacin [PC]</option> <option value=\\\"CONFIRMADA\\\">Confirmada</option> <option value=\\\"CANCELADA\\\">Cancelada</option> </select> </div> <div class=\\\"form-group\\\"> <label>Fecha de Viaje: <span style=\\\"color:#ef4444\\\">*</span></label> <input type=\\\"date\\\" id=\\\"fechaViaje\\\" required> </div> <div class=\\\"form-group\\\"> <label>Vendedor: <span style=\\\"color:#ef4444\\\">*</span></label> <select id=\\\"vendedor\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"TEST TEST\\\">TEST TEST</option> <option value=\\\"VENDEDOR 1\\\">Vendedor 1</option> <option value=\\\"VENDEDOR 2\\\">Vendedor 2</option> </select> </div> <div class=\\\"form-group\\\"> <label>Cliente: <span style=\\\"color:#ef4444\\\">*</span></label> <select id=\\\"cliente\\\" required> <option value=\\\"\\\">Seleccione...</option> <option value=\\\"DESPEGAR - TEST - 1\\\">DESPEGAR - TEST - 1</option> <option value=\\\"CLIENTE 1\\\">Cliente 1</option> <option value=\\\"CLIENTE 2\\\">Cliente 2</option> </select> </div> <div class=\\\"form-group\\\"> <label>Fecha de Reserva:</label> <input type=\\\"date\\\" id=\\\"fechaReserva\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha Fin de Tour:</label> <input type=\\\"date\\\" id=\\\"fechaFinTour\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha de Vencimiento:</label> <input type=\\\"date\\\" id=\\\"fechaVencimiento\\\"> </div> <div id=\\\"hotelSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Hotel</h3> <div id=\\\"hotelContainer\\\"> <div class=\\\"form-group\\\"> <label>Nombre del Hotel: <span style=\\\"color:#ef4444\\\">*</span></label> <input type=\\\"text\\\" id=\\\"hotel_nombre\\\" placeholder=\\\"Nombre del hotel\\\"> </div> <div class=\\\"form-group\\\"> <label>Tipo de Habitacin: <span style=\\\"color:#ef4444\\\">*</span></label> <input type=\\\"text\\\" id=\\\"hotel_tipo_habitacion\\\" placeholder=\\\"Ej: DWL, SGL, DBL\\\"> </div> <div class=\\\"form-group\\\"> <label>Ciudad: <span style=\\\"color:#ef4444\\\">*</span></label> <input type=\\\"text\\\" id=\\\"hotel_ciudad\\\" placeholder=\\\"Ej: MDZ, BUE\\\"> </div> <div class=\\\"form-group\\\"> <label>Categora:</label> <input type=\\\"text\\\" id=\\\"hotel_categoria\\\" placeholder=\\\"Categora del hotel\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha Entrada Hotel: <span style=\\\"color:#ef4444\\\">*</span></label> <input type=\\\"date\\\" id=\\\"hotel_in\\\"> </div> <div class=\\\"form-group\\\"> <label>Fecha Salida Hotel: <span style=\\\"color:#ef4444\\\">*</span></label> <input type=\\\"date\\\" id=\\\"hotel_out\\\"> </div> </div> </div> <button id=\\\"agregarHotel\\\" class=\\\"ms-Button btn-secondary\\\" style=\\\"margin-top:10px;display:none\\\"> <span class=\\\"ms-Button-label\\\">+ Agregar Hotel</span> </button> <div id=\\\"serviciosSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Servicios</h3> <div id=\\\"serviciosContainer\\\"></div> </div> <button id=\\\"agregarServicio\\\" class=\\\"ms-Button btn-secondary\\\" style=\\\"margin-top:10px\\\"> <span class=\\\"ms-Button-label\\\">+ Agregar Servicio</span> </button> <div id=\\\"vuelosSection\\\" style=\\\"margin-top:20px;display:none\\\"> <h3>Vuelos</h3> <div id=\\\"vuelosContainer\\\"></div> </div> </div> <button id=\\\"crearReserva\\\" class=\\\"ms-Button btn-crear-reserva\\\"> <span class=\\\"ms-Button-label\\\"> Crear Reserva en iTraffic</span> </button> <button id=\\\"guardar\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Guardar Todos los Datos</span> </button> </div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","formatearFecha","fecha","year","month","day","split","error","servicesList","masterData","sellers","clients","statuses","reservationTypes","genders","documentTypes","countries","loaded","extractionState","didExtractionExist","doesReservationExist","reservationCode","originData","createdReservationCode","datosReservaSectionOriginalHTML","mostrarMensaje","mensaje","tipo","mensajeDiv","createElement","className","textContent","style","position","top","left","transform","zIndex","minWidth","maxWidth","textAlign","animation","body","appendChild","setTimeout","parentNode","removeChild","validarFechasHotel","hotelIn","getElementById","hotelOut","value","borderColor","fechaIn","Date","fechaOut","isNaN","getTime","Math","floor","poblarSelectReserva","tipoReservaSelect","innerHTML","forEach","option","name","console","log","estadoSelect","estado","vendedorSelect","vendedor","clienteSelect","cliente","async","run","isReExtract","runButton","display","loader","resultsDiv","Office","context","mailbox","item","getAsync","CoercionType","Text","result","status","AsyncResultStatus","Succeeded","cuerpoCorreo","images","MAX_IMAGE_SIZE","MAX_TOTAL_SIZE","totalSize","warn","attachments","attachment","some","ext","toLowerCase","endsWith","attachmentData","Promise","resolve","reject","getAttachmentContentAsync","id","message","contentType","base64Data","content","binaryString","atob","bytes","Uint8Array","j","charCodeAt","blob","Blob","type","size","toFixed","compressedBlob","comprimirImagen","file","File","push","htmlBody","Html","imgTags","DOMParser","parseFromString","querySelectorAll","img","getAttribute","startsWith","header","contentTypeMatch","match","fileName","extraerImagenesDelEmail","imageError","extractedData","emailContent","extractUrl","RPA_API_URL","formData","FormData","append","userProfile","emailAddress","conversationId","toString","validImagesCount","image","index","response","fetch","method","ok","errorData","json","catch","data","headers","JSON","stringify","userId","extraerDatosConIA","mainContainer","querySelector","classList","remove","reextractButton","passengers","didExtractionExistRaw","doesReservationExistRaw","parse","crearFormulariosPasajeros","datosPasajeros","datos","numero","tipoPasajero","passengerType","paxType","firstName","lastName","documentNumber","dateOfBirth","birthDate","cuilCuit","tipoDocSelect","documentType","sexoSelect","sex","nacionalidadSelect","nationality","direccion","phoneNumber","telefono","actualizarEstadoBotonCrearReserva","datosExtraidos","valorTipoReserva","reservationType","Array","from","options","map","coincidencia","find","opt","includes","estadoReservaSelect","valorEstado","opcionesDisponibles","opciones","trim","valorUpper","travelDate","valorVendedor","seller","valorCliente","client","clienteCoincidente","clienteBackend","clientsList","isArray","clienteNormalizado","clienteLower","clienteUpper","palabrasBackend","filter","mejorCoincidencia","maxCoincidencias","mejorPuntuacion","clienteSinEspacios","clienteNameUpper","clienteNameSinEspacios","tieneCoincidenciaSinEspacios","palabrasLista","coincidencias","puntuacion","palabraBackend","palabraLista","encontrarClienteCoincidente","codigo","reservationDate","tourEndDate","dueDate","contact","contactEmail","contactPhone","currency","exchangeRate","commission","netAmount","grossAmount","tripName","productCode","adults","children","infants","provider","hotelSection","agregarHotelButton","hotel","campoId","campo","required","nombre_hotel","tipo_habitacion","Ciudad","Categoria","in","out","checkIn","checkOut","estadoDeuda","serviciosSection","services","servicios","serviciosContainer","servicio","servicioDiv","crearElementoServicio","llenarServicios","flights","vuelosSection","vuelos","vuelosContainer","vuelo","vueloDiv","airline","flightNumber","origin","destination","date","time","llenarVuelos","actualizarTextoBotonReserva","imageBlob","Image","url","URL","createObjectURL","timeout","revokeObjectURL","onload","clearTimeout","maxDimension","width","height","canvas","ctx","getContext","drawImage","toBlob","onerror","numeroPasajeros","container","pasajeroDiv","crearFormularioPasajero","dataset","numeroPasajero","onclick","target","contains","isOpen","arrow","nombreInput","apellidoInput","addEventListener","stopPropagation","nuevoNumero","eliminarPasajero","valorActual","genero","code","pais","poblarSelectsPasajero","esDeExtraccion","servicioCoincidente","servicioBackend","palabrasClave","servicioLista","encontrarServicioCoincidente","estadoNormalizado","match2","normalizarEstadoServicio","datalistId","requiredAttr","requiredSpan","servicioIndex","destino","nts","basePax","s","join","descripcion","btnEliminar","nuevoIndex","tituloDiv","titulo","campoBase","campoViejo","setAttribute","datalist","renumerarServicios","eliminarServicio","isEdit","boton","label","texto","esValido","pasajeros","pasajerosValidos","nombre","apellido","tipoReserva","estadoReserva","fechaViaje","reservaValida","hotelValido","hotelNombre","hotelTipoHabitacion","hotelCiudad","serviciosValidos","servicioItems","servicioIn","servicioOut","validarCamposObligatorios","disabled","opacity","cursor","onReady","info","host","HostType","Outlook","datosReservaSection","sideloadMsg","appBody","add","guardarButton","todosPasajeros","dni","fechaNacimiento","cuil","tipoDoc","sexo","nacionalidad","guardarDatos","agregarButton","nuevoPasajero","scrollIntoView","behavior","block","agregarNuevoPasajero","mostrarSeccionHotel","agregarServicioButton","nuevoServicio","agregarNuevoServicio","crearReservaButton","datosReserva","parseFloat","parseInt","nombreHotel","tipoHabitacion","ciudad","categoria","itemId","camposFaltantes","pasajero","servicioField","primerServicio","cambios","nuevosPasajeros","nuevosServicios","nuevoHotel","tieneCambios","pasajerosOriginales","nuevo","original","serviciosOriginales","hotelOriginal","compararDatos","confirmar","overlay","cssText","modal","cambiosLista","mostrarModalConfirmacion","input","backgroundColor","btn","pointerEvents","btnAgregar","btnGuardar","deshabilitarFormularios","botonCrearReserva","resultado","datosRPA","emailId","transformarDatosParaRPA","serviceUrl","success","errorMessage","statusText","crearReservaEnITraffic","mensajeExito","codigoReserva","botonCrearOtra","pasajerosContainer","resetearAplicacion","btnCrearReserva","convertirAModoLectura","habilitarFormularios","ejecutarCrearReserva","masterDataUrl","vendedores","clientes","estados","tiposReserva","generos","tiposDoc","paises","cargarDatosMaestros"],"ignoreList":[],"sourceRoot":""}