(()=>{"use strict";Office.onReady(()=>{console.log("üìå Commands loaded")}),Office.actions.associate("showTaskpane",function(e){Office.addin.showAsTaskpane(),e.completed()}),Office.actions.associate("checkStatus",async function(e){try{const e=Office.context.mailbox;e.item&&e.item?.notificationMessages.addAsync("status-check",{type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:"‚úÖ Email Classifier is active",icon:"icon-16",persistent:!1})}catch(e){console.error("Error checking status:",e)}finally{e.completed()}}),Office.actions.associate("classifyEmail",async function(e){console.log("üéØ classifyEmail called");try{const s=Office.context.mailbox,i=s.item;if(!i)return console.error("‚ùå No email item selected"),void e.completed();s.item?.notificationMessages.addAsync("classify-processing",{type:Office.MailboxEnums.ItemNotificationMessageType.ProgressIndicator,message:"ü§ñ Clasificando email..."});const o=Office.context.roamingSettings.get("email-classifier-userId");if(!o)return console.error("‚ùå User not registered"),s.item?.notificationMessages.replaceAsync("classify-processing",{type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:"‚ö†Ô∏è Debes activar el clasificador primero. Abre el panel lateral."}),void e.completed();console.log("üë§ Using userId:",o);const a=i.itemId;if(!a)return console.error("‚ùå No email ID available"),s.item?.notificationMessages.replaceAsync("classify-processing",{type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:"‚ö†Ô∏è Email no disponible para clasificaci√≥n"}),void e.completed();console.log("üìß Classifying email:",a);const c="https://app-itraffic-rpa.whiteflower-4df565a8.eastus2.azurecontainerapps.io",t=await fetch(`${c}/api/classify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:o,messageId:a})});if(!t.ok){const e=await t.json();throw new Error(e.error||e.message||"Error al clasificar")}const n=await t.json();console.log("‚úÖ Classification result:",n),s.item?.notificationMessages.replaceAsync("classify-processing",{type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:`‚úÖ Clasificado como: ${n.categories.join(", ")}`,icon:"icon-16",persistent:!1})}catch(e){console.error("‚ùå Error classifying email:",e),Office.context.mailbox.item?.notificationMessages.replaceAsync("classify-processing",{type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:`‚ö†Ô∏è Error: ${e?.message||"Error desconocido"}`})}finally{e.completed()}})})();
//# sourceMappingURL=commands.js.map